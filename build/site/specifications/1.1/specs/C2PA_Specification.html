<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>C2PA Technical Specification :: C2PA Specifications</title>
    <link rel="canonical" href="https://c2pa.org/specifications/specifications/2.2/specs/C2PA_Specification.html">
    <meta name="page-spec" content="1.1@specifications:specs:C2PA_Specification.adoc">
    <meta name="generator" content="Antora 3.1.7">
    <link rel="stylesheet" href="../../../_/css/site.css">
<link rel="stylesheet" href="../../../_/css/search.css">
    <link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item logo" title="C2PA" href="https://c2pa.org"><img src="../../../_/img/C2PA-logo.svg" alt="C2PA" width="64"></a>
      <a class="navbar-item title" href="../../..">C2PA Specifications</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Download</div>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="../../1.0/specs/_attachments/C2PA_Specification.pdf">Technical Specifications</a> 
            <a class="navbar-item" href="../../1.0/explainer/_attachments/Explainer.pdf">Explainer</a> 
            <a class="navbar-item" href="../../1.0/guidance/_attachments/Guidance.pdf">Guidance for Implementers</a> 
            <a class="navbar-item" href="../../1.0/ux/_attachments/UX_Recommendations.pdf">User Experience Guidance</a> 
            <a class="navbar-item" href="../../1.0/security/_attachments/Security_Considerations.pdf">Security Considerations</a> 
            <a class="navbar-item" href="../../1.0/security/_attachments/Harms_Modelling.pdf">Harms Modelling</a> 
            <a class="navbar-item" href="../../1.0/specs/_attachments/C2PA_Schemas.zip">CDDL and JSON Schemas</a> 
          </div>
        </div>
          <div class="navbar-item">
            <input id="search-input" type="text" placeholder="Search docs">
          </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-item" href="https://asciidoctor.zulipchat.com" target="_blank" rel="noopener" data-title="Communication">
            <span class="icon"><img src="../../../_/img/octicons-24.svg#view-comment-discussion"></span>
          </a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item has-icon" href="https://github.com/c2pa-org" target="_blank" rel="noopener">
              <span class="icon"><img src="../../../_/img/octicons-16.svg#view-mark-github"></span>
              <span>Repository</span>
            </a>
            <a class="navbar-item has-icon" href="https://twitter.com/c2pa" target="_blank" rel="noopener">
              <span class="icon"><img src="../../../_/img/octicons-16.svg#view-hash"></span>
              <span>Tweets</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active is-loading" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" title="Toggle expand/collapse all"></button>
    <h3 class="title"><a href="../index.html">C2PA Specifications</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item is-current-url" data-depth="1">
    <a class="nav-link" href="C2PA_Specification.html">Technical Specifications</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../1.0/explainer/Explainer.html">Explainer</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../1.0/guidance/Guidance.html">Guidance for Implementors</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../1.0/ux/UX_Recommendations.html">User Experience Guidance</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../1.0/security/Security_Considerations.html">C2PA Security Considerations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../1.0/security/Harms_Modelling.html">C2PA Harms Modelling</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
  <script>
;(function () {
  var panel = document.querySelector('.nav-panel-menu')
  var page
  var hash = window.location.hash
  if (hash) {
    if (~hash.indexOf('%')) hash = decodeURIComponent(hash)
    if (~hash.indexOf('"')) hash = hash.replace(/(?=")/g, '\\')
    var link = panel.querySelector('.nav-link[href="' + hash + '"]')
    if (link) page = link.parentNode
    else if ((page = panel.querySelector('.is-current-url'))) page.classList.add('is-provisional')
  } else {
    page = panel.querySelector('.is-current-url')
  }
  if (page) {
    var ancestor = page
    while ((ancestor = ancestor.parentNode) && ancestor !== panel) {
      if (ancestor.className === 'nav-item') ancestor.classList.add('is-current-path', 'is-active')
    }
    page.classList.add('is-current-page', 'is-active')
    if (panel.scrollHeight > panel.clientHeight) {
      var panelRect = panel.getBoundingClientRect()
      var linkRect = page.querySelector('.nav-link').getBoundingClientRect()
      panel.scrollTop += Math.round(linkRect.top - panelRect.top - (panelRect.height - linkRect.height) * 0.5)
    }
  } else {
    panel.scrollTop = 0
  }
  panel.classList.remove('is-loading')
})()
  </script>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">C2PA Specifications</span>
    <span class="version">1.1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../2.2/index.html">C2PA Specifications</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../2.2/index.html">2.2</a>
        </li>
        <li class="version">
          <a href="../../2.1/index.html">2.1</a>
        </li>
        <li class="version">
          <a href="../../2.0/index.html">2.0</a>
        </li>
        <li class="version">
          <a href="../../1.4/index.html">1.4</a>
        </li>
        <li class="version">
          <a href="../../1.3/index.html">1.3</a>
        </li>
        <li class="version">
          <a href="../../1.2/index.html">1.2</a>
        </li>
        <li class="version is-current">
          <a href="../index.html">1.1</a>
        </li>
        <li class="version">
          <a href="../../1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">C2PA Specifications</a></li>
    <li><a href="C2PA_Specification.html">Technical Specifications</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">1.1</button>
  <div class="version-menu">
    <a class="version" href="../../2.2/specs/C2PA_Specification.html">2.2</a>
    <a class="version" href="../../2.1/specs/C2PA_Specification.html">2.1</a>
    <a class="version" href="../../2.0/specs/C2PA_Specification.html">2.0</a>
    <a class="version" href="../../1.4/specs/C2PA_Specification.html">1.4</a>
    <a class="version" href="../../1.3/specs/C2PA_Specification.html">1.3</a>
    <a class="version" href="../../1.2/specs/C2PA_Specification.html">1.2</a>
    <a class="version is-current" href="C2PA_Specification.html">1.1</a>
    <a class="version" href="../../1.0/specs/C2PA_Specification.html">1.0</a>
  </div>
</div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">C2PA Technical Specification</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#_overview">1.1. Overview</a></li>
<li><a href="#_scope">1.2. Scope</a></li>
<li><a href="#_technical_overview">1.3. Technical Overview</a></li>
<li><a href="#_establishing_trust">1.4. Establishing Trust</a></li>
<li><a href="#_an_example">1.5. An Example</a></li>
<li><a href="#_design_goals">1.6. Design Goals</a></li>
</ul>
</li>
<li><a href="#_glossary">2. Glossary</a>
<ul class="sectlevel2">
<li><a href="#_introductory_terms">2.1. Introductory terms</a></li>
<li><a href="#_assets_and_content">2.2. Assets and Content</a></li>
<li><a href="#_core_aspects_of_c2pa">2.3. Core Aspects of C2PA</a></li>
<li><a href="#_additional_terms">2.4. Additional Terms</a></li>
<li><a href="#_overview_2">2.5. Overview</a></li>
</ul>
</li>
<li><a href="#_normative_references">3. Normative References</a>
<ul class="sectlevel2">
<li><a href="#_core_formats">3.1. Core Formats</a></li>
<li><a href="#_schemas">3.2. Schemas</a></li>
<li><a href="#_digital_electronic_signatures">3.3. Digital &amp; Electronic Signatures</a></li>
<li><a href="#_other">3.4. Other</a></li>
</ul>
</li>
<li><a href="#_standard_terms">4. Standard Terms</a></li>
<li><a href="#_version_history">5. Version History</a></li>
<li><a href="#_assertions">6. Assertions</a>
<ul class="sectlevel2">
<li><a href="#_general">6.1. General</a></li>
<li><a href="#_labels">6.2. Labels</a></li>
<li><a href="#_versioning">6.3. Versioning</a></li>
<li><a href="#_multiple_instances">6.4. Multiple Instances</a></li>
<li><a href="#_assertion_store">6.5. Assertion Store</a></li>
<li><a href="#_embedded_vs_externally_stored_data">6.6. Embedded vs Externally-Stored Data</a></li>
<li><a href="#_redaction_of_assertions">6.7. Redaction of Assertions</a></li>
</ul>
</li>
<li><a href="#_unique_identifiers">7. Unique Identifiers</a>
<ul class="sectlevel2">
<li><a href="#_using_xmp">7.1. Using XMP</a></li>
<li><a href="#_other_identifiers">7.2. Other Identifiers</a></li>
<li><a href="#_uri_references">7.3. URI References</a></li>
</ul>
</li>
<li><a href="#_w3c_verifiable_credentials">8. W3C Verifiable Credentials</a>
<ul class="sectlevel2">
<li><a href="#_general_2">8.1. General</a></li>
<li><a href="#_vcstore">8.2. VCStore</a></li>
<li><a href="#_using_credentials">8.3. Using Credentials</a></li>
<li><a href="#_credential_security_considerations">8.4. Credential Security Considerations</a></li>
<li><a href="#_redaction_of_credentials">8.5. Redaction of Credentials</a></li>
</ul>
</li>
<li><a href="#_binding_to_content">9. Binding to Content</a>
<ul class="sectlevel2">
<li><a href="#_overview_3">9.1. Overview</a></li>
<li><a href="#_hard_bindings">9.2. Hard Bindings</a></li>
<li><a href="#_soft_bindings">9.3. Soft Bindings</a></li>
</ul>
</li>
<li><a href="#_claims">10. Claims</a>
<ul class="sectlevel2">
<li><a href="#_overview_4">10.1. Overview</a></li>
<li><a href="#_syntax">10.2. Syntax</a></li>
<li><a href="#_creating_a_claim">10.3. Creating a Claim</a></li>
<li><a href="#_multiple_step_processing">10.4. Multiple Step Processing</a></li>
</ul>
</li>
<li><a href="#_manifests">11. Manifests</a>
<ul class="sectlevel2">
<li><a href="#_use_of_jumbf">11.1. Use of JUMBF</a></li>
<li><a href="#_types_of_manifests">11.2. Types of Manifests</a></li>
<li><a href="#_embedding_manifests_into_assets">11.3. Embedding manifests into assets</a></li>
<li><a href="#_external_manifests">11.4. External Manifests</a></li>
<li><a href="#_embedding_a_reference_to_the_active_manifest">11.5. Embedding a Reference to the Active Manifest</a></li>
</ul>
</li>
<li><a href="#_entity_diagram">12. Entity Diagram</a></li>
<li><a href="#_cryptography">13. Cryptography</a>
<ul class="sectlevel2">
<li><a href="#_hashing">13.1. Hashing</a></li>
<li><a href="#_digital_signatures">13.2. Digital Signatures</a></li>
</ul>
</li>
<li><a href="#_trust_model">14. Trust Model</a>
<ul class="sectlevel2">
<li><a href="#_overview_5">14.1. Overview</a></li>
<li><a href="#_identity_of_signers">14.2. Identity of Signers</a></li>
<li><a href="#_signer_credential_trust">14.3. Signer Credential Trust</a></li>
<li><a href="#_credential_types">14.4. Credential Types</a></li>
<li><a href="#_identity_in_assertions">14.5. Identity In Assertions</a></li>
<li><a href="#_statements">14.6. Statements</a></li>
<li><a href="#_endorsement">14.7. Endorsement</a></li>
</ul>
</li>
<li><a href="#_validation">15. Validation</a>
<ul class="sectlevel2">
<li><a href="#_status_codes">15.1. Status Codes</a></li>
<li><a href="#_locating_the_active_manifest">15.2. Locating the Active Manifest</a></li>
<li><a href="#_locating_the_claim">15.3. Locating the Claim</a></li>
<li><a href="#_validate_the_signature">15.4. Validate the Signature</a></li>
<li><a href="#_validate_the_time_stamp">15.5. Validate the Time-Stamp</a></li>
<li><a href="#_validate_the_credential_revocation_information">15.6. Validate the Credential Revocation Information</a></li>
<li><a href="#_validate_the_assertions">15.7. Validate the Assertions</a></li>
<li><a href="#_recursively_validating_integrity_of_ingredients">15.8. Recursively Validating Integrity of Ingredients</a></li>
<li><a href="#_validate_the_endorsements">15.9. Validate the Endorsements</a></li>
<li><a href="#_visual_look_of_validation">15.10. Visual look of Validation</a></li>
<li><a href="#_validate_the_assets_content">15.11. Validate the Asset&#8217;s Content</a></li>
</ul>
</li>
<li><a href="#_user_experience">16. User Experience</a>
<ul class="sectlevel2">
<li><a href="#_approach">16.1. Approach</a></li>
<li><a href="#_principles">16.2. Principles</a></li>
<li><a href="#_disclosure_levels">16.3. Disclosure Levels</a></li>
<li><a href="#_public_review_feedback_and_evolution">16.4. Public Review, Feedback and Evolution</a></li>
</ul>
</li>
<li><a href="#_information_security">17. Information security</a>
<ul class="sectlevel2">
<li><a href="#_threats_and_security_considerations">17.1. Threats and Security Considerations</a></li>
<li><a href="#_harms_misuse_and_abuse">17.2. Harms, Misuse, and Abuse</a></li>
</ul>
</li>
<li><a href="#_c2pa_standard_assertions">18. C2PA Standard Assertions</a>
<ul class="sectlevel2">
<li><a href="#_introduction_3">18.1. Introduction</a></li>
<li><a href="#_use_of_cbor">18.2. Use of CBOR</a></li>
<li><a href="#_metadata_about_assertions">18.3. Metadata About Assertions</a></li>
<li><a href="#_standard_c2pa_assertion_summary">18.4. Standard C2PA Assertion Summary</a></li>
<li><a href="#_data_hash">18.5. Data Hash</a></li>
<li><a href="#_bmff_based_hash">18.6. BMFF-Based Hash</a></li>
<li><a href="#_soft_binding_2">18.7. Soft Binding</a></li>
<li><a href="#_cloud_data">18.8. Cloud Data</a></li>
<li><a href="#_thumbnail">18.9. Thumbnail</a></li>
<li><a href="#_actions">18.10. Actions</a></li>
<li><a href="#_ingredient">18.11. Ingredient</a></li>
<li><a href="#_depthmap">18.12. Depthmap</a></li>
<li><a href="#_endorsement_assertion">18.13. Endorsement Assertion</a></li>
<li><a href="#_exif_information">18.14. Exif Information</a></li>
<li><a href="#_iptc_photo_metadata">18.15. IPTC Photo Metadata</a></li>
<li><a href="#_use_of_schema_org">18.16. Use of Schema.org</a></li>
<li><a href="#_common_data_model_actor">18.17. Common Data Model: Actor</a></li>
</ul>
</li>
<li><a href="#_open_topics">19. Open Topics</a>
<ul class="sectlevel2">
<li><a href="#_assertions_2">19.1. Assertions</a></li>
<li><a href="#_binding_to_content_2">19.2. Binding to Content</a></li>
<li><a href="#_trust_model_2">19.3. Trust Model</a></li>
<li><a href="#_validation_2">19.4. Validation</a></li>
<li><a href="#_user_experience_2">19.5. User Experience</a></li>
</ul>
</li>
<li><a href="#_patent_policy">20. Patent Policy</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="exampleblock">
<div class="content">
<div class="imageblock text-center">
<div class="content">
<a class="image" href="http://creativecommons.org/licenses/by/4.0/"><img src="_images/CCby4.png" alt="Creative Commons License"></a>
</div>
</div>
<div class="paragraph text-center">
<p>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p>
</div>
<hr>
<div class="paragraph">
<p>THESE MATERIALS ARE PROVIDED “AS IS.” The parties expressly disclaim any warranties (express, implied, or otherwise), including implied warranties of merchantability, non-infringement, fitness for a particular purpose, or title, related to the materials. The entire risk as to implementing or otherwise using the materials is assumed by the implementer and user. IN NO EVENT WILL THE PARTIES BE LIABLE TO ANY OTHER PARTY FOR LOST PROFITS OR ANY FORM OF INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER FROM ANY CAUSES OF ACTION OF ANY KIND WITH RESPECT TO THIS DELIVERABLE OR ITS GOVERNING AGREEMENT, WHETHER BASED ON BREACH OF CONTRACT, TORT (INCLUDING NEGLIGENCE), OR OTHERWISE, AND WHETHER OR NOT THE OTHER MEMBER HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
</div>
</div>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview"><a class="anchor" href="#_overview"></a>1.1. Overview</h3>
<div class="paragraph">
<p>With the increasing velocity of digital content and the increasing availability of powerful creation and editing techniques, establishing the provenance of media is critical to ensure transparency, understanding, and ultimately, trust.</p>
</div>
<div class="paragraph">
<p>We are witnessing extraordinary challenges to trust in media. As social platforms amplify the reach and influence of certain content via ever more complex and opaque algorithms, mis-attributed and mis-contextualized content spreads quickly. Whether inadvertent misinformation or deliberate deception via disinformation, inauthentic content is on the rise.</p>
</div>
<div class="paragraph">
<p>Currently, creators who wish to include metadata about their work (for example, authorship) cannot do so in a secure, tamper-evident and standardized way across platforms. Without this attribution information, publishers and consumers lack critical context for determining the authenticity of media.</p>
</div>
<div class="paragraph">
<p>Provenance empowers content creators and editors, regardless of their geographic location or degree of access to technology, to disclose information about who created or changed an asset, what was changed and how it was changed. Content with provenance provides indicators of authenticity so that consumers can have awareness of who has altered content and what exactly has been changed. This ability to provide provenance for creators, publishers and consumers is essential to facilitating trust online.</p>
</div>
<div class="paragraph">
<p>To address this issue at scale for publishers, creators and consumers, the Coalition for Content Provenance and Authenticity (C2PA) has developed this technical specification for providing content provenance and authenticity. It is designed to enable global, opt-in, adoption of digital provenance techniques through the creation of a rich ecosystem of digital provenance enabled applications for a wide range of individuals and organizations while meeting appropriate security requirements.</p>
</div>
<div class="paragraph">
<p>This specification has been, and continues to be, informed by scenarios, workflows and requirements gathered from industry experts and partner organizations, including the <a href="https://www.originproject.info/">Project Origin Alliance</a> and the <a href="https://contentauthenticity.org/">Content Authenticity Initiative (CAI)</a>. It is also possible that regulatory bodies and governmental agencies could utilize this specification to establish standards for digital provenance.</p>
</div>
</div>
<div class="sect2">
<h3 id="_scope"><a class="anchor" href="#_scope"></a>1.2. Scope</h3>
<div class="paragraph">
<p>This specification describes the technical aspects of the C2PA architecture; a model for storing and accessing cryptographically verifiable information whose trustworthiness can be assessed based on a defined <a href="#_trust_model">trust model</a>. Included in this document is information about how to create and process a C2PA Manifest and its components, including the use of digital signature technology for enabling tamper-evidence as well as establishing trust.</p>
</div>
<div class="paragraph">
<p>Prior to developing this specification, the C2PA created our <a href="https://c2pa.org/principles/">Guiding Principles</a> that enabled us to remain focused on ensuring that the specification can be used in ways that respect privacy and personal control of data with a critical eye toward potential abuse and misuse. For example, the creators and publishers of the media assets always have control over whether provenance data is included as well as what specific pieces of data are included.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>From the overarching goals section of the guiding principles:</p>
</div>
<div class="quoteblock">
<blockquote>
C2PA specifications SHOULD NOT provide value judgments about whether a given set of provenance data is 'good' or 'bad,' merely whether the assertions included within can be validated as associated with the underlying asset, correctly formed, and free from tampering.
</blockquote>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is important that the specification does not negatively impact content accessibility for consumers.</p>
</div>
<div class="paragraph">
<p>Other documents from the C2PA will address specific implementation considerations such as expected user experiences and details of our threat and harms modelling.</p>
</div>
</div>
<div class="sect2">
<h3 id="_technical_overview"><a class="anchor" href="#_technical_overview"></a>1.3. Technical Overview</h3>
<div class="paragraph">
<p>The C2PA information comprises a series of statements that cover areas such as asset creation, authorship, edit actions, capture device details, bindings to content and many other subjects. These statements, called <a href="#_assertion">Assertions</a>, make up the provenance of a given asset and represent a series of trust signals that can be used by a human to improve their view of trustworthiness concerning the asset. Assertions are wrapped up with additional information into a <a href="#_digital_signatures">digitally signed</a> entity called a <a href="#_claim">Claim</a>.</p>
</div>
<div class="paragraph">
<p>The <a href="https://www.w3.org/TR/vc-data-model">W3C Verifiable Credentials</a> of individual actors that are involved in the creation of the assertions can be added to the C2PA information to provide additional trust signals to the process of assessing trustworthiness of the asset.</p>
</div>
<div class="paragraph">
<p>These assertions, claims, credentials and signatures are all bound together into a verifiable unit called a <a href="#_c2pa_manifest">C2PA Manifest</a> by a hardware or software component called a Claim Generator. The set of C2PA Manifests, as stored in the asset&#8217;s C2PA Manifest Store, represent its provenance data.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/Manifest.drawio.svg" alt="A C2PA Manifest and its parts" height="150">
</div>
<div class="title">Figure 1. A C2PA Manifest and its constituent parts</div>
</div>
</div>
<div class="sect2">
<h3 id="_establishing_trust"><a class="anchor" href="#_establishing_trust"></a>1.4. Establishing Trust</h3>
<div class="paragraph">
<p>The basis of making trust decisions in C2PA, our <a href="#_trust_model">Trust Model</a>, is the identity of the actor associated with the cryptographic signing key used to sign the claim in the Active Manifest. The identity of a signatory is not necessarily a human actor, and the identity presented may be a pseudonym, completely anonymous, or pertain to a service or trusted hardware device with its own identity, including an application running inside such a service or trusted hardware. C2PA Manifests can be validated indefinitely regardless of whether the cryptographic credentials used to sign its contents are later expired or revoked.</p>
</div>
</div>
<div class="sect2">
<h3 id="_an_example"><a class="anchor" href="#_an_example"></a>1.5. An Example</h3>
<div class="paragraph">
<p>A very common scenario will be a user (called an actor in the C2PA ecosystem) taking a photograph with their C2PA-enabled camera (or phone). In that instance, the camera would create a manifest containing some such assertions including information about the camera itself, a thumbnail of the image and some cryptographic hashes that bind the photograph to the manifest. These assertions would then be listed in the Claim, which would be digitally signed and then the entire manifest would be embedded into the output JPEG. This manifest would remain valid indefinitely.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/Photo_Manifest.svg" alt="Example C2PA Manifest of a Photograph" width="284" height="424">
</div>
<div class="title">Figure 2. Example C2PA Manifest of a Photograph</div>
</div>
<div class="paragraph">
<p>A Manifest Consumer, such as a C2PA Validator, could help users to establish the trustworthiness of the asset by first validating the digital signature and its associated credential. It can also check each of the assertions for validity and present the information contained in them, and the signature, to the user in a way that they can then make an informed decision about the trustworthiness of the digital content.</p>
</div>
</div>
<div class="sect2">
<h3 id="_design_goals"><a class="anchor" href="#_design_goals"></a>1.6. Design Goals</h3>
<div class="paragraph">
<p>In the creation of the C2PA architecture, it was important to establish some clear goals for the work to ensure that the technology was usable across a wide spectrum of hardware and software implementations worldwide and accessible to all.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Goal</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privacy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enable actors to control the privacy of their information, including identity, consumption data and information recorded in provenance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Responsibility</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure consumers can determine the provenance of an asset</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scalability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enable creation/consumption/validation of media provenance at the same scale as media creation/consumption on the web</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extensibility</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure future metadata and credential providers are able to add their information without requiring input or approval from the C2PA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interoperability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure that differing implementations are able to operate with each other without ambiguity</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whole Workflow Applicability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maintain the provenance of the asset across multiple tools, from creation through all subsequent modification and publication/distribution</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Technology Minimalism</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create only the minimum required novel technology in the specification by relying on prior, well-established techniques</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Design to ensure that consumers can trust the integrity and source of provenance, and ensure the design is reviewed by experts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Content Ubiquity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enable the inclusion of provenance for all common media types, including documents</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flexible Locality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enable both online and offline (asset-only) storage and consumption/validation of provenance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Global Universality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Design for the needs of interested users throughout the world</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Accessibility</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure that the technology can be used in a way that conform to recognized accessibility standards, such as WCAG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Harms and Misuse</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Design to avert and mitigate potential harms, including threats to human rights and disproportionate risks to vulnerable groups</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Evolving</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Continuous review of the specification against these goals to ensure that they remain our priority</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_glossary"><a class="anchor" href="#_glossary"></a>2. Glossary</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introductory_terms"><a class="anchor" href="#_introductory_terms"></a>2.1. Introductory terms</h3>
<div class="sect3">
<h4 id="_actor"><a class="anchor" href="#_actor"></a>2.1.1. Actor</h4>
<div class="paragraph">
<p>A human or non-human (hardware or software) that is participating in the C2PA ecosystem. For example: a camera (capture device), image editing software, cloud service or the person using such tools.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
An organization or group of <em>actors</em> may also be considered an <em>actor</em> in the C2PA ecosystem.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_signer"><a class="anchor" href="#_signer"></a>2.1.2. Signer</h4>
<div class="paragraph">
<p>An <em>actor</em> (human or non-human) whose credential&#8217;s private key is used to sign the <em>claim</em>.  The <em>signer</em> is identified by the subject of the credential.</p>
</div>
</div>
<div class="sect3">
<h4 id="_claim_generator"><a class="anchor" href="#_claim_generator"></a>2.1.3. Claim generator</h4>
<div class="paragraph">
<p>The non-human (hardware or software) <em>actor</em> that generates the <em>claim</em> about an <em>asset</em> as well as the <em>claim signature</em>, thus leading to the <em>asset</em>'s associated <em>manifest</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_manifest_consumer"><a class="anchor" href="#_manifest_consumer"></a>2.1.4. Manifest consumer</h4>
<div class="paragraph">
<p>An <em>actor</em> who consumes an <em>asset</em> with an associated <em>manifest</em> for the purpose of obtaining the <em>provenance data</em> from the <em>manifest</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_validator"><a class="anchor" href="#_validator"></a>2.1.5. Validator</h4>
<div class="paragraph">
<p>A <em>manifest consumer</em> whose role is to perform the actions described in <a href="#_validation">Chapter 15, <em>Validation</em></a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_action"><a class="anchor" href="#_action"></a>2.1.6. Action</h4>
<div class="paragraph">
<p>An operation performed by an <em>actor</em> on an <em>asset.</em> For example, "create", "embed", or "apply filter".</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_assets_and_content"><a class="anchor" href="#_assets_and_content"></a>2.2. Assets and Content</h3>
<div class="sect3">
<h4 id="_digital_content"><a class="anchor" href="#_digital_content"></a>2.2.1. Digital content</h4>
<div class="paragraph">
<p>The portion of an <em>asset</em> that represents the actual content, such as the pixels of an image, along with any additional technical metadata required to understand the content (e.g., a colour profile or encoding parameters).</p>
</div>
</div>
<div class="sect3">
<h4 id="_asset_metadata"><a class="anchor" href="#_asset_metadata"></a>2.2.2. Asset metadata</h4>
<div class="paragraph">
<p>The portion of an <em>asset</em> that represents non-technical information about the <em>asset</em> and its <em>digital content</em>, as may be stored via standards such as Exif or XMP.</p>
</div>
</div>
<div class="sect3">
<h4 id="_asset"><a class="anchor" href="#_asset"></a>2.2.3. Asset</h4>
<div class="paragraph">
<p>A file or stream of data containing <em>digital content</em>, <em>asset metadata</em> and optionally, a <em>C2PA Manifest</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For the purposes of this definition, we will extend the typical definition of "file" to include cloud-native and dynamically generated data.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_derived_asset"><a class="anchor" href="#_derived_asset"></a>2.2.4. Derived asset</h4>
<div class="paragraph">
<p>A <em>derived asset</em> is an <em>asset</em> that is created by starting from an existing <em>asset</em> and performing <em>actions</em> to it that modify its <em>digital content</em> and <em>asset metadata</em>.</p>
</div>
<div class="exampleblock">
<div class="content">
<strong>EXAMPLE:</strong> An audio stream that has been shortened or a document where pages have been added.
</div>
</div>
</div>
<div class="sect3">
<h4 id="_asset_rendition"><a class="anchor" href="#_asset_rendition"></a>2.2.5. Asset rendition</h4>
<div class="paragraph">
<p>A representation of an <em>asset</em> (either as a part of an <em>asset</em> or a completely new <em>asset</em>) where the <em>digital content</em> has had a 'non-editorial transformation' <em>action</em> (e.g., re-encoding or scaling) applied but where the <em>asset metadata</em> has not been modified.</p>
</div>
<div class="exampleblock">
<div class="content">
<strong>EXAMPLE:</strong> A video file that is re-encoded for reduced screen resolution or network bandwidth.
</div>
</div>
</div>
<div class="sect3">
<h4 id="_composed_asset"><a class="anchor" href="#_composed_asset"></a>2.2.6. Composed asset</h4>
<div class="paragraph">
<p>A composed asset is an <em>asset</em> that is created by building up a collection of multiple parts or fragments of <em>digital content</em> (referred to as ingredients) from one or more other <em>assets</em>. When starting from an existing <em>asset</em>, it is a special case of a <em>derived asset</em> - however a <em>composed asset</em> can also be one that starts from a "blank slate".</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>EXAMPLES:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>A video created by importing existing video clips and audio segments into a "blank slate".</p>
</li>
<li>
<p>An image where another image is imported and super-imposed on top of the starting image.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_core_aspects_of_c2pa"><a class="anchor" href="#_core_aspects_of_c2pa"></a>2.3. Core Aspects of C2PA</h3>
<div class="sect3">
<h4 id="_assertion"><a class="anchor" href="#_assertion"></a>2.3.1. Assertion</h4>
<div class="paragraph">
<p>A data structure which represents a statement asserted by an <em>actor</em> concerning the <em>asset</em>. This data is a part of the <em>C2PA Manifest</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_claim"><a class="anchor" href="#_claim"></a>2.3.2. Claim</h4>
<div class="paragraph">
<p>A digitally signed and tamper-evident data structure that references a set of <em>assertions</em> by one or more <em>actors</em>, concerning an <em>asset</em>, and the information necessary to represent the <em>content binding</em>. If any <em>assertions</em> were redacted, then a declaration to that effect is included. This data is a part of the <em>C2PA Manifest</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_claim_signature"><a class="anchor" href="#_claim_signature"></a>2.3.3. Claim signature</h4>
<div class="paragraph">
<p>The digital signature on the <em>claim</em> using the private key of an <em>actor</em>. The <em>claim signature</em> is a part of the <em>C2PA Manifest</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_c2pa_manifest"><a class="anchor" href="#_c2pa_manifest"></a>2.3.4. C2PA Manifest</h4>
<div class="paragraph">
<p>The set of information about the <em>provenance</em> of an <em>asset</em> based on the combination of one or more <em>assertions</em> (including <em>content bindings</em>), a single <em>claim</em>, and a <em>claim signature</em>. A <em>C2PA Manifest</em> is part of a <em>C2PA Manifest Store</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A <em>C2PA Manifest</em> can reference other <em>C2PA Manifest</em>s.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_c2pa_manifest_store"><a class="anchor" href="#_c2pa_manifest_store"></a>2.3.5. C2PA Manifest Store</h4>
<div class="paragraph">
<p>A collection of <em>C2PA Manifests</em> that can either be embedded into an <em>asset</em> or be external to its <em>asset</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_origin"><a class="anchor" href="#_origin"></a>2.3.6. Origin</h4>
<div class="paragraph">
<p>The <em>C2PA Manifest</em> in the <em>provenance data</em> which represents the software or device that initially created the <em>asset</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Details on how one determines which <em>C2PA Manifest</em> is the <em>origin</em> are left for specification.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_active_manifest"><a class="anchor" href="#_active_manifest"></a>2.3.7. Active Manifest</h4>
<div class="paragraph">
<p>The last manifest in the list of <em>C2PA Manifests</em> inside of a <em>C2PA Manifest Store</em> which is the one with the set of <em>content bindings</em> that are able to be validated.</p>
</div>
</div>
<div class="sect3">
<h4 id="_provenance"><a class="anchor" href="#_provenance"></a>2.3.8. Provenance</h4>
<div class="paragraph">
<p>The logical concept of understanding the history of an <em>asset</em> and its interaction with <em>actors</em> and other <em>assets</em>, as represented by the <em>provenance data</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_provenance_data"><a class="anchor" href="#_provenance_data"></a>2.3.9. Provenance data</h4>
<div class="paragraph">
<p>The set of <em>C2PA Manifest</em>s for an <em>asset</em> and, in the case of a <em>composed asset</em>, its <em>ingredients</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A <em>C2PA Manifest</em> can reference other <em>C2PA Manifest</em>s.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_authenticity"><a class="anchor" href="#_authenticity"></a>2.3.10. Authenticity</h4>
<div class="paragraph">
<p>A property of <em>digital content</em> comprising a set of facts (<em>provenance data</em> and <em>hard bindings</em>) that can be cryptographically verified as not having been tampered with.</p>
</div>
</div>
<div class="sect3">
<h4 id="_content_binding"><a class="anchor" href="#_content_binding"></a>2.3.11. Content binding</h4>
<div class="paragraph">
<p>Information that associates <em>digital content</em> to a specific <em>C2PA Manifest</em> associated with a specific <em>asset</em>, either as a <em>hard binding</em> or a <em>soft binding</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_hard_binding"><a class="anchor" href="#_hard_binding"></a>2.3.12. Hard binding</h4>
<div class="paragraph">
<p>One or more cryptographic hashes that uniquely identifies either the entire <em>asset</em> or a portion thereof.</p>
</div>
</div>
<div class="sect3">
<h4 id="_soft_binding"><a class="anchor" href="#_soft_binding"></a>2.3.13. Soft binding</h4>
<div class="paragraph">
<p>A content identifier that is either (a) not statistically unique, such as a <em>fingerprint</em>, or (b) embedded as a <em>watermark</em> in the identified <em>digital content</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_trust_signals"><a class="anchor" href="#_trust_signals"></a>2.3.14. Trust signals</h4>
<div class="paragraph">
<p>The collection of information that can inform an <em>actor&#8217;s</em> judgment of the trustworthiness of an <em>asset</em>. These are in addition to the <em>signer</em> of a <em>claim</em>, upon which the fundamental trust model relies.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_additional_terms"><a class="anchor" href="#_additional_terms"></a>2.4. Additional Terms</h3>
<div class="sect3">
<h4 id="_fingerprint"><a class="anchor" href="#_fingerprint"></a>2.4.1. Fingerprint</h4>
<div class="paragraph">
<p>A set of inherent properties computable from <em>digital content</em> that identifies the content or near duplicates of it.</p>
</div>
<div class="exampleblock">
<div class="content">
<strong>EXAMPLE:</strong> An <em>asset</em> can become separated from its <em>manifest</em> due to removal or corruption of <em>asset</em> metadata. A <em>fingerprint</em> of the <em>digital content</em> of the <em>asset</em> could be used to search a database to recover the <em>asset</em> with an intact <em>manifest</em>.
</div>
</div>
</div>
<div class="sect3">
<h4 id="_watermark"><a class="anchor" href="#_watermark"></a>2.4.2. Watermark</h4>
<div class="paragraph">
<p>Information incorporated into the <em>digital content</em> (perceptibly or imperceptibly) of an <em>asset</em> which can be used, for example, to uniquely identify the <em>asset</em> or to store a reference to a <em>C2PA Manifest</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_manifest_repository"><a class="anchor" href="#_manifest_repository"></a>2.4.3. Manifest Repository</h4>
<div class="paragraph">
<p>A repository into which <em>C2PA Manifests</em> and <em>C2PA Manifest Stores</em> can be placed, and which can be searched using a <em>content binding</em>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_overview_2"><a class="anchor" href="#_overview_2"></a>2.5. Overview</h3>
<div class="paragraph">
<p>This image shows how all these various elements come together to represent the C2PA architecture.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/c2pa_visualglossary.png" alt="A diagram of how all the parts of C2PA go together" width="697" height="454">
</div>
<div class="title">Figure 3. Elements of C2PA</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_normative_references"><a class="anchor" href="#_normative_references"></a>3. Normative References</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_core_formats"><a class="anchor" href="#_core_formats"></a>3.1. Core Formats</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://tools.ietf.org/html/rfc8949">CBOR</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc8259">JSON</a></p>
</li>
<li>
<p><a href="https://www.w3.org/TR/json-ld11/">JSON-LD</a></p>
</li>
<li>
<p><a href="https://www.iso.org/standard/73604.html">JPEG universal metadata box format</a> (JUMBF)</p>
</li>
<li>
<p><a href="https://www.iso.org/standard/74428.html">ISO Base Media File Format</a> (BMFF)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_schemas"><a class="anchor" href="#_schemas"></a>3.2. Schemas</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL</a></p>
</li>
<li>
<p><a href="https://json-schema.org/specification-links.html#2020-12">JSON Schema</a></p>
</li>
<li>
<p><a href="https://www.dublincore.org/specifications/dublin-core/dces/">Dublin Core Metadata Initiative</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_digital_electronic_signatures"><a class="anchor" href="#_digital_electronic_signatures"></a>3.3. Digital &amp; Electronic Signatures</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://tools.ietf.org/html/rfc5280">X.509 Certificates</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc7518">JSON Web Algorithms</a> (JWA)</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc8152">CBOR Object Signing and Encryption</a> (COSE)</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc8230">Using RSA Algorithms with COSE Messages</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc6960">Online Certificate Status Protocol</a> (OCSP)</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc3161">Internet X.509 PKI Time-Stamp Protocol</a></p>
</li>
<li>
<p><a href="https://datatracker.ietf.org/doc/draft-ietf-cose-x509/">CBOR Object Signing and Encryption (COSE): Header parameters for carrying and referencing X.509 certificates</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc3279">Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc5758">Internet X.509 Public Key Infrastructure: Additional Algorithms and Identifiers for DSA and ECDSA</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc8410">Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc8017">PKCS #1: RSA Cryptography Specifications Version 2.2</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc8032">Edwards-Curve Digital Signature Algorithm (EdDSA)</a></p>
</li>
<li>
<p><a href="https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf">JSON Advanced Electronic Signatures</a> (JAdES)</p>
</li>
<li>
<p><a href="https://datatracker.ietf.org/doc/html/rfc6234">US Secure Hash Algorithms</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_other"><a class="anchor" href="#_other"></a>3.4. Other</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.iso.org/standard/75163.html">eXtensible Metadata Platform</a> (XMP)</p>
</li>
<li>
<p><a href="https://www.iso.org/standard/79384.html">JSON-LD serialization of XMP</a></p>
</li>
<li>
<p><a href="http://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata">IPTC Photo Metadata Standard</a></p>
</li>
<li>
<p><a href="https://www.cipa.jp/std/documents/download_e.html?DC-008-Translation-2019-E">Exif</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc4122">UUID</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_standard_terms"><a class="anchor" href="#_standard_terms"></a>4. Standard Terms</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="https://tools.ietf.org/html/rfc2119">RFC 2119</a>, and <a href="https://tools.ietf.org/html/rfc8174">RFC 8174</a> when they appear in any casing (upper, lower or mixed).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_version_history"><a class="anchor" href="#_version_history"></a>5. Version History</h2>
<div class="sectionbody">
<div class="paragraph">
<p>1.1 - September 2022</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Define a mechanism to support salting box hashing</p>
</li>
<li>
<p>New <code>c2pa.hash.bmff.v2</code> assertion, with changes to hashing model, to improve security</p>
</li>
<li>
<p>Enable assertion metadata for the Claim</p>
</li>
<li>
<p>Replaced <code>claim_generator_hints</code> with <code>claim_generator_info</code></p>
</li>
<li>
<p>Added a new assertion to support the concept of Endorsements</p>
</li>
<li>
<p>Improvements to the <code>c2pa.actions</code> assertion</p>
</li>
<li>
<p>All Error &amp; Status Codes are now prefixed with <code>c2pa</code></p>
</li>
<li>
<p>Define mechanism for redaction of W3C VC&#8217;s</p>
</li>
<li>
<p>Clarify validation of EKUs in certificates</p>
</li>
<li>
<p>Validation algorithm revised to reflect technical changes</p>
</li>
<li>
<p>Corrections to the CDDL and JSON schemas to match normative text</p>
</li>
<li>
<p>Revise figures to reflect changes</p>
</li>
<li>
<p>Various Editorial and Typographical Corrections</p>
</li>
<li>
<p>Update Normative References (incl. JUMBF &amp; W3C VC Data Model)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>1.0 - December 2021</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Initial Release</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_assertions"><a class="anchor" href="#_assertions"></a>6. Assertions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_general"><a class="anchor" href="#_general"></a>6.1. General</h3>
<div class="paragraph">
<p>It is expected that each of the actors in the system that creates or processes an asset will produce one or more assertions about when, where, and how the asset was originated or transformed. An assertion is labelled data, typically (though not required to be) in a CBOR-based structure which represents a declaration made by an actor about an asset. Some of these actors will be human and add human-generated information (e.g., copyright) while other actors are machines (software/hardware) providing the information they generated (e.g., camera type).</p>
</div>
<div class="paragraph">
<p>Some examples of assertions are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Exif information (e.g. camera information such as maker, lens)</p>
</li>
<li>
<p>Actions performed on the asset (e.g., clipping, color correction)</p>
</li>
<li>
<p>Thumbnail of the asset or its ingredients</p>
</li>
<li>
<p>Content bindings (e.g., cryptographic hashes)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Certain assertions may be redacted by subsequent claims (see <a href="#_redaction_of_assertions">Section 6.7, &#8220;Redaction of Assertions&#8221;</a>), but they cannot be modified once made as part of a claim.</p>
</div>
</div>
<div class="sect2">
<h3 id="_labels"><a class="anchor" href="#_labels"></a>6.2. Labels</h3>
<div class="paragraph">
<p>Each assertion has a label defined either by the C2PA specifications or an external entity.</p>
</div>
<div class="paragraph">
<p>Labels are string values organized into namespaces using a period (<code>.</code>) as a separator.  The namespace component of the label can be an entity, or a reference to a well-established standard (see ABNF below). The most common labels will be defined by the C2PA and will begin with <code>c2pa.</code>. Entity-specific labels shall begin with the Internet domain name for the entity similar to how Java packages are defined (e.g., <code>com.litware</code>, <code>net.fineartschool</code>). Well-established standards can use the "stds." prefix when describing their namespace.  They are also versioned with a simple incrementing integer scheme (e.g., <code>c2pa.actions.v2</code>). If no version is provided, it is considered as <code>v1</code>. The list of publicly known labels can be found in <a href="#_c2pa_standard_assertions">Chapter 18, <em>C2PA Standard Assertions</em></a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-abnf hljs" data-lang="abnf">namespaced-label = qualified-namespace label
qualified-namespace = entity / ( "stds."  std-name )
entity = 1*( DIGIT / ALPHA / "-" )
std-name = 1*( DIGIT / ALPHA / "-" )
label = 1*("." 1(ALPHA / "_" ) *( DIGIT / ALPHA / "_" ) )</code></pre>
</div>
</div>
<div class="paragraph">
<p>The period-separated components of a label follow the variable naming convention (<code>[a-zA-Z_][a-zA-Z0-9_]*</code>) specified in the POSIX or C locale, with the restriction that the use of a repeated underscore character (<code>__</code>) is reserved for labelling multiple assertions of the same type.</p>
</div>
</div>
<div class="sect2">
<h3 id="_versioning"><a class="anchor" href="#_versioning"></a>6.3. Versioning</h3>
<div class="paragraph">
<p>When an assertion&#8217;s schema is changed, it should be done in a backwards-compatible manner. This means that new fields may be added and existing ones may be marked as deprecated (i.e., can be read, but never written). Existing fields shall not be removed. The label would then consist of an incremented version number, for example moving from <code>c2pa.hash.bmff</code> (deprecated) to <code>c2pa.hash.bmff.v2</code>.</p>
</div>
<div class="paragraph">
<p>Deprecated fields for C2PA standard assertions shall be indicated in <a href="#_c2pa_standard_assertions">Chapter 18, <em>C2PA Standard Assertions</em></a>. Tools which enable actors to create assertions shall prevent the actor from inserting data into deprecated assertion fields.</p>
</div>
<div class="paragraph">
<p>In addition, there are situations where a non-backwards compatible change is required. In that case, instead of increasing the label&#8217;s version number, the assertion shall be given a new label. For example, <code>c2pa.ingredient</code> could be changed to the fictional <code>c2pa.component</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_multiple_instances"><a class="anchor" href="#_multiple_instances"></a>6.4. Multiple Instances</h3>
<div class="paragraph">
<p>Multiple assertions of the same type can occur in the same manifest, but since assertions are referenced by claims via their label, the assertion labels must be unique.  This is accomplished by adding a double-underscore and a monotonically increasing index to the label.  For example, if a manifest contains a single assertion of type <code>stds.schema-org.CreativeWork</code>, then the assertion label will be <code>stds.schema-org.CreativeWork</code>.  If a manifest contains three assertions of this type, the labels will be <code>stds.schema-org.CreativeWork</code>, <code>stds.schema-org.CreativeWork__1</code> and <code>stds.schema-org.CreativeWork__2</code>.</p>
</div>
<div class="paragraph">
<p>When a label includes a version number, that version number is part of the label itself. As such, when there are multiple instances, the instance number continues to follow the label - e.g., <code>c2pa.ingredient.v2__2</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_assertion_store"><a class="anchor" href="#_assertion_store"></a>6.5. Assertion Store</h3>
<div class="paragraph">
<p>The set of assertions referenced by a <a href="#_claims">claim</a> in a manifest are collected together into a logical construct that is referred to as the <em>assertion store</em>. The assertions and assertion store shall be stored as described in <a href="#_use_of_jumbf">Section 11.1, &#8220;Use of JUMBF&#8221;</a>; in particular, the assertion store shall be located in the same C2PA Manifest box as the claim that refers to its assertions.</p>
</div>
<div class="paragraph">
<p>For each manifest, there is a single assertion store associated with it. However, as an asset may have multiple manifests associated with it, each one representing a specific series of assertions, there may be multiple assertion stores associated with an asset.</p>
</div>
</div>
<div class="sect2">
<h3 id="_embedded_vs_externally_stored_data"><a class="anchor" href="#_embedded_vs_externally_stored_data"></a>6.6. Embedded vs Externally-Stored Data</h3>
<div class="paragraph">
<p>Some assertion data, due to its size or an infrequent need for it, may be externally hosted. Such data are not embedded in the assertion store, but instead are referenced by URI. This is accomplished through a cloud data assertion (see <a href="#_cloud_data">Section 18.8, &#8220;Cloud Data&#8221;</a>). Unlike embedded assertion data, cloud data is not retrieved nor validated as part of manifest validation, and are only retrieved and validated when specifically needed by an application according to a different set of validation rules as described in <a href="#_validate_the_assertions">Section 15.7, &#8220;Validate the Assertions&#8221;</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_redaction_of_assertions"><a class="anchor" href="#_redaction_of_assertions"></a>6.7. Redaction of Assertions</h3>
<div class="paragraph">
<p>Assertions that are present in an asset-embedded manifest may be removed from that asset&#8217;s manifest when the asset is <a href="#_ingredient_storage">used as an ingredient</a>. This process is called redaction.</p>
</div>
<div class="paragraph">
<p>Redaction involves removing either the entire assertion from the manifest&#8217;s assertion store or retaining the labelled assertion container but replacing its data with zeros (binary <code>\0</code> values). In addition, a record that something was removed must be added to the <a href="#_claims">claim</a> in the form of a <a href="#_uri_references">URI reference</a> to the redaction assertion in the <code>redacted_assertions</code> field of the claim.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Because each assertion&#8217;s <a href="#_uri_references">URI reference</a> includes the assertion label, it is also known what type of information (e.g., thumbnail, IPTC metadata, etc.) was removed. This enables both humans and machines to apply rules to determine if the removal was acceptable.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Unless the redaction of the assertion also requires modification to the digital content, an <a href="#_update_manifests">update manifest</a> shall be used to document the redaction as it makes a statement about the non-changes to the content.</p>
</div>
<div class="paragraph">
<p>Claims generators shall not redact assertions with a label of <code>c2pa.actions</code> as this assertion type represents essential information in understanding the history of an asset.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_unique_identifiers"><a class="anchor" href="#_unique_identifiers"></a>7. Unique Identifiers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Every asset that is referenced by the <a href="#_claims">claim</a> shall be referenced via a unique identifier. In addition, these identifiers are used in various parts of a C2PA-enabled workflow, such as when identifying it as an <a href="#_ingredient">ingredient</a> in a derived or composed asset.</p>
</div>
<div class="sect2">
<h3 id="_using_xmp"><a class="anchor" href="#_using_xmp"></a>7.1. Using XMP</h3>
<div class="paragraph">
<p>When an asset contains embedded XMP, that XMP shall include (at least) values for <code>xmpMM:DocumentID</code> and <code>xmpMM:InstanceID</code> as defined in <a href="https://github.com/adobe/xmp-docs/blob/master/XMPSpecifications/XMPSpecificationPart2.pdf">XMP Specification Part 2, 2.2</a>. If an asset does not contain XMP at the time a claim is made, and the type of the asset supports it, an embedded XMP packet may be created as part of the process, and the identifiers shall be added to it.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">NOTE 1</div>
Some asset types are not suited for embedded XMP (e.g., text). It is possible to create XMP as a sidecar.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_other_identifiers"><a class="anchor" href="#_other_identifiers"></a>7.2. Other Identifiers</h3>
<div class="paragraph">
<p>Instead of using XMP, a unique identifier for an asset could be a URI defined by standards such as <a href="https://www.w3.org/TR/did-core/">Decentralized Identifiers (DID)</a>, <a href="http://www.handle.net/">Handle</a>, <a href="https://www.eidr.org/">EIDR</a> and <a href="https://www.doi.org/">DOI</a>.</p>
</div>
<div class="paragraph">
<p>Another standard unique identifier for an asset could be the cryptographic hash of the asset. When this method is used, the hash shall be represented using a standard <a href="https://tools.ietf.org/html/rfc4122">RFC 4122 UUID</a> following the recommendations at <a href="https://datatracker.ietf.org/doc/html/draft-thiemann-hash-urn-01" class="bare">https://datatracker.ietf.org/doc/html/draft-thiemann-hash-urn-01</a> .</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">EDITORS NOTE</div>
Other methods may be defined here as they are developed.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_uri_references"><a class="anchor" href="#_uri_references"></a>7.3. URI References</h3>
<div class="paragraph">
<p>All references to information in the manifest, whether stored internally to the asset (i.e., embedded) or stored externally to the asset (e.g., in the cloud), shall be referenced via JUMBF URI references as defined in <a href="https://www.iso.org/standard/73604.html">ISO 19566-5, C.2</a>. These URIs shall be used either as part of a <code>hashed_uri</code> or <code>hashed_ext_uri</code> data structure.</p>
</div>
<div class="sect3">
<h4 id="_hashed_uris"><a class="anchor" href="#_hashed_uris"></a>7.3.1. Hashed URIs</h4>
<div class="paragraph">
<p>A <code>hashed_uri</code> is used when the URI is for something embedded in the same manifest store.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "http://ns.c2pa.org/hashed-uri/v1",
  "type": "object",
  "description": "The data structure used to store a reference to a local URL and its hash",
  "definitions": {
    "JUMBF_URI": {
      "$id": "#JUMBF_URI",
      "description": "JUMBF URI reference",
      "type": "string",
	  "pattern": "^self#jumbf=[\\w\\d][\\w\\d\\./:-]+[\\w\\d]$"
    }
  },
  "examples": [
    {
      "url": "self#jumbf=c2pa/urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.assertions/c2pa.actions",
      "alg": "sha256",
      "hash": "hoOspQQ1lFTy/4Tp8Epx670E5QW5NwkNR+2b30KFXug="
    }
  ],
  "required": ["url", "hash"],
  "properties": {
    "url": {
      "$ref": "#/definitions/JUMBF_URI",
      "description": "JUMBF URI reference"
    },
    "alg": {
      "type": "string",
      "minLength": 1,
      "description": "A string identifying the cryptographic hash algorithm used to compute all hashes in this claim, taken from the C2PA hash algorithm identifier list. If this field is absent, the hash algorithm is taken from an enclosing structure as defined by that structure. If both are present, the field in this structure is used. If no value is present in any of these places, this structure is invalid; there is no default."
    },
    "hash": {
      "type": "string",
      "minLength": 1,
      "description": "CBOR byte string containing the hash value"
    }
  },
  "additionalProperties": false
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This specification provides an equivalent <code>hashed-uri-map</code> data structure for schemas defined using <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; The data structure used to store a reference to a URL within the same JUMBF and its hash. We use a socket/plug here to allow hashed-uri-map to be used in individual files without having the map defined in the same file
$hashed-uri-map /= {
  "url": url-regexp-type, ; JUMBF URI reference
  ? "alg": tstr .size (1..max-tstr-length), ; A string identifying the cryptographic hash algorithm used to compute all hashes in this claim, taken from the C2PA hash algorithm identifier list. If this field is absent, the hash algorithm is taken from an enclosing structure as defined by that structure. If both are present, the field in this structure is used. If no value is present in any of these places, this structure is invalid; there is no default.
  "hash": bstr, ;  byte string containing the hash value
}

; with CBOR Head (#) and tail ($) are introduced in regexp, so not needed explicitly
url-regexp-type  /= tstr .regexp "self#jumbf=[\\w\\d][\\w\\d\\.\/:-]+[\\w\\d]"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because assertion stores shall be located in the same C2PA Manifest box as the claim that refers to them, only <code>self#jumbf</code> URIs are permitted. These <code>self#jumbf</code> URIs may be relative to the entire C2PA Manifest Store, in which case they shall start with a <code>/</code> (U+002F, Slash), or relative to the current C2PA Manifest. URIs shall not contain the sequence <code>..</code> (a pair of U+002E, Full Stop).</p>
</div>
<div class="paragraph">
<p>When referring to a resource that exists externally to the manifest store, a <code>hashed-ext-uri-map</code> data structure is used.  This is described in <a href="#_cloud_data">Section 18.8, &#8220;Cloud Data&#8221;</a>.</p>
</div>
<div class="paragraph">
<p><strong>EXAMPLES:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>self#jumbf=/c2pa/urn:uuid:f095f30e-6cd5-4bf7-8c44-ce8420ca9fb7/c2pa.assertions/c2pa.thumbnail.claim.jpeg</code> is relative to the entire store (since it starts with <code>/</code>),</p>
</li>
<li>
<p><code>self#jumbf=c2pa.assertions/c2pa.thumbnail.claim.jpeg</code> would be relative to the manifest of the box containing the URI.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_hashing_jumbf_boxes"><a class="anchor" href="#_hashing_jumbf_boxes"></a>7.3.1.1. Hashing JUMBF Boxes</h5>
<div class="paragraph">
<p>When creating a URI reference to an assertion (i.e., as part of constructing a <a href="#_claims">Claim</a>), a <a href="#_w3c_verifiable_credentials">W3C Verifiable Credential</a> or other C2PA structure stored as a JUMBF box, the hash shall be performed over the contents of the structure&#8217;s JUMBF superbox, which includes both the JUMBF Description Box and all content boxes therein (but does not include the structure&#8217;s JUMBF superbox header).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
More details on hashing can be found at <a href="#_hashing">Section 13.1, &#8220;Hashing&#8221;</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As described in the forthcoming dated revision to JUMBF (ISO 19566-5:2022/3), a new <code>Private</code> field can be present as part of any JUMBF Description box. This C2PA specification defines the C2PA salt as a <code>Private</code> field whose value is a standard box consisting of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a box length (LBox, as a 4-byte big-endian unsigned integer)</p>
</li>
<li>
<p>a box type (TBox, 4-byte big-endian unsigned integer, with a value of <code>c2sh</code> (for C2PA salt hash))</p>
</li>
<li>
<p>and payload data (consisting of randomly-generated binary data of either 16 or 32 bytes in length).</p>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/assertion_JUMBF.drawio.svg" alt="Example assertion structure" width="361" height="451">
</div>
<div class="title">Figure 4. Example <code>c2pa.actions</code> assertion</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_w3c_verifiable_credentials"><a class="anchor" href="#_w3c_verifiable_credentials"></a>8. W3C Verifiable Credentials</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_general_2"><a class="anchor" href="#_general_2"></a>8.1. General</h3>
<div class="paragraph">
<p>In some use cases, the actors in the system may wish to provide their own <a href="https://www.w3.org/TR/vc-data-model/">W3C Verifiable Credential</a>, as they exist at that moment in time, to the claim generator to have them associated with one or more assertions. These actors may be individuals, groups or organizations.</p>
</div>
<div class="paragraph">
<p>W3C Verifiable Credentials are used in this specification to decorate the actors identified in assertions with more information, potentially providing additional trust signals. Although these W3C Verifiable Credentials can include proofs of their own authenticity, they are <strong>not</strong> a mechanism for verifying that a particular actor authorised a claim, assertion or piece of metadata. Any validation or usage of the W3C Verifiable Credential is out of scope of this specification and has no bearing on the <a href="#_trust_model">C2PA Trust Model</a>.</p>
</div>
<div class="paragraph">
<p>For example, conveying a W3C Verifiable Credential for the actor identified as the <code>author</code> in an assertion might link that author&#8217;s ID with an email address, social media ID, or real name, or it might identify that actor as a member of a particular professional body, or provide other qualifications relevant to the actor&#8217;s involvement in the asset.</p>
</div>
<div class="paragraph">
<p>Such credentials shall be compliant with the <a href="https://www.w3.org/TR/vc-data-model/">W3C Verifiable Credentials Data Model</a> using the <a href="https://www.w3.org/TR/vc-data-model/#json-ld">JSON-LD serialisation</a> described there.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>JSON-LD serialization is mandated as it is the most commonly used of the three syntaxes presented in section 6 of the W3C Verifiable Credentials specification. It is also the one that aligns best with its extensibility model, which could be useful to some implementers.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An example of a compliant credential for an individual might be one issued by the National Press Photographers Association (NPPA), which links an identifier for a person to their name ("John Doe") and a statement about their membership of the NPPA. It might look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "@context": [
    "https://www.w3.org/2018/credentials/v1",
    "http://schema.org"
  ],
  "type": [
    "VerifiableCredential",
    "NPPACredential"
  ],
  "issuer": "https://nppa.org/",
  "credentialSubject": {
    "id": "did:nppa:eb1bb9934d9896a374c384521410c7f14",
    "name": "John Doe",
    "memberOf": "https://nppa.org/"
  },
  "proof": {
    "type": "RsaSignature2018",
    "created": "2021-06-18T21:19:10Z",
    "proofPurpose": "assertionMethod",
    "verificationMethod": "did:nppa:eb1bb9934d9896a374c384521410c7f14#_Qq0UL2Fq651Q0Fjd6TvnYE-faHiOpRlPVQcY_-tA4A",
    "jws": "eyJhbGciOiJQUzI1NiIsImI2NCI6ZmFsc2UsImNyaXQiOlsiYjY0Il19
      DJBMvvFAIC00nSGB6Tn0XKbbF9XrsaJZREWvR2aONYTQQxnyXirtXnlewJMB
      Bn2h9hfcGZrvnC1b6PgWmukzFJ1IiH1dWgnDIS81BH-IxXnPkbuYDeySorc4
      QU9MJxdVkY5EL4HYbcIfwKj6X4LBQ2_ZHZIu1jdqLcRZqHcsDF5KKylKc1TH
      n5VRWy5WhYg_gBnyWny8E6Qkrze53MR7OuAmmNJ1m1nN8SxDrG6a08L78J0-
      Fbas5OjAQz3c17GY8mVuDPOBIOVjMEghBlgl3nOi1ysxbRGhHLEK4s0KKbeR
      ogZdgt1DkQxDFxxn41QWDw_mmMCjs9qxg0zcZzqEJw"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A W3C Verifiable Credential used with C2PA shall contain only a single <code>credentialSubject</code> and that <code>credentialSubject</code> shall have an <code>id</code> value.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Although the example above and many examples in the W3C Verifiable Credentials data model specification use Decentralized Identifiers (DIDs) as the value of the <code>id</code> field, DIDs are not necessary for W3C Verifiable Credentials to be useful. Specifically, W3C Verifiable Credentials do not depend on DIDs and DIDs do not depend on W3C Verifiable Credentials. DID-based URLs are just one way to express identifiers associated with subjects, issuers, holders, credential status lists, cryptographic keys, and other machine-readable information associated with a W3C Verifiable Credential.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vcstore"><a class="anchor" href="#_vcstore"></a>8.2. VCStore</h3>
<div class="paragraph">
<p>The set of credentials in a manifest are collected together into a logical construct that is referred to as the <strong>credential store</strong> or <strong>VCStore</strong> (for short) and it shall be stored as described in <a href="#_use_of_jumbf">Section 11.1, &#8220;Use of JUMBF&#8221;</a>.  Just as with the assertion store, the VCStore shall always be included/embedded in the JUMBF - it is not stored separately.</p>
</div>
<div class="paragraph">
<p>For each manifest, there is a VCStore associated with it. However, as an asset may have multiple manifests associated with it, there may be multiple VCStores associated with an asset.</p>
</div>
</div>
<div class="sect2">
<h3 id="_using_credentials"><a class="anchor" href="#_using_credentials"></a>8.3. Using Credentials</h3>
<div class="paragraph">
<p>Some assertions, such as <a href="#_creative_work">Creative Work</a> and <a href="#_actions">Actions</a>, may contain references to Persons or Organisations which are responsible for various roles and responsibilities. These references to Actors are defined in <a href="#_common_data_model_actor">Section 18.17, &#8220;Common Data Model: Actor&#8221;</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "@context": "http://schema.org/",
  "@type": "CreativeWork",
  "copyrightHolder": {
    "name": "BBC",
    "legalName": "British Broadcasting Corporation",
    "identifier": "https://www.bbc.co.uk/",
    "credential": [
      {
        "url": "self#jumbf=c2pa/urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.credentials/https://www.bbc.co.uk/",
        "alg": "sha256",
        "hash": "Auxjtmax46cC2N3Y9aFmBO9Jfay8LEwJWzBUtZ0sUM8gA"
      }
    ]
  },
  "copyrightYear": 2021,
  "copyrightNotice": "Copyright © 2021 BBC."
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_credential_security_considerations"><a class="anchor" href="#_credential_security_considerations"></a>8.4. Credential Security Considerations</h3>
<div class="paragraph">
<p>In most W3C Verifiable Credential workflows, the information about the subject (e.g., the cryptographic keys) is fetched on demand at the time of validation. While that is an acceptable model, it does open up a possible attack vector by providing an attacker with an externally-visible signal about what the validator is validating. Therefore, C2PA also supports having the information captured and embedded at the time of signature. This not only prevents leakage, but also makes it very clear what data the signer is asserting about the credential&#8217;s subject.</p>
</div>
</div>
<div class="sect2">
<h3 id="_redaction_of_credentials"><a class="anchor" href="#_redaction_of_credentials"></a>8.5. Redaction of Credentials</h3>
<div class="paragraph">
<p>Since a W3C Verifiable Credential can contain personally identifiable information, there may be workflows where it is necessary to remove/redact a W3C Verifiable Credential from the VCStore. To redact a W3C Verifiable Credential, a claim generator shall overwrite the contents of the credential in the W3C Credential Store with all zeroes, just as one would when <a href="#_redaction_of_assertions">redacting an assertion</a>, however, doing only that will cause validation failures later on since the <code>hashed_uri</code> to the W3C Verifiable Credential will fail to resolve causing a validation failure.  To fully redact a W3C Verifiable Credential, the associated (referencing) assertion would also need to be redacted.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_binding_to_content"><a class="anchor" href="#_binding_to_content"></a>9. Binding to Content</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_3"><a class="anchor" href="#_overview_3"></a>9.1. Overview</h3>
<div class="paragraph">
<p>A key aspect to the <a href="#_standard_manifests">standard C2PA manifest</a> is the presence of one or more data structures, called content bindings, that can uniquely identify portions of the asset. There are two types of bindings that are supported by C2PA - hard bindings and soft bindings. A hard binding (also known as a cryptographic binding) enables the validator to ensure that (a) this manifest belongs with this asset and (b) that the asset has not been modified, by determining values that can match only this asset and no other, not even other assets derived from it or renditions produced from it.  A soft binding is computed from the digital content of an asset, rather than its raw bits.  A soft binding is useful for identifying derived assets and asset renditions.</p>
</div>
<div class="paragraph">
<p>A single manifest shall not contain more than one assertion defining a hard binding.</p>
</div>
</div>
<div class="sect2">
<h3 id="_hard_bindings"><a class="anchor" href="#_hard_bindings"></a>9.2. Hard Bindings</h3>
<div class="sect3">
<h4 id="_hashing_using_byte_ranges"><a class="anchor" href="#_hashing_using_byte_ranges"></a>9.2.1. Hashing using byte ranges</h4>
<div class="paragraph">
<p>The simplest type of hard binding that can be used to detect tampering is a cryptographic hashing algorithm, as described in <a href="#_hashing">Section 13.1, &#8220;Hashing&#8221;</a>, over some or all of the bytes of an asset. This approach can be used on any type of asset.</p>
</div>
<div class="paragraph">
<p>When using this form of hard binding, one or more <a href="#_data_hash">data hash assertions</a> is used to define the range of bytes that are hashed (and those that are not). Because each data hash assertion defines a byte range and optional URL, it is flexible enough to be usable whether the asset is a single binary or represented in multiple chunks or portions, local or remote.</p>
</div>
</div>
<div class="sect3">
<h4 id="_hashing_a_bmff_formatted_asset"><a class="anchor" href="#_hashing_a_bmff_formatted_asset"></a>9.2.2. Hashing a BMFF-formatted asset</h4>
<div class="paragraph">
<p>If the asset is based on <a href="https://www.iso.org/standard/74428.html">ISO BMFF</a> then a hard binding optimized for the box-based format (called <a href="#_bmff_based_hash">BMFF-based hash assertions</a>) may be used instead.</p>
</div>
<div class="paragraph">
<p>For a monolithic MP4 file asset where the <code>mdat</code> box is validated as a unit, the assertion is validated nearly identically to a data hash assertion.  It simply uses a box exclusion list instead of byte ranges to define the range of bytes that are hashed (and those that are not).</p>
</div>
<div class="paragraph">
<p>For a monolithic MP4 file asset where the <code>mdat</code> box is validated piecemeal or an asset composed of fragmented MP4 (fMP4) files, the assertion itself must be combined with chunk-specific hashing information which is located as specified in <a href="#_embedding_manifests_into_bmff_based_assets">Section 11.3.2, &#8220;Embedding manifests into BMFF-based assets&#8221;</a>.  Validating a given chunk requires first validating the <code>merkle</code> field&#8217;s <code>initHash</code> over the corresponding initialization segment and then locating the correct entry in the <code>merkle</code> field&#8217;s <code>hashes</code> array and validating it against the hash of the chunk&#8217;s data plus (if needed) deriving the hash using the other <code>hashes</code> specified in the chunk&#8217;s C2PA-specific box.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/bmff_validation1.svg" alt="Validating the initialization segment">
</div>
<div class="title">Figure 5. Validating the initialization segment</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/bmff_validation2.png" alt="Validating the chunk&#8217;s data">
</div>
<div class="title">Figure 6. Validating the chunk&#8217;s data</div>
</div>
</div>
<div class="sect3">
<h4 id="_asset_metadata_bindings"><a class="anchor" href="#_asset_metadata_bindings"></a>9.2.3. Asset Metadata Bindings</h4>
<div class="paragraph">
<p>In those workflows which embed asset metadata into the asset, such asset metadata should not be excluded by <a href="#_data_hash">data hash assertions</a>.</p>
</div>
<div class="paragraph">
<p>This means that by default all asset metadata (including Exif metadata and IPTC metadata in either IPTC-IIM or XMP format) will be included in the <a href="#_data_hash">data hash assertions</a>, but with no provenance information such as who made the claims.</p>
</div>
<div class="paragraph">
<p>To explicitly assert the same claims in a C2PA assertion with verifiable provenance, the Exif or IPTC fields should be copied to a <code>stds.exif</code> or <code>stds.iptc.photo-metadata</code> assertion, as appropriate (see <a href="#_exif_information">Section 18.14, &#8220;Exif Information&#8221;</a> and <a href="#_iptc_photo_metadata">Section 18.15, &#8220;IPTC Photo Metadata&#8221;</a>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We recommend that existing Exif, IPTC-IIM and/or XMP asset metadata be left untouched in the asset. This will allow for compatibility with tools which do not yet support C2PA metadata.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_soft_bindings"><a class="anchor" href="#_soft_bindings"></a>9.3. Soft Bindings</h3>
<div class="paragraph">
<p>Soft bindings are described using <a href="#_soft_binding">soft binding assertions</a> such as via a perceptual hash computed from the digital content or a watermark embedded within the digital content. These soft bindings enable digital content to be matched even if the underlying bits differ, for example due to an asset rendition in a different resolution or encoding format. Additionally, should a C2PA manifest be removed from an asset, but a copy of that manifest remains in a provenance store elsewhere, the manifest and asset may be matched using available soft bindings.</p>
</div>
<div class="paragraph">
<p>Because they serve a different purpose, a soft binding shall not be used as a hard binding.</p>
</div>
<div class="paragraph">
<p>All soft bindings shall be generated using one of the algorithms listed as supported by this specification. This section is intended to provide:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A list of algorithms that are allowed for generating soft bindings of new content as well as required for validating or locating existing content (the allowed list), and</p>
</li>
<li>
<p>A list of algorithms that are required to be supported for validating or locating existing content but are not allowed for generating soft bindings of new content (the deprecated list).</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_none_defined_in_1_0"><a class="anchor" href="#_none_defined_in_1_0"></a>9.3.1. None Defined in 1.0</h4>
<div class="paragraph">
<p>There are no soft binding algorithms defined in the approved list nor in the deprecated list in this version of the specification.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The C2PA is currently evaluating various soft binding algorithms. One of the many possible options includes the <a href="https://iscc.codes/">ISCC - International Standard Content Code</a>. The ISCC is an identifier and fingerprint for digital assets that supports all major content types (e.g., text, image, audio, video). The ISCC uses is similarity-preserving hashes generated both from metadata and content.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_future_requirements"><a class="anchor" href="#_future_requirements"></a>9.3.2. Future Requirements</h4>
<div class="paragraph">
<p>This list of allowed algorithms will define the string algorithm identifier to be used as the algorithm identifier in the corresponding field and the content types over which it is applicable. In cases where there are different versions of an algorithm, each will be defined using different string algorithm identifiers.  Any technical documentation sufficient for the soft binding algorithm to be uniquely identified and utilized, should be referenced.</p>
</div>
<div class="paragraph">
<p>Each algorithm should be defined along with the names and values of all parameters affecting the operation of that algorithm. When doing so, it shall describe the manner in which those parameters must be encoded within the <code>alg-params</code> field of the <a href="#_soft_binding">soft binding assertion</a>.  An algorithm that is instantiated over a different parameter set will be considered a different algorithm.</p>
</div>
<div class="paragraph">
<p>Each algorithm may also define an encoding scheme for specifying the portion of digital content over which a soft binding is computed (namely, the <code>extent</code> field of the <code>scope</code> object within the <a href="#_soft_binding">soft binding assertion</a>).  An algorithm that encodes the <code>extent</code> differently will be considered a different algorithm.</p>
</div>
<div class="paragraph">
<p>It is recommended that the string identifiers for soft binding algorithms conform to how they are referred to in common practice.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_claims"><a class="anchor" href="#_claims"></a>10. Claims</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_4"><a class="anchor" href="#_overview_4"></a>10.1. Overview</h3>
<div class="paragraph">
<p>A <strong>claim</strong> gathers together all the assertions about an asset from an actor at a given time including the set of assertions for <a href="#_binding_to_content">binding to the content</a>. The claim is then cryptographically hashed and signed as described in <a href="#_signing_a_claim">Section 10.3.2.4, &#8220;Signing a Claim&#8221;</a>. A claim has all the same properties as an assertion including being assigned the label (<code>c2pa.claim</code>) and supporting the use of <a href="#_metadata_about_assertions">assertion metadata</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_syntax"><a class="anchor" href="#_syntax"></a>10.2. Syntax</h3>
<div class="paragraph">
<p>The <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a> for this type is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; CDDL schema for a claim map in C2PA
claim-map = {
  "claim_generator": tstr, ; A User-Agent string formatted as per http://tools.ietf.org/html/rfc7231#section-5.5.3, for including the name and version of the claims generator that created the claim
  "claim_generator_info": [1* generator-info-map],
  "signature": jumbf-uri-type, ; JUMBF URI reference to the signature of this claim
  "assertions": [1* $hashed-uri-map],
  "dc:format": tstr, ; media type of the asset
  "instanceID": tstr .size (1..max-tstr-length), ; uniquely identifies a specific version of an asset
  ? "dc:title": tstr .size (1..max-tstr-length), ; name of the asset,
  ? "redacted_assertions": [1* jumbf-uri-type], ; List of hashed URI references to the assertions of ingredient manifests being redacted
  ? "alg": tstr .size (1..max-tstr-length), ; A string identifying the cryptographic hash algorithm used to compute all data hash assertions listed in this claim unless otherwise overridden, taken from the C2PA data hash algorithm identifier registry. This provides the value for the 'alg' field in data-hash and hashed-uri structures contained in this claim
  ? "alg_soft": tstr .size (1..max-tstr-length), ; A string identifying the algorithm used to compute all soft binding assertions listed in this claim unless otherwise overridden, taken from the C2PA soft binding algorithm identifier registry."
  ? "metadata": $assertion-metadata-map, ; additional information about the assertion
}

jumbf-uri-type = tstr .regexp "self#jumbf=[\\w\\d][\\w\\d\\.\/:-]+[\\w\\d]"

generator-info-map = {
  "name": tstr .size (1..max-tstr-length), ; A human readable string naming the claim_generator	  ? "Sec-CH-UA": [1* tstr], ; A human readable string naming the claim_generator
  ? "version": tstr, ; A human readable string of the product's version	
  ? "icon": hashed-uri-map / $hashed-ext-uri-map, ; hashed URI to the icon (either embedded or remote)
  * tstr =&gt; any	  * tstr =&gt; any
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in <a href="https://www.rfc-editor.org/rfc/rfc8949.html#name-diagnostic-notation">CBOR-Diag</a> is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "alg" : "sha256",
  "claim_generator": "Joe's Photo Editor/2.0 (Windows 10)",
	"claim_generator_info" : [
		{
			"name": "Joe's Photo Editor",
			"version": "2.0",
			"schema.org.SoftwareApplication.operatingSystem": "Windows 10"
		}
	],
  "signature" : "self#jumbf=c2pa/urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.signature",
  "dc:format": "image/jpeg",
  "assertions" : [
    {
      "url": "self#jumbf=c2pa/urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.assertions/c2pa.hash.data",
      "hash": b64'U9Gyz05tmpftkoEYP6XYNsMnUbnS/KcktAg2vv7n1n8='
    },
    {
      "url": "self#jumbf=c2pa/urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.assertions/c2pa.thumbnail.claim.jpeg",
      "hash": b64'G5hfJwYeWTlflxOhmfCO9xDAK52aKQ+YbKNhRZeq92c='
    },
    {
      "url": "self#jumbf=c2pa/urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.assertions/c2pa.claim.ingredient",
      "hash": b64'Yzag4o5jO4xPyfANVtw7ETlbFSWZNfeM78qbSi8Abkk='
    }
  ],
  "redacted_assertions" : [
    "self#jumbf=c2pa/urn:uuid:5E7B01FC-4932-4BAB-AB32-D4F12A8AA322/c2pa.assertions/stds.exif"
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://www.iana.org/assignments/media-types/media-types.xhtml">Media Type</a> of the ingredient shall be declared in <code>dc:format</code>. If present, the value of <code>dc:title</code> shall be a human-readable name for the asset.</p>
</div>
<div class="paragraph">
<p>If the asset contains XMP, then the asset&#8217;s <code>xmpMM:InstanceID</code> should be used as the <code>instanceID</code>. When no XMP is available, then some other <a href="#_unique_identifiers">unique identifier</a> for the asset shall be used as the value for <code>instanceID</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Some field names, such as <code>dc:format</code>, have namespace prefixes as their names and definitions are taken directly from the XMP standard.  However, their usage in C2PA does not require the use of XMP.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>signature</code> field shall be present containing a <a href="#_uri_references">URI reference</a> to a <a href="#_signing_a_claim">claim signature</a>.</p>
</div>
<div class="paragraph">
<p>The <code>assertions</code> field shall be present containing one or more <a href="#_uri_references">URI references</a> to the <a href="#_assertions">assertions</a> being made by this claim.</p>
</div>
<div class="paragraph">
<p>When present, the <code>redacted_assertions</code> field shall contain one or more <a href="#_uri_references">URI references</a> to <a href="#_redaction_of_assertions">redacted assertions</a>.</p>
</div>
<div class="sect3">
<h4 id="_claim_generator_2"><a class="anchor" href="#_claim_generator_2"></a>10.2.1. Claim Generator</h4>
<div class="paragraph">
<p>The <code>claim_generator</code> field is required and its value is a string that conforms to the User-Agent string format specified in section 5.5.3 of <a href="http://tools.ietf.org/html/rfc7231#section-5.5.3">HTTP/1.1 Semantics and Content</a> to inform a manifest consumer about what software/hardware/system produced this Claim.  Since the User-Agent string uses spaces to separate tokens, it is recommended to use an <code>_</code> (underscore, U+005F) to combine words inside a single token (e.g.,  "Joe&#8217;s Editor" &#8594; "Joe&#8217;s_Editor").</p>
</div>
</div>
<div class="sect3">
<h4 id="_claim_generator_info"><a class="anchor" href="#_claim_generator_info"></a>10.2.2. Claim Generator Info</h4>
<div class="paragraph">
<p>More detailed information about the claim generator shall be present as the value of <code>claim_generator_info</code>. For compatibility with version 1.0 of this standard, both <code>claim_generator</code> and <code>claim_generator_info</code> are required to be present.</p>
</div>
<div class="paragraph">
<p>A Manifest Consumer shall use the value of <code>claim_generator_info</code> in determining information about the claim generator for itself or for presentation in a UX. If only a <code>claim_generator</code> field is present, or both <code>claim_generator</code> and <code>claim_generator_hints</code> are present, the Manifest Consumer shall consider this a 1.0-compliant claim. In that case, it shall use the value of <code>claim_generator</code>, as is, for presentation in a UX.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In previous versions of this specification, there existed a <code>claim_generator_hints</code> object which allowed using the specific fields from <a href="https://wicg.github.io/ua-client-hints/#http-ua-hints">W3C&#8217;s proposed User Agent Client Hints specification</a>.  However, the W3C chose to take that specification in a direction that is not aligned with C2PA and so that structure is no longer written into claims.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_generator_info_map"><a class="anchor" href="#_generator_info_map"></a>10.2.2.1. Generator Info Map</h5>
<div class="paragraph">
<p>When adding a <code>claim_generator_info</code> field, its value is an array of at least one <code>generator-info-map</code> object.  Each object shall contain at least the <code>name</code> field and may optionally contain a <code>version</code> field and an <code>icon</code> field, though any other field is permitted, using the standard entity-specific labels' format described in <a href="#_labels">Section 6.2, &#8220;Labels&#8221;</a>. The first entry of the array shall represent the hardware/software that actually created the claim (aka the claim generator itself), while other entries may represent other hardware, software or libraries involved in the process in decreasing order of significance.</p>
</div>
<div class="paragraph">
<p>A claim generator may desire to provide a graphical representation of itself, referred here as an <code>icon</code>, to a manifest consumer that is presenting a user experience. The value of the <code>icon</code> object, if present, shall be a <a href="#_hashed_uris">hashed URI</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As with the assertions array, the hash algorithm used for a <a href="#_hashed_uris">hashed URI</a> is determined by the <code>alg</code> field present in the hashed URI, or when absent, by a <code>hash</code> field in the claim.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example using claim generator info</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
	"claim_generator": "Joe's_Photo_Editor/2.0 (Windows 10)",
	"claim_generator_info" : [
		{
			"name": "Joe's Photo Editor",
			"version": "2.0",
			"schema.org.SoftwareApplication.operatingSystem": "Windows 10",
			"icon": {
				"url": "http://cdn.examplephotoagency.com/logo.svg",
				"hash": "5bdec8169b4e4484b79aba44cee5c6bd"
			}
		},
		{
			"name": "Some C2PA SDK",
			"version": "1.5",
			"com.litware.url" : "https://www.litware.com/SDK"
		}
	]
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_claim"><a class="anchor" href="#_creating_a_claim"></a>10.3. Creating a Claim</h3>
<div class="sect3">
<h4 id="_creating_assertions"><a class="anchor" href="#_creating_assertions"></a>10.3.1. Creating Assertions</h4>
<div class="paragraph">
<p>Before the claim can be finalized, all <a href="#_assertions">assertions</a> must be created and stored in a newly created <a href="#_c2pa_box_details">C2PA Assertion Store</a> as described <a href="#_types_of_manifests">later in this document</a>.</p>
</div>
<div class="paragraph">
<p>When creating a standard manifest, it may not be possible to know all of the required binding information at the time of claim creation, in which case use the <a href="#_multiple_step_processing">multiple step processing method</a> to setup and then later fill-in the information.</p>
</div>
</div>
<div class="sect3">
<h4 id="_preparing_the_claim"><a class="anchor" href="#_preparing_the_claim"></a>10.3.2. Preparing the Claim</h4>
<div class="sect4">
<h5 id="_adding_assertions_and_redactions"><a class="anchor" href="#_adding_assertions_and_redactions"></a>10.3.2.1. Adding Assertions and Redactions</h5>
<div class="paragraph">
<p>The claim shall contain the <code>assertions</code> field and its value is a list of all of the URI references for all assertions that were added to the assertion store that are being "claimed" by this claim. At least one of the assertions shall be either a <a href="#_data_hash">data hash assertion</a> or a <a href="#_bmff_based_hash">BMFF-based hash assertion</a>.</p>
</div>
<div class="paragraph">
<p>If any assertions in ingredient claims are being redacted, their URI references shall be added to list which is the value of the <code>redacted_assertions</code> field.</p>
</div>
</div>
<div class="sect4">
<h5 id="_adding_ingredients"><a class="anchor" href="#_adding_ingredients"></a>10.3.2.2. Adding Ingredients</h5>
<div class="paragraph">
<p>In many authoring scenarios, an actor does not create an entirely new asset but instead brings in other existing assets on which to create their work - either as a derived asset, a composed asset or an asset rendition. These existing assets are called ingredients and their use is documented in the provenance data through the use of an <a href="#_ingredient">ingredient assertion</a>. When an ingredient contains one or more C2PA manifests, those manifests must be inserted into this asset&#8217;s manifest store to ensure that the provenance data is kept intact. Such ingredient manifests are added to the JUMBF as described in <a href="#_c2pa_box_details">Section 11.1.1, &#8220;C2PA Box details&#8221;</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_connecting_the_signature"><a class="anchor" href="#_connecting_the_signature"></a>10.3.2.3. Connecting the Signature</h5>
<div class="paragraph">
<p>The signature cannot be part of the signed payload, but since its label is pre-defined, then the full URI reference is also known. As such, we can include that in the claim by setting the value of the <code>signature</code> field of the claim to that URI reference.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This provides the explicit binding of the claim to its signature.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_signing_a_claim"><a class="anchor" href="#_signing_a_claim"></a>10.3.2.4. Signing a Claim</h5>
<div class="paragraph">
<p>Producing the signature is specified in <a href="#_digital_signatures">Section 13.2, &#8220;Digital Signatures&#8221;</a>. The <code>payload</code> field of <code>Sig_structure</code> shall be the serialized CBOR of the claim document, and shall use detached content mode. The serialized <code>COSE_Sign1_Tagged</code> structure resulting from the digital signature procedure is written into the C2PA Claim Signature box.</p>
</div>
</div>
<div class="sect4">
<h5 id="_time_stamps"><a class="anchor" href="#_time_stamps"></a>10.3.2.5. Time-stamps</h5>
<div class="paragraph">
<p>If possible, the signer should use a RFC3161-compliant Time Stamp Authority (TSA) (<a href="https://datatracker.ietf.org/doc/html/rfc3161">RFC 3161 section 1</a>) to obtain a trusted time-stamp proving that the signature itself actually existed at a certain date and time and incorporate that into the <code>COSE_Sign1_Tagged</code> structure as a countersignature. A manifest may contain multiple time-stamps.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Signers are encouraged to obtain and include time-stamps to ensure their manifests will remain valid. As described in <a href="#_validation">Chapter 15, <em>Validation</em></a>, manifests without time-stamps cease to be valid when the signing credential expires or becomes revoked.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All time-stamps shall be obtained as described in <a href="https://tools.ietf.org/html/rfc3161">RFC3161</a> with the following additional requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>MessageImprint</code> of the <code>TimeStampReq</code> structure (<a href="https://datatracker.ietf.org/doc/html/rfc3161#section-2.4.1">RFC 3161 section 2.4.1</a>) shall be computed by creating the <code>ToBeSigned</code> value in <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-4.4">RFC 8152 section 4.4</a> with the following values for elements of <code>Sig_structure</code>:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>context</code> element shall be <code>CounterSignature</code>.</p>
</li>
<li>
<p>The <code>payload</code> element shall be as described in <a href="#_signing_a_claim">Section 10.3.2.4, &#8220;Signing a Claim&#8221;</a>.</p>
</li>
<li>
<p>The remaining elements of <code>Sig_structure</code> are as described in <a href="#_digital_signatures">Section 13.2, &#8220;Digital Signatures&#8221;</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The <code>ToBeSigned</code> value is then hashed using a hash algorithm from the allowed list in <a href="#_hashing">Section 13.1, &#8220;Hashing&#8221;</a> that the TSA supports, and that hash algorithm and value are placed in the <code>MessageImprint</code>. If the TSA does not support any hash algorithms from the allowed list, it cannot be used for time-stamping.</p>
<div class="ulist">
<ul>
<li>
<p>Where possible, the hash algorithm should use the same hash algorithm used in the digital signature of the claim.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The <code>certReq</code> boolean of the <code>TimeStampReq</code> structure shall be asserted in the request to the TSA, to ensure its certificate chain is provided in the response.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Time-stamps shall be stored in a COSE unprotected header whose label is the string <code>sigTst</code>. If no time-stamps are included, the header shall be absent. When present, the value of this header shall be a <code>tstContainer</code> defined by the following CDDL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; CBOR version of tstContainer and related structures based on JSON schema at https://forge.etsi.org/rep/esi/x19_182_JAdES/raw/v1.1.1/19182-jsonSchema.json
tstContainer = {
  "tstTokens": [1* tstToken]
}

tstToken = {
  "val": bstr
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The content of the <code>TimeStampResp</code> structure received in reply from the TSA shall be stored as the value of the <code>val</code> property of an element of <code>tstTokens</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The above definition is a CBOR adaptation of a subset of the schema from <a href="https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf">JAdES section 5.3.4</a> and <a href="https://forge.etsi.org/rep/esi/x19_182_JAdES/raw/v1.1.1/19182-jsonSchema.json">its JSON schema</a>, except with the modification that the content of <code>val</code> is a byte string containing the content of the <code>TimeStampResp</code>, and not a Base64-encoded version of the same.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_credential_revocation_information"><a class="anchor" href="#_credential_revocation_information"></a>10.3.2.6. Credential Revocation Information</h5>
<div class="paragraph">
<p>If the signer&#8217;s credential type supports querying its online credential status, and the credential contains a pointer to a service to provide time-stamped credential status information, the signer should query the service, capture the response, and store it in the manner described for the signer&#8217;s credential type in the <a href="#_trust_model">Trust Model</a>. If credential revocation information is attached in this manner, a trusted time-stamp must also be obtained after signing, as described in <a href="#_time_stamps">Section 10.3.2.5, &#8220;Time-stamps&#8221;</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_examples_of_claims"><a class="anchor" href="#_examples_of_claims"></a>10.3.3. Examples of Claims</h4>
<div class="sect4">
<h5 id="_single_claim"><a class="anchor" href="#_single_claim"></a>10.3.3.1. Single Claim</h5>
<div class="paragraph">
<p>Here is a visual representation of an image containing a single claim with multiple assertions that have been embedded inside it.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/Single_Claim.svg" alt="A single claim with assertions" width="720" height="432">
</div>
<div class="title">Figure 7. A single claim with assertions</div>
</div>
</div>
<div class="sect4">
<h5 id="_multiple_claims"><a class="anchor" href="#_multiple_claims"></a>10.3.3.2. Multiple Claims</h5>
<div class="paragraph">
<p>In this example of creating a second claim for the <a href="#_single_claim">previous example</a>, one of the original assertions has been redacted from the previous claim. The visual representation for this scenario would look like:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/Multiple_Claims.svg" alt="Redacting assertions in a secondary claim" width="720" height="432">
</div>
<div class="title">Figure 8. Redacting assertions in a secondary claim</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_multiple_step_processing"><a class="anchor" href="#_multiple_step_processing"></a>10.4. Multiple Step Processing</h3>
<div class="paragraph">
<p>Some asset file formats require file offsets of the C2PA Manifest Store and asset content to be fixed before the manifest is signed, so that content bindings will correctly align with the content they authenticate. Unfortunately, the size of a manifest and its signature cannot be precisely known until after signing, which could cause file offsets to change. For example, in <a href="https://en.wikipedia.org/wiki/JPEG">JPEG-1</a> files, the entire C2PA Manifest Store must appear in the file before the image data, and so its size will affect the file offsets of content being authenticated.</p>
</div>
<div class="paragraph">
<p>To accomplish this, a multiple step approach is taken, similar to how signatures in PDF are done.</p>
</div>
<div class="sect3">
<h4 id="_prepare_the_xmp"><a class="anchor" href="#_prepare_the_xmp"></a>10.4.1. Prepare the XMP</h4>
<div class="paragraph">
<p>For those C2PA-enabled assets that contain embedded XMP, start by creating the XMP data stream and then serializing it into the asset in the standard location reserved for it in the format of the asset. The XMP stream may include the <a href="#_embedding_a_reference_to_the_active_manifest">active manifest reference</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
While it is possible to add the XMP data to the list of exclusions in a data hash assertion, doing so is not recommended as it would remove tamper detection of that asset metadata.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_create_content_bindings"><a class="anchor" href="#_create_content_bindings"></a>10.4.2. Create content bindings</h4>
<div class="paragraph">
<p>When creating a <a href="#_standard_manifests">standard manifest</a>, its claim shall include one or more content binding assertions in its list of assertions to ensure that the asset is tamper-evident.</p>
</div>
<div class="paragraph">
<p>Create the data hash assertion and add it to the assertion store taking into account the following considerations.</p>
</div>
<div class="paragraph">
<p>In many cases, such as with JPEG-1, it is not possible to hash the asset in its entirety because the manifest will be embedded in the middle of the file, so the size or location manifest data will not be known at the time the asset hash is calculated.  This circular dependency is avoided by allowing exclusion ranges to be specified during hashing.  When exclusion ranges are specified, a single hash is performed, but only over the asset ranges that are not in any of the exclusions.</p>
</div>
<div class="paragraph">
<p>If a manifest is embedded in the center of a JPEG-1 file in an APP11 segment, then the claim creator may exclude the APP11 segment(s) from the hash calculation.</p>
</div>
<div class="paragraph">
<p>In order to prevent insertion attacks, it is desirable to have only a single exclusion range when possible. When the size or location (or both) of the manifest in the asset is not known, then the <code>start</code> and <code>length</code> values in the data hash assertion shall both be zero and the size of the <code>pad</code> value should be large enough to accommodate writing in the values in the second pass.  At least 16 bytes is recommended. The value of the <code>pad</code> key shall consist of all 0x00&#8217;s.</p>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_temporary_claim_and_signature"><a class="anchor" href="#_create_a_temporary_claim_and_signature"></a>10.4.3. Create a temporary Claim and Signature</h4>
<div class="paragraph">
<p>Add the newly created data hash assertion reference to the claim&#8217;s assertion list providing a temporary hash value, such as empty spaces.</p>
</div>
<div class="paragraph">
<p>At this point, the temporary claim is complete and can be added to the C2PA Manifest being created.</p>
</div>
<div class="paragraph">
<p>Since the claim is only temporary at this time, it is not possible to sign it. To ensure the claim signature box contains a valid CBOR structure, create a temporary <code>COSE_Sign1_Tagged</code> structure as described in <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-4.2">RFC 8152 section 4.2</a>. The <code>COSE_Sign1_Tagged</code> is a tag byte followed by a <code>COSE_Sign1</code> structure, which is a four-element CBOR array. Construct the array as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first element is the <code>protected</code> header bucket (<a href="https://datatracker.ietf.org/doc/html/rfc8152#section-3">RFC 8152 section 3</a>). Create an empty bucket by placing a <code>bstr</code> of size 0 in this position.</p>
</li>
<li>
<p>The second element is the <code>unprotected</code> header bucket, which is a CBOR map. Create a map of 1 pair. Use the string <code>pad</code> as the label, and place a <code>bstr</code> of the desired padding size filled with zero bytes (0x00) as the value. A 25 kilobyte size is recommended for the initial size of this padding.</p>
</li>
<li>
<p>The third element is the <code>payload</code>. Place the value <code>nil</code> (CBOR major type 7, value 22) here.</p>
</li>
<li>
<p>The fourth element is <code>signature</code>. Place a <code>bstr</code> of size 0 here.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_complete_the_c2pa_manifest"><a class="anchor" href="#_complete_the_c2pa_manifest"></a>10.4.4. Complete the C2PA Manifest</h4>
<div class="paragraph">
<p>At this point all of the boxes that comprise the entire C2PA Manifest for the asset are completed and can be (if not already) constructed into its final form. The asset&#8217;s C2PA Manifest, along with the manifests of any ingredients, are combined together to form the complete C2PA Manifest Store. The active manifest must be the last C2PA Manifest superbox in the C2PA Manifest Store superbox. The C2PA Manifest Store can then be embedded into the asset as discussed in <a href="#_embedding_manifests_into_assets">Section 11.3, &#8220;Embedding manifests into assets&#8221;</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_going_back_and_filling_in"><a class="anchor" href="#_going_back_and_filling_in"></a>10.4.5. Going back and filling in</h4>
<div class="paragraph">
<p>Now that the C2PA Manifest Store has been embedded into the asset, the starting offset and the length of the active manifest can be updated in its data hash assertion.  It is necessary that when doing so, you do not change the size of the assertion&#8217;s box, only its data.  This is done by adjusting the value of the <code>pad</code> field to be the necessary length to "fill up" the remaining bytes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Preferred/deterministic CBOR serialization of <code>pad</code> uses a variable length integer to specify the length of the encoded binary data. When the length goes from zero to 1 byte, or 1 to 2 bytes (etc.), the length of the resulting pad jumps by two bytes. This means that not all paddings can be expressed using a single padding field. For example, 24-byte and 26-byte pads can be created, but a 25-byte pad cannot.  If this situation arises, the desired padding can be split between <code>pad</code> and <code>pad2</code>. For example, to make a 25-byte pad, a claim generator can encode 19 bytes into <code>pad</code> (resulting in an encoded length of 20 bytes), and 4 bytes into <code>pad2</code> (resulting in 5 bytes.)</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once the data hash assertion has been updated, it can be hashed and the hash written over the empty spaces that were used previously to hold the location.</p>
</div>
<div class="paragraph">
<p>The claim is now complete, and it can be hashed and signed as described in <a href="#_signing_a_claim">Section 10.3.2.4, &#8220;Signing a Claim&#8221;</a>, with the resultant signature filling the pre-allocated space. The <code>pad</code> header can then be shrunk as required so that the claim signature box remains the same size; because this header is unprotected, changing it does not invalidate the claim signature.</p>
</div>
<div class="paragraph">
<p>If the serialized <code>COSE_Sign1_Tagged</code> structure exceeds the reserved size of the C2PA Claim Signature box, multiple step processing must be repeated with a larger padding size chosen in <a href="#_create_a_temporary_claim_and_signature">Section 10.4.3, &#8220;Create a temporary Claim and Signature&#8221;</a>. Revocation information retrieved during the previous attempt should be reusable if it is still within its validity interval (<a href="https://datatracker.ietf.org/doc/html/rfc6960#section-4.2.2.1">RFC 6960 section 4.2.2.1</a>), but a new time-stamp will be required on the new claim with the file offsets changed as the result of added padding.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_manifests"><a class="anchor" href="#_manifests"></a>11. Manifests</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_use_of_jumbf"><a class="anchor" href="#_use_of_jumbf"></a>11.1. Use of JUMBF</h3>
<div class="paragraph">
<p>In order to support many of the requirements of C2PA, C2PA Manifests needed to be stored (serialized) into a structured binary data store that enables some specific functionality including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ability to store multiple manifests (e.g., parents and ingredients) in a single container</p>
</li>
<li>
<p>Ability to refer to individual elements (both within and across manifests) via URIs</p>
</li>
<li>
<p>Ability to clearly identify the parts of an element to be hashed</p>
</li>
<li>
<p>Ability to store pre-defined data types used by C2PA (e.g., JSON and CBOR)</p>
</li>
<li>
<p>Ability to store arbitrary data formats (e.g., XML, JPEG, etc.)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition to supporting all of the requirements above, our chosen container format - <a href="https://www.iso.org/standard/73604.html">JUMBF, ISO 19566-5</a> - is also natively supported by the JPEG family of formats and is compatible with the box-based model (i.e., <a href="https://www.iso.org/standard/68960.html">ISOBMFF, ISO 14496-12</a>) used by many common image and video file formats. Using JUMBF enables all the same benefits (and a few extras, such as <a href="#_uri_references">URI References</a>) while being able to work with classic image formats, such as JPEG/JFIF and PNG as well as 3D and document (e.g., PDF) formats. This serialized format shall be used also in formats that do not natively support JUMBF, or when C2PA Manifest Stores are stored separately from the asset, such as in a separate file or URI location.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Since most of the standard assertions, as well the claim signature, are serialized as CBOR, using CBOR for the entire C2PA Manifest was considered but not chosen because CBOR is not a container format. It could be used as one through having to re-define how CBOR would be used to provide the features natively supported by JUMBF.</p>
</div>
<div class="paragraph">
<p>For example, to store a "blob of JSON" inside of CBOR, and know that it is JSON (and not some other format) would require designing a data structure for storing such things. Then the parent structure would need to be defined as to how to carry that structure. This same concept would also have to be done for each of the native features of JUMBF.</p>
</div>
<div class="paragraph">
<p>While it would certainly be possible to re-implement all of the required functionality entirely in CBOR, it would be a lot of work and would not fully remove the need for a JUMBF/BMFF parser in all implementations.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A C2PA Manifest Consumer shall never process an assertion, assertion store, claim, claim signature or C2PA Manifest that is not contained inside of a C2PA Manifest Store. Additionally, when a C2PA Manifest Consumer encounters a JUMBF box or superbox whose UUID it does not recognize, it shall skip over (and ignore) its contents.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This means that the C2PA Manifest Consumer can process private boxes that it knows about, but ignore ones of which it is unaware.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_c2pa_box_details"><a class="anchor" href="#_c2pa_box_details"></a>11.1.1. C2PA Box details</h4>
<div class="paragraph">
<p>C2PA data is serialized into a JUMBF-compatible box structure, and the outermost box is referred to as the C2PA Manifest Store. An example C2PA Manifest Store, with a single C2PA Manifest, might look like this:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/ManifestStore.svg" alt="C2PA Manifest Store" width="240" height="500">
</div>
<div class="title">Figure 9. C2PA Manifest Store</div>
</div>
<div class="paragraph">
<p>The C2PA Manifest Store is a JUMBF superbox composed of a series of other JUMBF boxes and superboxes, each identified by their own UUID and label in their JUMBF Description box. The C2PA Manifest Store shall have a label of <code>c2pa</code>, a UUID of <code>0x63327061-0011-0010-8000-00AA00389B71</code> (<code>c2pa</code>) and shall contain one or more C2PA manifest superboxes, also known as C2PA Manifests. The C2PA Manifest Store may also contain JUMBF superboxes whose UUIDs are not defined in this specification.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Allowing other superboxes enables custom extensions to C2PA as well as enabling the addition of new boxes in future versions of this specification without breaking compatibility.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each C2PA Manifest shall contain the data created at the time a claim is issued including the C2PA Assertion Store, a C2PA Claim, and a C2PA Claim Signature. It may also contain a <a href="#_vcstore">C2PA Credential Store</a>. A C2PA Manifest may also contain JUMBF superboxes whose UUIDs are not defined in this specification.</p>
</div>
<div class="paragraph">
<p>The UUID for each C2PA Manifest shall be either <code>0x63326D61-0011-0010-8000-00AA00389B71</code> (<code>c2ma</code>) or <code>0x6332756D-0011-0010-8000-00AA00389B71</code> (<code>c2um</code>) depending on the <a href="#_types_of_manifests">type of manifest</a>. In order to enable uniquely identifying each C2PA Manifest, they shall be labelled with a <a href="https://tools.ietf.org/html/rfc4122">RFC 4122, UUID</a> optionally proceeded by an identifier of the claim generator and a <code>:</code>. An example label for the fictitious ACME claim generator might look like <code>acme:urn:uuid:F9168C5E-CEB2-4FAA-B6BF-329BF39FA1E4</code>.</p>
</div>
<div class="paragraph">
<p>The C2PA <a href="#_assertion_store">Assertion Store</a> is a superbox that shall have a label of <code>c2pa.assertions</code> and a UUID of <code>0x63326173-0011-0010-8000-00AA00389B71</code> (<code>c2as</code>). It shall contain one or more JUMBF superboxes (called C2PA Assertion boxes) whose JUMBF type defines the BMFF type of the sub-boxes that contain the assertion data (see ISO 19566-5, Annex B, Table B.1 and ISO 19566-5/AMD-1, Annex B). These superboxes shall each have a label as defined in <a href="#_c2pa_standard_assertions">Standard Assertions</a>. The JUMBF Content Type (ISO 19566-5, Annex B) box(es) contained in each assertion superbox should be CBOR Content Type (<code>cbor</code>), JSON Content Type (<code>json</code>), Embedded File Content Type (<code>bfdb</code> &amp; <code>bidb</code>) or UUID Content Type (<code>uuid</code>) though any Content Type defined in JUMBF and its amendments is permitted. The C2PA Assertion Store shall not contain any JUMBF boxes or superboxes that are not JUMBF Content Boxes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Custom assertions containing other formats/serializations of data, such as encrypted data, are supported through the use of a UUID Content Box containing the custom UUID followed by the data (see ISO 19566-5, B.5).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The C2PA <a href="#_claims">Claim</a> box shall have a label of <code>c2pa.claim</code>, a UUID of <code>0x6332636C-0011-0010-8000-00AA00389B71</code> (<code>c2cl</code>) and shall consist of a single CBOR Content Type box (<code>cbor</code>).</p>
</div>
<div class="paragraph">
<p>The C2PA <a href="#_digital_signatures">Claim Signature</a> box shall have a label of <code>c2pa.signature</code>, a UUID of <code>0x63326373-0011-0010-8000-00AA00389B71</code> (<code>c2cs</code>) and shall consist of a single CBOR Content Type box (<code>cbor</code>).</p>
</div>
<div class="sect4">
<h5 id="_credential_storage"><a class="anchor" href="#_credential_storage"></a>11.1.1.1. Credential Storage</h5>
<div class="paragraph">
<p>A C2PA Credential Store (VCStore) is a JUMBF superbox that shall contain only one or more JSON Content Type boxes (ISO 19566-5, Annex B.4). It shall not contain any other type of JUMBF box or superbox. It shall have a label of <code>c2pa.credentials</code> and a UUID of <code>0x63327663-0011-0010-8000-00AA00389B71</code> (<code>c2vc</code>).</p>
</div>
<div class="paragraph">
<p>When storing W3C Verifiable Credentials in a VCStore, each one shall be labelled with the value of the <code>id</code> field of the <code>credentialSubject</code> of the VC itself. Since the <code>id</code> is guaranteed to be unique, this ensures that the URI to that credential will be unique.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/ManifestStore_Credential.svg" alt="C2PA Manifest Store with W3C Verifiable Credentials" width="244" height="500">
</div>
<div class="title">Figure 10. C2PA Manifest Store with W3C Verifiable Credentials</div>
</div>
</div>
<div class="sect4">
<h5 id="_ingredient_storage"><a class="anchor" href="#_ingredient_storage"></a>11.1.1.2. Ingredient Storage</h5>
<div class="paragraph">
<p>When a C2PA Manifest includes <a href="#_ingredient">ingredient assertions</a>, and an ingredient contains a C2PA Manifest, that manifest shall be brought into this asset to ensure that the provenance data is kept intact. Such ingredient manifests are added to the C2PA Manifest Store as a peer of the C2PA Manifest for the asset itself.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/ManifestStore_Ingredient.svg" alt="C2PA Manifest Store with Ingredient" width="240" height="500">
</div>
<div class="title">Figure 11. C2PA Manifest Store With an Ingredient</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_types_of_manifests"><a class="anchor" href="#_types_of_manifests"></a>11.2. Types of Manifests</h3>
<div class="sect3">
<h4 id="_commonalities"><a class="anchor" href="#_commonalities"></a>11.2.1. Commonalities</h4>
<div class="paragraph">
<p>All C2PA Manifests shall contain an <a href="#_assertion_store">assertion store</a> with at least one <a href="#_assertions">assertion</a>, a <a href="#_claims">claim</a> and a <a href="#_signing_a_claim">claim signature</a>. It may also contain a <a href="#_vcstore">credential store</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_standard_manifests"><a class="anchor" href="#_standard_manifests"></a>11.2.2. Standard Manifests</h4>
<div class="paragraph">
<p>A standard C2PA Manifest (UUID: <code>0x63326D61-0011-0010-8000-00AA00389B71</code> (<code>c2ma</code>)) shall contain exactly one <a href="#_binding_to_content">hard binding to content</a> assertion - either a <code>c2pa.hash.data</code>, <code>c2pa.hash.bmff</code> (deprecated), or <code>c2pa.hash.bmff.v2</code> based on the type of asset and version for which the manifest is destined. Because of this requirement, they are the predominant type of manifest that will be present in C2PA provenance data.</p>
</div>
</div>
<div class="sect3">
<h4 id="_update_manifests"><a class="anchor" href="#_update_manifests"></a>11.2.3. Update Manifests</h4>
<div class="paragraph">
<p>There are, however, provenance workflows where additional assertions need to be added but the digital content is not changed. In these workflows, an Update Manifest (UUID: <code>0x6332756D-0011-0010-8000-00AA00389B71</code> (<code>c2um</code>)) can be used.</p>
</div>
<div class="paragraph">
<p>An Update Manifest shall not contain assertions of types <code>c2pa.hash.data</code>, <code>c2pa.hash.bmff</code>, or <code>c2pa.hash.bmff.v2</code> because the content has not changed and therefore the bindings need not be updated.  If the hashes cover other types of potentially updatable information, such as XMP or IPTC metadata areas in the format, they too cannot be modified.  In the case of a file offset hash (<code>c2pa.hash.data</code>), the C2PA Manifest Store has to continue to start at the same file offset after updating - only its length can change.</p>
</div>
<div class="paragraph">
<p>The Update Manifest shall not contain an assertion of type <code>c2pa.actions</code> because that assertion is defined to describe "changes to the digital content". It shall not contain a <a href="#:_thumbnails">Thumbnail assertion</a> as that would imply changes to the content as well.</p>
</div>
<div class="paragraph">
<p>The Update Manifest shall contain exactly one <code>c2pa.ingredient</code> assertion that (a) includes a <code>c2pa_manifest</code> field with a value that is the <a href="#_uri_references">URI reference</a> to that <a href="#_c2pa_box_details">C2PA Manifest</a> that is being updated and (b) has the value of <code>parentOf</code> for the <code>relationship</code> field.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The ingredient&#8217;s C2PA Manifest (referenced via the <code>c2pa_manifest</code> field) can be either a standard manifest or an update manifest.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_embedding_manifests_into_assets"><a class="anchor" href="#_embedding_manifests_into_assets"></a>11.3. Embedding manifests into assets</h3>
<div class="sect3">
<h4 id="_embedding_manifests_into_non_bmff_based_assets"><a class="anchor" href="#_embedding_manifests_into_non_bmff_based_assets"></a>11.3.1. Embedding manifests into non-BMFF-based assets</h4>
<div class="paragraph">
<p>A C2PA Manifest is embedded into an asset as part of the C2PA Manifest Store for that asset.</p>
</div>
<div class="paragraph">
<p>When embedding the C2PA Manifest Store into an asset, the location will vary based on the type of the asset. Here are some well-known types and the location to use:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">JPEG</dt>
<dd>
<p>Refer to <a href="#_embedding_manifests_into_jpeg">Section 11.3.1.1, &#8220;Embedding manifests into JPEG&#8221;</a> for more information.</p>
</dd>
<dt class="hdlist1">PNG</dt>
<dd>
<p>Refer to <a href="#_embedding_manifests_into_png">Section 11.3.1.2, &#8220;Embedding manifests into PNG&#8221;</a> for more information.</p>
</dd>
<dt class="hdlist1">SVG</dt>
<dd>
<p>Refer to <a href="#_embedding_manifests_into_svg">Section 11.3.1.3, &#8220;Embedding manifests into SVG&#8221;</a> for more information.</p>
</dd>
<dt class="hdlist1">PDF</dt>
<dd>
<p>Refer to <a href="#_embedding_manifests_into_pdfs">Section 11.3.1.4, &#8220;Embedding manifests into PDFs&#8221;</a> for more information.</p>
</dd>
<dt class="hdlist1">FLAC</dt>
<dd>
<p>Refer to <a href="#_embedding_manifests_into_id3">Section 11.3.1.5, &#8220;Embedding manifests into ID3&#8221;</a> for more information.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">EDITORS NOTE</div>
C2PA is asking for feedback from the audio community if embedding the C2PA Manifest Store in an ID3v2 container will work with FLAC or if we will need to use the native FLAC container.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1">MP3</dt>
<dd>
<p>Refer to <a href="#_embedding_manifests_into_id3">Section 11.3.1.5, &#8220;Embedding manifests into ID3&#8221;</a> for more information.</p>
</dd>
<dt class="hdlist1">BMFF-based formats</dt>
<dd>
<p>The box specified in <a href="#_embedding_manifests_into_bmff_based_assets">Section 11.3.2, &#8220;Embedding manifests into BMFF-based assets&#8221;</a>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A C2PA Manifest Store can be embedded in BMFF-based downloadable audio files using codecs such as the Advanced Audio Codec (AAC) or the Apple Lossless Audio Codec (ALAC).
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Additional locations for other file formats will be added in the future.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Non-BMFF-based audio formats which are being considered for addition to this specification include MP3, Ogg Vorbis and the native container version of the Free Lossless Audio Codec (Native FLAC).
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Many classic image formats such as GIF and BMP do not support the embedding of arbitrary data, so that the use of an <a href="#_external_manifests">external manifest</a> is required.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_embedding_manifests_into_jpeg"><a class="anchor" href="#_embedding_manifests_into_jpeg"></a>11.3.1.1. Embedding manifests into JPEG</h5>
<div class="paragraph">
<p>The C2PA Manifest Store shall be embedded as the data contained in an <strong>APP11</strong> Marker as defined in <a href="https://www.iso.org/standard/66071.html">JPEG XT, ISO/IEC 18477-3</a>.</p>
</div>
<div class="paragraph">
<p>Since a single marker segment in JPEG-1 cannot be larger than 64K bytes, it is likely that multiple <strong>APP11</strong> segments will be required, and they shall be constructed as per the JPEG-1 standard and <a href="https://www.iso.org/standard/73604.html">ISO 19566-5, D.2</a>. When writing multiple segments, they shall be written in sequential order, and they shall be contiguous (i.e., one segment immediately following the next).</p>
</div>
</div>
<div class="sect4">
<h5 id="_embedding_manifests_into_png"><a class="anchor" href="#_embedding_manifests_into_png"></a>11.3.1.2. Embedding manifests into PNG</h5>
<div class="paragraph">
<p>The C2PA Manifest Store shall be embedded using an ancillary, private, not safe to copy, chunk type of <code>'caBX'</code> (as per <a href="https://www.w3.org/TR/2003/REC-PNG-20031110/">PNG, 4.7.2</a>). It is recommended that the <code>'caBX'</code> chuck precede the <code>'IDAT'</code> chunks.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Although PNG supports it, it&#8217;s considered bad-form to have a data block after the <code>'IDAT'</code> and before the <code>'IEND'</code>. (The exception being animated PNG blocks)
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_embedding_manifests_into_svg"><a class="anchor" href="#_embedding_manifests_into_svg"></a>11.3.1.3. Embedding manifests into SVG</h5>
<div class="paragraph">
<p><a href="https://www.w3.org/TR/SVG11/">SVG</a> is an XML-based format that can exist either stand-alone or embedded into other text-based formats such as HTML. As such, it is necessary to Base64 encode the binary C2PA Manifest Store to perform the embedding. While this section describes how to do that, the use of an <a href="#_external_manifests">external manifest</a> is preferred.</p>
</div>
<div class="paragraph">
<p>The C2PA Manifest Store shall be embedded as the Base64-encoded value of a <code>c2pa:manifest</code> element in the <a href="https://www.w3.org/TR/SVG11/metadata.html#MetadataElement"><code>metadata</code> element</a> of the SVG.</p>
</div>
<div class="paragraph">
<p>An example might look like this (with the actual C2PA Manifest&#8217;s data left out)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" standalone="yes"?&gt;
&lt;svg width="4in" height="3in" version="1.1"
    xmlns = 'http://www.w3.org/2000/svg'&gt;
    &lt;metadata&gt;
        &lt;c2pa:manifest&gt;...Base64 data goes here...&lt;/c2pa:manifest&gt;
    &lt;/metadata&gt;
&lt;/svg&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_embedding_manifests_into_pdfs"><a class="anchor" href="#_embedding_manifests_into_pdfs"></a>11.3.1.4. Embedding manifests into PDFs</h5>
<div class="paragraph">
<p>The C2PA Manifest Store shall be embedded using an embedded file specification (ISO 32000, 7.11.3). The file specification dictionary shall have an <code>AFRelationship</code> key whose value is <code>C2PA_Manifest</code>. If the C2PA Manifest Store is embedded into an encrypted PDF, the embedded file stream shall use an <code>Identity</code> crypt filter.</p>
</div>
<div class="paragraph">
<p>The embedded file specification shall be the value (via indirect object) of the <code>AF</code> key in the document catalog dictionary. It shall also be referenced (via indirect object) either from the <code>EmbeddedFiles</code> NameTree (<code>/Catalog/Names/EmbeddedFiles</code>) or from a <code>FileAttachment</code> annotation. The annotation approach shall be used when adding a C2PA Manifest Store to a PDF that already has an existing PDF signature in order to avoid invalidating its <code>DocMDP</code> restrictions.</p>
</div>
<div class="paragraph">
<p>It is possible to add a PDF signature (certifying or approval) to a PDF following the inclusion of a C2PA Manifest Store, but only if the addition is known at the time of the creation of the active manifest. Since the PDF signature will change the contents of the PDF after the C2PA Manifest is signed, the size and location of value of its <code>Contents</code> key must be determined before C2PA signing and added to the list of exclusions in the <code>data.hash</code> assertion, so that the C2PA signature is not invalidated by the addition of the PDF signature.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Adding the PDF signature in addition to the C2PA&#8217;s claim signature improves compatibility with the existing PDF ecosystem.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_embedding_manifests_into_id3"><a class="anchor" href="#_embedding_manifests_into_id3"></a>11.3.1.5. Embedding manifests into ID3</h5>
<div class="paragraph">
<p>The C2PA Manifest Store shall be embedded into a ID3v2-compatible, compressed audio file (e.g., MP3 or FLAC) file as the Encapsulated object data of a General Encapsulated Object (GEOB) as defined in <a href="https://id3.org/id3v2.3.0#General_encapsulated_object" class="bare">https://id3.org/id3v2.3.0#General_encapsulated_object</a>. The GEOB&#8217;s <code>MIME type</code> field shall be present and shall use the value for the media type for JUMBF as described in <a href="#_external_manifests">Section 11.4, &#8220;External Manifests&#8221;</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_embedding_manifests_into_bmff_based_assets"><a class="anchor" href="#_embedding_manifests_into_bmff_based_assets"></a>11.3.2. Embedding manifests into BMFF-based assets</h4>
<div class="sect4">
<h5 id="_the_uuid_box_for_c2pa"><a class="anchor" href="#_the_uuid_box_for_c2pa"></a>11.3.2.1. The <code>'uuid'</code> Box for C2PA</h5>
<div class="paragraph">
<p>All BMFF-based C2PA assets, whether they are timed (e.g., videos with or without audio tracks), untimed (e.g., still photos) or mixed (e.g., live or animated photos) audiovisual media, shall use a <code>'uuid'</code> box that adheres to the following syntax and semantics defined below.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">EDITORS NOTE</div>
<div class="paragraph">
<p>The reason that a <code>'uuid'</code> box instead of a <code>'c2pa'</code> box is being used is that browsers based on Chromium will immediately fail playback when they encounter any unknown top-level boxes.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Some file formats that are BMFF-based and would be supported via this method include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>MPEG-4 code-points, either complete (<code>.mp4</code>) or fragmented (<code>.m4s</code>); downloadable audio files (<code>.m4a</code>)</p>
</li>
<li>
<p>HEIF (<code>.heif</code>, <code>.heic</code>)</p>
</li>
<li>
<p>AVIF (<code>.avif</code>)</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_definition"><a class="anchor" href="#_definition"></a>11.3.2.1.1. Definition</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">Box Type: `'uuid'`
Extended Box Type: 0xD8, 0xFE, 0xC3, 0xD6, 0x1B, 0x0E, 0x48, 0x3C, 0x92, 0x97, 0x58, 0x28, 0x87, 0x7E, 0xC4, 0x81
Container: File
Mandatory: No
Quantity: Zero or more</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Coalition for Content Provenance and Authenticity (<code>'uuid'</code> with aforementioned uuid) box embeds provenance into BMFF. One such box contains a C2PA Manifest Store, and there may be one or more auxiliary boxes containing additional information required for validation.</p>
</div>
</div>
<div class="sect5">
<h6 id="_syntax_2"><a class="anchor" href="#_syntax_2"></a>11.3.2.1.2. Syntax</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">aligned(8) class ContentProvenanceBox extends FullBox(`'uuid'`, extended_type = 0xD8 0xFE 0xC3 0xD6 0x1B 0x0E 0x48 0x3C 0x92 0x97 0x58 0x28 0x87 0x7E 0xC4 0x81, version = 0, 0) {
    string box_purpose;
    bit(8) data[];
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_semantics"><a class="anchor" href="#_semantics"></a>11.3.2.1.3. Semantics</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">box_purpose</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[indicates purpose of box]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[depends on box_purpose]</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The box_purpose and fields that depend on it are described below for each box purpose.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Regarding unique ids:</p>
</div>
<div class="paragraph">
<p>There are cases, such as fragmented MP4 (fMP4), where the id for a subset of the asset, such as the track_id field of the <code>'tkhd'</code> box, is only locally unique to a subset of the overall asset rather than globally unique to the asset.</p>
</div>
<div class="paragraph">
<p>Because a globally unique id is required to determine what to hash, a unique id is included.  This unique id does not equal any value from the original asset; each value is instead defined when the manifest is created.  The unique id is then combined with an associated local id to form an id that&#8217;s globally unique to the entire asset.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_box_containing_the_manifest"><a class="anchor" href="#_box_containing_the_manifest"></a>11.3.2.2. Box Containing the Manifest</h5>
<div class="paragraph">
<p>The box containing the C2PA Manifest Store shall appear before the first <code>'mdat'</code> box in the file and before any <code>'moov'</code> box in the file.  To accommodate major_brand and compatible_brand verification, it shall be placed after the <code>'ftyp'</code> box.</p>
</div>
<div class="paragraph">
<p>The fields in the corresponding box described above shall be set as follows.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">box_purpose</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For a C2PA Manifest Store, this value shall be <code>manifest</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When box_purpose is <code>manifest</code>, the first 8 bytes inside <code>'data'</code> shall be the absolute file byte offset to the first auxiliary <code>'uuid'</code> C2PA box with box_purpose equal to <code>merkle</code>.  If this file contains no such boxes, those 8 bytes shall be zero.  Those 8 bytes shall be followed by the raw C2PA Manifest Store bytes followed by zero or more unused padding bytes.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>'data'</code> field inside the <code>'uuid'</code> box of type <code>manifest</code> includes the absolute file byte offset, manifest, and padding bytes.  Padding bytes are NOT permitted OUTSIDE the <code>'uuid'</code> box unless they are contained in their own mp4 box such as a <code>'free'</code> box.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For fragmented MP4 (fMP4) files, an identical <code>'uuid'</code> C2PA box of type <code>manifest</code> shall be present in each initialization segment; the C2PA Manifest Store shall be identical.</p>
</div>
</div>
<div class="sect4">
<h5 id="_auxiliary_c2pa_boxes_for_large_and_fragmented_files"><a class="anchor" href="#_auxiliary_c2pa_boxes_for_large_and_fragmented_files"></a>11.3.2.3. Auxiliary <code>'c2pa'</code> Boxes for Large and Fragmented Files</h5>
<div class="paragraph">
<p>Some files have one or more very large <code>'mdat'</code> boxes (e.g., large video or image files which may be downloaded and rendered progressively) or large numbers of independent 'mdat' boxes (e.g., fMP4 where each fragment can be downloaded independently).</p>
</div>
<div class="paragraph">
<p>In these cases, it is unreasonable to require a client to completely download all <code>'mdat'</code> box(es) before validating any portion of the asset.  Avoiding that necessity is resolved by using multiple hashes.</p>
</div>
<div class="paragraph">
<p>For each large <code>'mdat'</code> box, subsets of the box have individual hashes that can be validated independently; how to determine these subsets is specified below. For fMP4 content where each <code>'mdat'</code> box can be downloaded independently, each fragment has its own individual hash.</p>
</div>
<div class="paragraph">
<p>In the simplest case, all of these hashes are stored in the active manifest. Each subset has an auxiliary <code>'uuid'</code> C2PA box that declares how to locate its hash in the active manifest; refer to the note regarding unique ids above for why this is the case.</p>
</div>
<div class="paragraph">
<p>However, for sufficiently large assets, including every subset&#8217;s hash in the manifest itself would increase the size of the C2PA Manifest Store to one or more megabytes.</p>
</div>
<div class="paragraph">
<p>Avoiding such a large C2PA Manifest Store for a large asset is achieved by using one or more Merkle trees.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For a large non-fragmented asset that contains one or more <code>'mdat'</code> boxes in a single large file, one Merkle tree is used for each <code>'mdat'</code> box.</p>
</li>
<li>
<p>For a large fragmented asset that contains a set of <code>'mdat'</code> boxes for a single track which may be spread across multiple files, one Merkle tree is used for each track.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In either case:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each leaf node of any given Merkle tree is the subset&#8217;s hash.</p>
</li>
<li>
<p>The manifest stores one row of each Merkle tree.</p>
</li>
<li>
<p>The auxiliary <code>'uuid'</code> C2PA box that exists for each subset indicates which Merkle tree row in the active manifest it requires and which leaf node it represents. It also includes any additional hash(es) from the Merkle tree necessary to derive a hash in the active manifest&#8217;s Merkle tree row.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The selection of which Merkle tree row to store in the manifest creates a size tradeoff within the asset.  Specifically, storing a single hash per Merkle tree in the manifest minimizes the size of the manifest but requires log2(subsets) to be stored in each subset-specific box.  Each time the number of hashes stored in the manifest for a Merkle tree is doubled (by moving "down" one Merkle tree row), the number of hashes stored in each subset-specific box decreases by one.  Thus, increasing the size of the manifest decreases the size of the entire asset and vice-versa, and since hashes for individual subsets are replicated across subsets as required to derive a manifest-specified hash, the tradeoff is not 1 to 1.</p>
</div>
<div class="paragraph">
<p>Making this size tradeoff is left up to the implementation creating the manifest; this spec neither mandates nor recommends that any specific Merkle tree row be stored in the manifest.  That said, because the simplest case of storing all subset hashes in the manifest is equivalent to using a Merkle tree where the leaf nodes are stored in the manifest, the same Merkle tree construction is used for multiple hashes in all cases.  That construction is defined as follows.</p>
</div>
<div class="paragraph">
<p>The portion of the manifest containing the BMFF Hash shall include the <code>merkle</code> field.  Refer to <a href="#_hashing_a_bmff_formatted_asset">Section 9.2.2, &#8220;Hashing a BMFF-formatted asset&#8221;</a> for more information.</p>
</div>
<div class="paragraph">
<p>For large <code>'mdat'</code> boxes that can be validated piecemeal, two or more auxiliary <code>'uuid'</code> C2PA boxes with box_purpose set to <code>'merkle'</code> as described below shall be included in the single asset file. They shall follow the last <code>'mdat'</code> box in the file.</p>
</div>
<div class="paragraph">
<p>For timed-media where an <code>'stco'</code> or <code>'co64'</code> box is present, the hash used for a given leaf node in the Merkle tree shall be computed over an individual subset of samples as defined by that box.</p>
</div>
<div class="paragraph">
<p>For untimed-media where an <code>'iloc'</code> box is present (such as HEIF or AVIF), the hash used for a given leaf node in the Merkle tree shall be computed over an individual item as defined by that box.</p>
</div>
<div class="paragraph">
<p>Regardless of the subset-defining mechanism, all such auxiliary <code>'uuid'</code> C2PA boxes shall occur in the same sequence as the subsets they hash as specified by the <code>'stco'</code>, <code>'co64'</code>, or <code>'iloc'</code> box regardless of their location in the <code>'mdat'</code>. They shall also be grouped such that a single Merkle tree&#8217;s auxiliary <code>'uuid'</code> C2PA boxes are sequential with no intervening boxes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">EDITORS NOTE</div>
<div class="paragraph">
<p>Are there other scenarios where an <code>'mdat'</code> can be large enough to be worth dividing where neither <code>'stco'</code>, <code>'co64'</code>, nor <code>'iloc'</code> is present?  If so, what box(es) should be used to decide on subset division points?</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For fMP4 assets which are split across multiple files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One auxiliary <code>'uuid'</code> C2PA box with box_purpose set to <code>'merkle'</code> as described below shall be included in each fragment file immediately preceding the <code>'moof'</code> box.</p>
</li>
<li>
<p>The hash used for a given leaf node in the Merkle tree shall be over all data in its containing single fragment file except data excluded by the exclusion list.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This specification does not enable support for fMP4 assets which are split across multiple files where individual fragment files contain more than one <code>'moof'</code> box and/or <code>'mdat'</code> box.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For fMP4 assets which are stored as a single flat MP4 file with a single <code>'moov'</code> for all tracks and then one <code>'moof'</code>/<code>'mdat'</code> pair for each fragment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One auxiliary <code>'uuid'</code> C2PA box with box_purpose set to <code>'merkle'</code> as described below shall be included immediately preceding each <code>'moof'</code> box.</p>
</li>
<li>
<p>The hash used for a given leaf node in the Merkle tree shall be over that <code>'moof'</code> box plus all data preceding the next <code>'moof'</code> box or over all data through the end of the file if there is no further <code>'moof'</code> box.  The hash shall not cover data excluded by the exclusion list.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Taking a c2pa-compliant fMP4 asset which is split across multiple files (i.e., has <code>'c2pa'</code> boxes of types <code>'manifest'</code> and <code>'merkle'</code>) and appending the individual files together will not produce a single file which is <code>'c2pa'</code> compliant (nor vice-versa).  This is because which boxes are included in each <code>'merkle'</code> hash will be different in the two cases.  If both forms are desirable, the second form shall consider the first form as an ingredient and the new manifest shall include both an 'Ingredient' assertion with relationship 'parentOf' and an 'Actions' assertion that includes an action of type 'c2pa.repackaged'.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Regardless of how the asset is structured, the fields in the corresponding box described above shall be set as follows.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">box_purpose</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For an auxiliary <code>'uuid'</code> C2PA box, this value shall be <code>merkle</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When box_purpose is <code>merkle</code>, this value shall contain raw CBOR bytes indicating how to validate a portion of the asset as defined as follows.  If there are multiple auxiliary <code>'uuid'</code> C2PA boxes with box_purpose <code>merkle</code> for a given Merkle tree in a single file, each shall be followed by sufficient padding bytes (zero or more) to make all auxiliary <code>'uuid'</code> C2PA boxes for that Merkle tree a fixed size.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When there are more than one of these boxes in a single file, i.e., the case where there are large <code>'mdat'</code>(s) being validated piecemeal, a fixed size is required in order to enable a progressively downloading client to only download the boxes it needs to begin validation rather than the entire Merkle tree.  Such a client can download enough of the first of these boxes based on the absolute file byte offset in the <code>active manifest</code> to determine if its uniqueId and localId match the 'mdat' it is trying to validate.  If they do, it can determine the absolute file byte offset to the box it needs to validate by multiplying the subset number by that size then download just that box.  Otherwise, it can determine the absolute file byte offset to the beginning of the next Merkle tree by multiplying that fixed size by the current Merkle tree&#8217;s total number of leaf nodes, and it can repeat this process until it locates the box it needs.  The total download size for this subset of boxes is very small relative to the size of a single subset.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="_schema_and_example"><a class="anchor" href="#_schema_and_example"></a>11.3.2.3.1. Schema and Example</h6>
<div class="paragraph">
<p>The <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a> for this type is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; The data structure used to store sufficient information to validate a single 'mdat' box or 
; a portion of an 'mdat' box when a Merkle tree is used",
bmff-merkle-map = {
  "uniqueId": int, ; A unique integer used to differentiate local ids
  "localId": int, ; A local id indicating which 'mdat' box this entry pertains to.  This may not be globally unique
  "location": int, ; Zero-based index into the leaf-most Merkle tree row corresponding to this 'mdat' box or portion of this 'mdat' box
  ? "hashes": [1* bstr], ; An ordered array representing the set of additional hashes required to reach a hash in the Merkle tree specified in the manifest from leaf-most (peer of this node) to root-most (child of node in manifest).  Note that this array may not be present, e.g. if the manifest itself contains the leaf-most row of the Merkle tree.  Null hashes are not included in this array.  The algorithm used shall be determined using the `alg` field from the corresponding entry in the `merkle` field array in the BMFF hash structure.
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "hashes": [
    b64'TWVub3JhaA=='
  ],
  "localId": 4402,
  "location": 2203,
  "uniqueId": 1339
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For files that use a <code>'tkhd'</code> box to indicate individual tracks, the localId in the preceding CBOR shall be set to the track_id field of the <code>'tkhd'</code> box pertaining to the <code>'mdat'</code> being hashed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">EDITORS NOTE</div>
<div class="paragraph">
<p>How do we handle the case where there are multiple <code>'mdat'</code> boxes for untimed media, e.g. a file that includes multiple image <code>'mdat'</code> boxes?
How do we handle the case where there are multiple <code>'mdat'</code> boxes of different types, e.g. a file that has both audio/video <code>'mdat'</code> boxes as well as an image <code>'mdat'</code> box (e.g. for a thumbnail)?
For scenarios such as these, a <code>'tkhd'</code> box alone cannot be used to reference the complete set of different <code>'mdat'</code> boxes when there are more than one; it may not be present at all.
What box value(s) should be used for localId instead?</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_dynamic_stream_generation"><a class="anchor" href="#_dynamic_stream_generation"></a>11.3.2.4. Dynamic stream generation</h5>
<div class="paragraph">
<p>Many adaptive bitrate streaming (ABR) implementations store a single version of an asset, e.g., as a flat MP4 or in another intermediate format, and generate individual asset streams using various codecs, bitrates, etc. at consumption time. As a result, such a server must either hash said streams and create a C2PA Manifest each time the content is consumed or, if generation is deterministic, create and cache the hashes and C2PA Manifests once and then embed them at consumption time.</p>
</div>
<div class="paragraph">
<p>This also means that such a server must have a signing identity of its own that will be trusted by validators or be able to sign the generated files on behalf of the content creator in a secure and trustworthy manner.</p>
</div>
</div>
<div class="sect4">
<h5 id="_exclusion_list_requirements"><a class="anchor" href="#_exclusion_list_requirements"></a>11.3.2.5. Exclusion List Requirements</h5>
<div class="paragraph">
<p>For all <code>c2pa.hash.bmff</code> (deprecated) and <code>c2pa.hash.bmff.v2</code> assertions, the following entries shall always appear on the exclusion list.  Other entries are allowed but not required.</p>
</div>
<div class="paragraph">
<p>The entire <code>'uuid'</code> C2PA box shall be excluded.  (The <code>'data'</code> field is ensuring that other <code>'uuid'</code> boxes are not excluded.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">xpath = "/uuid"
data = [ { offset = 8, data = "2P7D1hsOSDySl1goh37EgQ==" } ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The entire <code>'ftyp'</code> and <code>'mfra'</code> boxes shall be excluded.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">xpath = "/ftyp"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">xpath = "/mfra"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Previous versions of this specification included additional mandatory exclusions, but it was discovered that excluding them is insecure.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For all <code>c2pa.hash.bmff.v2</code> assertions where the bmff-hash-map includes both the <code>hash</code> field and <code>merkle</code> fields, the following entry shall appear on the exclusion list.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">xpath = "/mdat"
subset = { { 16, 0 } }</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As indicated in the CDDL Definition above, the <code>c2pa.hash.bmff</code> assertion excludes the entire <code>'mdat'</code> box in this case, but it was discovered that excluding it is insecure.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As indicated in the CDDL Definition above, a relative byte offset or relative byte offset plus length that exceeds the length of the box is allowed; bytes beyond the end of the box are never hashed.  For example, if the <code>mdat</code> box is only 12 bytes long, all of it is hashed and the aforementioned mandatory exclusion entry has no effect although it is still required.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_timed_media_streams_that_are_neither_audio_nor_video"><a class="anchor" href="#_timed_media_streams_that_are_neither_audio_nor_video"></a>11.3.2.6. Timed-media streams that are neither audio nor video</h5>
<div class="paragraph">
<p>Timed-media streams that are neither audio nor video, such as text streams for captions, that the claim generator wishes to make tamper evident shall be handled the same way as audio and video streams.</p>
</div>
</div>
<div class="sect4">
<h5 id="_external_references"><a class="anchor" href="#_external_references"></a>11.3.2.7. External references</h5>
<div class="paragraph">
<p>Externally referenced content declared inside BMFF boxes, such as in a <code>'dref'</code>, <code>'url'</code>, or <code>'urn'</code> box, that the claim generator wishes to make tamper evident shall <strong>not</strong> exclude the referencing box and shall include a separate <a href="#_cloud_data">cloud data assertion</a> for each external reference to be hashed.</p>
</div>
</div>
<div class="sect4">
<h5 id="_size_requirements"><a class="anchor" href="#_size_requirements"></a>11.3.2.8. Size requirements</h5>
<div class="paragraph">
<p>If a BMFF-based asset uses 32-bit sizes or offsets in any box(es), e.g. the <code>'stco'</code> box, and adding boxes to conform to this specification will push the file size over 4 gigabytes, it is the responsibility of the manifest creator to edit the file to use appropriate sizes and offsets, e.g. by replacing the <code>'stco'</code> box with a <code>'co64'</code> box, before creating the manifest.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_external_manifests"><a class="anchor" href="#_external_manifests"></a>11.4. External Manifests</h3>
<div class="paragraph">
<p>In some cases, it may not be possible (or practical) to embed a C2PA Manifest Store in an asset. In those cases, keeping the C2PA Manifests externally to the asset is an acceptable model for providing providence to assets. The manifest should be stored in a location, referred to as a manifest repository, that is easily locatable by a manifest consumer working with the asset, such as <a href="#_by_reference_or_uri">by reference or URI</a>. As the C2PA Manifest Store is a JUMBF box, it shall be served with the JUMBF Media Type, <code>application/x-c2pa-manifest-store</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Editors Note</div>
<div class="paragraph">
<p>The C2PA is in the process of formally registering the media type with IANA.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Some common reasons to use an external manifest are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It may not be technically possible, such as with a <code>.txt</code> file.</p>
</li>
<li>
<p>It may not be practical, such as when the size of the C2PA Manifest Store is larger than the asset&#8217;s digital content.</p>
</li>
<li>
<p>It may not be appropriate, such as when it would modify an asset that should not be modified.
NOTE: a good example of this is creating a manifest for a pre-existing asset.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_embedding_a_reference_to_the_active_manifest"><a class="anchor" href="#_embedding_a_reference_to_the_active_manifest"></a>11.5. Embedding a Reference to the Active Manifest</h3>
<div class="paragraph">
<p>If the asset has embedded XMP, it is recommended that the claim generator add a <a href="https://www.dublincore.org/specifications/dublin-core/dcmi-terms/#http://purl.org/dc/terms/provenance"><strong>dcterms:provenance</strong></a> key to the XMP, the value (a URI reference) being where to locate the Active Manifest. The URI shall either be a JUMBF URI for an embedded C2PA Manifest or a standard URI for any non-embedded scenarios, whether stored remotely or locally on the same storage system as the asset itself.</p>
</div>
<div class="paragraph">
<p>An example JUMBF URI would be stored as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dcterms:provenance&gt;self#jumbf=c2pa/urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4&lt;/dcterms:provenance&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_entity_diagram"><a class="anchor" href="#_entity_diagram"></a>12. Entity Diagram</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following diagram provides a look at how all of the pieces of the C2PA system integrate and relate to each other.</p>
</div>
<div class="imageblock text-center kroki">
<div class="content">
<img src="https://kroki.io/plantuml/svg/eNqVVE1v2zAMPdu_gugOAwY4vntDgDbYgB62Aktuww6KxThaZcmQlGVBsf8-Sv6QnLTpepNJvsenR8p5JrFBxfMs-wC3UoJByZzQyu5FZ4EZBCtUc5DMwEFJtBa026M5CkuZDmuxE9ijvyMHKRRa4ugMWlQOsN0i58jLWivHhLKh8k4e8KKUvh-JweAODaoa-9IN_nEgFJSlcEyK2pYltMgUyei8TCYBJbZEQPV0j-E2efYe9oIjkFaSqd0UYOpEqjp3ohRdzC4WizwLmVqYWuLw0Ze0Xr-xgc66E0ls_PHbw-ZzBdRTUI0glxSQNmZhpw3UklnSYh-F6phhLTxsf2HtvpABa6JA2GrJ0_zKA87Svgv7rQWHzugtXdDCUbg9dWokmVQbfaRuiP5ekclb6k4dgjZur3NvSJB4ay06eCJDV9SGgnTy186-omOcOTZ9MyV2aCn_dwY23upAUJYjpizTqpVB7o80j6c0ficUJ9fmwXvVULnwU_ec94p8a8PWjUKozSDlrI1kog2gSZaNGNpAVoeYR_XRgFiLRjF3MOi55mRTqpfCL-4T6TfmYB25vxEtrh1ru7m2UfFc3tpp33bkiLwhcabzZdGX1qXtYn6yoA_nWT_7T0Xxg_aaWv8sIE45JKtqoiqKgi-T_Dg9ii9hKB5WCN5t6RV_dPQ-K3-CavZ0n0OOm3Mdmk9bWFVzF8Fz3bT0gm-Srawg_lv-BzkqeysuWdoKWnYa4Sn6bLopPH0hL-PDegfPhn04y8VtjUVxT_IsipxNdfnc3lxOwauaJkFsgT7xxPZdL0ZwbZ4w0cTXmfoSF_Y1PSPP60ZcX7B_rrVH3w==" alt="C2PA Entity Diagram" width="612">
</div>
<div class="title">Figure 12. C2PA Entity Diagram</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cryptography"><a class="anchor" href="#_cryptography"></a>13. Cryptography</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_hashing"><a class="anchor" href="#_hashing"></a>13.1. Hashing</h3>
<div class="paragraph">
<p>All cryptographic hashes that are stored in a C2PA Manifest shall be generated using one of the hash algorithms as described in this section. This section defines both:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A list of hash algorithms that are allowed for generating hashes of new content as well as required for validating hashes of existing content (the allowed list), and</p>
</li>
<li>
<p>A list of hash algorithms that are required to be supported for validating hashes of existing content but are not allowed for generating hashes of new content (the deprecated list).</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This section does not govern algorithms used for soft bindings as described in <a href="#_soft_bindings">Section 9.3, &#8220;Soft Bindings&#8221;</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An algorithm must appear in no more than one list. An algorithm that is instantiated over multiple output lengths (such as the various lengths of SHA2) will each be considered different algorithms, and each instantiation must be listed separately. If an algorithm does not appear in either list, it is forbidden and must not be used or supported. Algorithms can be removed from the lists in order to implement forbidding an algorithm. For this reason, implementations must not support additional algorithms on an optional basis.</p>
</div>
<div class="paragraph">
<p>Implementers should consult this section in the current version of the specification when releasing software updates and ensure their supported algorithms conform to it.</p>
</div>
<div class="paragraph">
<p>These lists establish the allowed algorithms for creating hashes and a string algorithm identifier to be used as the algorithm identifier (usually called <code>alg</code>) in the corresponding field of C2PA data structures. The outputs of hash functions shall be stored as their binary values encoded into CBOR as byte strings (major type 2) with a declared length. Wherever a field contains the output of a hash function, an algorithm identifier string field shall be present within the same structure, or within an enclosing structure, to declare which algorithm was used. A hash algorithm identifier field should be present in exactly one of these places, but if more than one is present within the structure and its enclosing structures, the nearest identifier must be used. Nearest is defined first as an identifier that is a sibling field of the hash value, and then the immediately enclosing structure, up to the root structure.</p>
</div>
<div class="paragraph">
<p>The allowed list is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SHA2-256 ("sha256")</p>
</li>
<li>
<p>SHA2-384 ("sha384")</p>
</li>
<li>
<p>SHA2-512 ("sha512")</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The SHA-3 family of hash algorithms are not on the allowed list for consistency with the digital signature algorithm allowed list, because COSE has not yet established digital signature algorithms that use a SHA-3 algorithm as the hash algorithm. A future version of this specification will incorporate SHA-3 for hashing as well as COSE digital signature algorithms that use SHA-3 when they are available.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The deprecated list is empty.</p>
</div>
</div>
<div class="sect2">
<h3 id="_digital_signatures"><a class="anchor" href="#_digital_signatures"></a>13.2. Digital Signatures</h3>
<div class="paragraph">
<p>All digital signatures that are stored in a C2PA Manifest shall be generated using one of the digital signature algorithms and key types listed as described in this section. This section defines both:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A list of digital signature algorithms and key types that are allowed for generating signatures of new content as well as required for validating signatures of existing content (the allowed list), and</p>
</li>
<li>
<p>A list of digital signature algorithms and key types that are required to be supported for validating signatures of existing content but are not allowed for generating signatures of new context (the deprecated list).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These lists establish the allowed algorithms and key types by referencing an algorithm identifier from the relevant standards that define algorithms for COSE and their mappings to CBOR identifiers, including but not limited to <a href="https://tools.ietf.org/html/rfc8152">RFC 8152</a> and <a href="https://datatracker.ietf.org/doc/html/rfc8230/">RFC 8230</a>. These standards also specify the hash algorithm used in the signature scheme. Nothing in <a href="#_hashing">Section 13.1, &#8220;Hashing&#8221;</a> shall apply to this use of hash algorithms; if a digital signature algorithm is present in the digital signature algorithm and key type registry, the use of its specified hash algorithm in the signature scheme shall be allowed and followed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Parenthetical notes in the lists below are explainers provided only as an aid to the reader.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_signature_algorithms"><a class="anchor" href="#_signature_algorithms"></a>13.2.1. Signature Algorithms</h4>
<div class="paragraph">
<p>The allowed list is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ES256</code> (ECDSA with SHA-256)</p>
</li>
<li>
<p><code>ES384</code> (ECDSA with SHA-384)</p>
</li>
<li>
<p><code>ES512</code> (ECDSA with SHA-512)</p>
</li>
<li>
<p><code>PS256</code> (RSASSA-PSS using SHA-256 and MGF1 with SHA-256)</p>
</li>
<li>
<p><code>PS384</code> (RSASSA-PSS using SHA-384 and MGF1 with SHA-384)</p>
</li>
<li>
<p><code>PS512</code> (RSASSA-PSS using SHA-512 and MGF1 with SHA-512)</p>
</li>
<li>
<p><code>EdDSA</code> (Edwards-Curve DSA)</p>
<div class="ulist">
<ul>
<li>
<p>Ed25519 instance only. No other EdDSA instances are allowed.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The deprecated list is empty.</p>
</div>
<div class="paragraph">
<p>Implementations must check that keys provided for signing or verification operations are correct for the chosen algorithm, as required by <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-8.1">RFC 8152 section 8.1</a> for ECDSA, <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-8.2">RFC 8152 section 8.2</a> for EdDSA, and <a href="https://www.rfc-editor.org/rfc/rfc8230.html#section-2">RFC 8230 section 2</a> and <a href="https://www.rfc-editor.org/rfc/rfc8230.html#section-4">section 4</a> for RSASSA-PSS. These requirements are summarized here for convenience:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ECDSA requires elliptic curve keys on the P-256, P-384, or P-521 elliptic curves.</p>
<div class="ulist">
<ul>
<li>
<p>Although it is recommended to use P-256 keys with <code>ES256</code>, P-384 keys with <code>ES384</code>, and P-521 keys with <code>ES512</code>, it is not required. Implementations must accept keys on any of these curves for all ECDSA algorithm choices.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Ed25519 requires elliptic curve keys on the X25519 elliptic curve.</p>
</li>
<li>
<p>RSASSA-PSS requires RSA keys with a modulus length of at least 2048 bits.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Implementations must refuse to generate or verify signatures with keys that are not correct for the algorithm choice. Implementations may refuse RSA keys with modulus length greater than 16384 bits.</p>
</div>
</div>
<div class="sect3">
<h4 id="_use_of_cose"><a class="anchor" href="#_use_of_cose"></a>13.2.2. Use of COSE</h4>
<div class="paragraph">
<p>The signature for the CBOR-encoded claim is produced by CBOR Object Signing and Encryption (COSE) as described in <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-4.2">RFC 8152</a> sections <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-4.2">4.2</a> and <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-4.4">4.4</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Payloads can either be present inside a COSE signature, or transported separately ("detached content" as described in <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-4.1">RFC 8152 section 4.1</a>). In "detached content" mode, the signed data is stored externally to the <code>COSE_Sign1_Tagged</code> structure, and the <code>payload</code> field of the <code>COSE_Sign1_Tagged</code> structure is always <code>nil</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Regardless of whether the payload will be present in or detached from the <code>COSE_Sign1_Tagged</code> signature; the contents of the <code>payload</code> field of <code>Sig_structure</code> in memory, when constructed to compute or verify a digital signature, must be populated with that external data as described by the particular use of digital signature in this specification. The <code>payload</code> field of <code>Sig_structure</code> shall never be <code>nil</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For example, when computing or verifying a claim signature, the <code>payload</code> field of the <code>Sig_structure</code> will contain the contents of the Claim JUMBF box, as described in <a href="#_signing_a_claim">Section 10.3.2.4, &#8220;Signing a Claim&#8221;</a> and <a href="#_use_of_jumbf">Section 11.1, &#8220;Use of JUMBF&#8221;</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_computing_the_signature"><a class="anchor" href="#_computing_the_signature"></a>13.2.3. Computing the Signature</h4>
<div class="ulist">
<ul>
<li>
<p>The signature is computed or verified as described in <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-4.4">RFC 8152 section 4.4</a>. The following additional requirements apply to the construction of <code>Sig_structure</code>:</p>
<div class="ulist">
<ul>
<li>
<p>The value for the <code>context</code> element shall be <code>Signature1</code> except where a particular use of digital signatures in this specification specifies using <code>CounterSignature</code> instead. <code>Signature</code> shall not be used.</p>
</li>
<li>
<p>The value for the <code>payload</code> element will be specified by each use of digital signatures in this specification.</p>
</li>
<li>
<p>The <code>external_aad</code> element shall be a bstr of length zero. External authenticated data must not be used.</p>
</li>
<li>
<p>The <code>alg</code> header specifying the signature algorithm shall be present in the <code>body_protected</code> element. <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-3.1">RFC 8152 section 3.1</a></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>alg</code> header is a standard COSE header, and therefore is always included in the protected header map with the integer <code>1</code> as its label, as established in the <a href="https://www.iana.org/assignments/cose/cose.xhtml#header-parameters">IANA COSE Header Parameters Registry</a>. The literal string <code>alg</code> is never used as the label. The <code>sign_protected</code> element is always omitted when using <code>COSE_Sign1</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>All digital signatures in C2PA structures shall be a <code>COSE_Sign1_Tagged</code> structure as defined in <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-4.2">RFC 8152 section 4.2</a>. <code>COSE_Sign1_Tagged</code> contains a <code>COSE_Sign1</code> structure. The following additional requirements apply to the construction of <code>COSE_Sign1_Tagged</code>:</p>
<div class="ulist">
<ul>
<li>
<p>The same <code>alg</code> header in the <code>Sig_structure</code> above shall be present in the <code>protected</code> header bucket.</p>
</li>
<li>
<p>The value for the <code>payload</code> field and whether the payload is present in the signature or detached will be specified by each use of digital signatures in this specification. When the <code>payload</code> is specified as detached, its value here must be <code>nil</code>. Conversely, when the payload is present in the signature, the binary contents of the payload are stored in this field as a <code>bstr</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>COSE defines <code>nil</code> to be major type 7, value 22 in <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-1.3">section 1.3</a> and uses this value exclusively for detached content. A byte array (major type 2) of length zero cannot be used to indicate detached content.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_signature_validation"><a class="anchor" href="#_signature_validation"></a>13.2.4. Signature Validation</h4>
<div class="paragraph">
<p>When producing a signature, if the claim generator can also act as a validator, the claim generator should validate that the signing credential is acceptable according to <a href="#_trust_model">Chapter 14, <em>Trust Model</em></a> for the credential&#8217;s type, and produce a warning if it is not. The claim generator should still allow signing with that credential if so desired. This may be desirable if it is known the local claim generator&#8217;s validator has a different configuration than validators used by the expected audience of the asset.</p>
</div>
<div class="paragraph">
<p>When verifying a signature, an in-memory <code>Sig_structure</code> is generated. Its <code>body_protected</code> field is populated with the contents of the <code>protected</code> header bucket from the <code>COSE_Sign1_Tagged</code> structure (see <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-4.4" class="bare">https://datatracker.ietf.org/doc/html/rfc8152#section-4.4</a>). For the <code>payload</code> field, if the payload was specified as present in the signature, it is populated from the <code>payload</code> field of the <code>COSE_Sign1_Tagged</code> structure. If the payload was specified as detached, the <code>payload</code> field of the <code>COSE_Sign1_Tagged</code> structure will be <code>nil</code>. In this case, the contents of the <code>payload</code> field of <code>Sig_structure</code> shall be populated from the same external source that was used in the generation of the signature. These are defined in the places where the digital signature is used in this specification.</p>
</div>
</div>
<div class="sect3">
<h4 id="_inclusion_of_signer_icons"><a class="anchor" href="#_inclusion_of_signer_icons"></a>13.2.5. Inclusion of Signer Icons</h4>
<div class="paragraph">
<p>A C2PA Manifest Consumer may wish to display an icon or logo for the signer. To locate such a graphic, it shall look inside the embedded certificate for a logotype as defined in <a href="https://www.rfc-editor.org/rfc/rfc6170.html">RFC 6170</a>. If no logotype is present, the Manifest Consumer may use icons or logos from other sources in an implementation-dependent manner.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The IETF is working on an update for RFC 6170 referred to as <a href="https://www.ietf.org/archive/id/draft-ietf-lamps-rfc3709bis-04.txt">RFC 3709-bis-04</a>.  It is recommended that when this update is approved, that it be used instead.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_trust_model"><a class="anchor" href="#_trust_model"></a>14. Trust Model</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_5"><a class="anchor" href="#_overview_5"></a>14.1. Overview</h3>
<div class="imageblock text-center kroki">
<div class="content">
<img src="https://kroki.io/ditaa/svg/eNqtkstqw0AMRff-Cu0H_0BINy4Esm7oMjAdK8lQxwZpXDD446t5-ZFHF6F3Jev4SjMjqTJJwY1U-RTd4GLMyfFAPTsGtucWCVw3EZAoQcvcBxiSGUuRj-iSJKPpCcFd0JL_a19j66wbBNkQnobUgwV_6sbW2nU0Lk6yLddSsI9979H6jlLE7HZVOrMhDA11wz5hqkgWJ19IjFXChfqPh_XfR3hRx2DfvGrf_GFXb1lqGutPnkKYbLYnqJmRnO1aCQnnohKZC5rv6JYJg27rufvcZykF71KovyI95v6XIta_6hrha_CblJcS1t07IjSuGabFKp4_yeraaf9-AXaXuCc=" alt="TrustModel">
</div>
</div>
<div class="paragraph">
<p>The above model shows, in yellow, green and red, the three entities specified in the trust model, which is concerned with trust in a signer&#8217;s identity. In dashed lines, below, is the consumer (who is not specified in the trust model), who uses the identity of the signer, along with other trust signals, to decide whether the assertions made about an asset are true.</p>
</div>
</div>
<div class="sect2">
<h3 id="_identity_of_signers"><a class="anchor" href="#_identity_of_signers"></a>14.2. Identity of Signers</h3>
<div class="paragraph">
<p>Identity in the trust model is the means by which a cryptographic signing key is associated with an actor for the basis of making trust decisions based on any structure (including, but not limited to, claims and manifests) signed with that key. The identity of a signatory is not necessarily a human actor, and the identity presented may be a pseudonym, completely anonymous, or pertain to a service or trusted hardware device with its own identity, including an application running inside such a service or trusted hardware.</p>
</div>
<div class="paragraph">
<p>The credential should be listed in the COSE unprotected headers of the <code>COSE_Sign1_Tagged</code> structure used for digital signatures in all C2PA manifests. The credential may appear in the protected headers, though as all credential types are themselves signed objects and so carry their own integrity protection, this is not necessary. Regardless, exactly one instance of an identity credential must appear in the union of the protected and unprotected headers. <code>COSE_Sign1_Tagged</code> structures with no credentials, or two or more credentials, must be rejected. Repeating the same credential more than once, including separately in the protected and unprotected headers, is also an instance of two or more credentials and must be rejected.</p>
</div>
<div class="paragraph">
<p>Each credential type will define the following data to be provided to the validator:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>How the credential is stored in the header value,</p>
</li>
<li>
<p>How a trust chain is computed from the signer to an entry in the validator&#8217;s trust anchor store for C2PA signers,</p>
</li>
<li>
<p>The public key in the credential used to validate the signature, and</p>
</li>
<li>
<p>The time validity period of the credential.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The name of the header to indicate credential type, how the credential is stored in the header value, and how trust chains are constructed are specified for each credential type in <a href="#_credential_types">Section 14.4, &#8220;Credential Types&#8221;</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_signer_credential_trust"><a class="anchor" href="#_signer_credential_trust"></a>14.3. Signer Credential Trust</h3>
<div class="paragraph">
<p>As part of the validation of an asset, the signer&#8217;s credential is validated as being trusted to sign manifests. Credential types are defined in <a href="#_credential_types">Section 14.4, &#8220;Credential Types&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>A validator shall maintain the following lists:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A list of X.509 certificate trust anchors for C2PA signers,</p>
</li>
<li>
<p>A list of accepted Extended Key Usage (EKU) values for C2PA signers, and</p>
</li>
<li>
<p>A list of X.509 certificate trust anchors for Time Stamp Authorities.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this section, "user" refers to human actors that are using C2PA-compliant validators in consumption and authoring scenarios.</p>
</div>
<div class="paragraph">
<p>A validator should allow these trust anchor stores to be configured by the user, and should provide default options or offer lists maintained by external parties that the user may opt into to populate the validator&#8217;s trust anchor store for C2PA signers or Time Stamp Authorities.</p>
</div>
<div class="paragraph">
<p>A validator may also allow the user to create and maintain a private credential store of signing credentials for each credential type. This store is intended as an "address book" of credentials they have chosen to trust based on an out-of-band relationship. For example, a journalist may choose to add sources to their private credential store to facilitate accepting and validating media with C2PA provenance data attached, even though the sources themselves would have no reason to be on an externally-maintained trust list used broadly by the general public. Credentials in the private credential store may be self-issued, and may be anonymous or pseudonymous (that is, containing no identifying information about the signer, or information that only identifies by pseudonym). The private credential store shall only apply to validating signed C2PA manifests, and shall not apply to validating time-stamps. The private credential store shall only allow trust in signer certificates directly; entries in the private credential store cannot issue credentials and shall not be included as trust anchors during validation.</p>
</div>
<div class="paragraph">
<p>A validator must not be pre-configured with any entries in a private credential store.</p>
</div>
<div class="paragraph">
<p>A validator must only add entries to a private credential store in response to a user request to trust the credential. Similarly, a validator must only remove entries from a private credential store in response to a user request to stop trusting the credential.</p>
</div>
</div>
<div class="sect2">
<h3 id="_credential_types"><a class="anchor" href="#_credential_types"></a>14.4. Credential Types</h3>
<div class="paragraph">
<p>Each credential type defined in this section may be used to sign C2PA manifests.</p>
</div>
<div class="sect3">
<h4 id="_x_509_certificates"><a class="anchor" href="#_x_509_certificates"></a>14.4.1. X.509 Certificates</h4>
<div class="paragraph">
<p>X.509 Certificates are stored as defined by the draft specification <a href="https://datatracker.ietf.org/doc/draft-ietf-cose-x509/">CBOR Object Signing and Encryption (COSE): Header parameters for carrying and referencing X.509 certificates (draft-ietf-cose-x509)</a> section 2. This is a draft at the time of publication of this specification, but a temporary integer label of 33 has been assigned by the IANA in the <a href="https://www.iana.org/assignments/cose/cose.xhtml#header-parameters">IANA COSE Header Parameters Registry</a>. To prepare for the future standardization of this header:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Claim generators shall write only the string <code>x5chain</code> as the label when inserting this header into a COSE signature.</p>
</li>
<li>
<p>Validators shall accept either the string <code>x5chain</code> or the integer 33 as the label for this header. If both labels are present, validators shall use the header with the string <code>x5chain</code> as the label and ignore the header with the integer label 33.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It will only be possible for both headers to be present in the unlikely event the IANA temporary assignment lapses, and the value 33 is assigned to another header type. Preferring the string label prevents a validator from misinterpreting the contents of a header with the integer label 33, if this happens.</p>
</div>
<div class="paragraph">
<p>When <code>draft-ietf-cose-x509</code> is adopted as a standard and the IANA assignment is permanent, a future version of this specification will deprecate use of the string label and prefer the integer label for both claim generators and validators, in addition to adopting any changes to the standard. Validators will still have to support the string label to maintain compatibility with assets compliant with this version of this specification.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The definition of <code>x5chain</code> at time of this specification&#8217;s publication, taken from <a href="https://datatracker.ietf.org/doc/draft-ietf-cose-x509/08/">revision 08</a>, is copied below. The definition here shall be used in this specification.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>x5chain:  This header parameter contains an ordered array of X.509 certificates.  The certificates are to be ordered starting with the certificate containing the end-entity key followed by the certificate which signed it and so on.  There is no requirement for the entire chain to be present in the element if there is reason to believe that the relying party already has, or can locate the missing certificates.  This means that the relying party is still required to do path building, but that a candidate path is proposed in this header parameter.</p>
</div>
<div class="paragraph">
<p>The trust mechanism MUST process any certificates in this parameter as untrusted input.  The presence of a self-signed certificate in the parameter MUST NOT cause the update of the set of trust anchors without some out-of-band confirmation.  As the contents of this header parameter are untrusted input, the header parameter can be in either the protected or unprotected header bucket.</p>
</div>
<div class="paragraph">
<p>This header parameter allows for a single X.509 certificate or a chain of X.509 certificates to be carried in the message.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a single certificate is conveyed, it is placed in a CBOR byte string.</p>
</li>
<li>
<p>If multiple certificates are conveyed, a CBOR array of byte strings is used, with each certificate being in its own byte string.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>When creating the <code>x5chain</code> header as part of signing, the signer&#8217;s certificate and all intermediate certificate authorities shall be included in the header&#8217;s value. The trust anchor&#8217;s certificate (also called the root certificate) should not be included.</p>
</div>
<div class="paragraph">
<p>The <code>subjectPublicKeyInfo</code> element of the first or only certificate will be the public key used to validate the signature. The <code>validity</code> element of the <code>tbsCertificate</code> sequence provides the time validity period of the certificate.</p>
</div>
<div class="sect4">
<h5 id="_certificate_profile"><a class="anchor" href="#_certificate_profile"></a>14.4.1.1. Certificate Profile</h5>
<div class="paragraph">
<p>This section defines the requirements to validate that an X.509 certificate is acceptable as a signing credential as described in <a href="#_validate_the_signature">Section 15.4, &#8220;Validate the Signature&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>All certificates must fulfil the following requirements.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>algorithm</code> field of the <code>signatureAlgorithm</code> field shall be one of the following values:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ecdsa-with-SHA256</code></dt>
<dd>
<p><a href="https://datatracker.ietf.org/doc/html/rfc5758#section-3.2">RFC 5758 section 3.2</a></p>
</dd>
<dt class="hdlist1"><code>ecdsa-with-SHA384</code></dt>
<dd>
<p><a href="https://datatracker.ietf.org/doc/html/rfc5758#section-3.2">RFC 5758 section 3.2</a></p>
</dd>
<dt class="hdlist1"><code>ecdsa-with-SHA512</code></dt>
<dd>
<p><a href="https://datatracker.ietf.org/doc/html/rfc5758#section-3.2">RFC 5758 section 3.2</a></p>
</dd>
<dt class="hdlist1"><code>sha256WithRSAEncryption</code></dt>
<dd>
<p><a href="https://datatracker.ietf.org/doc/html/rfc8017#appendix-A.2.4">RFC 8017 appendix A.2.4</a></p>
</dd>
<dt class="hdlist1"><code>sha384WithRSAEncryption</code></dt>
<dd>
<p><a href="https://datatracker.ietf.org/doc/html/rfc8017#appendix-A.2.4">RFC 8017 appendix A.2.4</a></p>
</dd>
<dt class="hdlist1"><code>sha512WithRSAEncryption</code></dt>
<dd>
<p><a href="https://datatracker.ietf.org/doc/html/rfc8017#appendix-A.2.4">RFC 8017 appendix A.2.4</a></p>
</dd>
<dt class="hdlist1"><code>id-RSASSA-PSS</code></dt>
<dd>
<p><a href="https://datatracker.ietf.org/doc/html/rfc8017#appendix-A.2.3">RFC 8017 appendix A.2.3</a></p>
</dd>
<dt class="hdlist1"><code>id-Ed25519</code></dt>
<dd>
<p><a href="https://datatracker.ietf.org/doc/html/rfc8410#section-3">RFC 8410 section 3</a></p>
</dd>
</dl>
</div>
</li>
<li>
<p>If the <code>algorithm</code> field of the <code>signatureAlgorithm</code> field is <code>id-RSASSA-PSS</code>, the <code>parameters</code> field is of type <code>RSASSA-PSS-params</code>. Its fields shall have the following requirements: <a href="https://datatracker.ietf.org/doc/html/rfc8017#appendix-A.2.3">RFC 8017 section A.2.3</a></p>
<div class="ulist">
<ul>
<li>
<p>The <code>hashAlgorithm</code> field shall be present.</p>
</li>
<li>
<p>The <code>algorithm</code> field of the <code>hashAlgorithm</code> field shall be one of the following values: <a href="https://datatracker.ietf.org/doc/html/rfc8017#appendix-B.1">RFC 8017 appendix B.1</a></p>
<div class="ulist">
<ul>
<li>
<p><code>id-sha256</code></p>
</li>
<li>
<p><code>id-sha384</code></p>
</li>
<li>
<p><code>id-sha512</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>The <code>maskGenAlgorithm</code> field shall be present.</p>
</li>
<li>
<p>The <code>algorithm</code> field of the <code>parameters</code> field of the <code>maskGenAlgorithm</code> field shall be equal to the <code>algorithm</code> field of the <code>hashAlgorithm</code> field.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If the <code>algorithm</code> field of the <code>algorithm</code> field of the certificate&#8217;s <code>subjectPublicKeyInfo</code> is <code>id-ecPublicKey</code>, the <code>parameters</code> field shall be one of the following named curves: <a href="https://datatracker.ietf.org/doc/html/rfc5480#section-2.1.1.1">RFC 5480 section 2.1.1.1</a></p>
<div class="ulist">
<ul>
<li>
<p><code>prime256v1</code></p>
</li>
<li>
<p><code>secp384r1</code></p>
</li>
<li>
<p><code>secp521r1</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>If the <code>algorithm</code> field of the <code>algorithm</code> field of the certificate&#8217;s <code>subjectPublicKeyInfo</code> is <code>rsaEncryption</code> or <code>rsaPSS</code>, the <code>modulus</code> field of the <code>parameters</code> field shall have a length of at least 2048 bits.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All certificates except those in the private credential store for X.509 certificates must fulfill the following additional requirements to be acceptable.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Version must be v3. <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.1.2.1">RFC 5280 section 4.1.2.1</a></p>
</li>
<li>
<p>The <code>issuerUniqueID</code> and <code>subjectUniqueID</code> optional fields of the <code>TBSCertificate</code> sequence must not be present. <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.1.2.8">RFC 5280 section 4.1.2.8</a></p>
</li>
<li>
<p>The Basic Constraints extension must follow <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.9">RFC 5280 section 4.2.1.9</a>. In particular, it must be present with the <code>cA</code> boolean asserted if the certificate issues certificates, and not asserted if it does not.</p>
</li>
<li>
<p>The Authority Key Identifier extension must be present in any certificate that is not self-signed. <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.1">RFC 5280 section 4.2.1.1</a></p>
</li>
<li>
<p>The Subject Key Identifier extension must be present in any certificate that acts as a CA. It should be present in end entity certificates. <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.2">RFC 5280 section 4.2.1.2</a></p>
</li>
<li>
<p>The Key Usage extension must be present and should be marked as critical. Certificates used to sign C2PA manifests must assert the <code>digitalSignature</code> bit. The <code>keyCertSign</code> bit must only be asserted if the <code>cA</code> boolean is asserted in the Basic Constraints extension. <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.3">RFC 5280 section 4.2.1.3</a></p>
</li>
<li>
<p>The Extended Key Usage (EKU) extension must be present and non-empty in any certificate where the Basic Constraints extension is absent or the <code>cA</code> boolean is not asserted. These are commonly called "end entity" or "leaf" certificates. <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.12">RFC 5280 section 4.2.1.12</a></p>
<div class="ulist">
<ul>
<li>
<p>The <code>anyExtendedKeyUsage</code> EKU (2.5.29.37.0) must not be present.</p>
</li>
<li>
<p>If the configuration store contains a list of EKUs, a certificate that signs C2PA manifests must be valid for at least one of the listed purposes.</p>
</li>
<li>
<p>If the configuration store does not contain a list of EKUs, a certificate that signs C2PA manifests must be valid for the <code>id-kp-emailProtection</code> (1.3.6.1.5.5.7.3.4) purpose.</p>
<div class="ulist">
<ul>
<li>
<p>The <code>id-kp-emailProtection</code> purpose is not implicitly included by default if a list of EKUs has been configured. If desired, it must explicitly be added to the list in the configuration store.</p>
</li>
</ul>
</div>
</li>
<li>
<p>A certificate that signs time-stamping countersignatures must be valid for the <code>id-kp-timeStamping</code> (1.3.6.1.5.5.7.3.8) purpose.</p>
</li>
<li>
<p>A certificate that signs OCSP responses for certificates must be valid for the <code>id-kp-OCSPSigning</code> (1.3.6.1.5.5.7.3.9) purpose.</p>
</li>
<li>
<p>If a certificate is valid for either <code>id-kp-timeStamping</code> or <code>id-kp-OCSPSigning</code>, it must be valid for exactly one of those two purposes, and not valid for any other purpose.</p>
</li>
<li>
<p>A certificate should not be valid for any other purposes outside of the purposes listed above, but the presence of any EKUs not mentioned in this profile and not in the list of EKUs in the configuration store shall not cause the certificate to be rejected.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_certificate_trust_chain"><a class="anchor" href="#_certificate_trust_chain"></a>14.4.1.1.1. Certificate Trust Chain</h6>
<div class="paragraph">
<p>When validating a certificate as the signing credential, if the certificate is present in the private credential store for X.509 certificates, the certificate is accepted. The private credential store is not consulted when validating time-stamps.</p>
</div>
<div class="paragraph">
<p>If the certificate is not present in the private credential store, or the validator does not implement one, the trust chain shall be built and validated according to the procedure in <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-6">RFC 5280 section 6</a> for the particular purpose required (signing, time-stamping, or OCSP signing) and for the appropriate trust anchor store for that purpose. Any failure of that validation algorithm shall mean the chain must be rejected. The private credential store is never included when building certificate chains; certificates in the private credential store cannot act as CAs.</p>
</div>
<div class="paragraph">
<p>Only end entity certificates shall be used to sign C2PA manifests or time-stamps. A CA certificate must not be used for these purposes. Any CA certificate (where the <code>cA</code> boolean in the Basic Constraints extension is asserted) being used to validate a signature on a C2PA manifest, time-stamp, or OCSP response must be rejected.</p>
</div>
<div class="paragraph">
<p>A validator must ensure a signing certificate is authorized for the purpose for which it is being used, and reject certificates used for an unauthorized purpose. A certificate is authorized for a particular purpose if the purpose&#8217;s EKU Object Identifier (OID) is present in the Extended Key Usage extension of the certificate (<a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.12">RFC 5280 section 4.2.1.12</a>). When validating a certificate chain used to sign a C2PA manifest, the signing certificate must have one of the accepted EKUs for C2PA signers if configured, or the <code>id-kp-emailProtection</code> (1.3.6.1.5.5.7.3.4) EKU if such a list is not configured. When validating a certificate chain used to sign a time-stamp, the signing certificate must have the <code>id-kp-timeStamping</code> (1.3.6.1.5.5.7.3.8) EKU. When validating a certificate chain used to sign an OCSP response, the signing certificate must have the <code>id-kp-OCSPSigning</code> (1.3.6.1.5.5.7.3.9) EKU.</p>
</div>
<div class="paragraph">
<p>Except for certificates accepted through the private credential store for X.509 certificates, a validator must verify a certificate&#8217;s compliance with the Certificate Profile, and reject certificates that do not comply. This includes requiring the presence of the Extended Key Usage extension, as well as a certificate being authorized for no more than one of the three purposes listed in this section: C2PA signing, time-stamp signing, or OCSP response signing.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As described in the Certificate Profile, Certification Authority (CA) certificates which issue certificates are not required to have an EKU extension, and usually will not. If one is present, it is ignored. This requirement only applies to end entity certificates signing C2PA manifests, time-stamps, or OCSP responses. CA certificates cannot be used for signing C2PA manifests, time-stamps, or OCSP responses.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_certificate_revocation"><a class="anchor" href="#_certificate_revocation"></a>14.4.1.2. Certificate Revocation</h5>
<div class="paragraph">
<p>X.509 certificates support revocation status queries. C2PA uses the Online Certificate Status Protocol (OCSP) and OCSP stapling to implement revocation. C2PA does not use Certificate Revocation Lists (CRLs).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Using CRLs requires downloading the entire list of revoked certificates for each Certificate Authority encountered, which can be time-consuming. Although a CRL could be included in the same way an OCSP response is stapled, the potential size of a CRL relative to an OCSP response also makes this undesirable.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A conforming CA should include an AuthorityInfoAccess (AIA) extension (<a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.2.1">RFC 5280 section 4.2.2.1</a>) to provide access information for an Online Certificate Status Protocol (OCSP) service operated by the CA.</p>
</div>
<div class="paragraph">
<p>If the certificate has an AIA extension, revocation information shall be stored in an unprotected header of the <code>COSE_Sign1</code> structure with the string label <code>rVals</code> and the value shall follow the following CDDL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; CBOR version of rVals and related structures based on JSON schema in https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf section 5.3.5.2
rVals = {
  "ocspVals": [1* bstr] 
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The above definition is a CBOR adaptation of a subset of the schema from <a href="https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf">JAdES section 5.3.5.2</a>, which only stores OCSP responses, and stores them as binary strings.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Before signing a claim, if a signer&#8217;s certificate has the AIA extension, a signer should query the OCSP service indicated therein, capture the response, and store it in an element of the <code>ocspVals</code> array of the <code>rVals</code> header.</p>
</div>
<h6 id="_validating_the_certificate_revocation_information" class="discrete">Validating the Certificate Revocation Information</h6>
<div class="paragraph">
<p>A validator must follow the requirements of <a href="https://datatracker.ietf.org/doc/html/rfc6960">RFC 6960</a>, in particular <a href="https://datatracker.ietf.org/doc/html/rfc6960#section-3">section 3</a>, when constructing an OCSP query and accepting an OCSP response. If the response is not accepted, or contains a <code>certStatus</code> of <code>unknown</code>, nothing can be concluded about the certificate&#8217;s revocation status, and therefore:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the unusable response is in an <code>rVals</code> header, the validator must proceed as if the header was absent.</p>
</li>
<li>
<p>If the unusable response is received in reply to an OCSP query at validation time, the validator must proceed as if it chose not to make the query.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An accepted OCSP response in the <code>rVals</code> header establishes that the signer&#8217;s certificate was not revoked at the time of signing if all of the following requirements are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The manifest has a valid time-stamp, and the attested time falls within the <code>(thisUpdate,nextUpdate)</code> interval of the response,</p>
</li>
<li>
<p>The <code>certStatus</code> field of the response is <code>good</code>, or <code>revoked</code> but with a <code>revocationReason</code> of <code>removeFromCRL</code>, and</p>
</li>
<li>
<p>The signer of the response is an "authorized responder" as defined by <a href="https://datatracker.ietf.org/doc/html/rfc6960#section-4.2.2.2">RFC 6960 section 4.2.2.2</a>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>removeFromCRL</code> is unique amongst the values of <code>revocationReason</code> because it is equivalent to a <code>good</code> response. Despite being a type of <code>revoked</code> response, this response indicates the certificate had temporarily been put "on hold" (the <code>certificateHold</code> reason) previously due to some concern about its integrity, but that the concern has been resolved and the issuer is stating the certificate remains trustworthy.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Validators must check the <code>revocationReason</code> of any <code>revoked</code> response to disambiguate the <code>removedFromCRL</code> case from an actual revocation.</p>
</div>
<div class="paragraph">
<p>If the <code>rVals</code> header is not present or does not contain an accepted OCSP response, or if the manifest does not have a time-stamp, but the certificate has an AIA extension, the validator may choose to query the OCSP responder, as described in <a href="#_validate_the_credential_revocation_information">Section 15.6, &#8220;Validate the Credential Revocation Information&#8221;</a>. If it does, and the response is accepted per the requirements of RFC 6960, it shall establish the signer&#8217;s certificate was not revoked at the time of signing if either of the following requirements is fulfilled:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The manifest has a valid time-stamp, and the attested time falls within the <code>(thisUpdate,nextUpdate)</code> interval of the response, or</p>
</li>
<li>
<p>The manifest does not have a valid time-stamp but the current time falls within the <code>(thisUpdate,nextUpdate)</code> interval of the response,</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And both of the following requirements are fulfilled:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>certStatus</code> field of the response is <code>good</code>, or <code>revoked</code> but with a <code>revocationReason</code> of <code>removeFromCRL</code>, and</p>
</li>
<li>
<p>The signer of the response is an "authorized responder" as defined by <a href="https://datatracker.ietf.org/doc/html/rfc6960#section-4.2.2.2">RFC 6960 section 4.2.2.2</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <code>certStatus</code> field of the response is <code>revoked</code> but with a <code>revocationReason</code> that is not <code>removeFromCRL</code>, it shall establish the signer&#8217;s certificate was not revoked at the time of signing if both of the following requirements are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The manifest has a valid time-stamp, and the attested time falls within the <code>(thisUpdate,nextUpdate)</code> interval of the response, and</p>
</li>
<li>
<p>The <code>revocationTime</code> in the response is after the attested time-stamp.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Otherwise, the certificate shall be considered revoked at the time of signing and the claim shall be rejected.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_identity_in_assertions"><a class="anchor" href="#_identity_in_assertions"></a>14.5. Identity In Assertions</h3>
<div class="paragraph">
<p>Some assertions (such as <code>stds.schema-org.CreativeWork</code>) allow a person&#8217;s identity to be associated in a defined way with the asset. This identity is purely scoped via the definition in each assertion and does not imply any larger involvement or responsibility for any assertion made in the claim, or the asset itself. All assertions, as stated below, are made by a signer.</p>
</div>
</div>
<div class="sect2">
<h3 id="_statements"><a class="anchor" href="#_statements"></a>14.6. Statements</h3>
<div class="paragraph">
<p>A validator is a manifest consumer that will produce some <a href="#_validation">validation</a> statements about that asset. The actor consuming the asset, usually through their user agent and its user interface, then has to interpret those statements to arrive at a set of conclusions of their own about the provenance of the asset they are consuming. These conclusions will be drawn from these statements, the set of trust relationships that consumer currently has with the actors in the asset, and the contents of the asset itself.</p>
</div>
<div class="paragraph">
<p>A validator can make the following true or false statements about the asset they are validating, and no more.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The active manifest has not been modified since the active manifest was signed</p>
</li>
<li>
<p>The portions of the asset that are covered by content bindings have not been modified since the active manifest was produced</p>
</li>
<li>
<p>The claim was produced by a claim generator (typically software), and signed by an actor identified in the subject field of the signing credential</p>
</li>
<li>
<p>The assertions of the active manifest are statements by the signer and their contents are not verified</p>
</li>
<li>
<p>The assertions of the active manifest have not been modified since the active manifest was produced</p>
</li>
<li>
<p>The assets referred to by ingredient assertions are not (necessarily) available at validation of the active manifest, and therefore their hashes cannot be validated</p>
</li>
<li>
<p>The ingredient assertion may contain a <code>validationStatus</code> field that indicates the active manifest signer&#8217;s assessment of the validation state of the ingredient at the time of adding the ingredient</p>
</li>
<li>
<p>The content of ingredient assertions, like all other assertions, is not independently validated</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_endorsement"><a class="anchor" href="#_endorsement"></a>14.7. Endorsement</h3>
<div class="paragraph">
<p>Endorsements are a way of indicating approval of three possible actions, <code>c2pa.published</code>, <code>c2pa.transcoded</code> and <code>c2pa.repackaged</code>, that could be applied to an asset in a C2PA manifest in which the asset is used as an ingredient.</p>
</div>
<div class="paragraph">
<p>For example, the signer of a C2PA Manifest may want to endorse another party who wishes to transcode its asset. The signer creates an endorsement that identifies the transcoder, and conveys the endorsement to them (in some method that is out-of-band from this specification). When the transcoder creates their asset containing the ingredient, they include the endorsement as a <code>c2pa.endorsement</code> assertion, which lets the manifest consumer know that the actions they performed have been endorsed.</p>
</div>
<div class="paragraph">
<p>Endorsements are made by signers, and describe the actor they are endorsing through the use of their signing credentials and a validity period. These endorsements are conveyed out-of-band from the endorser to the endorsee. When the endorsee is using an asset created by the endorser as an ingredient in their own asset, they shall include the endorsement in its C2PA Manifest.</p>
</div>
<div class="paragraph">
<p>Endorsements endorse the specific actions (described in <a href="#_validate_the_endorsements">Section 15.9, &#8220;Validate the Endorsements&#8221;</a>) that may be taken by the endorsee, and are therefore valid for asset manifests that use only the specified actions. Actions are only endorsed by the signer of that action&#8217;s referenced ingredient; they cannot be endorsed across more than multiple C2PA Manifests in the asset&#8217;s provenance.</p>
</div>
<div class="sect3">
<h4 id="_endorsement_generation"><a class="anchor" href="#_endorsement_generation"></a>14.7.1. Endorsement Generation</h4>
<div class="paragraph">
<p>Endorsements are COSE objects (see <a href="#_digital_signatures">Section 13.2, &#8220;Digital Signatures&#8221;</a>), where the COSE payload is an "endorsement target" data structure encoded as CBOR, as shown below. The <code>endorseeCredential</code> field is an object with a single field, labelled according to the type of credential used to sign the endorsement. The label of this field indicates to validators the type of the credential present, so that they know how to decode, parse and validate the credential correctly. The following table details the format of each of the currently specified credential types:</p>
</div>
<div class="sect4">
<h5 id="_endorsement_credential_types"><a class="anchor" href="#_endorsement_credential_types"></a>14.7.1.1. Endorsement Credential Types</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Credential name</th>
<th class="tableblock halign-left valign-top">CBOR label</th>
<th class="tableblock halign-left valign-top">Value type</th>
<th class="tableblock halign-left valign-top">Compares To</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">X.509 SubjectPublicKeyInfo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.1">DER-encoded ASN.1 SubjectPublicKeyInfo</a> structure (as a CBOR <code>bstr</code>), from the <em>endorsee&#8217;s</em> X.509 certificate that will be used for signing the claims of assets that this endorsement is expected to be used with.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value of the credential shall be compared (bitwise identical) to the SubjectPublicKeyInfo structure of the certificate located in the <code>x5chain</code> or <code>33</code> (integer) COSE header of the active manifest Claim Signature (see <a href="#x_509_certificates">[x_509_certificates]</a>)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Endorsers shall place the credential of the signer they are endorsing and its type in the <code>endorseeCredential</code>. To limit the length of time that an endorser is lending their endorsement to another signer, the <code>notValidBefore</code> and <code>notValidAfter</code> fields contain ISO 8601 date times.</p>
</div>
<div class="paragraph">
<p>The CDDL schema for the endorsement target type is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">endorsement-target-map = {
  "endorseeCredential" : public-credential,  ; A DER-encoded SubjectPublicKeyInfo containing the public key
  "notValidBefore": tdate, ; The date-time that this endorsement valid from, before this time it is not valid
  "notValidAfter": tdate ; The date-time that this endorsement expires and is no longer valid
}

public-credential = {
  $credential-type: any ; an extensible field allowing the specification of the credential payload
}

$credential-type /= 1 ; credentials with this type are a DER-encoded ASN.1 SubjectPublicKeyInfo structure, as a bstr (specification text for usage)</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example endorsement target is show below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "endorseeCredential": {
    1: 'A DER-encoded SubjectPublicKeyInfo containing the public key of the signer to be endorsed'
  },
  "notValidBefore": 0("2021-03-21T20:04:00Z"),
  "notValidAfter": 0("2022-03-21T20:04:00Z")
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To sign an endorsement, follow the procedure specified in <a href="#_digital_signatures">Section 13.2, &#8220;Digital Signatures&#8221;</a>, using the serialised CBOR <code>endorsement-target</code> object as the contents of the payload field. A signer shall not include a <code>x5chain</code> header and value, as endorsements are validated in the context of their use as an ingredient, and therefore use the signing credential of that ingredient manifest (see <a href="#_validate_the_endorsements">Endorsement Validation</a>). The serialized <code>COSE_Sign1_Tagged</code> structure resulting from the digital signature procedure is the endorsement that may be conveyed to the signer identified in the <code>endorsment-target</code>, but the process for conveying it is out of scope of this specification.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_endorsement_storage"><a class="anchor" href="#_endorsement_storage"></a>14.7.2. Endorsement Storage</h4>
<div class="paragraph">
<p>If the active manifest signer possesses an endorsement that it wishes to use to endorse an action performed by an actor, it can choose to embed the endorsement in the manifest it is generating. The procedure for the validation of such endorsements is covered in <a href="#_validate_the_endorsements">Section 15.9, &#8220;Validate the Endorsements&#8221;</a>. An endorsement is added as an <a href="#_endorsement_assertion">Section 18.13, &#8220;Endorsement Assertion&#8221;</a> in the active manifest&#8217;s assertion store.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_validation"><a class="anchor" href="#_validation"></a>15. Validation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The active manifest of an asset is valid only if all the steps in this section are successful. This validation must be completed before a validator presents a successful result to a human user or begins to render any content. Validating content as it is rendered to the user is described in <a href="#_validate_the_assets_content">Section 15.11, &#8220;Validate the Asset&#8217;s Content&#8221;</a>.</p>
</div>
<div class="sect2">
<h3 id="_status_codes"><a class="anchor" href="#_status_codes"></a>15.1. Status Codes</h3>
<div class="paragraph">
<p>The validation algorithm outputs status codes to indicate successful or failed portions of the validation process. They are also used by <a href="#_ingredient">ingredient assertions</a> to document the validation done on ingredients during the claim generation process.</p>
</div>
<div class="paragraph">
<p>The set of standard success and failure codes are defined below. Custom status codes are also permitted, when a claim generator has a need to record some process-specific status information.  The code shall conform to the same syntax as <a href="#_labels">custom labels</a>, e.g. <code>com.litware</code>. When using custom labels, because they are not inherently success or failure codes, a boolean success or failure result must be returned as well. This is either part of the output of the validation algorithm when performing validation, or the value of the <code>success</code> boolean in the <code>validationStatus</code> object inside an ingredient assertion.</p>
</div>
<div class="paragraph">
<p>The <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a> for status codes is included in the schema for the ingredient assertion at <a href="#ingredient_schema">Section 18.11.4, &#8220;Schema and Example&#8221;</a>.</p>
</div>
<div class="sect3">
<h4 id="_success_codes"><a class="anchor" href="#_success_codes"></a>15.1.1. Success codes</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 21.0526%;">
<col style="width: 52.6315%;">
<col style="width: 26.3159%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top"><code>url</code> Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claimSignature.validated</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The claim signature referenced in the ingredient&#8217;s claim validated.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>signingCredential.trusted</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The signing credential is listed on the validator&#8217;s trust list.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>timeStamp.trusted</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time-stamp credential is listed on the validator&#8217;s trust list.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.hashedURI.match</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hash of the the referenced assertion in the ingredient&#8217;s manifest matches the corresponding hash in the assertion&#8217;s hashed URI in the claim.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.dataHash.match</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hash of a byte range of the asset matches the hash declared in the data hash assertion.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.bmffHash.match</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hash of a box-based asset matches the hash declared in the BMFF hash assertion.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.accessible</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A non-embedded (remote) assertion was accessible at the time of validation.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_failure_codes"><a class="anchor" href="#_failure_codes"></a>15.1.2. Failure codes</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 21.0526%;">
<col style="width: 52.6315%;">
<col style="width: 26.3159%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top"><code>url</code> Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claim.missing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The referenced claim in the ingredient&#8217;s manifest cannot be found.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claim.multiple</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">More than one claim box is present in the manifest.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claim.hardBindings.missing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No hard bindings are present in the claim.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claim.required.missing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A required field is not present in the claim.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claim.cbor.invalid</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The cbor of the claim is not valid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ingredient.hashedURI.mismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hash of the the referenced ingredient claim in the manifest does not match the corresponding hash in the ingredient&#8217;s hashed URI in the claim.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claimSignature.missing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The claim signature referenced in the ingredient&#8217;s claim cannot be found in its manifest.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claimSignature.mismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The claim signature referenced in the ingredient&#8217;s claim failed to validate.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>manifest.multipleParents</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The manifest has more than one ingredient whose <code>relationship</code> is <code>parentOf</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>manifest.update.invalid</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The manifest is an update manifest, but it contains a disallowed assertion, such as a hard binding or actions assertions.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>manifest.update.wrongParents</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The manifest is an update manifest, but it contains either zero or multiple <code>parentOf</code> ingredients.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>signingCredential.untrusted</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The signing credential is not listed on the validator&#8217;s trust list.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>signingCredential.invalid</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The signing credential is not valid for signing.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>signingCredential.revoked</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The signing credential has been revoked by the issuer.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>signingCredential.expired</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The signing credential has expired.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>timeStamp.mismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time-stamp does not correspond to the contents of the claim.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>timeStamp.untrusted</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time-stamp credential is not listed on the validator&#8217;s trust list.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>timeStamp.outsideValidity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The signed time-stamp attribute in the signature falls outside the validity window of the signing certificate or the TSA&#8217;s certificate.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.hashedURI.mismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hash of the the referenced assertion in the manifest does not match the corresponding hash in the assertion&#8217;s hashed URI in the claim.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.missing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An assertion listed in the ingredient&#8217;s claim is missing from the ingredient&#8217;s manifest.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.multipleHardBindings</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The manifest has more than one hard binding assertion.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion Store Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.undeclared</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An assertion was found in the ingredient&#8217;s manifest that was not explicitly declared in the ingredient&#8217;s claim.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box or C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.inaccessible</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A non-embedded (remote) assertion was inaccessible at the time of validation.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.notRedacted</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An assertion was declared as redacted in the ingredient&#8217;s claim but is still present in the ingredient&#8217;s manifest.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.selfRedacted</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An assertion was declared as redacted by its own claim.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.required.missing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A required field is not present in an assertion.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.json.invalid</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The JSON(-LD) of an assertion is not valid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.cbor.invalid</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The cbor of an assertion is not valid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.action.ingredientMismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An action that requires an associated ingredient either does not have one or the one specified cannot be located</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.action.redacted</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An <code>action</code> assertion was redacted when the ingredient&#8217;s claim was created.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.dataHash.mismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hash of a byte range of the asset does not match the hash declared in the data hash assertion.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.bmffHash.mismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hash of a box-based asset does not match the hash declared in a BMFF hash assertion.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.cloud-data.hardBinding</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A hard binding assertion is in a cloud data assertion.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.cloud-data.actions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An update manifest contains a cloud data assertion referencing an actions assertion.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algorithm.unsupported</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value of an <code>alg</code> header, or other header that specifies an algorithm used to compute the value of another field, is unknown or unsupported.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box or C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>general.error</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A value to be used when there was an error not specifically listed here.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box or C2PA Assertion</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_locating_the_active_manifest"><a class="anchor" href="#_locating_the_active_manifest"></a>15.2. Locating the Active Manifest</h3>
<div class="paragraph">
<p>The last C2PA Manifest superbox in the C2PA Manifest Store superbox is the active manifest, but locating the C2PA Manifest Store may involve looking in a number possible locations.</p>
</div>
<div class="sect3">
<h4 id="_embedded"><a class="anchor" href="#_embedded"></a>15.2.1. Embedded</h4>
<div class="paragraph">
<p>The manifest consumer shall look inside the asset for an embedded C2PA Manifest Store in the <a href="#_embedding_manifests_into_assets">standard locations for embedding manifests</a> to see if one is present.</p>
</div>
<div class="paragraph">
<p>If there are multiple C2PA Manifest Stores present in an asset, they shall all be considered as invalid and the validation should treat this as if no manifests were located. In the case where this asset is being added as an ingredient, none of these embedded C2PA manifests shall be included in the ingredient assertion.</p>
</div>
</div>
<div class="sect3">
<h4 id="_by_reference_or_uri"><a class="anchor" href="#_by_reference_or_uri"></a>15.2.2. By Reference or URI</h4>
<div class="paragraph">
<p>If there is no embedded C2PA Manifest Store, the following attempts should be made to locate one at a remote location.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the asset was retrieved via an HTTP connection, the manifest consumer should look in the header of the HTTP response for a <code>Link</code> header, as defined in <a href="https://datatracker.ietf.org/doc/html/rfc8288">RFC 8288</a>, containing a parameter of <code>rel=c2pa-manifest</code>. If present, a C2PA Manifest Store can be retrieved from that URI reference.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>HTTP refers to the <em>Hypertext Transfer Protocol</em> defined in <a href="https://tools.ietf.org/html/rfc7230">RFC 7230</a>, not the specific URL scheme <code>http://</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>If the asset has XMP and the XMP contains a <code>dcterms:provenance</code> key, the provided URI should be used to locate the active manifest.</p>
</li>
<li>
<p>If no C2PA Manifest Store has been located, the manifest consumer should look for files at the same path or URI, but with a filename extension of <code>.c2pa</code>. If the C2PA Manifest Store is not found, a manifest consumer may look in whatever additional places it deems most appropriate to locate it.  For example, a child folder of a file system.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A manifest consumer is not restricted to only the above locations, it can choose to look in additional locations as well.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Information about the IANA media type for a C2PA Manifest Store can be found in the <a href="#_external_manifests">external manifests section</a>.</p>
</div>
<div class="sect4">
<h5 id="_validating_a_match"><a class="anchor" href="#_validating_a_match"></a>15.2.2.1. Validating a Match</h5>
<div class="paragraph">
<p>A manifest consumer may wish to validate that the located C2PA Manifest Store is indeed the one associated with asset.</p>
</div>
<div class="paragraph">
<p>If the C2PA Manifest Store was located then the hard binding assertion present in its active manifest shall be used to validate that it is the matching manifest and whether the asset has been modified without manifest updates. If the hard binding does not match, it is unknown if that is because of (a) modification of the asset or (b) the wrong C2PA Manifest Store was located. Accordingly, the manifest consumer shall treat this as a non-matching hard binding and reject the manifest with a failure code of <code>assertion.dataHash.mismatch</code> if a data hash assertion is used or <code>assertion.bmffHash.mismatch</code> if a BMFF hash assertion is used.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_locating_the_claim"><a class="anchor" href="#_locating_the_claim"></a>15.3. Locating the Claim</h3>
<div class="paragraph">
<p>Once an active manifest has been located, the claim is found by locating, within the active manifest, the JUMBF Superbox with a label of <code>c2pa.claim</code> and a UUID of <code>0x6332636C-0011-0010-8000-00AA00389B71</code> (<code>c2cl</code>).  There shall only be one such box in the active manifest, if more than one is located, the manifest shall be rejected with a failure code of <code>claim.multiple</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_validate_the_signature"><a class="anchor" href="#_validate_the_signature"></a>15.4. Validate the Signature</h3>
<div class="paragraph">
<p>Retrieve the URI reference for the signature from the value of the claim&#8217;s <code>signature</code> field and resolve the URI reference to obtain the COSE signature. The signature must be embedded in the same manifest as described in <a href="#_c2pa_box_details">Section 11.1.1, &#8220;C2PA Box details&#8221;</a>. If the signature URI does not refer to a location within the same C2PA Manifest box (a <code>self#jumbf</code> location), the claim must be rejected. If no such field is present or the URI cannot be resolved, then the claim must be rejected with a failure code of <code>claimSignature.missing</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The signature and the claim need to be in the same manifest to be valid.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Validate that the credential used in the signature is acceptable according to <a href="#_trust_model">Chapter 14, <em>Trust Model</em></a> for the credential&#8217;s type. If a chain of trust cannot be built from the credential to an entry in the trust anchor list, the claim must be rejected with a failure code of <code>signingCredential.untrusted</code>. If the credential is not acceptable per the requirements of the credential&#8217;s type, then the claim must be rejected with a failure code of <code>signingCredential.invalid</code>. If the signature algorithm is not on the allowed or deprecated list in <a href="#_digital_signatures">Section 13.2, &#8220;Digital Signatures&#8221;</a>, then the claim must be rejected with a failure code of <code>algorithm.unsupported</code>. After confirming the credential type and signing algorithm are acceptable, validation should proceed according to the specified procedure in <a href="#_digital_signatures">Section 13.2, &#8220;Digital Signatures&#8221;</a>. If validation of the signature fails, then the claim must be rejected with a failure code of <code>claimSignature.mismatch</code>.</p>
</div>
<div class="paragraph">
<p>For the remainder of this chapter, headers refer to the union of the set of protected and unprotected header parameters in the COSE signature. Unless otherwise specified in <a href="#_digital_signatures">Section 13.2, &#8220;Digital Signatures&#8221;</a> or <a href="#_credential_types">Section 14.4, &#8220;Credential Types&#8221;</a>, a header may appear in either bucket. <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-3">RFC8152 section 3</a> describes COSE headers.</p>
</div>
</div>
<div class="sect2">
<h3 id="_validate_the_time_stamp"><a class="anchor" href="#_validate_the_time_stamp"></a>15.5. Validate the Time-Stamp</h3>
<div class="paragraph">
<p>If the <code>sigTst</code> header is not present, the claim is valid if the current time is within the validity period of the signer&#8217;s credential. If it is not, the claim must be rejected with a failure code of <code>signingCredential.expired</code>.</p>
</div>
<div class="paragraph">
<p>If the <code>sigTst</code> header is present, the claim is valid if the <code>tstTokens</code> array contains at least one <code>tstToken</code> whose <code>val</code> property is an RFC3161-compliant <code>TimeStampResp</code> which satisfies the following requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The time-stamp contains a message imprint as described in <a href="#_time_stamps">Section 10.3.2.5, &#8220;Time-stamps&#8221;</a> that matches the claim being validated. The claim must be rejected with a failure code of <code>timeStamp.mismatch</code> if it does not match.</p>
</li>
<li>
<p>The time attested by the Time Stamp Authority (TSA) falls within the validity period of the signing credential. The claim must be rejected with a failure code of <code>signingCredential.expired</code> if it does not.</p>
</li>
<li>
<p>The attested time falls within the validity period of the TSA&#8217;s signing certificate, The claim must be rejected with a failure code of <code>timeStamp.outsideValidity</code> if it does not.</p>
</li>
<li>
<p>A trust chain can be built to an entry in the TSA trust store as described in <a href="#_signer_credential_trust">Section 14.3, &#8220;Signer Credential Trust&#8221;</a>. Locating the TSA&#8217;s certificate in the <code>TimeStampResp</code> is described in <a href="https://datatracker.ietf.org/doc/html/rfc3161#section-2.4.1">RFC 3161 section 2.4.1</a>. The claim must be rejected with a failure code of <code>timeStamp.untrusted</code> if a trust chain cannot be built.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
At this time, the revocation status of a Time Stamp Authority&#8217;s certificate is neither captured at signing time nor validated at validation time.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_validate_the_credential_revocation_information"><a class="anchor" href="#_validate_the_credential_revocation_information"></a>15.6. Validate the Credential Revocation Information</h3>
<div class="paragraph">
<p>If the signer&#8217;s credential type does not support revocation status, or the credential&#8217;s issuer did not provide a method to query its revocation status, the validator presumes the credential is not revoked.</p>
</div>
<div class="paragraph">
<p>If the signer&#8217;s credential type supports revocation, and the credential&#8217;s issuer provided a method to query its revocation status:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the <code>rVals</code> header is present, its contents shall be validated as described in <a href="#_credential_types">Section 14.4, &#8220;Credential Types&#8221;</a> for the signer credential type.</p>
</li>
<li>
<p>If the <code>rVals</code> header is not present, and the signer&#8217;s credential is considered valid by the requirements of <a href="#_validate_the_signature">Section 15.4, &#8220;Validate the Signature&#8221;</a> and <a href="#_trust_model">Chapter 14, <em>Trust Model</em></a>, a validator may choose to query the credential status method to determine if the credential is currently revoked.</p>
<div class="ulist">
<ul>
<li>
<p>If the validator does not query the credential status, the validator shall presume the credential is not revoked.</p>
</li>
<li>
<p>If the validator does query the credential status, it shall determine the status from the response as described in <a href="#_credential_types">Section 14.4, &#8220;Credential Types&#8221;</a> for the signer&#8217;s credential type.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Querying the credential status method can reveal to an observer the identity of the asset being validated, and so this query is optional.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When a signer&#8217;s credential is revoked, this does not invalidate manifests that were signed before the time of revocation. The inclusion of the <code>rVals</code> header combined with a time-stamp provides proof that the signer&#8217;s credential was valid at the time of signing. Signers are encouraged to include revocation information and time-stamps to avoid the necessity of a query at validation time.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In all cases, if the credential is deemed revoked at the time of signing, the claim shall be rejected with a failure code of <code>signingCredential.revoked</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_validate_the_assertions"><a class="anchor" href="#_validate_the_assertions"></a>15.7. Validate the Assertions</h3>
<div class="sect3">
<h4 id="_validate_the_correct_assertions_for_the_type_of_manifest"><a class="anchor" href="#_validate_the_correct_assertions_for_the_type_of_manifest"></a>15.7.1. Validate the correct assertions for the type of manifest</h4>
<div class="paragraph">
<p>Depending on the <a href="#_types_of_manifests">type of manifest</a>, there are assertions that are either required or forbidden. A validator shall check for required and not-permitted assertions.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If it is a <a href="#_standard_manifests">standard manifest</a></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Validate that there is at exactly one <a href="#_binding_to_content">hard binding to content</a> assertion - either a <code>c2pa.hash.data</code>, a <code>c2pa.hash.bmff</code> (deprecated), or a <code>c2pa.hash.bmff.v2</code> based on the type of asset for which the manifest is destined.  If no such assertion is present, the manifest must be rejected with a failure code of <code>claim.hardBindings.missing</code>.  If there is more than one such assertion, the manifest must be rejected with a failure code of <code>assertion.multipleHardBindings</code>.</p>
</li>
<li>
<p>Validate that there are zero or one <code>c2pa.ingredient</code> assertions whose <code>relationship</code> is <code>parentOf</code>.  If there is more than one, the manifest must be rejected with a failure code of <code>manifest.multipleParents</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>If it is an <a href="#_update_manifests">update manifest</a></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Validate that there are not any <code>c2pa.hash.data</code>, <code>c2pa.hash.bmff</code>, <code>c2pa.hash.bmff.v2</code>, <code>c2pa.actions</code> or <a href="#_thumbnails">Thumbnail</a> assertions.  If there are, the manifest must be rejected with a failure code of <code>manifest.update.invalid</code>.</p>
</li>
<li>
<p>Validate that there is exactly one <code>c2pa.ingredient</code> assertion and whose <code>relationship</code> is <code>parentOf</code>.  If there is not (i.e., either it is missing, there are more than one, or the value of <code>relationship</code> is not <code>parentOf</code>), the manifest must be rejected with a failure code of <code>manifest.update.wrongParents</code>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_preparing_the_list_of_redacted_assertions"><a class="anchor" href="#_preparing_the_list_of_redacted_assertions"></a>15.7.2. Preparing the list of redacted assertions</h4>
<div class="paragraph">
<p>For each manifest, there may be a set of its assertions that were redacted from it. The list of those assertions is not found in the manifest itself but instead in a manifest that references it as an ingredient. Therefore a validator, when processing a claim, shall gather the set of redacted assertion for each ingredient manifest based on each <code>hashed_uri</code> listed in the <code>redacted_assertions</code> field. A claim&#8217;s <code>redacted_assertions</code> field shall never include a <code>hashed_uri</code> to any of its own assertions.</p>
</div>
</div>
<div class="sect3">
<h4 id="_assertion_validation"><a class="anchor" href="#_assertion_validation"></a>15.7.3. Assertion Validation</h4>
<div class="paragraph">
<p>Each assertion in the <code>assertions</code> field of the claim is a <code>hashed_uri</code> structure. For each assertion, the validator must:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If the URI reference in the <code>url</code> field is in the <a href="#_preparing_the_list_of_redacted_assertions">list of redacted assertions</a>:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If the assertion&#8217;s label is <code>c2pa.actions</code>, the claim must be rejected with a failure code of <code>assertion.action.redacted</code> as <code>c2pa.actions</code> assertions shall not be redacted.</p>
</li>
<li>
<p>Otherwise, the redacted assertion is considered valid, and validation continues to the next assertion.</p>
</li>
</ol>
</div>
</li>
<li>
<p>For all other assertions:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Resolve the URI reference in the <code>url</code> field to obtain its data. If the URI does not refer to a location within the same C2PA Manifest Store (a <code>self#jumbf</code> location), the claim must be rejected. If the URI cannot be resolved and the data retrieved, the claim must be rejected with a failure code of <code>assertion.missing</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A claim can refer to an assertion in a different C2PA Manifest box than the one it is in, provided that they are both in the same C2PA Manifest Store.
</td>
</tr>
</table>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>If the assertion&#8217;s label is <code>c2pa.cloud-data</code>:</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>If the <code>label</code> field of the external assertion is <code>c2pa.hash.data</code>, <code>c2pa.hash.bmff</code>, or <code>c2pa.hash.bmff.v2</code>, the claim must be rejected with a failure code of <code>assertion.cloud-data.hardBinding</code>.</p>
</li>
<li>
<p>If the manifest is an update manifest and the <code>label</code> field of the external assertion is <code>c2pa.actions</code>, the claim must be rejected with a failure code of <code>assertion.cloud-data.actions</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Compute a hash of the data using the hash algorithm, determined by following the procedure described in <a href="#_hashing">Section 13.1, &#8220;Hashing&#8221;</a>:</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>If an <code>alg</code> field is present in the <code>hashed_uri</code> structure, that determines the hash algorithm.</p>
</li>
<li>
<p>If an <code>alg</code> field is not present in the <code>hashed_uri</code> structure, an <code>alg</code> field must be present in an enclosing structure, and the nearest instance present determines the hash algorithm.</p>
</li>
<li>
<p>If no <code>alg</code> field is found in any of these locations:</p>
<div class="olist upperroman">
<ol class="upperroman" type="I">
<li>
<p>If an <code>alg</code> field is present in the claim, that determines the hash algorithm.</p>
</li>
<li>
<p>If no <code>alg</code> field is present in the claim, the claim must be rejected with a failure code of <code>assertion.hashedURI.mismatch</code>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>If the assertion&#8217;s label is <code>c2pa.actions</code>:</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>For each action in the <code>actions</code> list:</p>
<div class="olist upperroman">
<ol class="upperroman" type="I">
<li>
<p>If the <code>action</code> field is <code>c2pa.opened</code>, <code>c2pa.placed</code>, <code>c2pa.removed</code>, <code>c2pa.repackaged</code>, or <code>c2pa.transcoded</code>:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Check the <code>ingredient</code> field that is a member of the <code>parameters</code> object for the presence of a JUMBF URI. If the JUMBF URI is not present, or cannot be resolved to the related ingredient assertion, the claim must be rejected with a failure code of <code>assertion.action.ingredientMismatch</code>.</p>
</li>
<li>
<p>Follow the JUMBF URI link in the <code>ingredient</code> field to the ingredient assertion. Check that the URI link resolves to an assertion in the active manifest. If it does not, the claim must be rejected with a failure code of <code>assertion.action.ingredientMismatch</code>.</p>
</li>
<li>
<p>For <code>c2pa.opened</code>, <code>c2pa.repackaged</code>, or <code>c2pa.transcoded</code>: Check that the value of the <code>relationship</code> field is <code>parentOf</code>. If it is not, the claim must be rejected with a failure code of <code>assertion.action.ingredientMismatch</code>.</p>
</li>
<li>
<p>For <code>c2pa.placed</code> or <code>c2pa.removed</code>: Check that the value of the <code>relationship</code> field is <code>componentOf</code>. If it is not, the claim must be rejected with a failure code of <code>assertion.action.ingredientMismatch</code>.</p>
</li>
<li>
<p>Check the <code>c2pa_manifest</code> field in the ingredient assertion for the presence of a hashed URI. If the hashed URI is not present, or cannot be resolved to a manifest, the claim must be rejected with a failure code of <code>assertion.action.ingredientMismatch</code>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Locate the value of the <code>alg</code> field in the allowed list or the deprecated list in <a href="#_hashing">Section 13.1, &#8220;Hashing&#8221;</a> to determine the hash algorithm. If it is not present in either list, the claim must be rejected with a failure code of <code>algorithm.unsupported</code>.</p>
</li>
<li>
<p>Compare the computed hash value with the value in the <code>hash</code> field. If they do not match, the claim must be rejected with a failure code of <code>assertion.hashedURI.mismatch</code>.</p>
</li>
<li>
<p>Otherwise, the assertion is valid and validation continues to the next assertion.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Then, for each element of the claim&#8217;s own <code>redacted_assertions</code> array, if any element of the claim&#8217;s <code>assertions</code> array has a <code>url</code> field equal to that value, the claim must be rejected with a failure code of <code>assertion.selfRedacted</code>. A claim cannot redact its own assertions, only those of its ingredients.</p>
</div>
<div class="sect4">
<h5 id="_validation_of_references"><a class="anchor" href="#_validation_of_references"></a>15.7.3.1. Validation of References</h5>
<div class="paragraph">
<p>Some assertions support referencing other information in the C2PA Manifest via the use of a <code>hashed_uri</code>, for example, references to items in the <a href="#_vcstore">W3C Credential Store</a> or ingredient thumbnails. In those cases, when validation is taking place, and the destination of the <code>hashed_uri</code> cannot be located (i.e., that data isn&#8217;t present where it is supposed to be) then it shall be treated as a validation failure.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As described in <a href="#_w3c_verifiable_credentials">Chapter 8, <em>W3C Verifiable Credentials</em></a>, any proofs present inside a W3C Verifiable Credential are not validated. Like all contents of an assertion, C2PA only guarantees the contents of the credential are integrity-protected.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_external_data_validation"><a class="anchor" href="#_external_data_validation"></a>15.7.4. External Data Validation</h4>
<div class="paragraph">
<p>The contents of a <a href="#_cloud_data">cloud data assertion</a>, which contains the URI references to and hashes of external data, are validated like any other assertion, but those references are not retrieved and validated as part of standard validation. A validator must first successfully validate a claim before attempting to retrieve external data listed in a cloud data assertion. A validator must not attempt to retrieve external data from a rejected claim. As the retrieval of external data is optional, the inability to retrieve or validate external data shall not cause a claim to become rejected.</p>
</div>
<div class="paragraph">
<p>If a validator chooses to retrieve any of the external data in a cloud data assertion, the validator must:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>First, determine the hash algorithm to be used.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If an <code>alg</code> field is present in the <code>hashed_ext_uri</code> structure, that determines the hash algorithm. If an <code>alg</code> field is not present, the validator must abort the attempt to retrieve the external data.</p>
</li>
<li>
<p>Locate the value of the <code>alg</code> field in the allowed list or the deprecated list in <a href="#_hashing">Section 13.1, &#8220;Hashing&#8221;</a> to determine the hash algorithm. If it is not present in either list, the validator must abort the attempt to retrieve the external data.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>alg</code> field is mandatory in <code>hashed_ext_uri</code>, so no recursive procedure to determine the hash algorithm is required.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Resolve the URI reference in the <code>url</code> field to obtain its data. If the URI cannot be resolved and the data retrieved, the validator must abort the attempt to retrieve the external data.</p>
</li>
<li>
<p>If the size of the retrieved data is not equal to the value of the <code>size</code> field, the validator must return a failure code of <code>assertion.hashedURI.mismatch</code> to the application and not provide the retrieved data.</p>
</li>
<li>
<p>If the content type of the retrieved data, as determined by the <code>Content-Type</code> header of the HTTP response, is not equal to the value of the <code>content_type</code> field, the validator must return a failure code of <code>assertion.hashedURI.mismatch</code> to the application and not provide the retrieved data.</p>
</li>
<li>
<p>Compute a hash of the data using the hash algorithm, determined by following the procedure described in <a href="#_hashing">Section 13.1, &#8220;Hashing&#8221;</a>:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Compare the computed hash value with the value in the <code>hash</code> field. If they do not match, the validator must return a failure code of <code>assertion.hashedURI.mismatch</code> to the application and not provide the retrieved data.</p>
</li>
<li>
<p>Otherwise, the retrieved data is successfully provided to the application.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_recursively_validating_integrity_of_ingredients"><a class="anchor" href="#_recursively_validating_integrity_of_ingredients"></a>15.8. Recursively Validating Integrity of Ingredients</h3>
<div class="paragraph">
<p>A validator must perform the above validation steps for the asset being presented and its manifest. If any of the above steps conclude the manifest is invalid, that manifest must be rejected with the indicated failure code.</p>
</div>
<div class="paragraph">
<p>An asset&#8217;s manifest may list one or more ingredients. For standard manifests, a validator may choose to optionally recurse through any ingredient manifests, however the <code>parentOf</code> ingredient of an update manifest shall be validated by the procedure below. There is no requirement that signers of ingredient manifests are trusted by the validator (except in the case of <a href="#_validate_the_endorsements">endorsement validation</a>), and building of trust chains of signers of ingredients shall not be attempted. Instead, as the ingredient is included by the signer of the active manifest, and if the signer of the active manifest is accepted per the rules above, ingredient manifests will share in that trust for the purposes of this recursive validation. Applications should not display data from ingredient manifests with failed integrity checks. If the application chooses to display such data, it must flag the display with a warning about the failed integrity check, and that the data cannot be reliably attributed to the ingredient manifest&#8217;s signer nor to the asset&#8217;s manifest&#8217;s signer.</p>
</div>
<div class="paragraph">
<p>When ingredients are being added to an asset as part of an authoring workflow, the ingredient may undergo full validation and the results expressed in a <a href="#_existing_manifests">validation status</a>. In this scenario, the ingredient&#8217;s manifest is considered the active manifest for validation purposes, before the ingredient is added to another asset&#8217;s ingredients.</p>
</div>
<div class="paragraph">
<p>For consumption scenarios, it is expected that problems with ingredient manifests from a standard manifest would be ignored during normal consumption use but may be surfaced as a warning if a user opts to explore the provenance history. However, the <code>parentOf</code> ingredient of an update manifest shall be surfaced.</p>
</div>
<div class="paragraph">
<p>In authoring scenarios, it may be desirable to more prominently raise warnings so that a creator making use of such an asset with a flawed provenance history can make an informed decision of how to proceed.</p>
</div>
<div class="paragraph">
<p>If the manifest is an update manifest, or if a validator chooses to validate the ingredients of a standard manifest, then for each ingredient, it must recursively:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the ingredient does not have a <code>c2pa_manifest</code> field</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If the manifest is a standard manifest, then the ingredient is accepted.</p>
</li>
<li>
<p>If the manifest is an update manifest, then the claim must be rejected with a failure code of <code>manifest.update.wrongParents</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>If the ingredient does have a <code>c2pa_manifest</code> field:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create an <a href="#_preparing_the_list_of_redacted_assertions">list of redacted assertions</a> which is the concatenation of the claim&#8217;s <code>redacted_assertions</code> array with any pre-existing redacted assertions list from previous recursive calls. This list is therefore only the redacted assertions from the active manifest&#8217;s claim and any ingredients along the path to the current ingredient.</p>
</li>
<li>
<p>Resolve the URI reference in the <code>url</code> field to obtain the ingredient claim&#8217;s manifest. If the URI reference cannot be resolved, the ingredient claim is rejected with a failure code of <code>claim.missing</code>.</p>
</li>
<li>
<p>Determine the hash algorithm identifier as determined by following the procedure described in <a href="#_hashing">Section 13.1, &#8220;Hashing&#8221;</a>:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If an <code>alg</code> field is present in the <code>hashed_uri</code> structure, that determines the hash algorithm.</p>
</li>
<li>
<p>If an <code>alg</code> field is not present in the <code>hashed_uri</code> structure, an <code>alg</code> field must be present in an enclosing structure, and the nearest instance present determines the hash algorithm.</p>
</li>
<li>
<p>If no <code>alg</code> field is found in any of these locations, the claim must be rejected with a failure code of <code>ingredient.hashedURI.mismatch</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Compute the hash of the ingredient manifest&#8217;s data using that algorithm.</p>
</li>
<li>
<p>Compare the computed hash with the value in the <code>hash</code> field. If the hashes are not equal, the claim must be rejected with a failure code of <code>ingredient.hashedURI.mismatch</code>.</p>
</li>
<li>
<p>If the ingredient contains a <code>validationStatus</code> field, each of the entries in the array shall be evaluated.  If the <code>code</code> field of any <code>validationStatus</code> equals a failure code or has a <code>success</code> field with a value of <code>false</code>, as defined at <a href="#_failure_codes">Section 15.1.2, &#8220;Failure codes&#8221;</a>, the ingredient&#8217;s claim is admitted. An admitted manifest is treated like an accepted manifest, but with an explicit indication that it may contain validation errors that are known to the signer. If admitted in this way, the validator must present each <code>validationStatus</code> present in the <code>validationStatus</code> field array as part of any exploration of the provenance history. Validators should perform full validation if exploration of the provenance history of the ingredient is requested to indicate where there are validation errors.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The presence of a <code>validationStatus</code> with a failure code or with a <code>success</code> field with a value of <code>false</code> is an explicit statement by the signer that they acknowledged and have chosen to override validation errors in the ingredient&#8217;s claim itself.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Otherwise, validate the ingredient claim and assertions as described beginning in <a href="#_validate_the_signature">Section 15.4, &#8220;Validate the Signature&#8221;</a>, except skip establishing signer credential trust, as this is not applicable to ingredients.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>When validating the assertions as described in <a href="#_validate_the_assertions">Section 15.7, &#8220;Validate the Assertions&#8221;</a>, provide a <a href="#_preparing_the_list_of_redacted_assertions">list of redacted assertions</a> as an input.</p>
</li>
<li>
<p>The validator may optionally recursively validate the ingredient&#8217;s ingredients. If it does and those are accepted, the ingredient&#8217;s claim is accepted. If any are rejected, the ingredient&#8217;s claim is rejected. If the validator chooses not to recurse further, the ingredient&#8217;s claim is accepted.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_validate_the_endorsements"><a class="anchor" href="#_validate_the_endorsements"></a>15.9. Validate the Endorsements</h3>
<div class="paragraph">
<p>Endorsement validation shall only be attempted if the active manifest first meets a number of conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An <code>actions</code> assertion is present in the assertion store</p>
</li>
<li>
<p>There is exactly one <code>ingredient</code> assertion</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Retrieve the endorsement assertion in the active manifest, as described in <a href="#_endorsement_assertion">Section 18.13, &#8220;Endorsement Assertion&#8221;</a>. In order to provide resilience in the case of a claim generator unexpectedly adding multiple endorsement assertions to an assertion store, a validator may iterate through the validation process below with each endorsement, stopping the iteration immediately if an endorsement validates successfully.</p>
</div>
<div class="paragraph">
<p>For each <code>action</code> object in the <a href="#_actions">actions</a> assertion:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Check that the <code>action</code> field is set to <code>c2pa.published</code>, <code>c2pa.transcoded</code> or <code>c2pa.repackaged</code>. If any other action is present, fail the endorsement process for this manifest and do not proceed with further validation.</p>
</li>
<li>
<p>Check the <code>ingredient</code> field that is a member of the <code>parameters</code> object for the presence of a JUMBF URI. If the JUMBF URI is not present, or cannot be resolved to the related ingredient assertion, skip endorsement for this action.</p>
</li>
<li>
<p>Follow the JUMBF URI link in the <code>ingredient</code> field to the ingredient assertion. Check that the URI link resolves to an assertion in the active manifest. If it does not, skip endorsement for this action. Check that the <code>relationship</code> field is <code>parentOf</code>. If it is not, skip endorsement for this action.</p>
</li>
<li>
<p>Check the <code>c2pa_manifest</code> field in the ingredient assertion for the presence of a hashed URI. If the hashed URI is not present, or cannot be resolved to a manifest, skip endorsement for this action.</p>
</li>
<li>
<p>Follow the JUMBF URI link in the <code>c2pa_manifest</code> field to the ingredient&#8217;s manifest. Ensure that this <em>ingredient</em> manifest has been validated according to <a href="#_recursively_validating_integrity_of_ingredients">Section 15.8, &#8220;Recursively Validating Integrity of Ingredients&#8221;</a>, but do not skip the establishing of signer credential trust. If it does not validate, skip endorsement for this action.</p>
</li>
<li>
<p>Validate the endorsement as described in <a href="#_validate_the_signature">Section 15.4, &#8220;Validate the Signature&#8221;</a>, using the credential of the ingredient manifest signer. If a signing credential is present in the endorsement&#8217;s signature&#8217;s headers, it shall not be used for validation. If validation fails, skip this action.</p>
</li>
<li>
<p>Validate the <code>endorsement-target</code> payload itself, following the steps below:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Compare the <code>endorseeCredential</code> to the credential of the active manifest signer, according to the table found in <a href="#_endorsement_credential_types">Section 14.7.1.1, &#8220;Endorsement Credential Types&#8221;</a>. If the comparison fails, skip this endorsement.</p>
</li>
<li>
<p>If the active manifest is timestamped, then the <em>time-stamp</em> must fall within the endorsement&#8217;s validity time range. If it does not, skip this endorsement.</p>
</li>
<li>
<p>If the active manifest is not timestamped, then the <em>time of validation</em> must fall within the endorsement&#8217;s validity time range. If it does not, skip this endorsement.</p>
</li>
<li>
<p>If validation fails, skip this endorsement. If validation succeeds, mark that action as <em>endorsed</em>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>When endorsement validation has completed, for each <code>actions</code> assertion in the active manifest where all actions are marked as <em>endorsed</em>, the <code>actions</code> assertion itself shall be marked as <em>endorsed</em> in the validation results returned by the validator.</p>
</div>
</div>
<div class="sect2">
<h3 id="_visual_look_of_validation"><a class="anchor" href="#_visual_look_of_validation"></a>15.10. Visual look of Validation</h3>
<div class="paragraph">
<p>Here is a visual representation of the process of validating a claim (and its assertions).</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/Claim_Validation.svg" alt="Validating a Claim" width="720" height="432">
</div>
<div class="title">Figure 13. Validating a Claim</div>
</div>
</div>
<div class="sect2">
<h3 id="_validate_the_assets_content"><a class="anchor" href="#_validate_the_assets_content"></a>15.11. Validate the Asset&#8217;s Content</h3>
<div class="paragraph">
<p>If the active manifest is an update manifest, its <a href="#_hard_bindings">Section 9.2, &#8220;Hard Bindings&#8221;</a> are inherited from the <code>parentOf</code> ingredient&#8217;s manifest. If that manifest is also an update manifest, the search for a standard manifest shall recurse though the chain of ingredients.  If no standard manifest is found, then the manifest shall be rejected with a failure code of <code>manifest.update.wrongParents</code>.</p>
</div>
<div class="sect3">
<h4 id="_validating_a_data_hash"><a class="anchor" href="#_validating_a_data_hash"></a>15.11.1. Validating a data hash</h4>
<div class="paragraph">
<p>Once a standard manifest (and its bindings) has been located, the exclusion range(s) shall be extracted from the <code>c2pa.hash.data</code> assertion.</p>
</div>
<div class="paragraph">
<p>If any update manifests were encountered then the <code>length</code> value of the exclusion range whose <code>start</code> value is the offset of the start of the entire C2PA manifest store shall be treated as the current length of the entire C2PA manifest store plus any file format specific extras.</p>
</div>
<div class="paragraph">
<p>The hash algorithm (<code>alg</code>) specified in that <code>c2pa.hash.data</code> shall be computed over the bytes of the asset, minus those specified in the exclusion range(s).</p>
</div>
<div class="paragraph">
<p>If the resultant hash does not match the value of the <code>hash</code> field in the <code>c2pa.hash.data</code>, then the manifest shall be rejected with a failure code of <code>assertion.dataHash.mismatch</code>.</p>
</div>
<div class="sect4">
<h5 id="_hashing_of_jpeg_1_files"><a class="anchor" href="#_hashing_of_jpeg_1_files"></a>15.11.1.1. Hashing of JPEG-1 files</h5>
<div class="paragraph">
<p>In JPEG-1 files, the file format extras described above would include any <code>APP11</code> markers and their respective segment length bytes for <code>APP11</code> segments.  Because the segment lengths are inside the exclusion range, a validator shall match the total length of the exclusion range with that of the total length of all <code>APP11</code> segments representing the C2PA Manifest to ensure that the length was not tampered with.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A JPEG-1 file can contain <code>APP11</code> segments for reasons other than C2PA (e.g., JPEG 360 or JPSec) and those are not included in these calculations.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_validating_a_bmff_hash"><a class="anchor" href="#_validating_a_bmff_hash"></a>15.11.2. Validating a BMFF-hash</h4>
<div class="paragraph">
<p>For any portions of an asset rendered for presentation to a user, including but not limited to audio, video, or text, the corresponding hard binding corresponding to the rendered content must be validated in accordance with <a href="#_hard_bindings">Section 9.2, &#8220;Hard Bindings&#8221;</a>. If at any time content fails to be validated, the validator must clearly signal to the user that some of the content does not match the claim, and if possible, should indicate what part of the content did not validate. If any content is absent for which content bindings exist, discovery of this absence is also a validation failure. The validator must continue to report validation has failed, even if later portions of the content validate correctly.</p>
</div>
<div class="paragraph">
<p>For content that is not wholly available before rendering begins, such as during adaptive bitrate streaming (ABR) and progressive download, absence of not-yet-available portions of content is not considered a validation failure. As the content becomes available, the validator must validate each portion of the content before it is rendered as previously described. In addition, the validator must validate that the sequence of said content is the same as when the manifest was produced. Unless the player has explicitly signalled the validator that a discontinuity is expected (e.g., when the consumer performs a manual seek operation via the UI), the validator must clearly signal to the user that an unexpected discontinuity has occurred whenever the sequence does not match.</p>
</div>
<div class="paragraph">
<p>For content that is intentionally not being rendered as the claim generator originally intended, such as during fast-forward, rewind, or playback at a different speed, the validator may not be able to validate the content. In this case, the validator must clearly signal to the user that the content cannot be validated during the corresponding operation.</p>
</div>
<div class="paragraph">
<p>The <code>assertion.bmffHash.mismatch</code> failure code is used for all failures described in this section.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_user_experience"><a class="anchor" href="#_user_experience"></a>16. User Experience</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_approach"><a class="anchor" href="#_approach"></a>16.1. Approach</h3>
<div class="paragraph">
<p>The C2PA intends to provide clear recommendations and guidance for implementers of provenance-enabled user experiences (UX). Developing these recommendations is an ongoing process that involves diverse stakeholders, with the results balancing uniformity and familiarity with utility and flexibility for users across contexts, platforms, and devices. These recommendations can be found in the <a href="../ux/UX_Recommendations.html" class="xref page">User experience guidance document</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_principles"><a class="anchor" href="#_principles"></a>16.2. Principles</h3>
<div class="paragraph">
<p>The UX recommendations aim to define best practices for presenting C2PA provenance to consumers. The recommendations strive to describe standard, readily recognizable experiences that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>provide asset creators a means to capture information and history about the content they are creating, and</p>
</li>
<li>
<p>provide asset consumers information and history about the content they are experiencing, thereby empowering them to understand where it came from and decide how much to trust it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>User interfaces designed for the consumption of C2PA provenance must be informed by the context of the asset. We have studied 4 primary user groups and a collection of contexts in which C2PA assets are encountered. These user groups have been defined in the <a href="https://c2pa.org/principles/">C2PA Guiding Principles</a> as Consumers, Creators, Publishers and Verifiers (or Investigators). To serve the needs of each of these groups across common contexts, exemplary user interfaces are presented for many common cases. These are recommendations, not mandates, and we expect best practices to evolve.</p>
</div>
</div>
<div class="sect2">
<h3 id="_disclosure_levels"><a class="anchor" href="#_disclosure_levels"></a>16.3. Disclosure Levels</h3>
<div class="paragraph">
<p>Because the complete set of C2PA data for a given asset can be overwhelming to a user, we describe 4 levels of progressive disclosure which guide the designs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Level 1: An indication that C2PA data is present and its cryptographic validation status.</p>
</li>
<li>
<p>Level 2: A summary of C2PA data available for a given asset. This level should provide enough information for the particular content, user, and context to allow the consumer to understand to a sufficient degree how the asset came to its current state.</p>
</li>
<li>
<p>Level 3: A detailed display of all relevant provenance data. Note that the relevance of certain items over others is contextual and determined by the UX implementer.</p>
</li>
<li>
<p>Level 4: For sophisticated, forensic investigatory usage, a tool capable of revealing all the granular detail of signatures and trust signals is recommended.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_public_review_feedback_and_evolution"><a class="anchor" href="#_public_review_feedback_and_evolution"></a>16.4. Public Review, Feedback and Evolution</h3>
<div class="paragraph">
<p>The team authoring the UX recommendations is cognizant of its limitations and potential biases, recognizing that feedback, review, user testing and ongoing evolution is a key requirement for success. The recommendations will therefore be an evolving document, informed by real world experiences deploying C2PA UX across a wide variety of applications and scenarios.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_information_security"><a class="anchor" href="#_information_security"></a>17. Information security</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_threats_and_security_considerations"><a class="anchor" href="#_threats_and_security_considerations"></a>17.1. Threats and Security Considerations</h3>
<div class="paragraph">
<p>This section provides a summary of information security considerations and processes for technology described in the C2PA core specification. More detailed content will be provided in future releases of C2PA material including the Guidance document.</p>
</div>
<div class="sect3">
<h4 id="_context"><a class="anchor" href="#_context"></a>17.1.1. Context</h4>
<div class="paragraph">
<p>Information security is a principal concern of C2PA. C2PA maintains a threat model and security considerations for the C2PA specification. This effort complements other security-related work within C2PA. Associated documentation is currently in development and can be found at <a href="#security:Security_Considerations.adoc" class="xref unresolved">Security Considerations</a>.</p>
</div>
<div class="paragraph">
<p>The C2PA is developing security considerations documentation that includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A summary of relevant security features of C2PA technology</p>
</li>
<li>
<p>Security considerations for practical use of C2PA technology</p>
</li>
<li>
<p>Threats to C2PA technology and respective treatment of those threats, including countermeasures</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_threat_modelling_process_overview"><a class="anchor" href="#_threat_modelling_process_overview"></a>17.1.2. Threat modelling process overview</h4>
<div class="paragraph">
<p>The C2PA builds security into our designs as they are being developed, but also expects that security design and threat modelling will continue as the system, ecosystem, and threat landscape evolve.</p>
</div>
<div class="paragraph">
<p>To this end, the C2PA uses a focused threat modelling process to support development of a strong security and privacy design. Outcomes of the effort directly support development of explicit threats and security considerations documentation, but also facilitate security thinking throughout the design process.</p>
</div>
<div class="paragraph">
<p>The threat modelling process combines synchronous (live) threat modelling sessions consisting of focused groups of subject matter experts (SMEs) with asynchronous development of content. The number of attendees in each synchronous session is kept small to promote efficient discussions, but all members of the C2PA have the opportunity to participate via either modality.</p>
</div>
<div class="paragraph">
<p>Like other security activities, we expect our threat modelling process to evolve with the C2PA ecosystem. Process documentation is considered a guide rather than a strict directive on how threat modelling works within the C2PA.</p>
</div>
<div class="sect4">
<h5 id="_references"><a class="anchor" href="#_references"></a>17.1.2.1. References</h5>
<div class="paragraph">
<p>A variety of references and experiences are used to inform threat modelling and related security activities for the C2PA. This section provides a subset of public documents for reference.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://datatracker.ietf.org/doc/html/rfc3552#page-26">IETF on security considerations</a></p>
</li>
<li>
<p><a href="https://datatracker.ietf.org/doc/html/rfc6973#section-7">IETF on privacy considerations (guidelines)</a></p>
</li>
<li>
<p><a href="https://www.w3.org/TR/security-privacy-questionnaire/">W3C security and privacy self-review questionnaire</a></p>
</li>
<li>
<p><a href="https://datatracker.ietf.org/doc/html/rfc6819">OAuth2 threat model (example)</a></p>
</li>
<li>
<p><a href="https://shostack.org/books/threat-modelling-book">Threat modelling: Designing for Security</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-community/Threat_modelling">OWASP Threat modelling</a></p>
</li>
<li>
<p><a href="https://www.microsoft.com/en-us/securityengineering/sdl/threatmodelling">Microsoft Threat modelling</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_harms_misuse_and_abuse"><a class="anchor" href="#_harms_misuse_and_abuse"></a>17.2. Harms, Misuse, and Abuse</h3>
<div class="sect3">
<h4 id="_introduction_2"><a class="anchor" href="#_introduction_2"></a>17.2.1. Introduction</h4>
<div class="paragraph">
<p>The C2PA <a href="https://c2pa.org/principles/">Guiding Principles</a> establish that C2PA specifications must be reviewed with a critical eye towards the potential abuse or misuse of the framework to cause unintended harms, threats to human rights, or disproportionate risks to vulnerable groups globally.</p>
</div>
<div class="paragraph">
<p>To ensure that the C2PA is meeting this aspect of its principles, the harms, misuse, and abuse assessment aims to identify and address potential concerns during the specifications development and as encountered in subsequent implementations.</p>
</div>
<div class="paragraph">
<p>In addition, the specifications are being reviewed to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Anticipate and mitigate potential abuse and misuse;</p>
</li>
<li>
<p>Address common privacy concerns of its users; and</p>
</li>
<li>
<p>Consider the needs of users and stakeholders throughout the world.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_considerations"><a class="anchor" href="#_considerations"></a>17.2.2. Considerations</h4>
<div class="paragraph">
<p>The harms, misuse, and abuse assessment is an ongoing process. The information presented in the <a href="#security:Harms_Modelling.adoc" class="xref unresolved">Harms Modelling documentation</a> should not be considered the end result of a comprehensive evaluation, but as a basis for ongoing discussions centered on impacted communities, and aimed at mitigating potential abuse and misuse and protecting human rights.</p>
</div>
<div class="paragraph">
<p>There are two critical aspects of the approach:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ongoing</dt>
<dd>
<p>The harms, misuse, and abuse assessment necessarily accompanies the design and development, as well as implementation and use-stages of the C2PA by continuously informing the specifications development process, the implementation and user-experience guides, sensitization efforts, the governance of the Coalition and potentially multilateral cooperation for the promotion of a diverse C2PA ecosystem that serves a broad range of global contexts.</p>
</dd>
<dt class="hdlist1">Multi-disciplinary and diverse</dt>
<dd>
<p>The harms, misuse, and abuse assessment should be a collaborative effort that includes multi-disciplinary experts and a broad range of stakeholders with lived, practical and technical experience of the issues from diverse geographical locations, cultural backgrounds and individual identities.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_assessment"><a class="anchor" href="#_assessment"></a>17.2.3. Assessment</h4>
<div class="paragraph">
<p>Harms modelling focuses on analysing how a socio-technical system might negatively impact users, other stakeholders or broader society, or otherwise create or reenforce structures  of injustice, threats to human rights, or disproportionate risks to vulnerable groups globally. The process of harms modelling systematically requires combining knowledge about a system architecture and its user affordances with historical and contextual evidence about the impact of similar existing systems on different social groups and participatory consultation with a range of communities who may be implicated by the system. This combined information frames the ability to anticipate harm and proactively identify responses.</p>
</div>
<div class="paragraph">
<p>The <a href="#security:Harms_Modelling.adoc" class="xref unresolved">Harms Modelling documentation</a> describes the framework and the process carried out to date, followed by the methodology, an overview of the assessment, an outline for public review and feedback, and due diligence actions being developed to accompany version 1.0 of these specifications, its implementations and evolution.</p>
</div>
</div>
<div class="sect3">
<h4 id="_due_diligence_actions"><a class="anchor" href="#_due_diligence_actions"></a>17.2.4. Due Diligence Actions</h4>
<div class="paragraph">
<p>The harms, misuse and abuse assessment has informed, and should continue to inform, the development of the C2PA technical specifications as well as its accompanying documentation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#guidance:Guidance.adoc" class="xref unresolved">Guidance for implementers</a></p>
</li>
<li>
<p><a href="../ux/UX_Recommendations.html" class="xref page">User experience guidance</a></p>
</li>
<li>
<p><a href="#security:Security_Considerations.adoc" class="xref unresolved">Security Considerations</a></p>
</li>
<li>
<p>Explainer</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, the harms, misuse and abuse assessment should inform the governance of the Coalition and guide potential multilateral cooperation for the promotion of a diverse C2PA ecosystem that pushes for the optimization of the benefits in terms of trust in media, user control and transparency that prompted the development of the C2PA specifications.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_c2pa_standard_assertions"><a class="anchor" href="#_c2pa_standard_assertions"></a>18. C2PA Standard Assertions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction_3"><a class="anchor" href="#_introduction_3"></a>18.1. Introduction</h3>
<div class="paragraph">
<p>This section of the document lists the standard set of assertions for use by C2PA implementations, describing their syntax, usage, etc. To keep things simple, all example JUMBF URIs have been shortened for illustrative purposes - full URIs are necessary in the actual data.</p>
</div>
<div class="paragraph">
<p>All C2PA standardized assertions use the JSON JUMBF content type, the CBOR JUMBF content type, or the Embedded File content type from ISO 19566-5:AMD-1. Entity-specific assertions can be any of those, any of the other JUMBF content types from ISO 19566-5, B.1 (such as XML) or may create its own (as per the instructions in ISO 19566-5, Table B.1).  The Codestream content type shall not be used for a C2PA assertion.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
CBOR is not currently defined in 19566-5, but an upcoming update will define the type as <code>cbor</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Unless otherwise mentioned, all assertions documented in this standard set of assertions shall be serialized as CBOR. For all assertions of type CBOR, their schemas shall be defined using <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL</a>.  For those defined using JSON, their schemas shall be defined using <a href="https://json-schema.org/specification-links.html#draft-7">JSON Schema</a>.</p>
</div>
<div class="paragraph">
<p>All assertions shall have a label as described in <a href="#_labels">Section 6.2, &#8220;Labels&#8221;</a> and shall be versioned as described in <a href="#_versioning">Section 6.3, &#8220;Versioning&#8221;</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_use_of_cbor"><a class="anchor" href="#_use_of_cbor"></a>18.2. Use of CBOR</h3>
<div class="paragraph">
<p>All CBOR encoded data in a C2PA Manifest shall comply with the <a href="https://www.rfc-editor.org/rfc/rfc8949.html#name-core-deterministic-encoding">"Core Deterministic Encoding Requirements" of CBOR</a>.</p>
</div>
<div class="paragraph">
<p>When converting JSON data, based on one of the JSON Schemas documented here, to CBOR for the purposes of including as a valid C2PA assertion, the following shall be done:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A JSON <code>null</code> shall be serialized as Null (major type 7, additional information 22).</p>
</li>
<li>
<p>A JSON <code>false</code> shall be serialized as False (major type 7, additional information 20).</p>
</li>
<li>
<p>A JSON <code>true</code> shall be serialized as True (major type 7, additional information 21).</p>
</li>
<li>
<p>A JSON number shall be serialized either as an integer (major type 0 or 1) or a floating-point value (major type 7, additional information 25 through 27).</p>
</li>
<li>
<p>A JSON string that does not have an alternate semantic type (e.g., date-time or uri) shall either be serialized as a fixed-length UTF-8 string (major type 3) without any null termination, if human consumable, or a byte string (major type 2) if not. For Base64-encoded strings, unless specified otherwise, they shall be encoded in CBOR as a byte string (major type 2) after decoding from Base64.</p>
</li>
<li>
<p>A JSON string that is identified as a <code>date-time</code> shall be serialized with <a href="https://www.rfc-editor.org/rfc/rfc8949.html#stringdatetimesect">tag 0</a> (major type 6).</p>
</li>
<li>
<p>A JSON string that is identified as a <code>URI</code> shall be serialized with <a href="https://www.rfc-editor.org/rfc/rfc8949.html#stringdatetimesect">tag 32</a> (major type 6).</p>
</li>
<li>
<p>A JSON array shall be serialized as an array (major type 4).</p>
</li>
<li>
<p>A JSON object shall be serialized as a map (major type 5), with each key being serialized as a UTF-8 string (major type 3).</p>
</li>
<li>
<p>If a JSON object contains a key that is defined (by a specific schema) as optional, then either the key with an associated value shall be included in the map or neither its key nor any value shall be included in the map.</p>
</li>
<li>
<p>Indefinite-length items (additional information 31) shall not be used.  Accordingly, break codes (major type 7 and additional information value 31) shall not be used.</p>
</li>
<li>
<p>A JSON <code>null</code>, a JSON array of length zero, nor a JSON string of length zero shall be used unless they are (a) the value of a required (by a specific schema) key in a JSON object or (b) there are explicitly defined semantics (by a specific schema) for their usage.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The above list is based on an inversion of <a href="https://www.rfc-editor.org/rfc/rfc8949.html#name-converting-from-cbor-to-jso">section 6.1 of CBOR</a> with additions from C2PA best practices.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_metadata_about_assertions"><a class="anchor" href="#_metadata_about_assertions"></a>18.3. Metadata About Assertions</h3>
<div class="paragraph">
<p>In many cases, it is useful or even necessary to provide additional information about an assertion, such as the date and time when it was generated or other data that may help manifest consumers to make informed decisions about the provenance or veracity of the assertion data.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A manifest consumer is not required to read any portion of assertion metadata. It can choose which, if any, fields it wishes to consume, perhaps even varying based on the assertion type to which it is applied.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Below shows the core schemas used inside other assertions.</p>
</div>
<div class="paragraph">
<p>In CDDL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">;Describes additional information about an assertion, including a hashed-uri reference to it. We use a socket/plug here to allow hashed-uri-map to be used in individual files without having the map defined in the same file
$assertion-metadata-map /= {
  ? "reviewRatings": [1* rating-map], ; Ratings given to the assertion (may be empty)
  ? "dateTime":  tdate, ; The ISO 8601 date-time string when the assertion was created/generated
  ? "reference": $hashed-uri-map, ;hashed_uri reference to another assertion that this review is about
  ? "dataSource": source-map, ; A description of the source of the assertion data, selected from a predefined list
  ? "localizations" : [1* localization-data-entry] ; localizations for strings in the assertion
  * $$assertion-metadata-map-extension
}

$source-type /= "signer"
$source-type /= "claimGenerator.REE"
$source-type /= "claimGenerator.TEE"
$source-type /= "localProvider.REE"
$source-type /= "localProvider.TEE"
$source-type /= "remoteProvider.1stParty"
$source-type /= "remoteProvider.3rdParty"
$source-type /= "humanEntry.anonymous"
$source-type /= "humanEntry.identified"


source-map = {
  "type": $source-type, ; A value from among the enumerated list indicating whether the source of the assertion is a claim generator running in a rich execution environment (REE), a claim generator running in a trusted execution environment (TEE), a local data provider in REE (e.g. the location API from a mobile operating system), a local data running in a TEE (e.g. a trusted location trusted app from a chipset vendor), a remote data provider such as a server (e.g. Google's geolocation API service), entry by a human who wishes to remain anonymous, or a human who is credentialed with a W3C Verifiable Credential that's included in the asset.
  ? "details": tstr .size (1..max-tstr-length), ; A human readable string giving details about the source of the assertion data, e.g. the URL of the remote server that provided the data
  ? "actors" : [1* actor-map] ; array of hashed_uri references to W3C Verifiable Credentials
}

actor-map = {
  ? "identifier": tstr .size (1..max-tstr-length), ; An identifier for a human actor, used when the "type" is humanEntry.identified
  ? "credentials" : [1* $hashed-uri-map / $hashed-ext-uri-map] ; array of hashed_uri references to W3C Verifiable Credentials
}

int-range = 1..5

$review-code /= "actions.unknownActionsPerformed"
$review-code /= "actions.missing"
$review-code /= "actions.possiblyMissing"
$review-code /= "depthMap.sceneMismatch"
$review-code /= "ingredient.modified"
$review-code /= "ingredient.possiblyModified"
$review-code /= "thumbnail.primaryMismatch"
$review-code /= "stds.iptc.location.inaccurate"
$review-code /= "stds.schema-org.CreativeWork.misattributed"
$review-code /= "stds.schema-org.CreativeWork.missingAttribution"

rating-map = {
  "value":  int-range, ; "A value from 1 (worst) to 5 (best) of the rating of the item"
  ? "code": $review-code, ; A label-formatted string that describes the reason for the rating
  ? "explanation": tstr .size (1..max-tstr-length), ; A human readable string explaining why the rating is what it is
}

; The data structures used to store localization dictionaries
$localization-data-entry /= {
  * $$language-string
}

language-string /= tstr .size (1..max-tstr-length)</code></pre>
</div>
</div>
<div class="paragraph">
<p>In JSON Schema:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "http://ns.c2pa.org/assertion-metadata/v1",
  "type": "object",
  "description": "Assertion that describes additional information about an assertion, including a hashed-uri reference to it",
  "examples": [
    {
      "dataSource": {
        "type": "localProvider.REE",
        "details": "Dilip's Photo Editor for Windows v5.6"
      },
      "reviewRatings": [
        {
          "value": 2,
          "code" : "actions.unknownActionsPerformed",
          "explanation": "A 3rd party filter was used."
        }
      ],
      "dateTime": "2021-06-28T16:34:11.457Z"
    },
    {
      "reference": {
        "url": "self#jumbf=c2pa/urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.assertions/stds.schema-org.CreativeWork",
        "alg": "sha256",
        "hash": "hoOspQQ1lFTy/4Tp8Epx670E5QW5NwkNR+2b30KFXug="
      },
      "reviewRatings": [
        {
          "value": 1,
          "code": "stds.schema-org.CreativeWork.missingAttribution",
          "explanation": "Producer Thomas Chu was not credited."
        },
        {
          "value": 1,
          "code": "stds.schema-org.CreativeWork.misattributed",
          "explanation": "Editor of asset is Aswhini Viswanathan, not Stacey Higgs."
        }
      ],
      "localizations": [
        {
          "copyrightHolder.legalName": {
            "en-US": "British Broadcasting Corporation",
            "en-GB": "British Broadcasting Corporation",
            "es": "British Broadcasting Corporation",
            "fr": "British Broadcasting Corporation",
            "jp": "英国放送協会"
          }
        }
      ]
    }
  ],
  "definitions": {
    "ACTOR": {
      "type": "object",
      "properties": {
        "credentials": {
          "type": "array",
          "description": "An array of hashed uris to W3C Verifiable Credentials",
          "minItems": 1,
          "items": {
            "oneOf": [
              {
                "$ref": "http://ns.c2pa.org/hashed-uri/v1"
              },
              {
                "$ref": "http://ns.c2pa.org/hashed-ext-uri/v1"
              }
            ],
            "description": "hashed-uri reference to a W3C Verifiable Credential (VC) associated with the person or organization who entered the assertion content."
          }
        }
      },
      "identifier": {
        "type": "string",
        "description": "An identifier for a human actor, used when the 'type' is humanEntry.identified",
        "minLength": 1
      },
      "required": ["credentials"],
      "additionalProperties": false
    },
    "DATASOURCE": {
      "type": "object",
      "properties": {
        "type": {
          "enum": [
            "signer",
            "claimGenerator.REE",
            "claimGenerator.TEE",
            "localProvider.REE",
            "localProvider.TEE",
            "remoteProvider.1stParty",
            "remoteProvider.3rdParty",
            "humanEntry.anonymous",
            "humanEntry.identified`"
          ],
          "description": "A value from among the enumerated list indicating whether the source of the assertion is a claim generator running in a rich execution environment (REE), a claim generator running in a trusted execution environment (TEE), a local data provider in REE (e.g. the location API from a mobile operating system), a local data running in a TEE (e.g. a trusted location trusted app from a chipset vendor), a remote data provider such as a server (e.g. Google's geolocation API service), entry by a human who wishes to remain anonymous, or a human who is credentialed with a W3C Verifiable Credential that's included in the asset."
        },
        "details": {
          "type": "string",
          "description": "A human readable string giving details about the source of the assertion data, e.g. the URL of the remote server that provided the data"
        },
        "actors": {
          "type": "array",
          "description": "An array of the actors that undertook this action.",
          "minItems": 1,
          "items": {
            "type": "string",
            "minLength": 1,
            "$ref": "#/definitions/ACTOR",
            "description": "list of actors"
          }
        }
      },
      "anyOf": [
        {
          "not": {
            "properties": {
              "type": {
                "const": "humanEntry.credentialed"
              }
            },
            "required": ["type"]
          }
        },
        {
          "required": ["actors"]
        }
      ],
      "required": ["type"],
      "additionalProperties": false
    },
    "RATING": {
      "type": "object",
      "properties": {
        "value": {
          "type": "integer",
          "minimum": 1,
          "maximum": 5,
          "description": "A value from 1 (worst) to 5 (best) of the rating of the item"
        },
        "code": {
          "enum": [
            "actions.unknownActionsPerformed",
            "actions.missing",
            "actions.possiblyMissing",
            "depthMap.sceneMismatch",
            "ingredient.modified",
            "ingredient.possiblyModified",
            "thumbnail.primaryMismatch",
            "stds.iptc.location.inaccurate",
            "stds.schema-org.CreativeWork.misattributed",
            "stds.schema-org.CreativeWork.missingAttribution"
          ],
          "description": "A label-formatted string that describes the reason for the rating"
        },
        "explanation": {
          "type": "string",
          "minLength": 1,
          "description": "A human readable string explaining why the rating is what it is"
        }
      },
      "required": ["value"]
    },
    "LOCALIZATION_ENTRY": {
      "type": "object",
      "properties": {
        "^..[-A-Za-z]*$": {
          "type": "string",
          "description": "String for the value as describe by the BCP-47 code as the key",
          "minLength": 1
          }
      },
      "required": [],
      "additionalProperties": true
    }
  },
  "properties": {
    "dataSource": {
      "$ref": "#/definitions/DATASOURCE",
      "description": "A description of the source of the assertion data, selected from a predefined list"
    },
    "reviewRatings": {
      "type": "array",
      "description": "An array of review ratings",
      "minItems": 1,
      "items": {
        "$ref": "#/definitions/RATING",
        "description": "The rating given to the assertion"
      }
    },
    "dateTime": {
      "type": "string",
      "minLength": 1,
      "format": "date-time",
      "description": "The ISO 8601 date-time string when the assertion was created/generated"
    },
    "reference": {
      "$ref": "http://ns.c2pa.org/hashed-uri/v1",
      "description": "hashed_uri reference to another assertion that this review is about"
    },
    "localizations" : {
      "type": "array",
      "description": "An array of localizations",
      "minItems": 1,
      "items": {
        "$ref": "#/definitions/LOCALIZATION_ENTRY",
        "description": "The localization entries for a single string"
      }
    }
  },
  "required": [],
  "additionalProperties": true
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In most cases, this assertion specific metadata will appear directly inside of other assertions (e.g., ingredients) as the value of their <code>metadata</code> field. However, sometimes it is necessary or desirable to store the assertion metadata in a separate, independent <code>assertion metadata</code> assertion, such as when an assertion is not in JSON or CBOR, such as thumbnails.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Since the claim is a special type of assertion, it too supports having assertion metadata.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The label for the <code>assertion metadata</code> assertion is <code>c2pa.assertion.metadata</code>.</p>
</div>
<div class="sect3">
<h4 id="_data_source"><a class="anchor" href="#_data_source"></a>18.3.1. Data Source</h4>
<div class="paragraph">
<p>This <code>dataSource</code> field is an optional field that allows the claim signer to inform downstream manifest consumers about the source from which the assertion contents originated. If no <code>dataSource</code> is provided for a given assertion, the <code>dataSource</code> is considered to be the <code>Signer</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By default, all assertions are sourced to the Signer, as the Trust Model is rooted in trust of the Signer. Where a different source is indicated, it will be a useful Trust Signal to a manifest consumer.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of the field is a <code>dataSource</code> object that is composed of three fields: <code>type</code>, <code>details</code>, and if applicable, <code>credential</code>.</p>
</div>
<div class="paragraph">
<p>The dataSource <code>type</code> field defines the type of the dataSource. It is assembled with labels in the format described in <a href="#_labels">Section 6.2, &#8220;Labels&#8221;</a>. The value can be one of the following specification-defined values, or entity-specific labels can be used as an extension mechanism.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value of <code>type</code></th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>signer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The assertion contents came from the Signer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claimGenerator.REE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assertion contents came from a claim generator running in a rich execution environment (REE), such as a desktop or mobile operating system</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claimGenerator.TEE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assertion contents came from a claim generator running in a trusted execution environment (TEE), such as a trusted OS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>localProvider.REE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assertion contents came from a data source running in an REE on the same physical computing device as the claim generator</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>localProvider.TEE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assertion contents came from a data source running in a TEE on the same physical computing device as the claim generator</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>remoteProvider</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assertion contents came from a remote data source controlled by the signer or claim generator vendor</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>remoteProvider.external</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assertion contents came from an external, remote data source that is not the signer or claim generator vendor</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>humanEntry.anonymous</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assertion contents were entered by a human that wishes to remain anonymous</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>humanEntry.identified</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assertion contents were entered by an identified human actor(s), specified in the <code>actors</code> field of the <code>dataSource</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>details</code> field is a human-readable string that provides additional information about the dataSource, e.g., the name of the API used to provide the assertion contents, or the URL of the server from which the contents were provided. For example, a broad location assertion source may have a <code>type</code> value of <code>remoteProvider.3rdParty</code>, with the <code>details</code> value set to <code>www.googleapis.com/geolocation/v1/geolocate</code>.</p>
</div>
<div class="paragraph">
<p>If the value of the <code>type</code> field is <code>humanEntry.identified</code>, then an <code>actors</code> field shall contain an array of one or more actor objects as defined in <a href="#_common_data_model_actor">Section 18.17, &#8220;Common Data Model: Actor&#8221;</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_review_ratings"><a class="anchor" href="#_review_ratings"></a>18.3.2. Review Ratings</h4>
<div class="paragraph">
<p>When present, the <code>reviewRatings</code> array provides a place for the claim generator to provide one or more <code>rating</code> objects on the quality (or lack thereof) of an assertion. A <code>reviewRatings</code> shall not be present if a <code>dataSource</code> object is present with a <code>type</code> field whose value is either <code>humanEntry.anonymous</code> or <code>humanEntry.credentialed</code>.</p>
</div>
<div class="paragraph">
<p>The <code>value</code> field of the <code>rating</code> object shall be present with any integer value from <em>1</em> (worst) through <em>5</em> (best). If present, the <code>explanation</code> field shall contain a human-consumable string description of the type of rating. In addition, an optional machine-readable <code>code</code> field which defines assertion-specific evaluation outcome codes may be provided. The value of the <code>code</code> field is assembled with labels in the format described in <a href="#_labels">Section 6.2, &#8220;Labels&#8221;</a>. The value can be one of the following specification-defined values, or entity-specific labels can be used as an extension mechanism.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 22.2222%;">
<col style="width: 22.2222%;">
<col style="width: 55.5556%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value of <code>code</code></th>
<th class="tableblock halign-left valign-top">Applicable Assertion</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>actions.unknownActionsPerformed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c2pa.actions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>actions</code> assertion does not contain a full list of all actions performed in the authoring tool (e.g., because of the use of a 3rd party filter whose effect is unknown to the authoring tool).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>actions.placedIngredientNotFound</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c2pa.actions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>actions</code> assertion being reviewed has a <code>placed</code> action without a resolvable <code>ingredient</code> URI. <code>value</code> should be <code>1</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ingredient.actionMissing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c2pa.ingredient</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>ingredient</code> assertion being reviewed does not have at least one action that references it in its claim. <code>value</code> should be <code>1</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ingredient.notVisible</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c2pa.ingredient</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>ingredient</code> assertion being reviewed is not visible in the digital content bound to that manifest. <code>value</code> should be <code>1</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>depthMap.sceneMismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c2pa.depthmap.GDepth</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The contents of the depth map assertion do not correspond to the scene portrayed in the primary presentation in the asset (e.g., because of a picture-of-picture attack).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>thumbnail.primaryMismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c2pa.thumbnail.claim</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The thumbnail&#8217;s contents do not match the contents of the primary presentation in the asset.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stds.schema-org.CreativeWork.misattributed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stds.schema-org.CreativeWork</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">One or more of the roles listed in a <code>CreativeWork</code> assertion is misattributed to the wrong actor (e.g., the wrong credit is given for the <code>editor</code> role).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stds.schema-org.CreativeWork.missingAttribution</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stds.schema-org.CreativeWork</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An attribution for a role in a <code>CreativeWork</code> assertion is missing (e.g., a person who played the role of <code>producer</code> is not credited).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stds.iptc.location.inaccurate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stds.iptc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The reported location is inaccurate (e.g., reported to be in New York, NY but appears to be in another city entirely).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_references_2"><a class="anchor" href="#_references_2"></a>18.3.3. References</h4>
<div class="paragraph">
<p>Because the <code>reference</code> field of the <code>assertion metadata</code> assertion is a standard <a href="#_uri_references"><code>hashed_uri</code></a>, it is also possible to have an <a href="#_metadata_about_assertions"><code>assertion metadata</code> assertion</a> refer to assertions in other manifests than the active one. For example, the active manifest could include an <code>assertion metadata</code> assertion that validates the <code>precise location</code> assertion present in an ingredient&#8217;s manifest.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Since the claim is a special type of assertion, this same method can be used to refer to claims in other manifests.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_datetime"><a class="anchor" href="#_datetime"></a>18.3.4. DateTime</h4>
<div class="paragraph">
<p>If a <code>dateTime</code> field is present, its value shall be a date time string that complies with <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO 8601</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_localization"><a class="anchor" href="#_localization"></a>18.3.5. Localization</h4>
<div class="paragraph">
<p>It is important that consumers of C2PA manifests be able to understand the information in their native language, when possible. To this end, it is possible to add localization information for an assertion with a dictionary that is included in the assertion&#8217;s metadata.</p>
</div>
<div class="sect4">
<h5 id="_localization_dictionary"><a class="anchor" href="#_localization_dictionary"></a>18.3.5.1. Localization Dictionary</h5>
<div class="paragraph">
<p>A localization dictionary consists of a single object, where each of its keys represent the translations using the <a href="https://www.w3.org/TR/json-ld/#language-indexing">language indexing technique</a>.  If the value that requires translation is not associated with a top-level key, then "dot notation" (<code>.</code>) shall be used to reference keys nested in objects. An array indexing notation (<code>[n]</code>, <code>n&gt;=0</code>) shall be used where a specific element in an array needs to be traversed. When the value requiring translation is itself an array, a specific element may be referenced. Some examples would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "dc:title": {
    "en-US": "Kevin's Five Cats",
    "en-GB": "Lord Kevin's Five Cats",
    "es-MX": "Los Cinco Gatos de Kevin",
    "es-ES": "Los Thinco Gatos de Kevin",
    "fr": "Les Cinq Chats de Kevin",
    "jp": "ケヴィンの５匹の猫"
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "copyrightHolder.legalName": {
    "en-US": "British Broadcasting Corporation",
    "en-GB": "British Broadcasting Corporation",
    "es": "British Broadcasting Corporation",
    "fr": "British Broadcasting Corporation",
    "jp": "英国放送協会"
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "authors[2].name": {
    "en-US": "John Doe",
    "en-GB": "Joe Bloggs"
  },
  "authors[2].aliases[0]": {
    "en-US": "John Smith",
    "en-GB": "Fred Bloggs"
  },
  "authors[2].aliases[1]": {
    "en-US": "John Q. Public",
    "en-GB": "Joe Public"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Any such 3rd party keys or values are required to be namespaced in the same way as <a href="#_labels">Section 6.2, &#8220;Labels&#8221;</a>, e.g. <code>com.litware</code>. In order for a manifest consumer to display human-readable information about these keys and values, the claim generator should provide the strings via this localization approach.</p>
</div>
<div class="paragraph">
<p>The following example shows how this could be used for localizing custom <a href="#_actions">actions</a>, by using this in the assertion metadata of a <code>c2pa.actions</code> assertion.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "com.litware.blur": {
    "en-US": "Blur",
    "fr-FR": "Brouiller",
  },
  "com.litware.filter": {
    "en-US": "Filter",
    "es-ES": "Filtrar",
    "jp-JP": "フィルター"
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_standard_c2pa_assertion_summary"><a class="anchor" href="#_standard_c2pa_assertion_summary"></a>18.4. Standard C2PA Assertion Summary</h3>
<div class="paragraph">
<p>The standard C2PA assertions are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Assertion</th>
<th class="tableblock halign-left valign-top">Schema</th>
<th class="tableblock halign-left valign-top">Serialization</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assertion Metadata</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.assertion.metadata</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Hash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.hash.data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BMFF-based Hash v1 (deprecated)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.hash.bmff</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BMFF-based Hash v2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.hash.bmff.v2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Soft Binding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.soft-binding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cloud Data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.cloud-data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Thumbnail</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.thumbnail.claim (claim creation time) c2pa.thumbnail.ingredient (importing an ingredient)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Embedded File</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Actions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.actions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ingredient</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.ingredient</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GDepth Depthmap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.depthmap.GDepth</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developers.google.com/depthmap-metadata/reference" class="bare">https://developers.google.com/depthmap-metadata/reference</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Endorsement</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cp2a.endorsement</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exif information</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">stds.exif</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON-LD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IPTC Photo Metadata</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">stds.iptc.photo-metadata</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON-LD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Claim Review</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">stds.schema-org.ClaimReview</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Schema.org ClaimReview</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON-LD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Creative Work</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">stds.schema-org.CreativeWork</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Schema.org CreativeWork</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON-LD</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_data_hash"><a class="anchor" href="#_data_hash"></a>18.5. Data Hash</h3>
<div class="paragraph">
<p>Portion(s) of a non-BMFF-based asset that a claim generator wishes to uniquely identify with a hard binding (i.e., cryptographic hash) shall be described using data hash assertions. The types of hashes which can be created and stored in such an assertion are described in <a href="#_hashing">Section 13.1, &#8220;Hashing&#8221;</a>, and the value shall be present in the <code>hash</code> field.</p>
</div>
<div class="paragraph">
<p>Each data hash assertion defines a specified range of bytes over which the hash has been computed. By default, this range is the entire asset containing this assertion or the entire asset referred to by the <code>url</code> value in the assertion.  If only a portion of the asset shall be hashed, then the range(s) to be excluded shall be present in the array value of the <code>exclusions</code> field.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>url</code> value provides flexibility for hashing assets that may be represented in multiple chunks or portions, local or remote.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A Data Hash assertion shall have a label of <code>c2pa.hash.data</code>.</p>
</div>
<div class="paragraph">
<p>A Data Hash assertion must not appear in a <a href="#_cloud_data">Cloud Data assertion</a>.</p>
</div>
<div class="sect3">
<h4 id="_schema_and_example_2"><a class="anchor" href="#_schema_and_example_2"></a>18.5.1. Schema and Example</h4>
<div class="paragraph">
<p>The <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a> for this type is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; Also check optionality within the hash-map
; The data structure used to store the cryptographic hash of some or all of the asset's data 
; and additional information required to compute the hash.
data-hash-map = {
  ? "exclusions": [1* EXCLUSION_RANGE-map],
  ? "alg":tstr .size (1..max-tstr-length), ; A string identifying the cryptographic hash algorithm used to compute the hash in this assertion, taken from the C2PA hash algorithm identifier list. If this field is absent, the hash algorithm is taken the `alg` value of the enclosing structure. If both are present, the field in this structure is used. If no value is present in any of these places, this structure is invalid; there is no default.
  "hash": bstr, ; byte string of the hash value
  "pad": bstr, ; zero-filled byte string used for filling up space
  ? "pad2": bstr, ; optional zero-filled byte string used for filling up space
  ? "name": tstr .size (1..max-tstr-length), ; (optional) a human-readable description of what this hash cover
  ? "url": uri, ; (optional) a file or http(s) URL to where the bytes that are being hashed can be found. 
              ; This is useful for cases where the data lives in a different file chunk or side-car than the claim.
}

EXCLUSION_RANGE-map = {
  "start": int, ; Starting byte of the range
  "length": int, ; Number of bytes of data to exclude
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "alg" : "sha256",
  "pad" : 'abc',
  "hash": 'Auxjtmax46cC2N3Y9aFmBO9Jfay8LEwJWzBUtZ0sUM8gA=',
  "name": "JUMBF manifest"
  "exclusions": [ 
    {
      "start": 9960,
      "length": 4213
    } 
  ],
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Normally, the <code>start</code> and <code>length</code> values of an <code>exclusion</code> shall be written in their preferred serialization (i.e., "as short as possible"). However, when a data hash assertion needs to be created but the <code>start</code> and <code>length</code> values are not yet known, they shall be created "as large as possible", which would be as a 32-bit integer.</p>
</div>
<div class="paragraph">
<p>The <code>pad</code> value shall always be present but shall be a zero-filled byte string of length 0 unless used to replace (i.e., "pad") bytes during multiple pass processing. <code>pad2</code> is an optional zero-filled byte string that is used if the desired padding cannot be achieved with <code>pad</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<a href="#_multiple_step_processing">Section 10.4, &#8220;Multiple Step Processing&#8221;</a> describes how to fill in the correct values and adjust the padding.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_special_consideration_for_jpeg_1"><a class="anchor" href="#_special_consideration_for_jpeg_1"></a>18.5.2. Special consideration for JPEG-1</h4>
<div class="paragraph">
<p>When hashing a JPEG-1 (.jpg) file into which the C2PA Manifest will be embedded, the APP11 marker (<code>FFEB</code>)  and the segment&#8217;s length (<code>Lp</code>) of all APP11 segments containing the JUMBF data shall be included in the exclusion range.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All the APP11 segments containing the C2PA Manifest JUMBF are contiguous so that only a single range is required.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_special_consideration_for_png"><a class="anchor" href="#_special_consideration_for_png"></a>18.5.3. Special consideration for PNG</h4>
<div class="paragraph">
<p>When hashing a PNG (.png) file into which the C2PA Manifest will be embedded, it is important that the <code>Length</code> and the <code>'caBX'</code> (representing the chunk type) of the chunk containing the JUMBF data be included in the exclusion range.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bmff_based_hash"><a class="anchor" href="#_bmff_based_hash"></a>18.6. BMFF-Based Hash</h3>
<div class="paragraph">
<p>Portion(s) of a BMFF-based asset that a claim generator wishes to uniquely identify with a hard binding (i.e., cryptographic hash) shall be described using BMFF-based Hash assertions.</p>
</div>
<div class="paragraph">
<p>A BMFF-based Hash assertion shall have a label of <code>c2pa.hash.bmff</code> for v1 (deprecated) and <code>c2pa.hash.bmff.v2</code> for v2.</p>
</div>
<div class="paragraph">
<p>A BMFF-based Hash assertion must not appear in a <a href="#_cloud_data">Cloud Data assertion</a>.</p>
</div>
<div class="paragraph">
<p>To compute the hash specified in the value field of a BMFF hash, all bytes of the file are added to the hash excluding those BMFF boxes or subset[s] thereof which match any exclusion entry in the exclusions array.</p>
</div>
<div class="paragraph">
<p>Boxes that are included in their entirety also include their box headers in the input data contributed to the hash.  Similarly, boxes that are excluded in their entirety also exclude their box headers from the input data contributed to the hash.  When a box is partially excluded from the input data contributed to the hash through the use of a <code>subset</code> field in the exclusion specification, the portion(s) of the box to be excluded defined by the relative byte offsets in the <code>subset</code> field are offsets from the start of the box including the box headers, not offsets from the start of the box&#8217;s content.</p>
</div>
<div class="paragraph">
<p>In BMFF-based hash v1, for any root box not excluded in its entirety, the input data contributed to the hash for that box is comprised of <code>data</code>, where <code>data</code> is defined as the box&#8217;s contents, including headers, minus any exclusions.</p>
</div>
<div class="paragraph">
<p>In BMFF-based hash v2, for any root box not excluded in its entirety, the input data contributed to the hash for that box is comprised of the concatenation of the binary strings <code>offset || data</code>, where <code>offset</code> is defined as the absolute file offset of the box as an 8-byte integer in big-endian format, and <code>data</code> is defined as the box&#8217;s contents, including headers, minus any exclusions. In this definition, "||" represents the binary concatenation of the two.</p>
</div>
<div class="paragraph">
<p>There are two differences between BMFF-based hash v1 and v2.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The absolute file byte offset is included at the start of the input data contributed to the hash for any root box.  This ensures that a root box included in the hash cannot change positions in the file.</p>
</li>
<li>
<p>The <code>mdat</code> box is no longer excluded in its entirety when the bmff-hash-map includes both the <code>hash</code> and <code>merkle</code> fields.  Instead, a mandatory entry on the exclusion list excludes most of the box.  Along with the first difference, this ensures that the <code>mdat</code> cannot change positions in the file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A box matches an exclusion entry in the exclusions array if and only if all of the following conditions are met.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The box&#8217;s location in the file exactly matches the <code>exclusions-map</code> entry&#8217;s <code>xpath</code> field.</p>
</li>
<li>
<p>If <code>length</code> is specified in the <code>exclusions-map</code> entry, the box&#8217;s length exactly matches the <code>exclusions-map</code> entry&#8217;s <code>length</code> field.  Note: The length includes the box headers.</p>
</li>
<li>
<p>If <code>version</code> is specified in the <code>exclusions-map</code> entry, the box is a FullBox and the box&#8217;s version exactly matches the <code>exclusions-map</code> entry&#8217;s <code>version</code> field.</p>
</li>
<li>
<p>If <code>flags</code> (byte array of exactly 3 bytes) is specified in the <code>exclusions-map</code> entry and the box is a FullBox.  If <code>exact</code> is set to true or not specified, the box&#8217;s flags (bit(24), i.e., 3 bytes) also exactly matches the <code>exclusions-map</code> entry&#8217;s <code>flags</code> field.  If <code>exact</code> is set to false, the bitwise-and of the box&#8217;s flags (bit(24), i.e., 3 bytes) with the <code>exclusions-map</code> entry&#8217;s <code>flags</code> field exactly matches the <code>exclusions-map</code> entry&#8217;s <code>flags</code> field (i.e., the box has at least those bits set but may also have additional bits set).</p>
</li>
<li>
<p>If <code>data</code> (array of objects) is specified in the <code>exclusions-map</code> entry, then for each item in the array, the box&#8217;s binary data at that item&#8217;s relative byte <code>offset</code> field exactly matches that item&#8217;s <code>bytes</code> field.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>xpath</code> field&#8217;s string syntax shall be limited to the following strict subset.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Only abbreviated syntax shall be used.</p>
</li>
<li>
<p>Only full paths shall be used.</p>
</li>
<li>
<p>Only node selection via <code>node</code> or <code>node[integer]</code> shall be used.</p>
</li>
<li>
<p>Descendent syntax, i.e., <code>//</code>, shall NOT be used.</p>
</li>
<li>
<p>All nodes shall be BMFF <code>4cc</code> codes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Complete Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">  xpath = '/' nodes
  nodes = node
        | node '/' nodes
  node = box4cc
       | box4cc '[' integer ']'
Where:
  box4cc is any 4cc allowed by ISO/IEC 14496-12 for a BMFF box.
  integer is any non-zero positive integer with no leading zeros.</code></pre>
</div>
</div>
<div class="paragraph">
<p>A non-leaf xpath node shall only point to a container box that has no fields of its own (i.e., contains no data, only child boxes) and that does not inherit from FullBox.  This ensures that a C2PA validator does not need to be aware of the syntax and semantics of unusual boxes that contain other boxes.  If a child box of such an unusual box needs to be excluded in full or in part, the <code>exclusions-map</code> entry&#8217;s <code>xpath</code> field shall point to the unusual box itself and the <code>subset-map</code> field shall exclude the byte rang(es) containing the excluded child box data.  For example, the <code>'sgpd'</code> box contains other boxes but is unusual in that it inherits from FullBox; as such, if excluding child box(es), in whole or in part, from <code>'sgpd'</code> is required, the assertion shall use an <code>xpath</code> field pointing to the <code>'sgpd'</code> itself (e.g., <code>/moof/traf/sgpd</code>) and shall use the <code>subset-map</code> field to exclude the desired bytes.</p>
</div>
<div class="paragraph">
<p>If the C2PA Manifest is embedded into the file, the box containing it shall be one of the entries in the exclusions array.  Refer to <a href="#_embedding_manifests_into_bmff_based_assets">Section 11.3.2, &#8220;Embedding manifests into BMFF-based assets&#8221;</a> for more information.</p>
</div>
<div class="paragraph">
<p>If a non-root excluded box is removed after the C2PA Manifest is created, it shall be replaced with a <code>'free'</code> box of the same size to ensure that the input data contributed to the hash for other boxes are not invalidated.  If it is expected that a non-root excluded box may be added after the C2PA Manifest is created, then, at manifest creation time, a <code>'free'</code> box shall be inserted with sufficient space for the excluded box and that <code>'free'</code> box shall also be excluded by an exclusion entry using its full xpath.  When the excluded box is added, the <code>'free'</code> box shall be shrunk (or removed) to make space for the added box.</p>
</div>
<div class="paragraph">
<p>Embedding C2PA data into a BMFF-based asset via MP4 boxes changes file offsets in other MP4 boxes and, in v2, the absolute file byte offsets being included in the input data contributed to the hash for any root box.  Those boxes and offsets must be included in the input data contributed to the hash with their post-embed values, not their pre-embed values, or the BMFF-based Hash assertion will not validate.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Here are two possible ways an implementation can ensure that post-embed values for all file byte offsets are hashed.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use <code>'free'</code> boxes.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Determine reasonable maximum size(s) for the C2PA box(es) which will be embedded.  All MP4 boxes for C2PA support unused padding bytes at the end, so it is fine to overestimate the size for the <code>'free'</code> boxes because any extra bytes will be ignored.</p>
</li>
<li>
<p>Insert <code>'free'</code> box(es) of said size(s) into the asset file(s) and update all offsets appropriately.</p>
</li>
<li>
<p>Perform hashing of the asset with "/free" on the exclusion list.</p>
</li>
<li>
<p>Create and sign the manifest.  Create the C2PA box(es).</p>
</li>
<li>
<p>Overwrite the <code>'free'</code> box(es) with the C2PA box(es).</p>
</li>
</ol>
</div>
</li>
<li>
<p>Use a two-pass approach.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Compute the exact sizes of the BMFF-based Hash assertion and the <code>merkle</code> box(es) if any.  The latter will require parsing the asset file(s) to determine the size of the Merkle tree.</p>
</li>
<li>
<p>Compute the exact size of the final manifest.</p>
</li>
<li>
<p>Perform hashing of the asset file(s).  Update any box that includes any file offsets to correct values before including that box in the input data contributed to the hash.  In v2, compute the input data contributed to the hash using <code>(offset || data)</code> using the updated absolute file offset as described above.</p>
</li>
<li>
<p>Create and sign the manifest.  Create the C2PA box(es).</p>
</li>
<li>
<p>Insert the C2PA box(es).</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>While the latter method is significantly more complex, it does enable correct hashing without any foreknowledge of the maximum manifest size.  It also minimizes the final asset&#8217;s size.
Common boxes (<strong>not</strong> exhaustive) with file offsets include <code>'iloc'</code>, <code>'stco'</code>, <code>'co64'</code>, <code>'tfhd'</code>, <code>'sidx'</code>, and <code>'saio'</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_schema_and_example_3"><a class="anchor" href="#_schema_and_example_3"></a>18.6.1. Schema and Example</h4>
<div class="paragraph">
<p>The <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a> for this type is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">bmff-hash-map = {
  "exclusions": [1* exclusions-map],
  ? "alg": tstr .size (1..max-tstr-length), ; A string identifying the cryptographic hash algorithm used to compute this hash, taken from the C2PA hash algorithm identifier list. If this field is absent, the hash algorithm is taken from an enclosing structure as defined by that structure. If both are present, the field in this structure is used. If no value is present in any of these places, this structure is invalid; there is no default.
  ? "hash": bstr, ; For non-fragmented MP4, this shall be the hash of the entire BMFF file excluding boxes listed in the exclusions array.  For `c2pa.hash.bmff` (deprecated) assertions, if the merkle field is present, this hash also excludes all 'mdat' boxes.  For fragmented MP4, this field is required to be absent.
  ? "merkle": [1* merkle-map], ; A set of Merkle tree rows and the associated data required to enable verification of a single 'mdat' box, multiple 'mdat' boxes, and/or individual fragment files within the asset.
  ? "name": tstr .size (1..max-tstr-length), ; optional) a human-readable description of what this hash covers.
  ? "url": uri, ; (optional) a file or http(s) URL to where the bytes that are being hashed lived.  This is useful for cases where the data lives in a different file chunk or side-car than the claim.
}

;(optional) CBOR byte string of exactly 3 bytes.
flag-type = bytes

flag-t = flag-type .eq 3

exclusions-map = {
  "xpath": tstr, ; Location of box(es) to exclude from the hash starting from the root node as an xpath formatted string of version https://www.w3.org/TR/xpath-10/ with highly constrained syntax.
  ? "length": int, ; (optional) Length that a leafmost box must have to exclude from the hash.
  ? "data": [1* data-map], ; (optional) The data in the leafmost box at the specified relative byte offset must be identical to the specified data for the box to be excluded from the hash.
  ? "subset":[1* subset-map], ; (optional) Only this portion of the excluded box shall be excluded from the hash.  Each entry in the array must have a monotonically increasing relative byte offset.  No subset within the array may overlap.  The last entry may have a length of zero; this indicates that the remainder of the box from that relative byte offset onward is excluded.  A relative byte offset or relative byte offset plus length that exceeds the length of the box is allowed; bytes beyond the end of the box are never hashed.
  ? "version": int, ; (optional) Version that must be set in a leafmost box for the box to be excluded from the hash.  Shall only be specified for a box that inherits from FullBox.
  ? "flags": flag-t,  ; (optional) byte string of exactly 3 bytes.  The 24-bit flags that must be set in a leafmost box for the box to be excluded from the hash.  Shall only be specified for a box that inherits from FullBox.
  ? "exact": bool, ; (optional) indicates that flags must be an exact match.  If not specified, defaults to true.  Shall only be specified for a box that inherits from FullBox and when flags is also specified.
}

data-map = {
  "offset": int,
  "value" : bstr,
}
subset-map = {
  "offset": int,
  "length": int,
}

; Each entry in a map is a Merkle tree rows and the associated data required to enable validation of a single
; 'mdat' box or multiple 'mdat' boxes within the asset.",
merkle-map = {
  "uniqueId": int, ; 1-based unique id used to differentiate across files to determine which Merkle tree should be used to validate a given 'mdat' box.
  "localId": int, ; Local id used to differentiate across multiple 'mdat' boxes within a single file to determine which Merkle tree should be used to validate that 'mdat' box.
  "count": int, ; Number of leaf nodes in the Merkle tree.  Null nodes are not included in this count.
  ? "alg": tstr .size (1..max-tstr-length), ; A string identifying the cryptographic hash algorithm used to compute the hashes in this Merkle tree, taken from the C2PA hash algorithm identifier list. If this field is absent, the hash algorithm is taken the `alg` value of the enclosing structure as defined by that structure. If both are present, the field in this structure is used. If no value is present in any of these places, this structure is invalid; there is no default.
  ? "initHash": bstr, ; For fragmented MP4 assets which are split across multiple files, this field is required to be present and shall be the hash of the entire initialization segment file for chunks hashed by this Merkle tree excluding boxes listed in the exclusions array.  For fragmented MP4 assets which are stored as a single flat MP4 file, this field is required to be present and shall be the hash of all bytes preceding the first 'moof' box excluding boxes listed in the exclusions array.  For non-fragmented MP4, this field is required to be absent.
  "hashes": [1* bstr], ; An ordered array representing a single row of the Merkle tree which may be the leaf-most row, root row, or any intermediate row.  The depth of the row is implied by (shall be computed from) the number of items in this array.
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) for a monolithic MP4 file asset where the <code>mdat</code> box is validated as a unit is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "hash": b64'EiAuxjtmax46cC2N3Y9aFmBO9Jfay8LEwJWzBUtZ0sUM8gA=',
  "name": "Example BMFF-hash object",
  "exclusions": [
    {
      "data": [
        {
          "value": b64'2P7D1hsOSDySl1goh37EgQ==',
          "offset": 8
        }
      ],
      "xpath": "/uuid"
    },
    {
      "xpath": "/ftyp"
    },
    {
      "xpath": "/mfra"
    },
    {
      "xpath": "/moov[1]/pssh"
    },
    {
      "xpath": "/emsg",
      "data": [
        {
          "value": b64'r3avWCpXHkmKHATFsV0Q5g==',
          "offset": 20
        }
      ]
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) for an asset composed of fragmented MP4 files is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "alg": "sha256",
  "name": "Example BMFF-hash object for fMP4",
  "merkle": [
    {
      "count": 23,
      "hashes": [ b64'HvWZOxKMfkSatRAygs8DJfnEEcN/G1BNi359NdIDxbQ=', b64'HvWZOxKMfkSatRAygs8DJfnEEcN/G1BNi359NdIDxbQ=' ],
      "localId": 19,
      "initHash": b64'Hf0IgeqbL0m+FTTLpUWwsDGR8pvhUR1AlwvaXjQ0qGY=',
      "uniqueId": 17
    },
    {
      "count": 69,
      "hashes": [ b64'9Zk7Eox+RJq1EDKCzwMl+cQRw38bUE2Lfn010gPFtB0=', b64'9Zk7Eox+RJq1EDKCzwMl+cQRw38bUE2Lfn010gPFtB0=', b64'mTsSjH5EmrUQMoLPAyX5xBHDfxtQTYt+fTXSA8W0Hf0=', b64'mTsSjH5EmrUQMoLPAyX5xBHDfxtQTYt+fTXSA8W0Hf0=', b64'OxKMfkSatRAygs8DJfnEEcN/G1BNi359NdIDxbQd/Qg=' ],
      "localId": 38,
      "initHash": b64'Hf0IgeqbL0m+FTTLpUWwsDGR8pvhUR1AlwvaXjQ0qGY=',
      "uniqueId": 34
    },
    {
      "count": 46,
      "hashes": [ b64'OxKMfkSatRAygs8DJfnEEcN/G1BNi359NdIDxbQd/Qg=' ],
      "localId": 57,
      "initHash": b64'Hf0IgeqbL0m+FTTLpUWwsDGR8pvhUR1AlwvaXjQ0qGY=',
      "uniqueId": 51
    }
  ],
  "exclusions": [
    {
      "data": [
        {
          "value": b64'2P7D1hsOSDySl1goh37EgQ==',
          "offset": 8
        }
      ],
      "xpath": "/uuid"
    },
    {
      "xpath": "/ftyp"
    },
    {
      "xpath": "/mfra"
    },
    {
      "xpath": "/moov[1]/pssh"
    },
    {
      "data": [
        {
          "value": b64'9Q==',
          "offset": 5
        },
        {
          "value": b64'UAJXD79SlkG9rfnmcsqTUA==',
          "offset": 20
        },
        {
          "value": b64'OxKM',
          "offset": 70
        }
      ],
      "flags": b64'ZDNx',
      "xpath": "/emsg",
      "length": 200,
      "subset": [
        {
          "length": 7,
          "offset": 5
        },
        {
          "length": 28,
          "offset": 20
        },
        {
          "length": 63,
          "offset": 45
        },
        {
          "length": 112,
          "offset": 80
        }
      ],
      "version": 1
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A pseudo-code implementation of this algorithm follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">offset = 0
While (offset &lt; length of file)
	Starting at offset, locate the first byte of the first box that matches any entry in the exclusions array, call this first_excluded_byte
		If no such box is found, set first_excluded_byte = length of file
	Determine the length of that box, call this excluded_byte_count
		If no such box was found, set excluded_byte_count = 0
	To the hash, add all bytes between offset and first_excluded_byte minus one (inclusive)
	If first_excluded_byte &lt; length of file and there exists a subset array within the exclusion that determined the value of first_excluded_byte
		set next_included_begin = first_excluded_byte
		For each entry in the subset array within the exclusion that determined the value of first_excluded_byte
			Set next_excluded_begin = this subset array entry's offset field plus first_excluded_byte
			If next_excluded_begin &gt; next_included_begin
				To the hash, add all bytes between next_included_begin and next_excluded_begin minus one (inclusive)
			Set next_included_begin  = this subset array entry's length field plus next_excluded_begin
		If next_included_begin &lt; first_excluded_byte + excluded_byte_count
			To the hash, add all bytes between next_included_begin and first_excluded_byte + excluded_byte_count minus one (inclusive)
	Set offset = first_excluded_byte + excluded_byte_count</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_exclusion_list_profiles"><a class="anchor" href="#_exclusion_list_profiles"></a>18.6.2. Exclusion list profiles</h4>
<div class="sect4">
<h5 id="_basic_profile"><a class="anchor" href="#_basic_profile"></a>18.6.2.1. Basic profile</h5>
<div class="paragraph">
<p>Typical untimed media (e.g., still photos) and timed media (e.g., videos with or without audio tracks, whether fragmented or not) need only include the mandatory exclusions listed in <a href="#_exclusion_list_requirements">Exclusion List Requirements</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Editor&#8217;s Note</div>
<div class="paragraph">
<p>Additional recommended exclusions for other types of media should be added here as needed.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_soft_binding_2"><a class="anchor" href="#_soft_binding_2"></a>18.7. Soft Binding</h3>
<div class="paragraph">
<p>If a claim generator wishes to provide a soft binding for the asset&#8217;s content, it shall be described using a soft binding assertion. The types of soft bindings which can be created and stored in such an assertion are described in <a href="#_soft_bindings">Section 9.3, &#8220;Soft Bindings&#8221;</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>url</code> value provides flexibility for hashing assets that may be represented in multiple chunks or portions, local or remote.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A Soft Binding assertion shall have a label of <code>c2pa.soft-binding</code>.</p>
</div>
<div class="sect3">
<h4 id="_schema_and_example_4"><a class="anchor" href="#_schema_and_example_4"></a>18.7.1. Schema and Example</h4>
<div class="paragraph">
<p>The <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a> for this type is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">;The data structure used to store one or more soft bindings across some or all of the asset's content
soft-binding-map = {
  "alg": tstr, ; A string identifying the soft binding algorithm and version of that algorithm used 
              ; to compute the value, taken from the C2PA soft binding algorithm identifier list. If this field is absent, the algorithm is taken from the `softbinding-alg` value of the enclosing structure. If both are present, the field in this structure is used. 
              ; If no value is present in any of these places, this structure is invalid; there is no default.
  "blocks": [1* soft-binding-block-map],
  "pad": bytes, ; zero-filled byte string used for filling up space
  ? "pad2": bytes, ; optional zero-filled byte string used for filling up space
  ? "name": tstr .size (1..max-tstr-length), ; (optional) a human-readable description of what this hash covers
  ? "alg-params": bstr, ; (optional) CBOR byte string describing parameters of the soft binding algorithm. 
                        ; If this field is absent, the algorithm is taken from the `softbinding-alg-params` 
                        ; value of the enclosing structure, if present."
  ? "url": uri, ; (optional) a file or http(s) URL to where the bytes that are being hashed lived. 
                ; This is useful for cases where the data lives in a different file chunk or side-car 
                ; than the claim.
}

soft-binding-block-map = {
  "scope": soft-binding-scope-map,
  "value": bstr, ; CBOR byte string describing, in algorithm specific format, 
                ; the value of the soft binding computed over this block of digital content"
}

soft-binding-scope-map = {
  ? "extent": bstr, ;CBOR byte string describing, in algorithm specific format, 
                    ; the part of the digital content over which the soft binding value has been computed"
  ? "timespan":soft-binding-timespan-map,
}

soft-binding-timespan-map = {
  "start": uint, ; Start of the time range (as milliseconds from media start) over which the soft binding value has been computed.
  "end": uint,   ; End of the time range (as milliseconds from media start) over which the soft binding value has been computed.
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "alg": "phash",
  "pad": h'00',
  "url": 32("http://example.c2pa.org/media.mp4"),
  "blocks": [
    {
      "scope": {
        "extent": b64'c2NvcGUxCg==',
        "timespan": {
          "end": 133016
          "start": 0,
        }
      },
      "value": b64'dmFsdWUxCg=='
    },
    {
      "scope": {
        "extent": b64'YzJOdmNHVXlDZz09==',
        "timespan": {
          "end": 245009  
          "start": 133017,
        }
      },
      "value": b64'ZG1Gc2RXVXlDZz09=='
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The soft binding algorithm used shall be present as the value of the <code>alg</code> field, and the blocks over which is was applied shall be listed in the <code>blocks</code> field.  If the algorithm used requires any additional parameters, they should be present as the value of <code>alg-params</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cloud_data"><a class="anchor" href="#_cloud_data"></a>18.8. Cloud Data</h3>
<div class="paragraph">
<p>There are use cases where storing the data for the assertion remotely, such as in the cloud, is better than embedded inside the asset, especially when the data is large. For any such cases, it is possible to use a special type of assertion that serves as a reference to that information. For privacy and reliability reasons, data referenced through a Cloud Data assertion shall be considered optional: their contents should not be retrieved as part of manifest validation. A validator may retrieve the contents later to serve an application-dependent need, such as further exploration of the provenance history.</p>
</div>
<div class="paragraph">
<p>If <a href="#_metadata_about_assertions">assertion metadata</a> is included as part of another assertion, then it too would be part of the information referenced from a Cloud Data assertion.  It is also possible to store individual assertion metadata assertions remotely, just as with other assertion types.</p>
</div>
<div class="paragraph">
<p>A Cloud Data assertion shall have a label of <code>c2pa.cloud-data</code>.</p>
</div>
<div class="paragraph">
<p>A Cloud Data assertion must not refer to an assertion with the label <code>c2pa.hash.data</code>, <code>c2pa.hash.bmff</code> (deprecated), or <code>c2pa.hash.bmff.v2</code>.</p>
</div>
<div class="sect3">
<h4 id="_schema_and_example_5"><a class="anchor" href="#_schema_and_example_5"></a>18.8.1. Schema and Example</h4>
<div class="paragraph">
<p>The <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a> for this type is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; Assertion that references the actual assertion stored in the cloud
cloud-data-map = {
  "label": tstr, ; label for the cloud-based assertion (eg.c2pa.actions)
  "size": size-type, ; Number of bytes of data
  "location": $hashed-ext-uri-map, ; a file or http(s) URL to where the bytes that are being hashed can be found
  "content_type": tstr .regexp "^[-\\w.]+/[-+\\w.]+$", ; media/MIME type for the data
  ? "metadata": $assertion-metadata-map,  ; additional information about the assertion
}

; size is minimum 1 in multiples of 1.0
size-type = int .ge 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "size": 98765,
  "label": "c2pa.thumbnail.claim.jpg",
  "location": {
    "url": "https://some.storage.us/foo",
    "hash": b64'zP84FPSremIrAQHlhw+hRYQdZp/+KggnD0W8opXlIQQ='
  },
  "content_type": "application/jpeg"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To allow external references to content, this type uses the <code>hashed-ext-uri</code> type which is a variation on the <code>hashed-uri</code> type used elsewhere in this specification. The CDDL definition for <code>hashed-ext-uri</code> is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; The data structure used to store a reference to an external URL and its hash. We use a socket/plug here to allow hashed-ext-uri-map to be used in individual files without having the map defined in the same file
$hashed-ext-uri-map /= {
  "url": ext-url-regexp-type, ; http/https URI reference
  "alg": tstr .size (1..max-tstr-length), ; A string identifying the cryptographic hash algorithm used to compute all hashes in this claim, taken from the C2PA hash algorithm identifier list. Unlike alg fields in other types, this field is mandatory here.
  "hash": bstr, ;  byte string containing the hash value
}

; with CBOR Head (#) and tail ($) are introduced in regexp, so not needed explicitly
ext-url-regexp-type  /= tstr .regexp "https?:\/\/[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b[-a-zA-Z0-9@:%_\\+.~#?&amp;//=]*"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In keeping with common practice, it is recommended that the <code>https</code> scheme be used to retrieve assertion data to protect the privacy of the data in transit, but <code>http</code> is also permitted because the data&#8217;s integrity is protected by the <code>hash</code> field and this privacy may not be required in all circumstances. Authors of manifests with cloud-hosted data should choose the scheme to suit their needs.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_thumbnail"><a class="anchor" href="#_thumbnail"></a>18.9. Thumbnail</h3>
<div class="paragraph">
<p>A <strong>thumbnail</strong> assertion provides an approximate visual representation of the asset at a specific event in the lifecycle of an asset. There are currently two specific events:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ingredient import and claim creation</p>
</li>
<li>
<p>each using a unique label for the assertion.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For thumbnails created at claim creation time, the Thumbnail assertion shall have a label that starts with <code>c2pa.thumbnail.claim</code> and be followed by the <a href="https://www.iana.org/assignments/media-types/media-types.xhtml#image">IANA registry</a> image type (e.g., <code>c2pa.thumbnail.claim.png</code>). For each of these types of thumbnails, there can be only one per claim.</p>
</div>
<div class="paragraph">
<p>When importing an ingredient (see <a href="#_adding_ingredients">Section 10.3.2.2, &#8220;Adding Ingredients&#8221;</a>), it is preferable to reference that ingredient&#8217;s own manifest-stored thumbnail. However, some ingredients may not include a thumbnail assertion, or even a manifest. In that case, a new thumbnail of the ingredient should be generated, and a new thumbnail assertion in the active manifest created. The Thumbnail assertion shall have a label that starts with <code>c2pa.thumbnail.ingredient</code> and be followed by an underscore (<code>_</code> (U+005F)) then a unique ID such as a simple monotonically increasing integer and ending with the image type. For example, an ingredient thumbnail of type <code>jpeg</code> could have label <code>c2pa.thumbnail.ingredient_1.jpg</code>.</p>
</div>
<div class="paragraph">
<p>The data in a thumbnail assertion is the bits of a file (such as a raster image) in whatever format is desired by the claim generator. The Embedded File content type (ISO 19566-5:AMD-1), <code>bfdb</code>, shall be used to contain the thumbnail&#8217;s data.</p>
</div>
</div>
<div class="sect2">
<h3 id="_actions"><a class="anchor" href="#_actions"></a>18.10. Actions</h3>
<div class="paragraph">
<p>An <strong>actions</strong> assertion provides information on edits and other actions taken that affect the asset&#8217;s content. There will be an array of actions - each action declaring <em>what</em> took place on the asset, <em>when</em> it took place, along with possible other information such as what software performed the action.</p>
</div>
<div class="paragraph">
<p>An Actions assertion shall have a label of <code>c2pa.actions</code>, and there shall be no more than one Actions assertion per C2PA Manifest.</p>
</div>
<div class="paragraph">
<p>Actions are modelled after <a href="https://github.com/adobe/xmp-docs/blob/master/XMPNamespaces/XMPDataTypes/ResourceEvent.md">XMP ResourceEvents</a>.</p>
</div>
<div class="paragraph">
<p>For each action present in the array, the value of the <code>action</code> field shall be either a well-known common action name (<code>c2pa.resized</code>, <code>c2pa.edited</code>, etc.) or entity-specific action name (<code>adobe.ps.gaussian_blur</code>, etc.). The value of the <code>when</code> field should be the ISO 8601-compliant string of when the action was performed.</p>
</div>
<div class="paragraph">
<p>The set of defined names, prefixed with <code>c2pa.</code> are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 36.8421%;">
<col style="width: 63.1579%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Action</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.color_adjustments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changes to tone, saturation, etc.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.converted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The format of the asset was changed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.created</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The asset was first created, usually the asset&#8217;s origin.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.cropped</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Areas of the asset&#8217;s "editorial" content were cropped out.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.drawing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changes using drawing tools including brushes or eraser.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.edited</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generalized actions that would be considered 'editorial transformations' of the content.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.filtered</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changes to appearance with applied filters, styles, etc.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.opened</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An existing asset was opened and is being set as the <code>parentOf</code> ingredient.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.orientation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changes to the direction and position of content.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.placed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Added/Placed a <code>componentOf</code> ingredient into the asset.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.published</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Asset is released to a wider audience.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.removed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A <code>componentOf</code> ingredient was removed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.repackaged</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A conversion of one packaging or container format to another. Content is repackaged without transcoding. This action is considered as a 'non-editorial transformation' of the <code>parentOf</code> ingredient.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.resized</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changes to content dimensions and/or file size</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.transcoded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A conversion of one encoding to another, including resolution scaling, bitrate adjustment and encoding format change. This action is considered as a 'non-editorial transformation' of the <code>parentOf</code> ingredient.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.unknown</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Something happened, but the claim_generator cannot specify what.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An action may include an <code>actors</code> key which can point to the identity of one or more human actor who performed the action as described in <a href="#_common_data_model_actor">Section 18.17, &#8220;Common Data Model: Actor&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>When using a <code>c2pa.transcoded</code>, <code>c2pa.repackaged</code>, <code>c2pa.opened</code>, or a <code>c2pa.placed</code> action, the <code>ingredient</code> field in the <code>parameters</code> object shall contain the hashed JUMBF URI to the related ingredient assertion.  A <code>c2pa.removed</code> action may have the hashed JUMBF URI to an ingredient, if that ingredient is from a different manifest than the active one.</p>
</div>
<div class="sect3">
<h4 id="_asset_renditions"><a class="anchor" href="#_asset_renditions"></a>18.10.1. Asset Renditions</h4>
<div class="paragraph">
<p>Asset renditions are a common occurrence when distributing media on the internet. These renditions are often created for the purpose of delivering media to consumers in differing connectivity, screen resolution, and other environments. We can use the <code>actions</code> assertion to help consuming actors understand the intention of certain claim creators to create asset renditions.</p>
</div>
<div class="paragraph">
<p>The presence of only the <code>c2pa.published</code>, <code>c2pa.transcoded</code> and/or <code>c2pa.repackaged</code> actions in a <code>c2pa.actions</code> assertion provides a signal to the manifest consumer that the signer is asserting that no "editorial" changes have happened between the ingredient asset(s) and this one. Editorial changes are those that alter the intent and/or meaning of the content.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
These actions are the only ones supported as part of an <a href="#_endorsement_assertion">endorsement</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The additional presence of a single "parentOf" ingredient provides a further signal to the manifest consumer that the signer is asserting that the asset has been derived directly from that parent.</p>
</div>
</div>
<div class="sect3">
<h4 id="_deprecated_actions"><a class="anchor" href="#_deprecated_actions"></a>18.10.2. Deprecated Actions</h4>
<div class="paragraph">
<p>The following actions were part of previous versions of this specification and have since been deprecated.  Accordingly, they shall no longer be written into <code>c2pa.actions</code> assertions but may appear in pre-existing C2PA Manifests.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>c2pa.copied</p>
</li>
<li>
<p>c2pa.formatted</p>
</li>
<li>
<p>c2pa.version_updated</p>
</li>
<li>
<p>c2pa.printed</p>
</li>
<li>
<p>c2pa.managed</p>
</li>
<li>
<p>c2pa.produced</p>
</li>
<li>
<p>c2pa.saved</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_schema_and_example_6"><a class="anchor" href="#_schema_and_example_6"></a>18.10.3. Schema and Example</h4>
<div class="paragraph">
<p>The <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a> for this type is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">actions-map = {
  "actions" : [1* action-items-map],  ; list of actions
  ? "metadata": $assertion-metadata-map, ; additional information about the assertion
}


buuid = #6.37(bstr)

$action-choice /= "c2pa.color_adjustments"
$action-choice /= "c2pa.converted"
$action-choice /= "c2pa.copied"
$action-choice /= "c2pa.created"
$action-choice /= "c2pa.cropped"
$action-choice /= "c2pa.drawing"
$action-choice /= "c2pa.edited"
$action-choice /= "c2pa.filtered"
$action-choice /= "c2pa.formatted"
$action-choice /= "c2pa.managed"
$action-choice /= "c2pa.opened"
$action-choice /= "c2pa.orientation"
$action-choice /= "c2pa.produced"
$action-choice /= "c2pa.placed"
$action-choice /= "c2pa.printed"
$action-choice /= "c2pa.published"
$action-choice /= "c2pa.removed"
$action-choice /= "c2pa.repackaged"
$action-choice /= "c2pa.resized"
$action-choice /= "c2pa.saved"
$action-choice /= "c2pa.transcoded"
$action-choice /= "c2pa.unknown"
$action-choice /= "c2pa.version_updated"

actor-map = {
  ? "credentials": [1* $hashed-uri-map / $hashed-ext-uri-map],
  ? "identifier": tstr .size (1..max-tstr-length), ; An identifier for a human actor
}

action-items-map = {
  "action": $action-choice,
  ? "when": tdate, ; Timestamp of when the action occurred. 
  ? "softwareAgent": tstr .size (1..max-tstr-length), ;The software agent that performed the action.
  ? "changed": tstr .size (1..max-tstr-length), ; A semicolon-delimited list of the parts of the resource that were changed since the previous event history. If not present, presumed to be undefined. When tracking changes and the scope of the changed components is unknown, it should be assumed that anything might have changed.
  ? "instanceID": buuid, ; The value of the xmpMM:InstanceID property for the modified (output) resource
  ? "parameters": parameters-map, ; Additional parameters of the action. These will often vary by the type of action
  ? "actors": [1* actor-map], ; An array of the creators that undertook this action
}

parameters-map = {
  ? "ingredient": $hashed-uri-map, ; A hashed-uri to the ingredient assertion that this action acts on
  ? "description": tstr .size (1..max-tstr-length) ; Additional description of the action
  * tstr =&gt; any
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "actions": [
    {
      "when": 0("2020-02-11T09:00:00Z"),
      "action": "c2pa.filtered",
      "actors": [
        {
          "credentials": [
            {
              "url": "self#jumbf=c2pa/urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.credentials/Joe_Bloggs",
              "alg": "sha256",
              "hash": b64'hoOspQQ1lFTy/4Tp8Epx670E5QW5NwkNR+2b30KFXug='
            }
          ]
        }
      ]
      "changed": "change1;change2",
      "instanceID": 37(h'ed610ae51f604002be3dbf0c589a2f1f'),
      "softwareAgent": "Joe's Photo Editor 2020 for Windows",
    }
  ],
  "metadata": {
    "dateTime": 0("2021-06-28T16:34:11.457Z"),
    "reviewRating": [
      {
        "value": 1,
        "explanation": "Content bindings did not validate"
      }
    ]
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ingredient"><a class="anchor" href="#_ingredient"></a>18.11. Ingredient</h3>
<div class="paragraph">
<p>When assets are composed together, for example placing an image into a layer in Photoshop or an audio clip into a video in Premiere, it is important that information about any claim from the placed asset be recorded into the new asset to provide a way to understand the entire history of the new composed asset. This is also true when an existing asset is used to create a derived asset or asset rendition.</p>
</div>
<div class="paragraph">
<p>An Ingredient assertion shall have a label of <code>c2pa.ingredient</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Since there will most likely be more than one ingredient assertion, the use of the monotonically increasing index in the label would be used (e.g., <code>c2pa.ingredient__1</code>, <code>c2pa.ingredient__2</code>).
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_concept"><a class="anchor" href="#_concept"></a>18.11.1. Concept</h4>
<div class="paragraph">
<p>The concept of ingredients in C2PA is modelled on the XMP Ingredient and Pantry model, as described in the <a href="https://wwwimages2.adobe.com/content/dam/acom/en/devnet/xmp/pdfs/DynamicMediaXMPPartnerGuide.pdf">Partner Guide to XMP for Dynamic Media</a> and <a href="http://wwwimages.adobe.com/content/dam/acom/en/products/xmp/Pdfs/XMPAssetRelationships.pdf">Asset Relationships in XMP</a>. That model relies on the fact that each asset used in the construction of a document has, at the time of inclusion, at least one <a href="#_unique_identifiers">unique identifier</a>.</p>
</div>
<div class="paragraph">
<p>If the ingredient being added contains XMP, then the asset&#8217;s <code>xmpMM:DocumentID</code> becomes the <code>documentID</code> field while the <code>xmpMM:InstanceID</code> becomes the <code>instanceID</code>. However, if the ingredient being added does not have any associated XMP, then it may be possible for the XMP to be created and added to the ingredient itself and the identifiers used as described above.</p>
</div>
<div class="paragraph">
<p>When it is not possible or desirable to create XMP for an ingredient, then some other <a href="#_unique_identifiers">unique identifier</a> for the ingredient shall be used instead for the required values. In this situation, the <code>instanceID</code> field shall contain the unique identifier and the <code>documentID</code> field shall not be present.</p>
</div>
</div>
<div class="sect3">
<h4 id="_relationship"><a class="anchor" href="#_relationship"></a>18.11.2. Relationship</h4>
<div class="paragraph">
<p>When adding an ingredient, its relationship to the current asset shall be described. These are the possible values of the <code>relationship</code> field and their meanings:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>parentOf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The current asset is a derived asset or asset rendition of this ingredient. This relationship value is also used with <a href="#_update_manifests">update manifests</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>componentOf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The current asset is composed of multiple parts, this ingredient being one of them.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_title"><a class="anchor" href="#_title"></a>18.11.3. Title</h4>
<div class="paragraph">
<p>The value of <code>dc:title</code> shall be a human-readable name for the ingredient, which may be taken either from the asset&#8217;s XMP or the asset&#8217;s name in a local or remote (e.g., cloud-based) filesystem. The <a href="https://www.iana.org/assignments/media-types/media-types.xhtml">Media Type</a> of the ingredient shall be declared in <code>dc:format</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="ingredient_schema"><a class="anchor" href="#ingredient_schema"></a>18.11.4. Schema and Example</h4>
<div class="paragraph">
<p>The <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a> for this type is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">;Assertion that describes an ingredient used in the asset
ingredient-map = {
  "dc:title": tstr, ; name of the ingredient
  "dc:format": format-string, ; Media Type of the ingredient
  ? "documentID": tstr, ; value of the ingredient's `xmpMM:DocumentID`
  "instanceID": tstr, ; unique identifier, such as the value of the ingredient's `xmpMM:InstanceID`
  "relationship": $relation-choice, ; The relationship of this ingredient to the asset it is an ingredient of.
                                        ; For example, if an ingredient with a 'parentOf' relationship is added to
                                        ; an asset, then the asserter is stating that the current asset is a derived asset of the ingredient.
  ? "c2pa_manifest": $hashed-uri-map, ; hashed_uri reference to the C2PA Manifest of the ingredient
  ? "thumbnail": $hashed-uri-map, ; hashed_uri reference to an ingredient thumbnail
  ? "validationStatus": [1* $status-map] ; validation status of the ingredient
  ? "metadata": $assertion-metadata-map ; additional information about the assertion
}

format-string = tstr .regexp "^\\w+\/[-+.\\w]+$"
; Assertion that describes an ingredient used in the asset
$relation-choice /= "parentOf"
$relation-choice /= "componentOf"

; Success codes
$status-code /= "claimSignature.validated"
$status-code /= "signingCredential.trusted"
$status-code /= "timeStamp.trusted"
$status-code /= "assertion.hashedURI.match"
$status-code /= "assertion.dataHash.match"
$status-code /= "assertion.bmffHash.match"
$status-code /= "assertion.accessible"

; Failure codes
$status-code /= "claim.missing"
$status-code /= "claim.multiple"
$status-code /= "claim.hardBindings.missing"
$status-code /= "claim.required.missing"
$status-code /= "claim.cbor.invalid"
$status-code /= "ingredient.hashedURI.mismatch"
$status-code /= "claimSignature.missing"
$status-code /= "claimSignature.mismatch"
$status-code /= "manifest.multipleParents"
$status-code /= "manifest.update.invalid"
$status-code /= "manifest.update.wrongParents"
$status-code /= "signingCredential.untrusted"
$status-code /= "signingCredential.invalid"
$status-code /= "signingCredential.revoked"
$status-code /= "signingCredential.expired"
$status-code /= "timeStamp.mismatch"
$status-code /= "timeStamp.untrusted"
$status-code /= "timeStamp.outsideValidity"
$status-code /= "assertion.hashedURI.mismatch"
$status-code /= "assertion.missing"
$status-code /= "assertion.multipleHardBindings"
$status-code /= "assertion.undeclared"
$status-code /= "assertion.inaccessible"
$status-code /= "assertion.notRedacted"
$status-code /= "assertion.selfRedacted"
$status-code /= "assertion.required.missing"
$status-code /= "assertion.json.invalid"
$status-code /= "assertion.cbor.invalid"
$status-code /= "assertion.action.ingredientMismatch"
$status-code /= "assertion.action.redacted"
$status-code /= "assertion.dataHash.mismatch"
$status-code /= "assertion.bmffHash.mismatch"
$status-code /= "assertion.cloud-data.hardBinding"
$status-code /= "assertion.cloud-data.actions"
$status-code /= "algorithm.unsupported"
$status-code /= "general.error" ; when nothing else applies

status-map = {
  "code": $status-code, ; A label-formatted string that describes the status
  ? "url": url-regexp-type, ; JUMBF URI reference
  ? "explanation": tstr .size (1..max-tstr-length), ; A human readable string explaining the status
  ? "success": bool ; does the code reflect success (true) or failure (false)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "dc:title": "image 1.jpg",
  "metadata": {
    "dateTime": 0("2021-06-28T16:49:32.874Z"),
    "reviewRating": [
      {
        "value": 5,
        "explanation": "Content bindings validated"
      }
    ]
  }
  "dc:format": "image/jpeg",
  "thumbnail" : {
      "url": "self#jumbf=cp2a/urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.thumbnail.ingredient_1.jpg",
      "hash": b64'UjRAYWiAq4lfCRDmksWAlDJN/XtHHFFwMWymsZsm3j8='
  },
  "documentID" : "uuid:87d51599-286e-43b2-9478-88c79f49c347",
  "instanceID" : "uuid:7b57930e-2f23-47fc-affe-0400d70b738d",
  "relationship": "parentOf",
  "c2pa_manifest" : {
      "url": "self#jumbf=c2pa/urn:uuid:5E7B01FC-4932-4BAB-AB32-D4F12A8AA322",
      "hash": b64'1kjJTO108b71cL95UxgfHD3eDgk9VrCedW8n3fYTRMk='
  },
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_thumbnails"><a class="anchor" href="#_thumbnails"></a>18.11.5. Thumbnails</h4>
<div class="paragraph">
<p>When adding an ingredient, it may be useful to also include a thumbnail of the ingredient to help establish the state of the ingredient at the time of import. For that purpose, an ingredient import thumbnail should be added as described in <a href="#_thumbnail">Section 18.9, &#8220;Thumbnail&#8221;</a> and referenced herein via a URI reference.</p>
</div>
</div>
<div class="sect3">
<h4 id="_existing_manifests"><a class="anchor" href="#_existing_manifests"></a>18.11.6. Existing manifests</h4>
<div class="paragraph">
<p>If the ingredient has an existing C2PA Manifest Store, then all C2PA Manifests in the store (both standard and updates) shall be copied into the C2PA Manifest Store for the asset. The <a href="#_uri_references">URI reference</a> to the ingredient&#8217;s active <a href="#_c2pa_box_details">C2PA Manifest</a> shall be stored as the value of <code>c2pa_manifest</code>.</p>
</div>
<div class="sect4">
<h5 id="_ingredient_validation"><a class="anchor" href="#_ingredient_validation"></a>18.11.6.1. Ingredient validation</h5>
<div class="paragraph">
<p>In addition, it is recommended that the C2PA validator validate the ingredient&#8217;s active C2PA Manifest and document the validation status in the <code>validationStatus</code> field. When present, the value of the <code>validationStatus</code> field shall contain at least one entry in the array.</p>
</div>
<div class="paragraph">
<p>Each object in the <code>validationStatus</code> array consists of a <code>code</code> value that describes the validation status of a specific part of the manifest along with an optional <code>success</code> boolean value representing if the code reflect success (true) or failure (false). A optional <code>url</code> field with a JUMBF URI reference to that element in the manifest may be present. Depending on the code, the <code>url</code> could be to a claim, a claim signature or a specific assertion. An optional description of the validation status may be present in the <code>explanation</code> field if there is a need for an additional human readable explanation.</p>
</div>
<div class="paragraph">
<p>Custom status codes are also permitted, when a claim generator has a need to record some process-specific status information.  The code shall conform to the same syntax as <a href="#_labels">custom labels</a>, e.g. <code>com.litware</code> and the <code>validationStatus</code> object shall contain a <code>success</code> boolean. Status codes are defined in <a href="#_status_codes">Section 15.1, &#8220;Status Codes&#8221;</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_depthmap"><a class="anchor" href="#_depthmap"></a>18.12. Depthmap</h3>
<div class="paragraph">
<p>A Depthmap assertion provides a 3D description of the scene being captured by a camera. A Depthmap assertion may contain a pre-computed <a href="https://en.wikipedia.org/wiki/Depth_map">depth map</a>, or data which can later be used to compute a depth map by downstream ingestion or viewing software (e.g., left/right stereo images).</p>
</div>
<div class="paragraph">
<p>All Depthmap assertions shall have a label that starts with <code>c2pa.depthmap</code> and be followed by a third section that identifies the type of depth map.</p>
</div>
<div class="paragraph">
<p>C2PA Depthmap assertions shall be captured optically, not inferred from a single 2D image via, for example, a machine learning model.</p>
</div>
<div class="sect3">
<h4 id="_gdepth_depthmap"><a class="anchor" href="#_gdepth_depthmap"></a>18.12.1. GDepth Depthmap</h4>
<div class="paragraph">
<p>A GDepth depth map assertion leverages the well-established <a href="https://developers.google.com/depthmap-metadata/reference">GDepth format</a> to encode a pre-computed depth map.</p>
</div>
<div class="paragraph">
<p>A GDepth Depthmap assertion shall have a label of <code>c2pa.depthmap.GDepth</code>.</p>
</div>
<div class="paragraph">
<p>The schema for the data stored in this assertion should always mirror the schema at <a href="https://developers.google.com/depthmap-metadata/reference" class="bare">https://developers.google.com/depthmap-metadata/reference</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
There is no need to worry about splitting up the GDepth data when it grows beyond 64KB, as that limit existed in XMP to accommodate APP1 segment size limitations.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_schema_and_example_7"><a class="anchor" href="#_schema_and_example_7"></a>18.12.2. Schema and Example</h4>
<div class="paragraph">
<p>The <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a> for this type is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; Assertion that encodes a GDepth-formatted 3D depth map of the captured scene
depthmap-gdepth-map = {
  "GDepth:Format": format-type, ; The format that describes how to convert the depthmap data into a valid float-point depthmap. Current valid values are 'RangeInverse' and 'RangeLinear'
  "GDepth:Near": float, ; The near value of the depthmap in depth units
  "GDepth:Far": float,  ; The far value of the depthmap in depth units
  "GDepth:Mime": mime-type,  ;  The mime type for the base64 string describing the depth image content, e.g. 'image/jpeg' or 'image/png'",
  "GDepth:Data": base64-string-type,  ; The base64 encoded depth image. Please see GDepth encoding page at developers.google.com. The depthmap will be stretched-to-fit the corresponding color image
  ? "GDepth:Units": unit-type,   ; The units of the depthmap, e.g. 'm' for meters or 'mm' for millimeters
  ? "GDepth:MeasureType": depth-meas-type,  ; The type of depth measurement. Current valid values are 'OpticalAxis' and 'OpticRay
  ? "GDepth:ConfidenceMime": confidence-mime-type,  ; The mime type for the base64 string describing the confidence image content, e.g. 'image/png'.",
  ? "GDepth:Confidence": base64-string-type,   ; The base64 encoded confidence image. Please see GDepth encoding page at developers.google.com. The confidence map should have the same size as the depthmap
  ? "GDepth:Manufacturer": tstr .size (1..max-tstr-length),  ; The manufacturer of the device that created this depthmap
  ? "GDepth:Model": tstr .size (1..max-tstr-length),  ; The model of the device that created this depthmap
  ? "GDepth:Software": tstr .size (1..max-tstr-length), ; The software that created this depthmap
  ? "GDepth:ImageWidth": float, ; The width in pixels of the original color image associated to this depthmap. This is NOT the depthmap width. If present, apps must update this property when scaling, cropping or rotating the color image. Clients use this property to verify the integrity of the depthmap w.r.t. the color image
  ? "GDepth:ImageHeight": float, ; The height in pixels of the original color image associated to this depthmap. This is NOT the depthmap height. If present, apps must update this property when scaling, cropping or rotating the color image. Clients use this property to verify the integrity of the depthmap w.r.t. the color image
  ? "metadata": $assertion-metadata-map, ; additional information about the assertion
}

base64-string-type = tstr

$mime-choice /= "image/jpeg" 
$mime-choice /= "image/png"

mime-type = $mime-choice .default "image/jpeg"
confidence-mime-type = $mime-choice .default "image/png"

$format-choice /= "RangeInverse"
$format-choice /= "RangeLinear"

format-type = $format-choice .default "RangeInverse"

; Unit can be meter represented as "m" or could be millimeter represented as "mm"
$unit-choice /= "m"
$unit-choice /= "mm"
unit-type = $unit-choice .default "m"

$depth-meas-choice /= "OpticalAxis"
$depth-meas-choice /= "OpticRay"
depth-meas-type = $depth-meas-choice .default "OpticalAxis"</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "GDepth:Far": 878.7,
  "GDepth:Data": "hoOspQQ1lFTy/4Tp8Epx670E5QW5NwkNR+2b30KFXug=",
  "GDepth:Mime": "image/jpeg",
  "GDepth:Near": 29.3,
  "GDepth:Model": "CameraCompany Shooter S1",
  "GDepth:Units": "mm",
  "GDepth:Format": "RangeInverse",
  "GDepth:Software": "Truepic Foresight Firmware for QC QRD8250 v0.01",
  "GDepth:Confidence": "acdbpQQ1lFTy/4Tp8Epx670E5QW5NwkNR+2b30KFXug=",
  "GDepth:ImageWidth": 32.2,
  "GDepth:ImageHeight": 43.6
  "GDepth:MeasureType": "OpticalAxis",
  "GDepth:Manufacturer": "CameraCompany",
  "GDepth:ConfidenceMime": "image/png",
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As defined by the GDepth specification, the following fields shall be present in all GDepth depth map assertions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>GDepth:Format</p>
</li>
<li>
<p>GDepth:Near</p>
</li>
<li>
<p>GDepth:Far</p>
</li>
<li>
<p>GDepth:Mime</p>
</li>
<li>
<p>GDepth:Data</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_endorsement_assertion"><a class="anchor" href="#_endorsement_assertion"></a>18.13. Endorsement Assertion</h3>
<div class="paragraph">
<p>An endorsement is a way of indicating approval for specific actions made on content after it has had a manifest attached (see <a href="#_action_endorsement">[_action_endorsement]</a>). The Endorsement assertion is where an endorsement from the signer of an ingredient asset is stored. These endorsements are typically provided (out-of-band of this specification) by ingredient asset signers to actors those signers trust to perform the actions listed in <a href="#_action_endorsement">[_action_endorsement]</a>. They are used by a validator when assessing whether the actions of the active manifest are "endorsed" or not (see <a href="#_validate_the_endorsements">endorsement validation</a>).</p>
</div>
<div class="paragraph">
<p>To attach an endorsement, a claim generator must ensure that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>only the actions listed in the <a href="#_action_endorsement">[_action_endorsement]</a> section are present in the <code>actions</code> assertion</p>
</li>
<li>
<p>exactly one ingredient assertion is present in the assertion store, and,</p>
</li>
<li>
<p>that ingredient is the one referenced by the actions assertion&#8217;s <code>parameters.ingredient</code> field</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An Endorsement assertion shall have a label of <code>c2pa.endorsement</code>, and there shall be at most one Endorsement assertion per manifest. The assertion contents shall be a <code>COSE_Sign1_Tagged</code> structure that is created as defined in <a href="#_endorsement_generation">Section 14.7.1, &#8220;Endorsement Generation&#8221;</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_exif_information"><a class="anchor" href="#_exif_information"></a>18.14. Exif Information</h3>
<div class="paragraph">
<p>The <strong>Exif Information</strong> assertion can be used to ensure that Exif information, for example about the capture device, is added to the asset in a way that can be validated cryptographically. It is preferable to copy this information from the <code>Exif</code> block or from the <a href="https://github.com/adobe/xmp-docs/blob/master/XMPNamespaces/exif.md">Exif namespace</a> of the XMP block. Information should be copied to JSON-LD using the XMP field names specified in the <a href="https://www.cipa.jp/std/documents/download_e.html?DC-010-2020_E">Exif 2.32 metadata for XMP</a> specification. When copying the information from XMP, the data shall be re-serialized according to the rules of the <a href="https://www.iso.org/standard/79384.html">JSON-LD serialization of XMP</a>.</p>
</div>
<div class="paragraph">
<p>An Exif Information assertion shall have a label of <code>stds.exif</code>.</p>
</div>
<div class="paragraph">
<p>Any property from the <a href="https://www.cipa.jp/std/documents/download_e.html?DC-008-Translation-2019-E">latest version of the Exif specification (currently 2.32)</a> can be added to the stds.exif assertion, with the exception of the MakerNote (37500, 0x927c) field, the contents of which are vendor-specific.</p>
</div>
<div class="paragraph">
<p>This assertion should be used to assert the precise location associated with the content using the Exif GPS properties (those starting <code>exif:GPS</code>). For broad information about the location, see <a href="#_iptc_photo_metadata">Section 18.15, &#8220;IPTC Photo Metadata&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>An example of an Exif Information assertion:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "@context" : {
    "dc": "http://purl.org/dc/elements/1.1/",
    "exifEX": "http://cipa.jp/exif/2.32/",
    "exif": "http://ns.adobe.com/exif/1.0/",
    "tiff": "http://ns.adobe.com/tiff/1.0/",
    "xmp": "http://ns.adobe.com/xap/1.0/",
    "rdf": "http://www.w3.org/1999/02/22-rdf-syntax-ns#"
  },
  "exif:GPSVersionID": "2.2.0.0",
  "exif:GPSLatitude": "39,21.102N",
  "exif:GPSLongitude": "74,26.5737W",
  "exif:GPSAltitudeRef": 0,
  "exif:GPSAltitude": "100963/29890",
  "exif:GPSTimeStamp": "2019-09-22T18:22:57Z",
  "exif:GPSSpeedRef": "K",
  "exif:GPSSpeed": "4009/161323",
  "exif:GPSImgDirectionRef": "T",
  "exif:GPSImgDirection": "296140/911",
  "exif:GPSDestBearingRef": "T",
  "exif:GPSDestBearing": "296140/911",
  "exif:GPSHPositioningError": "13244/2207",
  "exif:ExposureTime": "1/100",
  "exif:FNumber": 4.0,
  "exif:ColorSpace": 1,
  "exif:DigitalZoomRatio": 2.0,
  "tiff:Make": "CameraCompany",
  "tiff:Model": "Shooter S1",
  "exifEX:LensMake": "CameraCompany",
  "exifEX:LensModel": "17.0-35.0 mm",
  "exifEX:LensSpecification": { "@list": [ 1.55, 4.2, 1.6, 2.4 ] }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Although the redaction process works in such a way that only an entire assertion can be redacted (see <a href="#_redaction_of_assertions">Section 6.7, &#8220;Redaction of Assertions&#8221;</a>), the use of an <a href="#_update_manifests">update manifest</a> enables partial redaction by removing the original and then placing the new, reduced, versions in the update manifest. This new assertion would be presented in a <a href="#_user_experience">user experience</a> in association with the signer of the update manifest and not with the signer of the C2PA Manifest that has been redacted.</p>
</div>
<div class="paragraph">
<p>For example, an assertion containing both location data and camera information which may need to have the location data redacted which could be done through an update manifest with a new <code>stds.exif</code> assertion with only the camera information.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_iptc_photo_metadata"><a class="anchor" href="#_iptc_photo_metadata"></a>18.15. IPTC Photo Metadata</h3>
<div class="paragraph">
<p>The <a href="https://iptc.org/">International Press Telecommunications Council</a> defines a standard set of descriptive, administrative and rights metadata typically used by photographers, distributors, news organizations, archivists, and developers. Early versions of the standard used IPTC&#8217;s binary <a href="https://www.iptc.org/standards/iim/">Information Interchange Model (IPTC-IIM)</a> format and later versions introduced XMP support for all IIM fields, plus a new set of fields which can only be expressed in XMP. Together, these are called the <a href="http://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata">IPTC Photo Metadata Standard</a>.</p>
</div>
<div class="paragraph">
<p>The IPTC Photo Metadata assertion can be used to ensure that IPTC Photo Metadata, for example describing ownership, rights and descriptive metadata about an image, is added to the asset in a way that can be validated cryptographically.</p>
</div>
<div class="paragraph">
<p>It is preferable to copy this information from the IPTC-IIM or XMP block. Information should be copied to JSON-LD using the XMP field names specified in the <a href="https://www.cipa.jp/std/documents/download_e.html?DC-010-2020_E">Exif 2.32 metadata for XMP</a> specification. When copying the information from XMP, the data shall be re-serialized according to the rules of the <a href="https://www.iso.org/standard/79384.html">JSON-LD serialization of XMP</a>.</p>
</div>
<div class="paragraph">
<p>IPTC Photo Metadata properties can be copied to the C2PA assertion store as an assertion with the label <code>stds.iptc.photo-metadata</code>. The data should be in JSON-LD format using the XMP field names and structures specified in the <a href="http://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata#metadata-properties-2">IPTC Photo Metadata Specification</a>.</p>
</div>
<div class="paragraph">
<p>Any property from the <a href="http://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata">IPTC Photo Metadata Standard</a> can be added to the <code>stds.iptc.photo-metadata</code> assertion.</p>
</div>
<div class="paragraph">
<p>In particular, the Location Created property can be used to assert the broad location associated with an asset. To assert the precise GPS location associated with an asset, the <a href="#_exif_information">Exif information</a> assertion should be used.</p>
</div>
<div class="paragraph">
<p>An example of an IPTC Photo Metadata assertion including location information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "@context" : {
    "Iptc4xmpCore": "http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/",
    "Iptc4xmpExt": "http://iptc.org/std/Iptc4xmpExt/2008-02-29/",
    "dc" : "http://purl.org/dc/elements/1.1/",
    "photoshop" : "http://ns.adobe.com/photoshop/1.0/",
    "plus" : "http://ns.useplus.org/ldf/xmp/1.0/",
    "xmp" : "http://ns.adobe.com/xap/1.0/",
    "xmpRights" : "http://ns.adobe.com/xap/1.0/rights/"
  },
  "photoshop:DateCreated": "Aug 31, 2022", <i class="conum" data-value="1"></i><b>(1)</b>
  "dc:creator": [ "Julie Smith" ], <i class="conum" data-value="2"></i><b>(2)</b>
  "dc:rights": "Copyright (C) 2022 Example Photo Agency. All Rights Reserved.", <i class="conum" data-value="3"></i><b>(3)</b>
  "photoshop:Credit": [ "Julie Smith/Example Photo Agency via Example Distributor" ], <i class="conum" data-value="4"></i><b>(4)</b>
  "plus:licensor": [ <i class="conum" data-value="5"></i><b>(5)</b>
    {
      "plus:LicensorName": "Example Photo Agency",
      "plus:LicensorURL": "http://examplephotoagency.com/images/"
    }
  ],
  "xmpRights:WebStatement": "http://examplephotoagency.com/terms.html", <i class="conum" data-value="6"></i><b>(6)</b>
  "xmpRights:UsageTerms": [
    "Not for online publication. Germany OUT" <i class="conum" data-value="7"></i><b>(7)</b>
  ],
  "Iptc4xmpExt:LocationCreated": { <i class="conum" data-value="8"></i><b>(8)</b>
    "Iptc4xmpExt:City": "San Francisco"
  },
  "Iptc4xmpExt:PersonInImage": [ <i class="conum" data-value="9"></i><b>(9)</b>
    "Erika Fictional"
  ]
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><a href="https://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata#date-created">Date Created</a></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><a href="https://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata#creator">Creator</a></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><a href="https://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata#copyright-notice">Copyright Notice</a></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><a href="https://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata#credit-line">Credit Line</a></td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><a href="https://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata#licensor">Licensor</a></td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><a href="https://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata#web-statement-of-rights">Web Statement of Rights</a></td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td><a href="https://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata#rights-usage-terms">Rights Usage Terms</a></td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td><a href="https://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata#location-created">Location Created</a></td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td><a href="https://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata#person-shown-in-the-image">Person Shown in the Image</a></td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Although the redaction process works in such a way that only an entire assertion can be redacted (see <a href="#_redaction_of_assertions">Section 6.7, &#8220;Redaction of Assertions&#8221;</a>), the use of an <a href="#_update_manifests">update manifest</a> enables partial redaction by removing the original and then placing the new, reduced, versions in the update manifest.  <a href="#_user_experience">User Experiences</a> would present this new assertion with the signer of the update manifest and not with the signer of the C2PA Manifest that has been redacted.</p>
</div>
<div class="paragraph">
<p>For example, an assertion containing location properties, creator name and other information  may need to have the creator name redacted which could be done through an update manifest with a new <code>stds.iptc.photo-metadata</code> assertion with the other information still present.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_use_of_schema_org"><a class="anchor" href="#_use_of_schema_org"></a>18.16. Use of Schema.org</h3>
<div class="paragraph">
<p><a href="https://schema.org/">Schema.org</a> is a collaborative, community activity with a mission to create, maintain, and promote schemas for structured data on the Internet. As such, they provide numerous JSON-based grammars that one may wish to include as an assertion. When using a schema.org type as a C2PA assertion, we require a full JSON-LD serialisation. Thus, the top-level <code>@context</code> field must have a value of <code><a href="http://schema.org" class="bare">http://schema.org</a></code>.</p>
</div>
<div class="paragraph">
<p>All Schema.org assertions shall have a label that starts with <code>schema.org</code> and be followed by the name of the schema that is being used. For example, <code>schema.org.ImageObject</code> can be used to include something extra about an image. Since schemas on <a href="https://schema.org/">Schema.org</a> are not versioned as described <a href="https://schema.org/docs/howwework.html">here</a>, no version indicator is used in their labels.</p>
</div>
<div class="sect3">
<h4 id="_claim_review"><a class="anchor" href="#_claim_review"></a>18.16.1. Claim Review</h4>
<div class="paragraph">
<p>A schema that is used by the publishing community for web sites has <a href="https://www.blog.google/products/search/bringing-fact-check-information-google-images/">recently also been introduced for images</a>. A <a href="https://schema.org/ClaimReview">ClaimReview</a> is used as 'A fact-checking review of claims made (or reported) in some creative work (referenced via itemReviewed).'</p>
</div>
<div class="paragraph">
<p>A ClaimReview assertion shall have a label of <code>stds.schema-org.ClaimReview</code>.</p>
</div>
<div class="paragraph">
<p>Inside the assertion (which, as described previously, is serialised as JSON-LD), the top-level <code>@type</code> field should be set to a value of <code>ClaimReview</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The "Claim" in ClaimReview refers to a "claim made (or reported) in some creative work", not the C2PA claim. ClaimReview assertions can be used as a way to mark the current asset as a review of the claims of another work, not any specific part of the C2PA manifest. To provide a review of a specific assertion, use an <a href="#_metadata_about_assertions">assertion metadata assertion</a>.
As an example: an image infographic has been assembled that fact-checks some other claim that is currently in public distribution. The image infographic includes a ClaimReview assertion which references the text of the claim its reviewing, a fact-checking rating of the claim, and zero to many links to other works (e.g., articles, videos, images) that are making that claim.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The reviewRating property inside the ClaimReview assertion is of type <a href="https://schema.org/Rating">Rating</a>. Depending on how an organisation does fact-checking reviews, it may have a numerical rating, a true or false, or some other textual description of how the asset has reviewed a claim. <a href="https://www.claimreviewproject.com/user-guide" class="bare">https://www.claimreviewproject.com/user-guide</a> provides a good guide on how to use the ClaimReview vocabulary.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>reviewRating</code> property in a ClaimReview is not the same as the <a href="#_review_ratings"><code>reviewRatings</code> field</a> in the assertion metadata.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A partial <a href="https://json-schema.org/">JSON Schema</a> for this type is:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This schema does not validate all aspects of the referenced schema.org types (just the top-level ClaimReview and Review properties). Please refer to <a href="https://schema.org" class="bare">https://schema.org</a> for the details on referenced types, and <a href="https://json-ld.org/" class="bare">https://json-ld.org/</a> for how to reference them in the assertion.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "http://ns.c2pa.org/claim_review/v1",
  "type": "object",
  "description": "Assertion that describes a fact-checking review of claims made (or reported) in some creative work (referenced via itemReviewed).",
  "examples": [
    {
      "@context": "http://schema.org",
      "@type": "ClaimReview",
      "claimReviewed": "The world is flat",
      "reviewRating": {
        "@type": "Rating",
        "ratingValue": "1",
        "bestRating": "5",
        "worstRating": "1",
        "ratingExplanation": "The world is not flat",
        "alternateName": "False"
      },
      "itemReviewed": {
        "@type": "CreativeWork",
        "author": {
          "@type": "Person",
          "name": "A N Other"
        },
        "headline": "Earth: Flat."
      }
    }
  ],
  "anyOf": [
    {
      "$ref": "https://json.schemastore.org/schema-org-thing.json"
    }
  ],
  "properties": {
    "claimReviewed": {
      "type": "string",
      "minLength": 1,
      "description": "A short summary of the specific claims reviewed in a ClaimReview."
    },
    "reviewAspect": {
      "type": "string",
      "minLength": 1,
      "description": "From http://schema.org/Review: This Review or Rating is relevant to this part or facet of the itemReviewed."
    },
    "reviewBody": {
      "type": "string",
      "minLength": 1,
      "description": "From http://schema.org/Review: The actual body of the review."
    },
    "reviewRating": {
      "description": "From http://schema.org/Review: The rating given in this review. Note that reviews can themselves be rated. The reviewRating applies to rating given by the review. The aggregateRating property applies to the review itself, as a creative work.",
      "anyOf": [
        {
          "$ref": "https://json.schemastore.org/jsonld#"
        }
      ]
    },
    "itemReviewed": {
      "description": "From http://schema.org/Review: The item that is being reviewed/rated.",
      "anyOf": [
        {
          "$ref": "https://json.schemastore.org/jsonld#"
        }
      ]
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_creative_work"><a class="anchor" href="#_creative_work"></a>18.16.2. Creative Work</h4>
<div class="paragraph">
<p>Schema.org provides a well-known and well-deployed set of types and metadata fields. One of the core types is <a href="https://schema.org/CreativeWork">CreativeWork</a>, which is intended to describe any representation of creative effort. This assertion allows an asserter to provide various pieces of information about the asset, including who they are, and the date/time of publication.</p>
</div>
<div class="paragraph">
<p>A Creative Work assertion shall have a label of <code>stds.schema-org.CreativeWork</code>.</p>
</div>
<div class="paragraph">
<p>Inside the assertion (which, as described previously, is serialised as JSON-LD), the top-level <code>@type</code> field should be set to a value of <code>CreativeWork</code>. The JSON-LD document&#8217;s root subject is the bound asset of the claim that this assertion is part of.</p>
</div>
<div class="paragraph">
<p>A partial <a href="https://json-schema.org/">JSON Schema</a> for this type is:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This schema does not validate all aspects of the schema.org types, a valid CreativeWork assertion is free to use any types or vocabulary specified by schema.org.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "http://ns.c2pa.org/creative_work/v1",
  "type": "object",
  "description": "Assertion that describes the most generic kind of creative work, including books, movies, photographs, software programs, etc.",
  "examples": [
    {
      "@context": [
        "http://schema.org/",
        {
          "credential": null
        }
      ],
      "@type": "CreativeWork",
      "datePublished": "2021-05-20T23:02:36+00:00",
      "publisher": {
        "name": "BBC News",
        "publishingPrinciples": "https://www.bbc.co.uk/news/help-41670342",
        "logo": "https://m.files.bbci.co.uk/modules/bbc-morph-news-waf-page-meta/5.1.0/bbc_news_logo.png",
        "parentOrganization": {
          "name": "BBC",
          "legalName": "British Broadcasting Corporation"
        }
      },
      "url": "https://www.bbc.co.uk/news/av/world-europe-57194011",
      "identifier": "p09j7vzv",
      "producer": {
        "identifier": "https://en.wikipedia.org/wiki/Joe_Bloggs",
        "name": "Joe Bloggs",
        "credential": [
          {
            "url": "self#jumbf=c2pa/urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.credentials/Joe_Bloggs",
            "alg": "sha256",
            "hash": "Auxjtmax46cC2N3Y9aFmBO9Jfay8LEwJWzBUtZ0sUM8gA"
          }
        ]
      },
      "copyrightHolder": {
        "name": "BBC",
        "legalName": "British Broadcasting Corporation"
      },
      "copyrightYear": 2021,
      "copyrightNotice": "Copyright © 2021 BBC."
    }
  ],
  "anyOf": [
    {
      "$ref": "https://json.schemastore.org/schema-org-thing.json"
    }
  ],
  "properties": {
    "datePublished": {
      "type": "string",
      "minLength": 1,
      "format": "date-time",
      "description": "From http://schema.org/CreativeWork: Date of first broadcast/publication."
    },
    "publisher": {
      "description": "From http://schema.org/CreativeWork: The publisher of the creative work.",
      "$ref": "#/definitions/personOrgOrUri"
    },
    "identifier": {
      "$ref": "#/definitions/credential"
    },
    "producer": {
      "description": "From http://schema.org/CreativeWork: The person or organization who produced the work (e.g. music album, movie, tv/radio series etc.).",
      "$ref": "#/definitions/personOrgOrUri"
    },
    "creator": {
      "description": "From http://schema.org/CreativeWork: The creator/author of this CreativeWork.",
      "$ref": "#/definitions/personOrgOrUri"
    },
    "editor": {
      "description": "From http://schema.org/CreativeWork: Specifies the Person who edited the CreativeWork.",
      "anyOf": [
        {
          "$ref": "#/definitions/person"
        },
        {
          "$ref": "#/definitions/uri"
        }
      ]
    },
    "contributor": {
      "description": "From http://schema.org/CreativeWork: A secondary contributor to the CreativeWork or Event.",
      "$ref": "#/definitions/personOrgOrUri"
    },
    "copyrightHolder": {
      "description": "From http://schema.org/CreativeWork: The party holding the legal copyright to the CreativeWork.",
      "$ref": "#/definitions/personOrgOrUri"
    },
    "copyrightNotice": {
      "type": "string",
      "minLength": 1,
      "description": "From http://schema.org/CreativeWork: Text of a notice appropriate for describing the copyright aspects of this Creative Work, ideally indicating the owner of the copyright for the Work."
    },
    "copyrightYear": {
      "type": "integer",
      "description": "From http://schema.org/CreativeWork: The year during which the claimed copyright for the CreativeWork was first asserted."
    }
  },
  "definitions": {
    "credential": {
      "type": "array",
      "description": "W3C Verifiable Credentials (VC) associated with this actor.",
      "minItems": 1,
      "items": {
        "oneOf": [
          {
            "$ref": "http://ns.c2pa.org/hashed-uri/v1"
          },
          {
            "$ref": "http://ns.c2pa.org/hashed-ext-uri/v1"
          }
        ]
      }
    },
    "organization": {
      "type": "object",
      "description": "From http://schema.org/Organization: An organization such as a school, NGO, corporation, club, etc.",
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1,
          "description": "The name of the Organization."
        },
        "legalName": {
          "type": "string",
          "minLength": 1,
          "description": "From http://schema.org/Organization: The official name of the organization, e.g. the registered company name."
        },
        "publishingPrinciples": {
          "type": "string",
          "minLength": 1,
          "format": "uri",
          "description": "From http://schema.org/Organization: The publishingPrinciples property indicates (typically via URL) a document describing the editorial principles of an Organization (or individual e.g. a Person writing a blog) that relate to their activities as a publisher, e.g. ethics or diversity policies."
        },
        "logo": {
          "type": "string",
          "minLength": 1,
          "format": "uri",
          "description": "From http://schema.org/Organization: An associated logo."
        },
        "parentOrganization": {
          "description": "From http://schema.org/Organization: The larger organization that this organization is a subOrganization of, if any.",
          "$ref": "#/definitions/organization"
        },
        "identifier": {
          "$ref": "#/definitions/credential"
        },
        "credential": {
          "$ref": "#/definitions/credential"
        }
      }
    },
    "person": {
      "type": "object",
      "description": "From http://schema.org/Organization: An organization such as a school, NGO, corporation, club, etc.",
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1,
          "description": "The name of the Person."
        },
        "givenName": {
          "type": "string",
          "minLength": 1,
          "description": "From http://schema.org/Person: Given name. In the U.S., the first name of a Person."
        },
        "familyName": {
          "type": "string",
          "minLength": 1,
          "description": "Family name. In the U.S., the last name of a Person."
        },
        "identifier": {
          "$ref": "#/definitions/credential"
        },
        "credential": {
          "$ref": "#/definitions/credential"
        }
      }
    },
    "uri": {
      "type": "string",
      "minLength": 1,
      "format": "uri"
    },
    "identifier": {
      "type": "string",
      "minLength": 1,
      "description": "The identifier property represents any kind of identifier for any kind of Thing (in this case, an identifier for this CreativeWork)."
    },
    "personOrgOrUri": {
      "anyOf": [
        {
          "$ref": "#/definitions/organization"
        },
        {
          "$ref": "#/definitions/person"
        },
        {
          "$ref": "#/definitions/uri"
        }
      ]
    },
    "metadata": {
      "$ref": "http://ns.c2pa.org/assertion-metadata/v1",
      "description": "additional information about the assertion"
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is possible to associate identifying information about an actor with their specific role in the Creative Work as described <a href="#_common_data_model_actor">below</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_common_data_model_actor"><a class="anchor" href="#_common_data_model_actor"></a>18.17. Common Data Model: Actor</h3>
<div class="paragraph">
<p>An <a href="#_actor">actor</a> object references a particular person or organisation. A valid actor object shall have either:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>an <code>identifier</code> field containing an identifier, or,</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Since this field is a URL, it is possible to use various identity schemes such as <a href="https://openid.net/connect/">OpenID</a>, <a href="https://www.w3.org/wiki/WebID">WebID</a> or <a href="https://isni.org/">ISNI</a>.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>a <code>credentials</code> or <code>credential</code> field containing at least one <a href="#_uri_references"><code>hashed_uri</code></a> to a <a href="#_w3c_verifiable_credentials">W3C Verifiable Credential</a> in the <a href="#_vcstore">Credential Store</a> that is associated with the actor, or,</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Most references to a W3C Verifiable Credentials are via a <code>credentials</code> field, the Creative Work assertion uses a <code>credential</code> field in order to align with the <code>schema.org</code> model of singular field names.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>both (in which case, the <code>id</code> field in the <code>credentialSubject</code> W3C Verifiable Credential object should match the <code>identifier</code> field of the actor).</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_open_topics"><a class="anchor" href="#_open_topics"></a>19. Open Topics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are a number of open topics that have not yet been addressed in this specification. They are briefly described below, organized by the relevant section of the specification.</p>
</div>
<div class="sect2">
<h3 id="_assertions_2"><a class="anchor" href="#_assertions_2"></a>19.1. <a href="#_assertions">Assertions</a></h3>
<div class="ulist">
<ul>
<li>
<p>Support for marking a previous claim or assertion as "retracted", a feature commonly used in the news publication industry.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_binding_to_content_2"><a class="anchor" href="#_binding_to_content_2"></a>19.2. <a href="#_binding_to_content">Binding to Content</a></h3>
<div class="ulist">
<ul>
<li>
<p>Add support for the binding of live video streams, 3D formats and audio formats.</p>
</li>
<li>
<p>Addressing the case where servers make real-time modifications to content streamed to a client, potentially altering the cryptographic hash used to bind ISO BMFF content to a manifest.</p>
</li>
<li>
<p>Determining whether the box exclusion list used for hashing a BMFF-formatted asset in the fragmented MP4 case needs to support having each fragment have its own exclusion list (e.g. if the subset to hash must be fragment-specific).</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_trust_model_2"><a class="anchor" href="#_trust_model_2"></a>19.3. <a href="#_trust_model">Trust Model</a></h3>
<div class="ulist">
<ul>
<li>
<p>Supporting additional credential types for use in signing manifests.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_validation_2"><a class="anchor" href="#_validation_2"></a>19.4. <a href="#_validation">Validation</a></h3>
<div class="ulist">
<ul>
<li>
<p>Design for how a video player can communicate with the media validator to indicate that a discontinuity in video playback is expected, perhaps due to seek, fast forward, or other types of "trick play".</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_user_experience_2"><a class="anchor" href="#_user_experience_2"></a>19.5. <a href="#_user_experience">User Experience</a></h3>
<div class="ulist">
<ul>
<li>
<p>Working with the W3C and browser vendors to define a standardized model for exposing the provenance data to user agents.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_patent_policy"><a class="anchor" href="#_patent_policy"></a>20. Patent Policy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The C2PA has adopted an open standard patent policy via W3C&#8217;s Patent Mode (2004):</p>
</div>
<div class="paragraph">
<p><strong>Licensing Commitment</strong>. For materials other than source code or datasets developed by the Working Group, each Working Group Participant agrees to make available any of its Essential Claims, as defined in the W3C Patent Policy (available at <a href="http://www.w3.org/Consortium/Patent-Policy-20040205" class="bare">http://www.w3.org/Consortium/Patent-Policy-20040205</a>), under the W3C RF licensing requirements Section 5 (<a href="http://www.w3.org/Consortium/Patent-Policy-20040205" class="bare">http://www.w3.org/Consortium/Patent-Policy-20040205</a>), in Approved Deliverables adopted by that Working Group as if that Approved Deliverable was a W3C Recommendation. Source code developed by the Working Group is subject to the license set forth in the Working Group charter.</p>
</div>
<div class="paragraph">
<p><strong>For Exclusion</strong>. Prior to the adoption of a Draft Deliverable as an Approved Deliverable, a Working Group Participant may exclude Essential Claims from its licensing commitments under this agreement by providing written notice of that intent to the Working Group chair (“Exclusion Notice”). The Exclusion Notice for issued patents and published applications must include the patent number(s) or title and application number(s), as the case may be, for each of the issued patent(s) or pending patent application(s) that the Working Group Participant wishes to exclude from the licensing commitment set forth in Section 1 of this patent policy. If an issued patent or pending patent application that may contain Essential Claims is not set forth in the Exclusion Notice, those Essential Claims shall continue to be subject to the licensing commitments under this agreement. The Exclusion Notice for unpublished patent applications must provide either: (i) the text of the filed application; or (ii) identification of the specific part(s) of the Draft Deliverable whose implementation makes the excluded claim an Essential Claim. If (ii) is chosen, the effect of the exclusion will be limited to the identified part(s) of the Draft Deliverable. The Working Group Chair will publish Exclusion Notices.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="footer-main">
    <figure class="footer-brand">
      <a class="logo" href="https://c2pa.org"><img src="../../../_/img/C2PA-logo.svg" alt="C2PA" width="64"></a>
      <figcaption class="footer-brand-name"><a href="https://c2pa.org">C2PA</a></figcaption>
    </figure>
    <ul class="footer-brand-links">
      <li><a href="https://c2pa.org" target="_blank" rel="noopener">Home</a></li>
      <li><a href="https://c2pa.org/specifications">Docs</a></li>
      <li><a href="https://github.com/c2pa-org" target="_blank" rel="noopener">Project</a></li>
    </ul>
    <p class="footer-brand-follow">
      <a href="https://twitter.com/c2pa_org" title="Follow us on Twitter" target="_blank" rel="noopener"><img src="../../../_/img/twitter-logo.svg" alt="Twitter logo" class="logo" width="28"><span class="handle">@C2PA_org</span></a>
    </p>
  </div>
  <div class="footer-legal">
    <p>Copyright © 2025 Coalition for Content Provenance and Authenticity (C2PA). Except where noted, the content is licensed under a Creative Commons Attribution 4.0 International (CC BY 4.0) license.</p>
    <p>The <a href="https://github.com/asciidoctor/asciidoctor-docs-ui" target="_blank" rel="noopener">UI for this site</a> is derived from the Antora default UI and is licensed under the MPL-2.0 license. Several icons are imported from <a href="https://primer.style/octicons/" target="_blank" rel="noopener">Octicons</a> and are licensed under the MIT license.</p>
  </div>
  <div class="footer-thanks">
    <p>Thanks to our <a href="https://c2pa.org/membership/" target="_blank" rel="noopener">membership</a> for helping to make this project possible.</p>
    <p>Authored in AsciiDoc.<br>Produced by <a href="https://antora.org" target="_blank" rel="noopener">Antora</a> and <a href="https://asciidoctor.org" target="_blank" rel="noopener">Asciidoctor</a>.</p>
  </div>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/vendor/search.js" id="search-script" data-base-path="../../.." data-page-path="/specifications/1.1/specs/C2PA_Specification.html"></script>
<script async src="../../../_/../search-index.js"></script>

  </body>
</html>
