<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Content Credentials : C2PA Technical Specification :: C2PA Specifications</title>
    <link rel="canonical" href="https://c2pa.org/specifications/specifications/2.0/specs/C2PA_Specification.html">
    <meta name="page-spec" content="specifications:specs:C2PA_Specification.adoc">
    <meta name="generator" content="Antora 3.1.7">
    <link rel="stylesheet" href="../../../_/css/site.css">
<link rel="stylesheet" href="../../../_/css/search.css">
    <link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item logo" title="C2PA" href="https://c2pa.org"><img src="../../../_/img/C2PA-logo.svg" alt="C2PA" width="64"></a>
      <a class="navbar-item title" href="../../..">C2PA Specifications</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Download</div>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="../../1.0/specs/_attachments/C2PA_Specification.pdf">Technical Specifications</a> 
            <a class="navbar-item" href="../../1.0/explainer/_attachments/Explainer.pdf">Explainer</a> 
            <a class="navbar-item" href="../../1.0/guidance/_attachments/Guidance.pdf">Guidance for Implementers</a> 
            <a class="navbar-item" href="../../1.0/ux/_attachments/UX_Recommendations.pdf">User Experience Guidance</a> 
            <a class="navbar-item" href="../../1.0/security/_attachments/Security_Considerations.pdf">Security Considerations</a> 
            <a class="navbar-item" href="../../1.0/security/_attachments/Harms_Modelling.pdf">Harms Modelling</a> 
            <a class="navbar-item" href="../../1.0/specs/_attachments/C2PA_Schemas.zip">CDDL and JSON Schemas</a> 
          </div>
        </div>
          <div class="navbar-item">
            <input id="search-input" type="text" placeholder="Search docs">
          </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-item" href="https://asciidoctor.zulipchat.com" target="_blank" rel="noopener" data-title="Communication">
            <span class="icon"><img src="../../../_/img/octicons-24.svg#view-comment-discussion"></span>
          </a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item has-icon" href="https://github.com/c2pa-org" target="_blank" rel="noopener">
              <span class="icon"><img src="../../../_/img/octicons-16.svg#view-mark-github"></span>
              <span>Repository</span>
            </a>
            <a class="navbar-item has-icon" href="https://twitter.com/c2pa" target="_blank" rel="noopener">
              <span class="icon"><img src="../../../_/img/octicons-16.svg#view-hash"></span>
              <span>Tweets</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active is-loading" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" title="Toggle expand/collapse all"></button>
    <h3 class="title"><a href="../index.html">C2PA Specifications</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Technical Specifications</span>
<ul class="nav-list">
  <li class="nav-item is-current-url" data-depth="2">
    <a class="nav-link" href="C2PA_Specification.html">Content Credentials</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../1.4/attestations/attestation.html">Attestations</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Informative Documents</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../1.3/explainer/Explainer.html">Explainer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../1.3/guidance/Guidance.html">Guidance for Implementers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../1.4/ux/UX_Recommendations.html">User Experience Guidance</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../1.0/security/Security_Considerations.html">C2PA Security Considerations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../1.0/security/Harms_Modelling.html">C2PA Harms Modelling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../1.3/ai-ml/ai_ml.html">Guidance for Artificial Intelligence and Machine Learning</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
  <script>
;(function () {
  var panel = document.querySelector('.nav-panel-menu')
  var page
  var hash = window.location.hash
  if (hash) {
    if (~hash.indexOf('%')) hash = decodeURIComponent(hash)
    if (~hash.indexOf('"')) hash = hash.replace(/(?=")/g, '\\')
    var link = panel.querySelector('.nav-link[href="' + hash + '"]')
    if (link) page = link.parentNode
    else if ((page = panel.querySelector('.is-current-url'))) page.classList.add('is-provisional')
  } else {
    page = panel.querySelector('.is-current-url')
  }
  if (page) {
    var ancestor = page
    while ((ancestor = ancestor.parentNode) && ancestor !== panel) {
      if (ancestor.className === 'nav-item') ancestor.classList.add('is-current-path', 'is-active')
    }
    page.classList.add('is-current-page', 'is-active')
    if (panel.scrollHeight > panel.clientHeight) {
      var panelRect = panel.getBoundingClientRect()
      var linkRect = page.querySelector('.nav-link').getBoundingClientRect()
      panel.scrollTop += Math.round(linkRect.top - panelRect.top - (panelRect.height - linkRect.height) * 0.5)
    }
  } else {
    panel.scrollTop = 0
  }
  panel.classList.remove('is-loading')
})()
  </script>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">C2PA Specifications</span>
    <span class="version">2.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">C2PA Specifications</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">2.0</a>
        </li>
        <li class="version">
          <a href="../../1.4/index.html">1.4</a>
        </li>
        <li class="version">
          <a href="../../1.3/index.html">1.3</a>
        </li>
        <li class="version">
          <a href="../../1.2/index.html">1.2</a>
        </li>
        <li class="version">
          <a href="../../1.1/index.html">1.1</a>
        </li>
        <li class="version">
          <a href="../../1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">C2PA Specifications</a></li>
    <li>Technical Specifications</li>
    <li><a href="C2PA_Specification.html">Content Credentials</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">2.0</button>
  <div class="version-menu">
    <a class="version is-current" href="C2PA_Specification.html">2.0</a>
    <a class="version" href="../../1.4/specs/C2PA_Specification.html">1.4</a>
    <a class="version" href="../../1.3/specs/C2PA_Specification.html">1.3</a>
    <a class="version" href="../../1.2/specs/C2PA_Specification.html">1.2</a>
    <a class="version" href="../../1.1/specs/C2PA_Specification.html">1.1</a>
    <a class="version" href="../../1.0/specs/C2PA_Specification.html">1.0</a>
  </div>
</div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Content Credentials : C2PA Technical Specification</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#_overview">1.1. Overview</a></li>
<li><a href="#_scope">1.2. Scope</a></li>
<li><a href="#_technical_overview">1.3. Technical Overview</a></li>
<li><a href="#_establishing_trust">1.4. Establishing Trust</a></li>
<li><a href="#_an_example">1.5. An Example</a></li>
<li><a href="#_design_goals">1.6. Design Goals</a></li>
</ul>
</li>
<li><a href="#_glossary">2. Glossary</a>
<ul class="sectlevel2">
<li><a href="#_introductory_terms">2.1. Introductory terms</a></li>
<li><a href="#_assets_and_content">2.2. Assets and Content</a></li>
<li><a href="#_core_aspects_of_c2pa">2.3. Core Aspects of C2PA</a></li>
<li><a href="#_additional_terms">2.4. Additional Terms</a></li>
<li><a href="#_overview_2">2.5. Overview</a></li>
</ul>
</li>
<li><a href="#_normative_references">3. Normative References</a>
<ul class="sectlevel2">
<li><a href="#_core_formats">3.1. Core Formats</a></li>
<li><a href="#_schemas">3.2. Schemas</a></li>
<li><a href="#_digital_electronic_signatures">3.3. Digital &amp; Electronic Signatures</a></li>
<li><a href="#_embeddable_formats">3.4. Embeddable Formats</a></li>
<li><a href="#_other">3.5. Other</a></li>
</ul>
</li>
<li><a href="#_standard_terms">4. Standard Terms</a></li>
<li><a href="#_version_history">5. Version History</a></li>
<li><a href="#_assertions">6. Assertions</a>
<ul class="sectlevel2">
<li><a href="#_general">6.1. General</a></li>
<li><a href="#_labels">6.2. Labels</a></li>
<li><a href="#_versioning">6.3. Versioning</a></li>
<li><a href="#_multiple_instances">6.4. Multiple Instances</a></li>
<li><a href="#_assertion_store">6.5. Assertion Store</a></li>
<li><a href="#_embedded_vs_externally_stored_data">6.6. Embedded vs Externally-Stored Data</a></li>
<li><a href="#_redaction_of_assertions">6.7. Redaction of Assertions</a></li>
</ul>
</li>
<li><a href="#_data_boxes">7. Data Boxes</a>
<ul class="sectlevel2">
<li><a href="#_schema_and_example">7.1. Schema and Example</a></li>
</ul>
</li>
<li><a href="#_unique_identifiers">8. Unique Identifiers</a>
<ul class="sectlevel2">
<li><a href="#_using_xmp_values">8.1. Using XMP values</a></li>
<li><a href="#_other_identifiers">8.2. Other Identifiers</a></li>
<li><a href="#_uri_references">8.3. URI References</a></li>
</ul>
</li>
<li><a href="#_binding_to_content">9. Binding to Content</a>
<ul class="sectlevel2">
<li><a href="#_overview_3">9.1. Overview</a></li>
<li><a href="#_hard_bindings">9.2. Hard Bindings</a></li>
<li><a href="#_soft_bindings">9.3. Soft Bindings</a></li>
</ul>
</li>
<li><a href="#_claims">10. Claims</a>
<ul class="sectlevel2">
<li><a href="#_overview_4">10.1. Overview</a></li>
<li><a href="#_syntax">10.2. Syntax</a></li>
<li><a href="#_creating_a_claim">10.3. Creating a Claim</a></li>
<li><a href="#_multiple_step_processing">10.4. Multiple Step Processing</a></li>
</ul>
</li>
<li><a href="#_manifests">11. Manifests</a>
<ul class="sectlevel2">
<li><a href="#_use_of_jumbf">11.1. Use of JUMBF</a></li>
<li><a href="#_types_of_manifests">11.2. Types of Manifests</a></li>
<li><a href="#_embedding_manifests_into_various_file_formats">11.3. Embedding manifests into various file formats</a></li>
<li><a href="#_external_manifests">11.4. External Manifests</a></li>
<li><a href="#_embedding_a_reference_to_an_external_manifest">11.5. Embedding a Reference to an external Manifest</a></li>
</ul>
</li>
<li><a href="#_entity_diagram">12. Entity Diagram</a></li>
<li><a href="#_cryptography">13. Cryptography</a>
<ul class="sectlevel2">
<li><a href="#_hashing_2">13.1. Hashing</a></li>
<li><a href="#_digital_signatures">13.2. Digital Signatures</a></li>
</ul>
</li>
<li><a href="#_trust_model">14. Trust Model</a>
<ul class="sectlevel2">
<li><a href="#_overview_5">14.1. Overview</a></li>
<li><a href="#_identity_of_signers">14.2. Identity of Signers</a></li>
<li><a href="#_statements_by_a_validator">14.3. Statements by a Validator</a></li>
<li><a href="#_trust_lists">14.4. Trust Lists</a></li>
<li><a href="#_c2pa_valid_manifests">14.5. C2PA Valid Manifests</a></li>
<li><a href="#x509_certificates">14.6. X.509 Certificates</a></li>
</ul>
</li>
<li><a href="#_validation">15. Validation</a>
<ul class="sectlevel2">
<li><a href="#_status_codes">15.1. Status Codes</a></li>
<li><a href="#_locating_the_active_manifest">15.2. Locating the Active Manifest</a></li>
<li><a href="#_locating_the_claim">15.3. Locating the Claim</a></li>
<li><a href="#_validate_the_signature">15.4. Validate the Signature</a></li>
<li><a href="#_validate_the_time_stamp">15.5. Validate the Time-Stamp</a></li>
<li><a href="#_validate_the_credential_revocation_information">15.6. Validate the Credential Revocation Information</a></li>
<li><a href="#_validate_the_assertions">15.7. Validate the Assertions</a></li>
<li><a href="#_recursively_validating_integrity_of_ingredients">15.8. Recursively Validating Integrity of Ingredients</a></li>
<li><a href="#_visual_look_of_validation">15.9. Visual look of Validation</a></li>
<li><a href="#_validate_the_assets_content">15.10. Validate the Asset&#8217;s Content</a></li>
</ul>
</li>
<li><a href="#_user_experience">16. User Experience</a>
<ul class="sectlevel2">
<li><a href="#_approach">16.1. Approach</a></li>
<li><a href="#_principles">16.2. Principles</a></li>
<li><a href="#_disclosure_levels">16.3. Disclosure Levels</a></li>
<li><a href="#_public_review_feedback_and_evolution">16.4. Public Review, Feedback and Evolution</a></li>
</ul>
</li>
<li><a href="#_information_security">17. Information security</a>
<ul class="sectlevel2">
<li><a href="#_threats_and_security_considerations">17.1. Threats and Security Considerations</a></li>
<li><a href="#_harms_misuse_and_abuse">17.2. Harms, Misuse, and Abuse</a></li>
</ul>
</li>
<li><a href="#_c2pa_standard_assertions">18. C2PA Standard Assertions</a>
<ul class="sectlevel2">
<li><a href="#_introduction_3">18.1. Introduction</a></li>
<li><a href="#_regions_of_interest">18.2. Regions of Interest</a></li>
<li><a href="#_metadata_about_assertions">18.3. Metadata About Assertions</a></li>
<li><a href="#_standard_c2pa_assertion_summary">18.4. Standard C2PA Assertion Summary</a></li>
<li><a href="#_data_hash">18.5. Data Hash</a></li>
<li><a href="#_bmff_based_hash">18.6. BMFF-Based Hash</a></li>
<li><a href="#_general_boxes_hash">18.7. General Boxes Hash</a></li>
<li><a href="#_collection_data_hash">18.8. Collection Data Hash</a></li>
<li><a href="#_soft_binding_2">18.9. Soft Binding</a></li>
<li><a href="#_cloud_data">18.10. Cloud Data</a></li>
<li><a href="#_thumbnail">18.11. Thumbnail</a></li>
<li><a href="#_actions">18.12. Actions</a></li>
<li><a href="#_ingredient">18.13. Ingredient</a></li>
<li><a href="#_metadata">18.14. Metadata</a></li>
<li><a href="#_asset_reference">18.15. Asset Reference</a></li>
<li><a href="#_asset_type">18.16. Asset Type</a></li>
<li><a href="#_depthmap">18.17. Depthmap</a></li>
<li><a href="#_font_information">18.18. Font Information</a></li>
</ul>
</li>
<li><a href="#_patent_policy">19. Patent Policy</a></li>
<li><a href="#metadata_annex">Appendix A: Implementation Details for <code>c2pa.metadata</code></a>
<ul class="sectlevel2">
<li><a href="#_completely_supported_schemas">A.1. Completely Supported Schemas</a></li>
<li><a href="#_partially_supported_schemas">A.2. Partially Supported Schemas</a></li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="exampleblock">
<div class="content">
<div class="imageblock text-center">
<div class="content">
<a class="image" href="http://creativecommons.org/licenses/by/4.0/"><img src="_images/CCby4.png" alt="Creative Commons License"></a>
</div>
</div>
<div class="paragraph text-center">
<p>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p>
</div>
<hr>
<div class="paragraph">
<p>THESE MATERIALS ARE PROVIDED “AS IS.” The parties expressly disclaim any warranties (express, implied, or otherwise), including implied warranties of merchantability, non-infringement, fitness for a particular purpose, or title, related to the materials. The entire risk as to implementing or otherwise using the materials is assumed by the implementer and user. IN NO EVENT WILL THE PARTIES BE LIABLE TO ANY OTHER PARTY FOR LOST PROFITS OR ANY FORM OF INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER FROM ANY CAUSES OF ACTION OF ANY KIND WITH RESPECT TO THIS DELIVERABLE OR ITS GOVERNING AGREEMENT, WHETHER BASED ON BREACH OF CONTRACT, TORT (INCLUDING NEGLIGENCE), OR OTHERWISE, AND WHETHER OR NOT THE OTHER MEMBER HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
</div>
</div>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview"><a class="anchor" href="#_overview"></a>1.1. Overview</h3>
<div class="paragraph">
<p>With the increasing velocity of digital content and the increasing availability of powerful creation and editing techniques, establishing the provenance of media is critical to ensure transparency, understanding, and ultimately, trust.</p>
</div>
<div class="paragraph">
<p>We are witnessing extraordinary challenges to trust in media. As social platforms amplify the reach and influence of certain content via ever more complex and opaque algorithms, mis-attributed and mis-contextualized content spreads quickly. Whether inadvertent misinformation or deliberate deception via disinformation, inauthentic content is on the rise.</p>
</div>
<div class="paragraph">
<p>Currently, those who wish to include metadata about their work cannot do so in a secure, tamper-evident and standardized way across platforms. Without this information coming from a recognized source, publishers and consumers lack critical context for determining the authenticity of media.</p>
</div>
<div class="paragraph">
<p>Provenance empowers content creators and editors, regardless of their geographic location or degree of access to technology, to disclose information about how an asset was created, how it was changed and what was changed. Each time an asset is changed, the existing provenance of the asset is preserved, with each new change being added to the provenance. In this way, content with provenance provides indicators of authenticity so that consumers can have awareness of altered content. Such provenance could include what has been changed and the source of those changes. This ability to provide provenance for creators, publishers and consumers is essential to facilitating trust online.</p>
</div>
<div class="paragraph">
<p>To address this issue at scale for publishers, creators and consumers, the Coalition for Content Provenance and Authenticity (C2PA) has developed this technical specification for providing content provenance and authenticity. It is designed to enable global, opt-in, adoption of digital provenance techniques through the creation of a rich ecosystem of digital provenance enabled applications for a wide range of individuals and organizations while meeting appropriate security requirements.</p>
</div>
<div class="paragraph">
<p>This specification has been, and continues to be, informed by scenarios, workflows and requirements gathered from industry experts and partner organizations, including the <a href="https://www.originproject.info/">Project Origin Alliance</a> and the <a href="https://contentauthenticity.org/">Content Authenticity Initiative (CAI)</a>. It is also possible that regulatory bodies and governmental agencies could utilize this specification to establish standards for digital provenance.</p>
</div>
</div>
<div class="sect2">
<h3 id="_scope"><a class="anchor" href="#_scope"></a>1.2. Scope</h3>
<div class="paragraph">
<p>This specification describes the technical aspects of the C2PA architecture; a model for storing and accessing cryptographically verifiable information whose trustworthiness can be assessed based on a defined <a href="#_trust_model">trust model</a>. Included in this document is information about how to create and process a C2PA Manifest and its components, including the use of digital signature technology for enabling tamper-evidence as well as establishing trust.</p>
</div>
<div class="paragraph">
<p>Prior to developing this specification, the C2PA created our <a href="https://c2pa.org/principles/">Guiding Principles</a> that enabled us to remain focused on ensuring that the specification can be used in ways that respect privacy and personal control of data with a critical eye toward potential abuse and misuse. For example, the creators and publishers of the media assets always have control over whether provenance data is included as well as what specific pieces of data are included.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>From the overarching goals section of the guiding principles:</p>
</div>
<div class="quoteblock">
<blockquote>
C2PA specifications SHOULD NOT provide value judgments about whether a given set of provenance data is 'good' or 'bad,' merely whether the assertions included within can be validated as associated with the underlying asset, correctly formed, and free from tampering.
</blockquote>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is important that the specification does not negatively impact content accessibility for consumers.</p>
</div>
<div class="paragraph">
<p>Other documents from the C2PA will address specific implementation considerations such as expected user experiences and details of our threat and harms modelling.</p>
</div>
</div>
<div class="sect2">
<h3 id="_technical_overview"><a class="anchor" href="#_technical_overview"></a>1.3. Technical Overview</h3>
<div class="paragraph">
<p>The C2PA information comprises a series of statements that cover areas such as asset creation, edit actions, capture device details, bindings to content and many other subjects. These statements, called <a href="#_assertion">assertions</a>, make up the provenance of a given asset and represent a series of trust signals that can be used by a human to improve their view of trustworthiness concerning the asset. Assertions are wrapped up with additional information into a <a href="#_digital_signatures">digitally signed</a> entity called a <a href="#_claim">claim</a>. This claim is digitally signed by the <a href="#signer-definition">signer</a>, producing the <a href="#_claim_signature">claim signature</a>.</p>
</div>
<div class="paragraph">
<p>These assertions, claims, and the claim signature are all bound together into a verifiable unit called a <a href="#_c2pa_manifest">C2PA Manifest</a> by a hardware or software component called a <a href="#claim-generator-definition">claim generator</a>. The set of C2PA Manifests, as stored in the asset&#8217;s Content Credential, represent its provenance data.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/Manifest.drawio.svg" alt="A C2PA Manifest and its parts" height="150">
</div>
<div class="title">Figure 1. A C2PA Manifest and its constituent parts</div>
</div>
</div>
<div class="sect2">
<h3 id="_establishing_trust"><a class="anchor" href="#_establishing_trust"></a>1.4. Establishing Trust</h3>
<div class="paragraph">
<p>The basis of making trust decisions in C2PA, our <a href="#_trust_model">trust model</a>, is the identity of the signer associated with the cryptographic signing key used to sign the claim in the Active Manifest. C2PA Manifests can be validated indefinitely regardless of whether the cryptographic credentials used to sign its contents are later expired or revoked.</p>
</div>
</div>
<div class="sect2">
<h3 id="_an_example"><a class="anchor" href="#_an_example"></a>1.5. An Example</h3>
<div class="paragraph">
<p>A very common scenario will be a user taking a photograph with their C2PA-enabled camera (or phone). In that instance, the camera would create a manifest containing some such assertions including information about the camera itself, a thumbnail of the image and some cryptographic hashes that bind the photograph to the manifest. These assertions would then be listed in the Claim, which would be digitally signed and then the entire C2PA Manifest would be embedded into the output JPEG. This C2PA Manifest would remain valid indefinitely.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/Photo_Manifest.svg" alt="Example C2PA Manifest of a Photograph" width="284" height="424">
</div>
<div class="title">Figure 2. Example C2PA Manifest of a Photograph</div>
</div>
<div class="paragraph">
<p>A Manifest Consumer, such as a C2PA Validator, could help users to establish the trustworthiness of the asset by first validating the digital signature and its associated credential. It can also check each of the assertions for validity and present the information contained in them, and the signature, to the user in a way that they can then make an informed decision about the trustworthiness of the digital content.</p>
</div>
</div>
<div class="sect2">
<h3 id="_design_goals"><a class="anchor" href="#_design_goals"></a>1.6. Design Goals</h3>
<div class="paragraph">
<p>In the creation of the C2PA architecture, it was important to establish some clear goals for the work to ensure that the technology was usable across a wide spectrum of hardware and software implementations worldwide and accessible to all.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Goal</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privacy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enable users to control the privacy of their information, including consumption data and information recorded in provenance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Responsibility</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure consumers can determine the provenance of an asset</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scalability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enable creation/consumption/validation of media provenance at the same scale as media creation/consumption on the web</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extensibility</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure future metadata and credential providers are able to add their information without requiring input or approval from the C2PA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interoperability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure that differing implementations are able to operate with each other without ambiguity</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whole Workflow Applicability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maintain the provenance of the asset across multiple tools, from creation through all subsequent modification and publication/distribution</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Technology Minimalism</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create only the minimum required novel technology in the specification by relying on prior, well-established techniques</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Design to ensure that consumers can trust the integrity and source of provenance, and ensure the design is reviewed by experts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Content Ubiquity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enable the inclusion of provenance for all common media types, including documents</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flexible Locality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enable both online and offline (asset-only) storage and consumption/validation of provenance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Global Universality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Design for the needs of interested users throughout the world</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Accessibility</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure that the technology can be used in a way that conform to recognized accessibility standards, such as WCAG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Harms and Misuse</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Design to avert and mitigate potential harms, including threats to human rights and disproportionate risks to vulnerable groups</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Evolving</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Continuous review of the specification against these goals to ensure that they remain our priority</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_glossary"><a class="anchor" href="#_glossary"></a>2. Glossary</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introductory_terms"><a class="anchor" href="#_introductory_terms"></a>2.1. Introductory terms</h3>
<div class="sect3">
<h4 id="_actor"><a class="anchor" href="#_actor"></a>2.1.1. Actor</h4>
<div class="paragraph">
<p>A human or non-human (hardware or software) that is participating in the C2PA ecosystem. For example: a camera (capture device), image editing software, cloud service or the person using such tools.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
An organization or group of <a href="#_actor">actors</a> may also be considered an <a href="#_actor">actor</a> in the C2PA ecosystem.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="claim-generator-definition"><a class="anchor" href="#claim-generator-definition"></a>2.1.2. Claim generator</h4>
<div class="paragraph">
<p>The non-human (hardware or software) <a href="#_actor">actor</a> that generates the <a href="#_claim">claim</a> about an <a href="#_asset">asset</a> as well as the <a href="#_claim_signature">claim signature</a>, thus leading to the <a href="#_asset">asset</a>'s associated <a href="#_c2pa_manifest">C2PA Manifest</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="signer-definition"><a class="anchor" href="#signer-definition"></a>2.1.3. Signer</h4>
<div class="paragraph">
<p>The credential holder of a private key that is used to sign the <a href="#_claim">claim</a>.  The <a href="#_signer">signer</a> is identified by the subject of the credential.</p>
</div>
</div>
<div class="sect3">
<h4 id="_manifest_consumer"><a class="anchor" href="#_manifest_consumer"></a>2.1.4. Manifest consumer</h4>
<div class="paragraph">
<p>An <a href="#_actor">actor</a> who consumes an <a href="#_asset">asset</a> with an associated <a href="#_c2pa_manifest">C2PA Manifest</a> for the purpose of obtaining the <a href="#_provenance_data">provenance data</a> from the <a href="#_c2pa_manifest">C2PA Manifest</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_validator"><a class="anchor" href="#_validator"></a>2.1.5. Validator</h4>
<div class="paragraph">
<p>A <a href="#_manifest_consumer">Manifest Consumer</a> whose role is to perform the actions described in <a href="#_validation">validation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_action"><a class="anchor" href="#_action"></a>2.1.6. Action</h4>
<div class="paragraph">
<p>An operation performed by an <a href="#_actor">actor</a> on an <a href="#_asset">asset</a>. For example, "create", "embed", or "apply filter".</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_assets_and_content"><a class="anchor" href="#_assets_and_content"></a>2.2. Assets and Content</h3>
<div class="sect3">
<h4 id="_digital_content"><a class="anchor" href="#_digital_content"></a>2.2.1. Digital content</h4>
<div class="paragraph">
<p>The portion of an <a href="#_asset">asset</a> that represents the actual content, such as the pixels of an image, along with any additional technical metadata required to understand the content (e.g., a colour profile or encoding parameters).</p>
</div>
</div>
<div class="sect3">
<h4 id="_asset_metadata"><a class="anchor" href="#_asset_metadata"></a>2.2.2. Asset metadata</h4>
<div class="paragraph">
<p>Non-technical information about the <a href="#_asset">asset</a> and its <a href="#_digital_content">digital content</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_asset"><a class="anchor" href="#_asset"></a>2.2.3. Asset</h4>
<div class="paragraph">
<p>A file or stream of data containing <a href="#_digital_content">digital content</a>, <a href="#_asset_metadata">asset metadata</a> and optionally, a <a href="#_c2pa_manifest">C2PA Manifest</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For the purposes of this definition, we will extend the typical definition of "file" to include cloud-native and dynamically generated data.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_derived_asset"><a class="anchor" href="#_derived_asset"></a>2.2.4. Derived asset</h4>
<div class="paragraph">
<p>A <a href="#_derived_asset">derived asset</a> is an <a href="#_asset">asset</a> that is created by starting from an existing <a href="#_asset">asset</a> and performing <a href="#_action">actions</a> to it that modify its <a href="#_digital_content">digital content</a>.</p>
</div>
<div class="exampleblock">
<div class="content">
<strong>EXAMPLE:</strong> An audio stream that has been shortened or a document where pages have been added.
</div>
</div>
</div>
<div class="sect3">
<h4 id="_asset_rendition"><a class="anchor" href="#_asset_rendition"></a>2.2.5. Asset rendition</h4>
<div class="paragraph">
<p>A representation of an <a href="#_asset">asset</a> (either as a part of an <a href="#_asset">asset</a> or a completely new <a href="#_asset">asset</a>) where the <a href="#_digital_content">digital content</a> has had a 'non-editorial transformation' <a href="#_action">action</a> (e.g., re-encoding or scaling) applied.</p>
</div>
<div class="exampleblock">
<div class="content">
<strong>EXAMPLE:</strong> A video file that is re-encoded for reduced screen resolution or network bandwidth.
</div>
</div>
</div>
<div class="sect3">
<h4 id="_composed_asset"><a class="anchor" href="#_composed_asset"></a>2.2.6. Composed asset</h4>
<div class="paragraph">
<p>A composed asset is an <a href="#_asset">asset</a> that is created by building up a collection of multiple parts or fragments of <a href="#_digital_content">digital content</a> (referred to as <a href="#_ingredient">ingredients</a>) from one or more other <a href="#_asset">assets</a>. When starting from an existing <a href="#_asset">asset</a>, it is a special case of a <a href="#_derived_asset">derived asset</a> - however a <a href="#_derived_asset">composed asset</a> can also be one that starts from a "blank slate".</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>EXAMPLES:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>A video created by importing existing video clips and audio segments into a "blank slate".</p>
</li>
<li>
<p>An image where another image is imported and super-imposed on top of the starting image.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_core_aspects_of_c2pa"><a class="anchor" href="#_core_aspects_of_c2pa"></a>2.3. Core Aspects of C2PA</h3>
<div class="sect3">
<h4 id="_assertion"><a class="anchor" href="#_assertion"></a>2.3.1. Assertion</h4>
<div class="paragraph">
<p>A data structure which represents a statement either made (or "created") by the <a href="#signer-definition">signer</a> or simply gathered at claim generation-time, concerning the <a href="#_asset">asset</a>. This data is a part of the <a href="#_c2pa_manifest">C2PA Manifest</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_claim"><a class="anchor" href="#_claim"></a>2.3.2. Claim</h4>
<div class="paragraph">
<p>A digitally signed and tamper-evident data structure that references a set of <a href="#_assertion">assertions</a>, concerning an <a href="#_asset">asset</a>, and the information necessary to represent the <a href="#_content_binding">content binding</a>. If any <a href="#_assertion">assertions</a> were redacted, then a declaration to that effect is included. This data is a part of the <a href="#_c2pa_manifest">C2PA Manifest</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="claim-signature-definition"><a class="anchor" href="#claim-signature-definition"></a>2.3.3. Claim signature</h4>
<div class="paragraph">
<p>The digital signature on the <a href="#_claim">claim</a> using the private key of a <a href="#signer-definition">signer</a>. The <a href="#_claim_signature">claim signature</a> is a part of the <a href="#_c2pa_manifest">C2PA Manifest</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_c2pa_manifest"><a class="anchor" href="#_c2pa_manifest"></a>2.3.4. C2PA Manifest</h4>
<div class="paragraph">
<p>The set of information about the <em>provenance</em> of an <a href="#_asset">asset</a> based on the combination of one or more <a href="#_assertion">assertions</a> (including <a href="#_binding_to_content">content bindings</a>), a single <a href="#_claim">claim</a>, and a <a href="#_claim_signature">claim signature</a>. A <a href="#_c2pa_manifest">C2PA Manifest</a> is part of a <a href="#_c2pa_manifest_store">C2PA Manifest Store</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A <a href="#_c2pa_manifest">C2PA Manifest</a> can reference other <a href="#_c2pa_manifest">C2PA Manifests</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_c2pa_manifest_store"><a class="anchor" href="#_c2pa_manifest_store"></a>2.3.5. C2PA Manifest Store</h4>
<div class="paragraph">
<p>A collection of <a href="#_c2pa_manifest">C2PA Manifests</a> that can either be embedded into an <a href="#_asset">asset</a> or be external to its <a href="#_asset">asset</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_content_credential"><a class="anchor" href="#_content_credential"></a>2.3.6. Content Credential</h4>
<div class="paragraph">
<p>This is the preferred, non-technical, term for a <a href="#_c2pa_manifest">C2PA Manifest</a>.  The <a href="#_c2pa_manifest_store">C2PA Manifest Store</a> therefore represents the Content Credentials of an asset.</p>
</div>
<div class="paragraph">
<p>Content Credentials also refers to the overall C2PA technology, and is therefore essentially treated as a plural noun. If a <a href="#_c2pa_manifest">C2PA Manifest</a> is a Content Credential, then multiple <a href="#_c2pa_manifest">C2PA Manifest</a> or the broader, universal concept is Content Credentials.</p>
</div>
</div>
<div class="sect3">
<h4 id="_active_manifest"><a class="anchor" href="#_active_manifest"></a>2.3.7. Active Manifest</h4>
<div class="paragraph">
<p>The last manifest in the list of <a href="#_c2pa_manifest">C2PA Manifests</a> inside of a <a href="#_c2pa_manifest_store">C2PA Manifest Store</a> which is the one with the set of <a href="#_content_bindings">content bindings</a> that are able to be validated.</p>
</div>
</div>
<div class="sect3">
<h4 id="_provenance"><a class="anchor" href="#_provenance"></a>2.3.8. Provenance</h4>
<div class="paragraph">
<p>The logical concept of understanding the history of an <a href="#_asset">asset</a> and its interaction with <a href="#_actor">actors</a> and other <a href="#_asset">assets</a>, as represented by the <a href="#_provenance_data">provenance data</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_provenance_data"><a class="anchor" href="#_provenance_data"></a>2.3.9. Provenance data</h4>
<div class="paragraph">
<p>The set of <a href="#_c2pa_manifest">C2PA Manifests</a> for an <a href="#_asset">asset</a> and, in the case of a <a href="#_composed_asset">composed asset</a>, its <a href="#_ingredient">ingredients</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A <a href="#_c2pa_manifest">C2PA Manifest</a> can reference other <a href="#_c2pa_manifest">C2PA Manifests</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_authenticity"><a class="anchor" href="#_authenticity"></a>2.3.10. Authenticity</h4>
<div class="paragraph">
<p>A property of <a href="#_digital_content">digital content</a> comprising a set of facts (such as the <a href="#_provenance_data">provenance data</a> and <a href="#_hard_binding">hard bindings</a>) that can be cryptographically verified as not having been tampered with.</p>
</div>
</div>
<div class="sect3">
<h4 id="_content_binding"><a class="anchor" href="#_content_binding"></a>2.3.11. Content binding</h4>
<div class="paragraph">
<p>Information that associates <a href="#_digital_content">digital content</a> to a specific <a href="#_c2pa_manifest">C2PA Manifest</a> associated with a specific <a href="#_asset">asset</a>, either as a <a href="#_hard_binding">hard binding</a> or a <a href="#_soft_binding">soft binding</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_hard_binding"><a class="anchor" href="#_hard_binding"></a>2.3.12. Hard binding</h4>
<div class="paragraph">
<p>One or more cryptographic hashes that uniquely identifies either the entire <a href="#_asset">asset</a> or a portion thereof.</p>
</div>
</div>
<div class="sect3">
<h4 id="_soft_binding"><a class="anchor" href="#_soft_binding"></a>2.3.13. Soft binding</h4>
<div class="paragraph">
<p>A content identifier that is either (a) not statistically unique, such as a <a href="#_fingerprint">fingerprint</a>, or (b) embedded as an <a href="#_invisible_watermark">invisible watermark</a> in the identified <a href="#_digital_content">digital content</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_trust_signals"><a class="anchor" href="#_trust_signals"></a>2.3.14. Trust signals</h4>
<div class="paragraph">
<p>The collection of information that can inform a <a href="#_manifest_consumer">Manifest Consumer&#8217;s</a> judgment of the trustworthiness of an <a href="#_asset">asset</a>. These are in addition to the <a href="#signer-definition">signer</a> of a <a href="#_claim">claim</a>, upon which the fundamental trust model relies.</p>
</div>
</div>
<div class="sect3">
<h4 id="_c2pa_trust_list"><a class="anchor" href="#_c2pa_trust_list"></a>2.3.15. C2PA Trust List</h4>
<div class="paragraph">
<p>A C2PA-managed list of X.509 certificate trust anchors that issue certificates to hardware &amp; software <a href="#signer-definition">signers</a> that are trusted to sign <a href="#_claim">claims</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_additional_terms"><a class="anchor" href="#_additional_terms"></a>2.4. Additional Terms</h3>
<div class="sect3">
<h4 id="_fingerprint"><a class="anchor" href="#_fingerprint"></a>2.4.1. Fingerprint</h4>
<div class="paragraph">
<p>A set of inherent properties computable from <a href="#_digital_content">digital content</a> that identifies the content or near duplicates of it.</p>
</div>
<div class="exampleblock">
<div class="content">
<strong>EXAMPLE:</strong> An <a href="#_asset">asset</a> can become separated from its <a href="#_c2pa_manifest">C2PA Manifest</a> due to removal or corruption of <a href="#_asset">asset</a> metadata. A <a href="#_fingerprint">fingerprint</a> of the <a href="#_digital_content">digital content</a> of the <a href="#_asset">asset</a> could be used to search a database to recover the <a href="#_asset">asset</a> with an intact <a href="#_c2pa_manifest">C2PA Manifest</a>.
</div>
</div>
</div>
<div class="sect3">
<h4 id="_invisible_watermark"><a class="anchor" href="#_invisible_watermark"></a>2.4.2. Invisible Watermark</h4>
<div class="paragraph">
<p>Information incorporated in a substantially human imperceptible way into the <a href="#_digital_content">digital content</a> of an <a href="#_asset">asset</a> which can be used, for example, to uniquely identify the <a href="#_asset">asset</a> or to store a reference to a <a href="#_c2pa_manifest">C2PA Manifest</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_visible_watermark"><a class="anchor" href="#_visible_watermark"></a>2.4.3. Visible Watermark</h4>
<div class="paragraph">
<p>A perceptible component of the <a href="#_digital_content">digital content</a> carrying some human consumable information about the provenance of the <a href="#_asset">asset</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_manifest_repository"><a class="anchor" href="#_manifest_repository"></a>2.4.4. Manifest Repository</h4>
<div class="paragraph">
<p>A repository into which <a href="#_c2pa_manifest">C2PA Manifests</a> and <a href="#_c2pa_manifest_stores">C2PA Manifest Stores</a> can be placed, and which can be searched using a <a href="#_content_binding">content binding</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_overview_2"><a class="anchor" href="#_overview_2"></a>2.5. Overview</h3>
<div class="paragraph">
<p>This image shows how all these various elements come together to represent the C2PA architecture.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/Overview_Diagram.svg" alt="A diagram of how all the parts of C2PA go together" width="697" height="454">
</div>
<div class="title">Figure 3. Elements of C2PA</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_normative_references"><a class="anchor" href="#_normative_references"></a>3. Normative References</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_core_formats"><a class="anchor" href="#_core_formats"></a>3.1. Core Formats</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://tools.ietf.org/html/rfc8949">CBOR</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc8259">JSON</a></p>
</li>
<li>
<p><a href="https://www.w3.org/TR/json-ld11/">JSON-LD</a></p>
</li>
<li>
<p><a href="https://www.iso.org/standard/73604.html">JPEG universal metadata box format</a> (JUMBF)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_schemas"><a class="anchor" href="#_schemas"></a>3.2. Schemas</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL</a></p>
</li>
<li>
<p><a href="https://json-schema.org/specification-links.html#2020-12">JSON Schema</a></p>
</li>
<li>
<p><a href="https://www.dublincore.org/specifications/dublin-core/dces/">Dublin Core Metadata Initiative</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_digital_electronic_signatures"><a class="anchor" href="#_digital_electronic_signatures"></a>3.3. Digital &amp; Electronic Signatures</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://tools.ietf.org/html/rfc5280">X.509 Certificates</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc7518">JSON Web Algorithms</a> (JWA)</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc8152">CBOR Object Signing and Encryption</a> (COSE)</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc8230">Using RSA Algorithms with COSE Messages</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc6960">Online Certificate Status Protocol</a> (OCSP)</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc3161">Internet X.509 PKI Time-Stamp Protocol</a></p>
</li>
<li>
<p><a href="https://datatracker.ietf.org/doc/html/rfc9360">CBOR Object Signing and Encryption (COSE): Header Parameters for Carrying and Referencing X.509 Certificates</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc3279">Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc5758">Internet X.509 Public Key Infrastructure: Additional Algorithms and Identifiers for DSA and ECDSA</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc8410">Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc8017">PKCS #1: RSA Cryptography Specifications Version 2.2</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc8032">Edwards-Curve Digital Signature Algorithm (EdDSA)</a></p>
</li>
<li>
<p><a href="https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf">JSON Advanced Electronic Signatures</a> (JAdES)</p>
</li>
<li>
<p><a href="https://datatracker.ietf.org/doc/html/rfc6234">US Secure Hash Algorithms</a></p>
</li>
<li>
<p><a href="https://www.rfc-editor.org/rfc/rfc9336">X.509 Certificate General-Purpose Extended Key Usage (EKU) for Document Signing</a></p>
</li>
<li>
<p><a href="https://www.rfc-editor.org/rfc/rfc6170.html">RFC 6170</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_embeddable_formats"><a class="anchor" href="#_embeddable_formats"></a>3.4. Embeddable Formats</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.iso.org/standard/74428.html">ISO Base Media File Format</a> (BMFF)</p>
</li>
<li>
<p><a href="https://www.iso.org/standard/51502.html">PDF 1.7</a></p>
</li>
<li>
<p><a href="https://www.iso.org/standard/75839.html">PDF 2.0</a></p>
</li>
<li>
<p><a href="https://www.iso.org/standard/18902.html">JPEG 1</a></p>
</li>
<li>
<p><a href="https://www.iso.org/standard/66071.html">JPEG XT, ISO/IEC 18477-3</a></p>
</li>
<li>
<p><a href="https://www.w3.org/TR/2003/REC-PNG-20031110/">PNG</a></p>
</li>
<li>
<p><a href="https://www.w3.org/TR/SVG11/">SVG</a></p>
</li>
<li>
<p><a href="https://www.w3.org/Graphics/GIF/spec-gif89a.txt">GIF</a></p>
</li>
<li>
<p><a href="https://id3.org/id3v2.3.0">ID3</a></p>
</li>
<li>
<p><a href="https://helpx.adobe.com/content/dam/help/en/photoshop/pdf/dng_spec_1_6_0_0.pdf">Digital Negative or DNG</a></p>
</li>
<li>
<p><a href="https://www.iso.org/standard/29377.html">TIFF/EP</a></p>
</li>
<li>
<p><a href="https://www.itu.int/itudoc/itu-t/com16/tiff-fx/docs/tiff6.pdf">TIFF v6</a>)</p>
</li>
<li>
<p><a href="https://www.loc.gov/preservation/digital/formats/fdd/fdd000025.shtml">RIFF</a></p>
</li>
<li>
<p><a href="https://www.cipa.jp/e/std/std-sec.html">Multi-Picture Format (MPF)</a></p>
</li>
<li>
<p><a href="https://www.iso.org/standard/74461.html">Open Font Format</a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/typography/opentype/spec/">OpenType</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_other"><a class="anchor" href="#_other"></a>3.5. Other</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.iso.org/standard/75163.html">eXtensible Metadata Platform</a> (XMP)</p>
</li>
<li>
<p><a href="https://www.iso.org/standard/79384.html">JSON-LD serialization of XMP</a></p>
</li>
<li>
<p><a href="http://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata">IPTC Photo Metadata Standard</a></p>
</li>
<li>
<p><a href="https://www.cipa.jp/std/documents/download_e.html?DC-008-Translation-2019-E">Exif</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc4122">UUID</a></p>
</li>
<li>
<p><a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO 8601</a></p>
</li>
<li>
<p><a href="https://www.ietf.org/rfc/rfc2326.txt">RFC 2326</a></p>
</li>
<li>
<p><a href="https://www.w3.org/TR/media-frags/">Media Fragments</a></p>
</li>
<li>
<p><a href="https://www.w3.org/TR/annotation-model/">Web Annotation Data Model</a></p>
</li>
<li>
<p><a href="https://datatracker.ietf.org/doc/html/rfc7932">Brotli Compressed Data Format</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_standard_terms"><a class="anchor" href="#_standard_terms"></a>4. Standard Terms</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="https://tools.ietf.org/html/rfc2119">RFC 2119</a>, and <a href="https://tools.ietf.org/html/rfc8174">RFC 8174</a> when they appear in any casing (upper, lower or mixed).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_version_history"><a class="anchor" href="#_version_history"></a>5. Version History</h2>
<div class="sectionbody">
<div class="paragraph">
<p>2.0 - January 2024</p>
</div>
<div class="paragraph">
<p>This version represents a significant departure from previous versions. It no longer has any references to actors as humans or organizations, they can only be hardware or software entities.  This philosophical change led to the following functional changes in the specification:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Only X.509 certificates may be used for signing.</p>
</li>
<li>
<p>Improvements to the Validation &amp; Trust Model sections</p>
<div class="ulist">
<ul>
<li>
<p>Introduces the concepts of "well-formed" and "valid" C2PA Manifests</p>
</li>
<li>
<p>Clarifies various aspects of the validation process</p>
</li>
</ul>
</div>
</li>
<li>
<p>Refined metadata handling</p>
<div class="ulist">
<ul>
<li>
<p>removed the deprecated Exif, IPTC and Schema.org metadata assertions</p>
</li>
<li>
<p>defined a new general "metadata assertion" concept</p>
</li>
<li>
<p><code>c2pa.metadata</code> only allows a fixed set of schemas &amp; values</p>
</li>
<li>
<p>the process for creating <code>c2pa.metadata</code> is now documented in more detail</p>
</li>
<li>
<p>XMP processing sections have been revamped to reflect relevant changes</p>
</li>
<li>
<p>improved recommendations concerning hashing of standard metadata locations outside the manifest</p>
</li>
</ul>
</div>
</li>
<li>
<p>Removed the "W3C Verifiable Credentials" section</p>
<div class="ulist">
<ul>
<li>
<p>Removed any references to it and the VC Store.</p>
</li>
<li>
<p>Removed the <code>actors</code> field from the actions assertion</p>
</li>
<li>
<p>Removed identified humans from assertion metadata</p>
</li>
</ul>
</div>
</li>
<li>
<p>Removed the "Training &amp; Data Mining" assertion</p>
</li>
<li>
<p>Removed the "Endorsements" assertion</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, the following other changes were made to improve various aspects of the spec:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Version v2 version of the claim.</p>
<div class="ulist">
<ul>
<li>
<p>Removes deprecated and unused fields</p>
</li>
<li>
<p>Split <code>assertions</code> into <code>created_assertions</code> &amp; <code>gathered_assertions</code></p>
</li>
<li>
<p>Only allows a single claim generator, which must be the signer</p>
</li>
<li>
<p>More tightly connects it to the signing certificate</p>
</li>
<li>
<p><code>claim-generator-info</code> now has a specific <code>operating_system</code> field</p>
</li>
</ul>
</div>
</li>
<li>
<p>Box-based hashing is now strongly recommended for any format that supports it</p>
</li>
<li>
<p>Removed the deprecated <code>c2pa.hash.bmff</code> assertion</p>
</li>
<li>
<p>Added a new <code>c2pa.watermarked</code> action</p>
</li>
<li>
<p><code>c2pa.font</code> actions are now just <code>font</code> actions</p>
<div class="ulist">
<ul>
<li>
<p>also <code>c2pa.font.info</code> is now just <code>font.info</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Cleaned up rendering of CDDL schemas</p>
</li>
<li>
<p>Updated some normative references &amp; removed notes about future versions</p>
</li>
<li>
<p>Lots of editorial improvements including fixed links</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>1.4 - November 2023</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Added support for embedding a C2PA Manifest into a ZIP-based format (e.g., EPUB, OOXML, ODF, OpenXPS)</p>
</li>
<li>
<p>Manifests can now be compressed into a special <code>brob</code> box.</p>
</li>
<li>
<p>Added support for multiple file, aka collection, hashing</p>
</li>
<li>
<p>Added new regions of interest for text-based formats (e.g., PDF, Office, EPUB, etc.)</p>
</li>
<li>
<p>Added new <code>c2pa.metadata</code> assertion to support Exif, IPTC, Schema.org and XMP</p>
</li>
<li>
<p>Major revision to TIFF embedding support</p>
</li>
<li>
<p>Added support for embedding C2PA Manifests inside of OpenType and TrueType fonts</p>
</li>
<li>
<p>Introduced support for object-level manifests in PDF</p>
</li>
<li>
<p>Extended the Link header support for embedded manifests</p>
</li>
<li>
<p>Clarified issues with box hashing</p>
</li>
<li>
<p>Clarified issues on signing including time stamping, PKIStatus &amp; document signing EKU</p>
</li>
<li>
<p>Align with Exif 3.0</p>
</li>
<li>
<p>Improvements to the CDDL schemas</p>
</li>
<li>
<p>Many editorial improvements</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>1.3 - April 2023</p>
</div>
<div class="ulist">
<ul>
<li>
<p>New v2 version of the actions assertion with support for many new options</p>
</li>
<li>
<p>New v2 version of the ingredient assertion with support for embedded data</p>
</li>
<li>
<p>New asset reference &amp; asset type assertions</p>
</li>
<li>
<p>New data boxes, for storing arbitrary data inside the Manifest</p>
</li>
<li>
<p>New generic box hash methodology for a more inclusive byte range hashing</p>
</li>
<li>
<p>New "Regions of Interest" data structures that can be applied to various assertions</p>
</li>
<li>
<p>Added document signing EKU as an alternative default EKU for C2PA signers when a validator is not configured with an EKU list</p>
</li>
<li>
<p>Added a new <code>digitalSourceType</code> field for use by C2PA</p>
</li>
<li>
<p>Added support for many new formats: MPF, WebP, AIFF, AVI, GIF</p>
</li>
<li>
<p>Updated Entity diagram to reflect additions since 1.0</p>
</li>
<li>
<p>Updated COSE header definition for X.509 certificates to RFC 9360</p>
</li>
<li>
<p>Updated the guidance on PDF embedding and its relationship to PDF signatures</p>
</li>
<li>
<p>Updated information about JUMBF hashing and JUMBF box toggles</p>
</li>
<li>
<p>Deprecated v1 of the BMFF Hash</p>
</li>
<li>
<p>Clarified use of the JUMBF Protection Box in a C2PA Manifest</p>
</li>
<li>
<p>Clarified C2PA-specific requirement that all intermediate X.509 certificates be included in COSE signatures</p>
</li>
<li>
<p>Clarified that time-stamps are valid indefinitely</p>
</li>
<li>
<p>LOTS of editorial improvements!!</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>1.2 - October 2022</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Added details about how to embed a C2PA Manifest in DNG or TIFF</p>
</li>
<li>
<p>Added new <code>digitalSourceType</code> field to Actions</p>
</li>
<li>
<p>Changed <code>stds.iptc.photometadata</code> &#8594; <code>stds.iptc</code> to support IPTC video metadata</p>
</li>
<li>
<p>Clarified versioning of assertions when adding optional fields</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>1.1 - September 2022</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Define a mechanism to support salting box hashing</p>
</li>
<li>
<p>New <code>c2pa.hash.bmff.v2</code> assertion, with changes to hashing model, to improve security</p>
</li>
<li>
<p>Enable assertion metadata for the Claim</p>
</li>
<li>
<p>Replaced <code>claim_generator_hints</code> with <code>claim_generator_info</code></p>
</li>
<li>
<p>Added a new assertion to support the concept of Endorsements</p>
</li>
<li>
<p>Improvements to the <code>c2pa.actions</code> assertion</p>
</li>
<li>
<p>All Error &amp; Status Codes are now prefixed with <code>c2pa</code></p>
</li>
<li>
<p>Define mechanism for redaction of W3C VC&#8217;s</p>
</li>
<li>
<p>Clarify validation of EKUs in certificates</p>
</li>
<li>
<p>Validation algorithm revised to reflect technical changes</p>
</li>
<li>
<p>Corrections to the CDDL and JSON schemas to match normative text</p>
</li>
<li>
<p>Revise figures to reflect changes</p>
</li>
<li>
<p>Various Editorial and Typographical Corrections</p>
</li>
<li>
<p>Update Normative References (incl. JUMBF &amp; W3C VC Data Model)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>1.0 - December 2021</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Initial Release</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_assertions"><a class="anchor" href="#_assertions"></a>6. Assertions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_general"><a class="anchor" href="#_general"></a>6.1. General</h3>
<div class="paragraph">
<p>It is expected that each claim generator, used by actors in the system that creates or processes an asset, will create or assemble one or more assertions about when, where, and how the asset was originated or transformed. An assertion is labelled data, typically (though not required to be) in a CBOR-based structure which represents a declaration about an asset. Some of these assertions will contain human-generated information (e.g., alternate text for accessibility) while others will come from machines (software/hardware) providing the information they generated (e.g., camera type).</p>
</div>
<div class="paragraph">
<p>Some examples of assertions are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Metadata (e.g. camera information such as maker or lens)</p>
</li>
<li>
<p>Actions performed on the asset (e.g., clipping, color correction)</p>
</li>
<li>
<p>Thumbnail of the asset or its ingredients</p>
</li>
<li>
<p>Content bindings (e.g., cryptographic hashes)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Certain assertions may be redacted by subsequent claims (see <a href="#_redaction_of_assertions">Section 6.7, &#8220;Redaction of Assertions&#8221;</a>), but they cannot be modified once made as part of a claim.</p>
</div>
</div>
<div class="sect2">
<h3 id="_labels"><a class="anchor" href="#_labels"></a>6.2. Labels</h3>
<div class="paragraph">
<p>Each assertion has a label defined either by the C2PA specifications or an external entity.</p>
</div>
<div class="paragraph">
<p>Labels are string values organized into namespaces using a period (<code>.</code>) as a separator.  The namespace component of the label can be an entity, or a reference to a well-established standard (see ABNF below). The most common labels will be defined by the C2PA and will begin with <code>c2pa.</code>. Entity-specific labels shall begin with the Internet domain name for the entity similar to how Java packages are defined (e.g., <code>com.litware</code>, <code>net.fineartschool</code>). They are also versioned with a simple incrementing integer scheme (e.g., <code>c2pa.actions.v2</code>). If no version is provided, it is considered as <code>v1</code>. The list of publicly known labels can be found in <a href="#_c2pa_standard_assertions">Chapter 18, <em>C2PA Standard Assertions</em></a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-abnf hljs" data-lang="abnf">namespaced-label = qualified-namespace label
qualified-namespace = entity / ( "stds."  std-name )
entity = 1*( DIGIT / ALPHA / "-" )
std-name = 1*( DIGIT / ALPHA / "-" )
label = 1*("." 1(ALPHA / "_" ) *( DIGIT / ALPHA / "_" ) )</code></pre>
</div>
</div>
<div class="paragraph">
<p>The period-separated components of a label follow the variable naming convention (<code>[a-zA-Z_][a-zA-Z0-9_]*</code>) specified in the POSIX or C locale, with the restriction that the use of a repeated underscore character (<code>__</code>) is reserved for labelling multiple assertions of the same type.</p>
</div>
</div>
<div class="sect2">
<h3 id="_versioning"><a class="anchor" href="#_versioning"></a>6.3. Versioning</h3>
<div class="paragraph">
<p>When an assertion&#8217;s schema is changed, it should be done in a backwards-compatible manner. This means that new fields may be added and existing ones may be marked as deprecated (i.e., can be read, but never written). Existing fields shall not be removed. The label would then consist of an incremented version number, for example moving from <code>c2pa.hash.bmff</code> (deprecated) to <code>c2pa.hash.bmff.v2</code>.</p>
</div>
<div class="paragraph">
<p>Since the addition of optional fields can be done while maintaining backwards compatibility, such fields may be added to an existing assertion&#8217;s schema without a change to the version number.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The schemas provided in this document, as well as the machine readable ones that can be downloaded from our website, should only be used for aids in understanding the syntax to be read or written. It is not necessary, nor it is recommended, for a Manifest Consumer to perform any form of schema validation when reading in assertions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Deprecated fields for C2PA standard assertions shall be indicated in <a href="#_c2pa_standard_assertions">Chapter 18, <em>C2PA Standard Assertions</em></a>. Claim generators shall not insert data into deprecated assertion fields when creating assertions.</p>
</div>
<div class="paragraph">
<p>In addition, there are situations where a non-backwards compatible change is required. In that case, instead of increasing the label&#8217;s version number, the assertion shall be given a new label. For example, <code>c2pa.ingredient</code> could be changed to the fictional <code>c2pa.component</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_multiple_instances"><a class="anchor" href="#_multiple_instances"></a>6.4. Multiple Instances</h3>
<div class="paragraph">
<p>Multiple assertions of the same type can occur in the same manifest, but since assertions are referenced by claims via their label, the assertion labels must be unique.  This is accomplished by adding a double-underscore and a monotonically increasing index to the label.  For example, if a manifest contains a single assertion of type <code>c2pa.metadata</code>, then the assertion label will be <code>c2pa.metadata</code>.  If a manifest contains three assertions of this type, the labels will be <code>c2pa.metadata</code>, <code>c2pa.metadata__1</code> and <code>c2pa.metadata__2</code>.</p>
</div>
<div class="paragraph">
<p>When a label includes a version number, that version number is part of the label itself. As such, when there are multiple instances, the instance number continues to follow the label - e.g., <code>c2pa.ingredient.v2__2</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_assertion_store"><a class="anchor" href="#_assertion_store"></a>6.5. Assertion Store</h3>
<div class="paragraph">
<p>The set of assertions referenced by a <a href="#_claims">claim</a> in a manifest are collected together into a logical construct that is referred to as the <em>assertion store</em>. The assertions and assertion store shall be stored as described in <a href="#_use_of_jumbf">Section 11.1, &#8220;Use of JUMBF&#8221;</a>; in particular, the assertion store shall be located in the same C2PA Manifest box as the claim that refers to its assertions.</p>
</div>
<div class="paragraph">
<p>For each manifest, there is a single assertion store associated with it. However, as an asset may have multiple manifests associated with it, each one representing a specific series of assertions, there may be multiple assertion stores associated with an asset.</p>
</div>
</div>
<div class="sect2">
<h3 id="_embedded_vs_externally_stored_data"><a class="anchor" href="#_embedded_vs_externally_stored_data"></a>6.6. Embedded vs Externally-Stored Data</h3>
<div class="paragraph">
<p>Some assertion data, due to its size or an infrequent need for it, may be externally hosted. Such data are not embedded in the assertion store, but instead are referenced by URI. This is accomplished through a cloud data assertion (see <a href="#_cloud_data">Section 18.10, &#8220;Cloud Data&#8221;</a>). Unlike embedded assertion data, cloud data is not retrieved nor validated as part of manifest validation, and are only retrieved and validated when specifically needed by an application according to a different set of validation rules as described in <a href="#_validate_the_assertions">Section 15.7, &#8220;Validate the Assertions&#8221;</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_redaction_of_assertions"><a class="anchor" href="#_redaction_of_assertions"></a>6.7. Redaction of Assertions</h3>
<div class="paragraph">
<p>Assertions that are present in an asset-embedded manifest may be removed from that asset&#8217;s manifest when the asset is <a href="#_ingredient_storage">used as an ingredient</a>. This process is called redaction.</p>
</div>
<div class="paragraph">
<p>Redaction involves removing either the entire assertion from the manifest&#8217;s assertion store or retaining the labelled assertion container but replacing its data with zeros (binary <code>\0</code> values). In addition, a record that something was removed must be added to the <a href="#_claims">claim</a> in the form of a <a href="#_uri_references">URI reference</a> to the redaction assertion in the <code>redacted_assertions</code> field of the claim. It is also strongly recommended that the claim generator should add a <code>c2pa.redaction</code> <a href="#_actions">action assertion</a> with a <code>redacted</code> field as described in <a href="#_parameters">Section 18.12.2, &#8220;Parameters&#8221;</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Because each assertion&#8217;s <a href="#_uri_references">URI reference</a> includes the assertion label, it is also known what type of information (e.g., thumbnail, metadata, etc.) was removed. This enables both humans and machines to apply rules to determine if the removal was acceptable.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Unless the redaction of the assertion also requires modification to the digital content, an <a href="#_update_manifests">update manifest</a> shall be used to document the redaction as it makes a statement about the non-changes to the content.</p>
</div>
<div class="paragraph">
<p>Claims generators shall not redact assertions with a label of <code>c2pa.actions</code> as this assertion type represents essential information in understanding the history of an asset.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_data_boxes"><a class="anchor" href="#_data_boxes"></a>7. Data Boxes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Data boxes provide a way to include arbitrary data into the C2PA Manifest that is referenced from an assertion, instead of embedding it directly into a field of the assertion as a binary string. These data boxes are placed in the <a href="#_data_storage">Data Box Store</a> and each one will be a single CBOR Content Type box (<code>cbor</code>).</p>
</div>
<div class="paragraph">
<p>The data of a data box is provided directly as the value of the <code>data</code> field, which is a <code>bstr</code>, so any binary data can be provided.  The type of the data shall be identified using the <code>dc:format</code> field, with a standard IANA media type.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<a href="https://www.iana.org/assignments/media-type-structured-suffix/media-type-structured-suffix.xhtml">IANA structured suffixes</a>, such as <code>+json</code> and <code>+zip</code>, are also supported as values of the <code>dc:format</code> field.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Sometimes, it may also be necessary to provide one or more <a href="#_asset_type">asset types</a> as the value of the <code>data_types</code> field for more clarity on the format and usage of that data.</p>
</div>
<div class="paragraph">
<p>A data box shall have a label of <code>c2pa.data</code> and follows the <a href="#_multiple_instances">rules of assertion labels</a> with respect to multiple instances.</p>
</div>
<div class="sect2">
<h3 id="_schema_and_example"><a class="anchor" href="#_schema_and_example"></a>7.1. Schema and Example</h3>
<div class="paragraph">
<p>The schema for this type is defined by the <code>data-box-map</code> rule in the following <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; box allowing for the storage of arbitrary data

data-box-map = {
  "dc:format": format-string, ; IANA media type of the data
  "data" : bstr, ; arbitrary text/binary data
  ? "data_types": [1* $asset-type-map],  ; additional information about the data's type
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_unique_identifiers"><a class="anchor" href="#_unique_identifiers"></a>8. Unique Identifiers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Every asset that is referenced by the <a href="#_claims">claim</a> shall be referenced via a unique identifier. In addition, these identifiers are used in various parts of a C2PA-enabled workflow, such as when identifying it as an <a href="#_ingredient">ingredient</a> in a derived or composed asset.</p>
</div>
<div class="sect2">
<h3 id="_using_xmp_values"><a class="anchor" href="#_using_xmp_values"></a>8.1. Using XMP values</h3>
<div class="paragraph">
<p>When an asset contains embedded XMP which include values for <code>xmpMM:DocumentID</code> and/or <code>xmpMM:InstanceID</code> as defined in <a href="https://github.com/adobe/xmp-docs/blob/master/XMPSpecifications/XMPSpecificationPart2.pdf">XMP Specification Part 2, 2.2</a>, those values shall be included in a <a href="#_metadata">metadata assertion</a> and should be used as identifiers for the asset.</p>
</div>
</div>
<div class="sect2">
<h3 id="_other_identifiers"><a class="anchor" href="#_other_identifiers"></a>8.2. Other Identifiers</h3>
<div class="paragraph">
<p>Alternatively, instead of using the identifiers from XMP, a unique identifier for an asset could be a URI defined by standards such as <a href="https://www.w3.org/TR/did-core/">Decentralized Identifiers (DID)</a>, <a href="http://www.handle.net/">Handle</a>, or <a href="https://www.doi.org/">DOI</a>.</p>
</div>
<div class="paragraph">
<p>Another standard unique identifier for an asset could be the cryptographic hash of the asset. When this method is used, the hash shall be represented using a standard <a href="https://tools.ietf.org/html/rfc4122">RFC 4122 UUID</a> following the recommendations at <a href="https://datatracker.ietf.org/doc/html/draft-thiemann-hash-urn-01" class="bare">https://datatracker.ietf.org/doc/html/draft-thiemann-hash-urn-01</a> .</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">EDITORS NOTE</div>
Other methods may be defined here as they are developed.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_uri_references"><a class="anchor" href="#_uri_references"></a>8.3. URI References</h3>
<div class="paragraph">
<p>All references to information in the manifest, whether stored internally to the asset (i.e., embedded) or stored externally to the asset (e.g., in the cloud), shall be referenced via JUMBF URI references as defined in <a href="https://www.iso.org/standard/84635.html">ISO 19566-5, C.2</a>. These URIs shall be used either as part of a <code>hashed_uri</code> or <code>hashed_ext_uri</code> data structure.</p>
</div>
<div class="paragraph">
<p>When the reference is to a <a href="#_compressed_manifests">compressed manifest</a>, the JUMBF URI shall not contain anything about the <code>brob</code> box, but the URI to the manifest is treated as if the manifest was not compressed. This means that the URI would include the label of the <code>c2ma</code> or <code>c2um</code> box, but not the label of the <code>c2cm</code> box. In addition, the URI reference to a compressed manifest shall not include the label of the <code>brob</code> box - but only the label of the compressed manifest itself.</p>
</div>
<div class="sect3">
<h4 id="_hashed_uris"><a class="anchor" href="#_hashed_uris"></a>8.3.1. Hashed URIs</h4>
<div class="sect4">
<h5 id="_embedded"><a class="anchor" href="#_embedded"></a>8.3.1.1. Embedded</h5>
<div class="paragraph">
<p>A <code>hashed_uri</code> is used when the URI is for something embedded in the same manifest store.</p>
</div>
<div class="paragraph">
<p>This specification provides an equivalent <code>hashed-uri-map</code> data structure for schemas defined using <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; The data structure used to store a reference to a URL within the same JUMBF and its hash. We use a socket/plug here to allow hashed-uri-map to be used in individual files without having the map defined in the same file
$hashed-uri-map /= {
  "url": url-regexp-type, ; JUMBF URI reference
  ? "alg": tstr .size (1..max-tstr-length), ; A string identifying the cryptographic hash algorithm used to compute all hashes in this claim, taken from the C2PA hash algorithm identifier list. If this field is absent, the hash algorithm is taken from an enclosing structure as defined by that structure. If both are present, the field in this structure is used. If no value is present in any of these places, this structure is invalid; there is no default.
  "hash": bstr, ;  byte string containing the hash value
}

; with CBOR Head (#) and tail ($) are introduced in regexp, so not needed explicitly
url-regexp-type  /= tstr .regexp "self#jumbf=[\\w\\d][\\w\\d\\.\/:-]+[\\w\\d]"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because assertion stores shall be located in the same C2PA Manifest box as the claim that refers to them, only <code>self#jumbf</code> URIs are permitted. These <code>self#jumbf</code> URIs may be relative to the entire C2PA Manifest Store, in which case they shall start with a <code>/</code> (U+002F, Slash), or relative to the current C2PA Manifest. URIs shall not contain the sequence <code>..</code> (a pair of U+002E, Full Stop).</p>
</div>
<div class="paragraph">
<p><strong>EXAMPLES:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>self#jumbf=/c2pa/urn:uuid:f095f30e-6cd5-4bf7-8c44-ce8420ca9fb7/c2pa.assertions/c2pa.thumbnail.claim.jpeg</code> is relative to the entire store (since it starts with <code>/</code>),</p>
</li>
<li>
<p><code>self#jumbf=c2pa.assertions/c2pa.thumbnail.claim.jpeg</code> would be relative to the manifest of the box containing the URI.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_external"><a class="anchor" href="#_external"></a>8.3.1.2. External</h5>
<div class="paragraph">
<p>When referring to a resource that exists externally to the manifest store, a <code>hashed-ext-uri-map</code> data structure is used.  It is a variation on the <code>hashed-uri</code>, in that it references an external URI instead of a <code>self#jumbf</code>. The <code>hashed-ext-uri</code> data structure is defined by the <code>hashed-ext-uri-map</code> rule in the following CDDL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; The data structure used to store a reference to an external URL and its hash. 
; We use a socket/plug here to allow hashed-ext-uri-map to be used in individual files 
; without having the map defined in the same file
$hashed-ext-uri-map /= {
  "url": ext-url-regexp-type, ; http/https URI reference
  "alg": tstr .size (1..max-tstr-length), ; A string identifying the cryptographic hash algorithm used to compute the hash on this URI's data, taken from the C2PA hash algorithm identifier list. Unlike alg fields in other types, this field is mandatory here.
  "hash": bstr, ;  byte string containing the hash value
  ? "dc:format": format-string, ; IANA media type of the data
  ? "size": size-type, ; Number of bytes of data
  ? "data_types": [1* $asset-type-map],  ; additional information about the data's type
}

; with CBOR Head (#) and tail ($) are introduced in regexp, so not needed explicitly
ext-url-regexp-type  /= tstr .regexp "https?:\/\/[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b[-a-zA-Z0-9@:%_\\+.~#?&amp;//=]*"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In keeping with common practice, it is recommended that the <code>https</code> scheme be used to retrieve assertion data to protect the privacy of the data in transit, but <code>http</code> is also permitted because the data&#8217;s integrity is protected by the <code>hash</code> field and this privacy may not be required in all circumstances. Authors of manifests with external URIs should choose the scheme to suit their needs.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The optional <code>dc:format</code> field, when present, provides an alternative to the <code>Content-Type</code> field of the http(s) headers. If present, this field shall be used as the required format retrieved during any content negotiate/request.  Sometimes, it may also be necessary to provide one or more <a href="#_asset_type">asset types</a> as the value of the <code>data_types</code> field for more clarity on the format and usage of that data.</p>
</div>
<div class="paragraph">
<p>An optional <code>size</code> field is also provided to specify the size of the data to be retrieved.  This may be useful to a Manifest Consumer as a hint as to whether to attempt downloading and/or for validation purposes, in addition to the hash.</p>
</div>
</div>
<div class="sect4">
<h5 id="_hashing_jumbf_boxes"><a class="anchor" href="#_hashing_jumbf_boxes"></a>8.3.1.3. Hashing JUMBF Boxes</h5>
<div class="paragraph">
<p>When creating a URI reference to an assertion (i.e., as part of constructing a <a href="#_claims">Claim</a>) or other C2PA structure stored as a JUMBF box, the hash shall be performed over the contents of the structure&#8217;s JUMBF superbox, which includes both the JUMBF Description Box and all content boxes therein (but does not include the structure&#8217;s JUMBF superbox header).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
More details on hashing can be found at <a href="#_hashing">Section 11.3.4.2, &#8220;Hashing&#8221;</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As described in the latest version of JUMBF (ISO 19566-5:2023), a new <code>Private</code> field can be present as part of any JUMBF Description box. This C2PA specification defines the C2PA salt as a <code>Private</code> field whose value is a standard box consisting of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a box length (LBox, as a 4-byte big-endian unsigned integer)</p>
</li>
<li>
<p>a box type (TBox, 4-byte big-endian unsigned integer, with a value of <code>c2sh</code> (for C2PA salt hash))</p>
</li>
<li>
<p>and payload data (consisting of randomly-generated binary data of either 16 or 32 bytes in length).</p>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/assertion_JUMBF.drawio.svg" alt="Example assertion structure" width="361" height="451">
</div>
<div class="title">Figure 4. Example <code>c2pa.actions</code> assertion</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_binding_to_content"><a class="anchor" href="#_binding_to_content"></a>9. Binding to Content</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_3"><a class="anchor" href="#_overview_3"></a>9.1. Overview</h3>
<div class="paragraph">
<p>A key aspect to the <a href="#_standard_manifests">standard C2PA manifest</a> is the presence of one or more data structures, called content bindings, that can uniquely identify portions of the asset. There are two types of bindings that are supported by C2PA - hard bindings and soft bindings. A hard binding (also known as a cryptographic binding) enables the validator to ensure that (a) this manifest belongs with this asset and (b) that the asset has not been modified, by determining values that can match only this asset and no other, not even other assets derived from it or renditions produced from it.  A soft binding is computed from the digital content of an asset, rather than its raw bits.  A soft binding is useful for identifying derived assets and asset renditions.</p>
</div>
<div class="paragraph">
<p>A single manifest shall not contain more than one assertion defining a hard binding.</p>
</div>
</div>
<div class="sect2">
<h3 id="_hard_bindings"><a class="anchor" href="#_hard_bindings"></a>9.2. Hard Bindings</h3>
<div class="sect3">
<h4 id="_hashing_using_byte_ranges"><a class="anchor" href="#_hashing_using_byte_ranges"></a>9.2.1. Hashing using byte ranges</h4>
<div class="paragraph">
<p>The simplest type of hard binding that can be used to detect tampering is a cryptographic hashing algorithm, as described in <a href="#_hashing">Section 11.3.4.2, &#8220;Hashing&#8221;</a>, over some or all of the bytes of an asset. This approach can be used on any type of asset, but should only be considered for formats that don&#8217;t support one of the forms of box-based hashing.</p>
</div>
<div class="paragraph">
<p>When using this form of hard binding, a <a href="#_data_hash">data hash assertion</a> is used to define the range of bytes that are hashed (and those that are not). Because a data hash assertion defines a byte range, it is flexible enough to be usable whether the asset is a single binary or represented in multiple chunks or portions.</p>
</div>
</div>
<div class="sect3">
<h4 id="_hashing_using_a_general_box_hash"><a class="anchor" href="#_hashing_using_a_general_box_hash"></a>9.2.2. Hashing using a general box hash</h4>
<div class="paragraph">
<p>When an asset&#8217;s format is a non-BMFF-based box format, such as JPEG, PNG, GIF or others listed <a href="#_handling_for_specific_formats">here</a>, then a <a href="#_boxes_hash">general box hash</a> assertion should be used. This assertion consists of an array of structures, each one listing one or more boxes (by their name/identifier) and a hash that covers that data of those boxes (and any possible data that may be present in the file between them), along with the algorithm used for <a href="#_hashing">hashing</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_hashing_a_bmff_formatted_asset"><a class="anchor" href="#_hashing_a_bmff_formatted_asset"></a>9.2.3. Hashing a BMFF-formatted asset</h4>
<div class="paragraph">
<p>If the asset is based on <a href="https://www.iso.org/standard/74428.html">ISO BMFF</a> then a hard binding optimized for the box-based format (called <a href="#_bmff_based_hash">BMFF-based hash assertions</a>) may be used instead.</p>
</div>
<div class="paragraph">
<p>For a monolithic MP4 file asset where the <code>mdat</code> box is validated as a unit, the assertion is validated nearly identically to a data hash assertion.  It simply uses a box exclusion list instead of byte ranges to define the range of bytes that are hashed (and those that are not).</p>
</div>
<div class="paragraph">
<p>For a monolithic MP4 file asset where the <code>mdat</code> box is validated piecemeal or an asset composed of fragmented MP4 (fMP4) files, the assertion itself must be combined with chunk-specific hashing information which is located as specified in <a href="#_embedding_manifests_into_bmff_based_assets">Section 11.3.3, &#8220;Embedding manifests into BMFF-based assets&#8221;</a>.  Validating a given chunk requires first validating the <code>merkle</code> field&#8217;s <code>initHash</code> over the corresponding initialization segment and then locating the correct entry in the <code>merkle</code> field&#8217;s <code>hashes</code> array and validating it against the hash of the chunk&#8217;s data plus (if needed) deriving the hash using the other <code>hashes</code> specified in the chunk&#8217;s C2PA-specific box.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/BMFF_Validation-Initialization.svg" alt="Validating the initialization segment">
</div>
<div class="title">Figure 5. Validating the initialization segment</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/BMFF_Validation-Chunks.svg" alt="Validating the chunk&#8217;s data">
</div>
<div class="title">Figure 6. Validating the chunk&#8217;s data</div>
</div>
</div>
<div class="sect3">
<h4 id="_asset_metadata_bindings"><a class="anchor" href="#_asset_metadata_bindings"></a>9.2.4. Asset Metadata Bindings</h4>
<div class="paragraph">
<p><a href="#_c2pa_signer">Signers</a> of the C2PA Manifest are not required to sign the asset metadata not contained within the C2PA Manifest. In such a case, the asset metadata shall be excluded by <a href="#_data_hash">data hash assertions</a> and their boxes shall not be listed by <a href="#_general_boxes_hash">general box hash assertions</a> or <a href="#_bmff_based_hash">BMFF-based hash assertions</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Not including asset metadata in a <a href="#_data_hash">data hash assertion</a> is a security concern, which is why using a <a href="#_general_boxes_hash">general box hash assertion</a>, when possible, is preferred if not signing the asset metadata.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Any asset metadata values that are supported by the <a href="#_metadata">common metadata assertion</a>, as described in <a href="#metadata_annex">Appendix A, <em>Implementation Details for <code>c2pa.metadata</code></em></a>, and can be asserted by the signer should be copied into such an assertion and included in the C2PA Manifest.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_soft_bindings"><a class="anchor" href="#_soft_bindings"></a>9.3. Soft Bindings</h3>
<div class="paragraph">
<p>Soft bindings are described using <a href="#_soft_binding">soft binding assertions</a> such as via a perceptual hash computed from the digital content or a watermark embedded within the digital content. These soft bindings enable digital content to be matched even if the underlying bits differ, for example due to an asset rendition in a different resolution or encoding format. Additionally, should a C2PA manifest be removed from an asset, but a copy of that manifest remains in a provenance store elsewhere, the manifest and asset may be matched using available soft bindings.</p>
</div>
<div class="paragraph">
<p>Because they serve a different purpose, a soft binding shall not be used as a hard binding.</p>
</div>
<div class="paragraph">
<p>All soft bindings shall be generated using one of the algorithms listed as supported by this specification. This section is intended to provide:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A list of algorithms that are allowed for generating soft bindings of new content as well as required for validating or locating existing content (the allowed list), and</p>
</li>
<li>
<p>A list of algorithms that are required to be supported for validating or locating existing content but are not allowed for generating soft bindings of new content (the deprecated list).</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_pre_defined"><a class="anchor" href="#_pre_defined"></a>9.3.1. Pre-defined</h4>
<div class="paragraph">
<p>There are no soft binding algorithms defined in the approved list nor in the deprecated list in this version of the specification.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The C2PA is currently evaluating various soft binding algorithms. One of the many possible options includes the <a href="https://iscc.codes/">ISCC - International Standard Content Code</a>. The ISCC is an identifier and fingerprint for digital assets that supports all major content types (e.g., text, image, audio, video). The ISCC uses is similarity-preserving hashes generated both from metadata and content.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_future_requirements"><a class="anchor" href="#_future_requirements"></a>9.3.2. Future Requirements</h4>
<div class="paragraph">
<p>This list of allowed algorithms will define the string algorithm identifier to be used as the algorithm identifier in the corresponding field and the content types over which it is applicable. In cases where there are different versions of an algorithm, each will be defined using different string algorithm identifiers.  Any technical documentation sufficient for the soft binding algorithm to be uniquely identified and utilized, should be referenced.</p>
</div>
<div class="paragraph">
<p>Each algorithm should be defined along with the names and values of all parameters affecting the operation of that algorithm. When doing so, it shall describe the manner in which those parameters must be encoded within the <code>alg-params</code> field of the <a href="#_soft_binding">soft binding assertion</a>.  An algorithm that is instantiated over a different parameter set will be considered a different algorithm.</p>
</div>
<div class="paragraph">
<p>Each algorithm may also define an encoding scheme for specifying the portion of digital content over which a soft binding is computed (namely, the <code>extent</code> field of the <code>scope</code> object within the <a href="#_soft_binding">soft binding assertion</a>).  An algorithm that encodes the <code>extent</code> differently will be considered a different algorithm.</p>
</div>
<div class="paragraph">
<p>It is recommended that the string identifiers for soft binding algorithms conform to how they are referred to in common practice.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_claims"><a class="anchor" href="#_claims"></a>10. Claims</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_4"><a class="anchor" href="#_overview_4"></a>10.1. Overview</h3>
<div class="paragraph">
<p>A <strong>claim</strong> gathers together all the assertions about an asset at a given time including the set of assertions for <a href="#_binding_to_content">binding to the content</a>. The claim is then cryptographically hashed and signed as described in <a href="#_signing_a_claim">Section 10.3.2.4, &#8220;Signing a Claim&#8221;</a>. A claim has all the same properties as an assertion including being assigned the label (<code>c2pa.claim.v2</code>) and supporting the use of <a href="#_metadata_about_assertions">assertion metadata</a>. It encoded as CBOR data, and such, shall comply with the <a href="https://www.rfc-editor.org/rfc/rfc8949.html#name-core-deterministic-encoding">"Core Deterministic Encoding Requirements" of CBOR</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A previous version of this specification used the label <code>c2pa.claim</code>, which is now deprecated.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_syntax"><a class="anchor" href="#_syntax"></a>10.2. Syntax</h3>
<div class="paragraph">
<p>The schema for this type is defined by the <code>claim-map</code> rule in the following <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; CDDL schema for a claim map in C2PA
claim-map = {
  "claim_generator": tstr, ; A User-Agent string formatted as per http://tools.ietf.org/html/rfc7231#section-5.5.3, for including the name and version of the claims generator that created the claim
  "claim_generator_info": [1* generator-info-map],
  "signature": jumbf-uri-type, ; JUMBF URI reference to the signature of this claim
  "assertions": [1* $hashed-uri-map],
  "dc:format": tstr, ; media type of the asset
  "instanceID": tstr .size (1..max-tstr-length), ; uniquely identifies a specific version of an asset
  ? "dc:title": tstr .size (1..max-tstr-length), ; name of the asset,
  ? "redacted_assertions": [1* jumbf-uri-type], ; List of hashed URI references to the assertions of ingredient manifests being redacted
  ? "alg": tstr .size (1..max-tstr-length), ; A string identifying the cryptographic hash algorithm used to compute all data hash assertions listed in this claim unless otherwise overridden, taken from the C2PA data hash algorithm identifier registry. This provides the value for the 'alg' field in data-hash and hashed-uri structures contained in this claim
  ? "alg_soft": tstr .size (1..max-tstr-length), ; A string identifying the algorithm used to compute all soft binding assertions listed in this claim unless otherwise overridden, taken from the C2PA soft binding algorithm identifier registry."
  ? "metadata": $assertion-metadata-map, ; additional information about the assertion
}

; CDDL schema for a claim map in C2PA
claim-map-v2 = {
  "instanceID": tstr .size (1..max-tstr-length), ; uniquely identifies a specific version of an asset
  "claim_generator_info": $generator-info-map, ; the claim generator of this claim
  "signature": jumbf-uri-type, ; JUMBF URI reference to the signature of this claim
  "created_assertions": [1* $hashed-uri-map],
  ? "gathered_assertions": [1* $hashed-uri-map],
  ? "dc:title": tstr .size (1..max-tstr-length), ; name of the asset,
  ? "redacted_assertions": [1* jumbf-uri-type], ; List of hashed URI references to the assertions of ingredient manifests being redacted
  ? "alg": tstr .size (1..max-tstr-length), ; A string identifying the cryptographic hash algorithm used to compute all data hash assertions listed in this claim unless otherwise overridden, taken from the C2PA data hash algorithm identifier registry. This provides the value for the 'alg' field in data-hash and hashed-uri structures contained in this claim
  ? "alg_soft": tstr .size (1..max-tstr-length), ; A string identifying the algorithm used to compute all soft binding assertions listed in this claim unless otherwise overridden, taken from the C2PA soft binding algorithm identifier registry."
  ? "metadata": $assertion-metadata-map, ; additional information about the assertion
}

jumbf-uri-type = tstr .regexp "self#jumbf=[\\w\\d][\\w\\d\\.\/:-]+[\\w\\d]"

generator-info-map = {
  "name": tstr .size (1..max-tstr-length), ; A human readable string naming the claim generator	  
  ? "version": tstr, ; A human readable string of the product's version	
  ? "icon": hashed-uri-map / $hashed-ext-uri-map, ; hashed URI to the icon (either embedded or remote)
  ? "operating_system": tstr, ; A human readable string of the operating system the claim generator is running on	
  * tstr =&gt; any
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in <a href="https://www.rfc-editor.org/rfc/rfc8949.html#name-diagnostic-notation">CBOR-Diag</a> is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{
  "alg" : "sha256",
	"claim_generator_info" : [
		{
			"name": "Joe's Photo Editor",
			"version": "2.0",
			"operating_system": "Windows 10"
		}
	],
  "signature" : "self#jumbf=c2pa/urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.signature",
  "dc:format": "image/jpeg",
  "assertions" : [
    {
      "url": "self#jumbf=c2pa/urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.assertions/c2pa.hash.data",
      "hash": b64'U9Gyz05tmpftkoEYP6XYNsMnUbnS/KcktAg2vv7n1n8='
    },
    {
      "url": "self#jumbf=c2pa/urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.assertions/c2pa.thumbnail.claim.jpeg",
      "hash": b64'G5hfJwYeWTlflxOhmfCO9xDAK52aKQ+YbKNhRZeq92c='
    },
    {
      "url": "self#jumbf=c2pa/urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.assertions/c2pa.claim.v2.ingredient",
      "hash": b64'Yzag4o5jO4xPyfANVtw7ETlbFSWZNfeM78qbSi8Abkk='
    }
  ],
  "redacted_assertions" : [
    "self#jumbf=c2pa/urn:uuid:5E7B01FC-4932-4BAB-AB32-D4F12A8AA322/c2pa.assertions/c2pa.metadata"
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If present, the value of <code>dc:title</code> shall be a human-readable name for the asset.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>c2pa.claim</code> has a <code>dc:format</code> field which is no longer present in <code>c2pa.claim.v2</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the asset contains XMP, then the asset&#8217;s <code>xmpMM:InstanceID</code> should be used as the <code>instanceID</code>. When no XMP is available, then some other <a href="#_unique_identifiers">unique identifier</a> for the asset shall be used as the value for <code>instanceID</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Some field names, such as <code>dc:title</code>, have namespace prefixes as their names and definitions are taken directly from the XMP standard.  However, their usage in C2PA does not require the use of XMP.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>signature</code> field shall be present containing a <a href="#_uri_references">URI reference</a> to a <a href="#_signing_a_claim">claim signature</a>.</p>
</div>
<div class="paragraph">
<p>The <code>created_assertions</code> field shall be present containing one or more <a href="#_uri_references">URI references</a> to the <a href="#_assertions">assertions</a> being made by this claim that were created by the claim generator.  There shall be at least one assertion in this list that represents a hard binding - either a <a href="#_data_hash">data hash assertion</a>, a <a href="#_general_box_hash">general boxes hash assertion</a>, or a <a href="#_bmff_based_hash">BMFF-based hash assertion</a>.</p>
</div>
<div class="paragraph">
<p>When present, the <code>gathered_assertions</code> field shall contain one or more <a href="#_uri_references">URI references</a> to assertions that have not been created by the claim generator but have been provided by other components in the workflow.</p>
</div>
<div class="paragraph">
<p>When present, the <code>redacted_assertions</code> field shall contain one or more <a href="#_uri_references">URI references</a> to <a href="#_redaction_of_assertions">redacted assertions</a>.</p>
</div>
<div class="sect3">
<h4 id="_claim_generator_info"><a class="anchor" href="#_claim_generator_info"></a>10.2.1. Claim Generator Info</h4>
<div class="paragraph">
<p>Detailed information about the claim generator shall be present as the value of <code>claim_generator_info</code>. A Manifest Consumer shall use the value of <code>claim_generator_info</code> in determining information about the claim generator for itself or for presentation in a UX.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>c2pa.claim</code> has a <code>claim_generator</code> field, whose value is a simple string, which is no longer present in <code>c2pa.claim.v2</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_generator_info_map"><a class="anchor" href="#_generator_info_map"></a>10.2.1.1. Generator Info Map</h5>
<div class="paragraph">
<p>When adding a <code>claim_generator_info</code> field, its value is a <code>generator-info-map</code> object which shall contain a <code>name</code> field.  It may also contain a <code>version</code> field and/or an <code>icon</code> field, though any other field is permitted, using the standard entity-specific labels' format described in <a href="#_labels">Section 6.2, &#8220;Labels&#8221;</a>. The data in this object shall represent the non-human (hardware or software) <a href="#_actor">actor</a> that actually generated the claim (aka the <a href="#claim-generator-definition">claim generator</a> itself).</p>
</div>
<div class="paragraph">
<p>A claim generator may desire to provide a graphical representation of itself, referred here as an <code>icon</code>, to a Manifest Consumer that is presenting a user experience. The value of the <code>icon</code> field, if present, shall be a <a href="#_hashed_uris">hashed URI</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As with the assertions array, the hash algorithm used for a <a href="#_hashed_uris">hashed URI</a> is determined by the <code>alg</code> field present in the hashed URI, or when absent, by a <code>hash</code> field in the claim.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example using claim generator info</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
	"claim_generator_info" : {
		"name": "Joe's Photo Editor",
		"version": "2.0",
		"operating_system": "Windows 10",
		"icon": {
			"url": "http://cdn.examplephotoagency.com/logo.svg",
			"hash": "5bdec8169b4e4484b79aba44cee5c6bd"
		}
	}
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_claim"><a class="anchor" href="#_creating_a_claim"></a>10.3. Creating a Claim</h3>
<div class="sect3">
<h4 id="_creating_assertions"><a class="anchor" href="#_creating_assertions"></a>10.3.1. Creating Assertions</h4>
<div class="paragraph">
<p>Before the claim can be finalized, all <a href="#_assertions">assertions</a> must be created and stored in a newly created <a href="#_c2pa_box_details">C2PA Assertion Store</a> as described <a href="#_types_of_manifests">later in this document</a>.</p>
</div>
<div class="paragraph">
<p>When creating a standard manifest, it may not be possible to know all of the required binding information at the time of claim creation, in which case use the <a href="#_multiple_step_processing">multiple step processing method</a> to setup and then later fill-in the information.</p>
</div>
</div>
<div class="sect3">
<h4 id="_preparing_the_claim"><a class="anchor" href="#_preparing_the_claim"></a>10.3.2. Preparing the Claim</h4>
<div class="sect4">
<h5 id="_adding_assertions_and_redactions"><a class="anchor" href="#_adding_assertions_and_redactions"></a>10.3.2.1. Adding Assertions and Redactions</h5>
<div class="paragraph">
<p>The claim shall contain the <code>created_assertions</code> field and may contain a <code>gathered_assertions</code> field.  The combined values from those two fields represents a list of all of the URI references for all assertions that were added to the assertion store that are being "claimed" by this claim. At least one of the assertions in the <code>created_assertions</code> field&#8217;s value shall be either a <a href="#_data_hash">data hash assertion</a>, a <a href="#_general_box_hash">general boxes hash assertion</a>, or a <a href="#_bmff_based_hash">BMFF-based hash assertion</a>.</p>
</div>
<div class="paragraph">
<p>If any assertions in ingredient claims are being redacted, their URI references shall be added to list which is the value of the <code>redacted_assertions</code> field.</p>
</div>
</div>
<div class="sect4">
<h5 id="_adding_ingredients"><a class="anchor" href="#_adding_ingredients"></a>10.3.2.2. Adding Ingredients</h5>
<div class="paragraph">
<p>In many authoring scenarios, an actor does not create an entirely new asset but instead brings in other existing assets on which to create their work - either as a derived asset, a composed asset or an asset rendition. These existing assets are called ingredients and their use is documented in the provenance data through the use of an <a href="#_ingredient">ingredient assertion</a>.</p>
</div>
<div class="paragraph">
<p>When an ingredient contains one or more C2PA manifests, those manifests must be inserted into this asset&#8217;s manifest store to ensure that the provenance data is kept intact. Such ingredient manifests are added to the JUMBF as described in <a href="#_c2pa_box_details">Section 11.1.4, &#8220;C2PA Box details&#8221;</a>. If an ingredient&#8217;s manifest is <a href="#_external_manifests">remote</a>, and the claim generator is unable to retrieve the manifest, it should use an error code of <code>manifest.inaccessible</code> to reflect that.</p>
</div>
</div>
<div class="sect4">
<h5 id="_connecting_the_signature"><a class="anchor" href="#_connecting_the_signature"></a>10.3.2.3. Connecting the Signature</h5>
<div class="paragraph">
<p>The signature cannot be part of the signed payload, but since its label is pre-defined, then the full URI reference is also known. As such, we can include that in the claim by setting the value of the <code>signature</code> field of the claim to that URI reference.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This provides the explicit binding of the claim to its signature.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_signing_a_claim"><a class="anchor" href="#_signing_a_claim"></a>10.3.2.4. Signing a Claim</h5>
<div class="paragraph">
<p>Producing the signature is specified in <a href="#_digital_signatures">Section 13.2, &#8220;Digital Signatures&#8221;</a>. The <code>payload</code> field of <code>Sig_structure</code> shall be the serialized CBOR of the claim document, and shall use detached content mode. The serialized <code>COSE_Sign1_Tagged</code> structure resulting from the digital signature procedure is written into the C2PA Claim Signature box.</p>
</div>
</div>
<div class="sect4">
<h5 id="_time_stamps"><a class="anchor" href="#_time_stamps"></a>10.3.2.5. Time-stamps</h5>
<div class="paragraph">
<p>If possible, the signer should use a RFC3161-compliant Time Stamp Authority (TSA) (<a href="https://datatracker.ietf.org/doc/html/rfc3161">RFC 3161 section 1</a>) to obtain a trusted time-stamp proving that the signature itself actually existed at a certain date and time and incorporate that into the <code>COSE_Sign1_Tagged</code> structure as a countersignature. A manifest may contain multiple time-stamps.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Signers are encouraged to obtain and include time-stamps to ensure their manifests will remain valid. As described in <a href="#_validation">Chapter 15, <em>Validation</em></a>, manifests without time-stamps cease to be valid when the signing credential expires or becomes revoked.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All time-stamps shall be obtained as described in <a href="https://tools.ietf.org/html/rfc3161">RFC3161</a> with the following additional requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>MessageImprint</code> of the <code>TimeStampReq</code> structure (<a href="https://datatracker.ietf.org/doc/html/rfc3161#section-2.4.1">RFC 3161 section 2.4.1</a>) shall be computed by creating the <code>ToBeSigned</code> value in <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-4.4">RFC 8152 section 4.4</a> with the following values for elements of <code>Sig_structure</code>:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>context</code> element shall be <code>CounterSignature</code>.</p>
</li>
<li>
<p>The <code>payload</code> element shall be as described in <a href="#_signing_a_claim">Section 10.3.2.4, &#8220;Signing a Claim&#8221;</a>.</p>
</li>
<li>
<p>The remaining elements of <code>Sig_structure</code> are as described in <a href="#_computing_the_signature">Section 13.2.3, &#8220;Computing the Signature&#8221;</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The <code>ToBeSigned</code> value is then hashed using a hash algorithm from the allowed list in <a href="#_hashing">Section 11.3.4.2, &#8220;Hashing&#8221;</a> that the TSA supports, and that hash algorithm and value are placed in the <code>MessageImprint</code>. If the TSA does not support any hash algorithms from the allowed list, it cannot be used for time-stamping.</p>
<div class="ulist">
<ul>
<li>
<p>Where possible, the hash algorithm should use the same hash algorithm used in the digital signature of the claim.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The <code>certReq</code> boolean of the <code>TimeStampReq</code> structure shall be asserted in the request to the TSA, to ensure its certificate chain is provided in the response.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Time-stamps shall be stored in a COSE unprotected header whose label is the string <code>sigTst</code>. If no time-stamps are included, the header shall be absent. When present, the value of this header shall be a <code>tstContainer</code> defined by the following CDDL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; CBOR version of tstContainer and related structures based on JSON schema at https://forge.etsi.org/rep/esi/x19_182_JAdES/raw/v1.1.1/19182-jsonSchema.json
tstContainer = {
  "tstTokens": [1* tstToken]
}

tstToken = {
  "val": bstr
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The content of the <code>TimeStampResp</code> structure received in reply from the TSA shall be stored as the value of the <code>val</code> property of an element of <code>tstTokens</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The above definition is a CBOR adaptation of a subset of the schema from <a href="https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf">JAdES section 5.3.4</a> and <a href="https://forge.etsi.org/rep/esi/x19_182_JAdES/raw/v1.1.1/19182-jsonSchema.json">its JSON schema</a>, except with the modification that the content of <code>val</code> is a byte string containing the content of the <code>TimeStampResp</code>, and not a Base64-encoded version of the same.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_credential_revocation_information"><a class="anchor" href="#_credential_revocation_information"></a>10.3.2.6. Credential Revocation Information</h5>
<div class="paragraph">
<p>If the signer&#8217;s credential supports querying its online credential status, and the credential contains a pointer to a service to provide time-stamped credential status information, the signer should query the service, capture the response, and store it in the manner described for <a href="#_x509_certificates">credentials</a> in the <a href="#_trust_model">Trust Model</a>. If credential revocation information is attached in this manner, a trusted time-stamp must also be obtained after signing, as described in <a href="#_time_stamps">Section 10.3.2.5, &#8220;Time-stamps&#8221;</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_examples_of_claims"><a class="anchor" href="#_examples_of_claims"></a>10.3.3. Examples of Claims</h4>
<div class="sect4">
<h5 id="_single_claim"><a class="anchor" href="#_single_claim"></a>10.3.3.1. Single Claim</h5>
<div class="paragraph">
<p>Here is a visual representation of an image containing a single claim with multiple assertions that have been embedded inside it.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/Single_Claim.svg" alt="A single claim with assertions" width="720" height="432">
</div>
<div class="title">Figure 7. A single claim with assertions</div>
</div>
</div>
<div class="sect4">
<h5 id="_multiple_claims"><a class="anchor" href="#_multiple_claims"></a>10.3.3.2. Multiple Claims</h5>
<div class="paragraph">
<p>In this example of creating a second claim for the <a href="#_single_claim">previous example</a>, one of the original assertions has been redacted from the previous claim. The visual representation for this scenario would look like:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/Multiple_Claims.svg" alt="Redacting assertions in a secondary claim" width="720" height="432">
</div>
<div class="title">Figure 8. Redacting assertions in a secondary claim</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_multiple_step_processing"><a class="anchor" href="#_multiple_step_processing"></a>10.4. Multiple Step Processing</h3>
<div class="paragraph">
<p>Some asset file formats require file offsets of the C2PA Manifest Store and asset content to be fixed before the manifest is signed, so that content bindings will correctly align with the content they authenticate. Unfortunately, the size of a manifest and its signature cannot be precisely known until after signing, which could cause file offsets to change. For example, in <a href="https://en.wikipedia.org/wiki/JPEG">JPEG-1</a> files, the entire C2PA Manifest Store must appear in the file before the image data, and so its size will affect the file offsets of content being authenticated.</p>
</div>
<div class="paragraph">
<p>To accomplish this, a multiple step approach is taken, similar to how signatures in PDF are done.</p>
</div>
<div class="sect3">
<h4 id="_create_content_bindings"><a class="anchor" href="#_create_content_bindings"></a>10.4.1. Create content bindings</h4>
<div class="paragraph">
<p>When creating a <a href="#_standard_manifests">standard manifest</a>, its claim shall include one or more content binding assertions in its list of assertions to ensure that the asset is tamper-evident.</p>
</div>
<div class="paragraph">
<p>Create the data hash assertion and add it to the assertion store taking into account the following considerations.</p>
</div>
<div class="paragraph">
<p>In many cases, such as with JPEG-1, it is not possible to hash the asset in its entirety because the manifest will be embedded in the middle of the file, so the size or location manifest data will not be known at the time the asset hash is calculated.  This circular dependency is avoided by allowing exclusion ranges to be specified during hashing.  When exclusion ranges are specified, a single hash is performed, but only over the asset ranges that are not in any of the exclusions. The data present in an exclusion range shall only contain a C2PA Manifest and any padding.</p>
</div>
<div class="paragraph">
<p>If a manifest is embedded in the center of a JPEG-1 file in an APP11 segment, then the claim creator may exclude the APP11 segment(s) from the hash calculation.</p>
</div>
<div class="paragraph">
<p>In order to prevent insertion attacks, it is desirable to have only a single exclusion range when possible. When the size or location (or both) of the manifest in the asset is not known, then the <code>start</code> and <code>length</code> values in the data hash assertion shall both be zero and the size of the <code>pad</code> value should be large enough to accommodate writing in the values during the second pass.  At least 16 bytes is recommended. The value of the <code>pad</code> key shall consist of all 0x00&#8217;s.</p>
</div>
<div class="paragraph">
<p>If padding is employed then the pad data could be changed without resulting in a validation failure. It is the responsibility of claim generators to ensure that changes to pad data (or any other excluded asset data) cannot change how the asset is interpreted.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the case of JPEG-1 files, this can be achieved either by eliminating padding or by ensuring that the JFIF APP11/C2PA segments cannot be shortened of changed to a different segment type. This is accomplished by including all the C2PA manifest segment headers (APP11) and 2-byte length fields in the data-hash-map for all manifest-containing segments. This ensures that any data changed in the exclusion region will not be misinterpreted by JPEG processors.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_temporary_claim_and_signature"><a class="anchor" href="#_create_a_temporary_claim_and_signature"></a>10.4.2. Create a temporary Claim and Signature</h4>
<div class="paragraph">
<p>Add the newly created data hash assertion reference to the claim&#8217;s assertion list providing a temporary hash value, such as empty spaces.</p>
</div>
<div class="paragraph">
<p>At this point, the temporary claim is complete and can be added to the C2PA Manifest being created.</p>
</div>
<div class="paragraph">
<p>Since the claim is only temporary at this time, it is not possible to sign it. To ensure the claim signature box contains a valid CBOR structure, create a temporary <code>COSE_Sign1_Tagged</code> structure as described in <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-4.2">RFC 8152 section 4.2</a>. The <code>COSE_Sign1_Tagged</code> is a tag byte followed by a <code>COSE_Sign1</code> structure, which is a four-element CBOR array. Construct the array as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first element is the <code>protected</code> header bucket (<a href="https://datatracker.ietf.org/doc/html/rfc8152#section-3">RFC 8152 section 3</a>). Create an empty bucket by placing a <code>bstr</code> of size 0 in this position.</p>
</li>
<li>
<p>The second element is the <code>unprotected</code> header bucket, which is a CBOR map. Create a map of 1 pair. Use the string <code>pad</code> as the label, and place a <code>bstr</code> of the desired padding size filled with zero bytes (0x00) as the value. A 25 kilobyte size is recommended for the initial size of this padding.</p>
</li>
<li>
<p>The third element is the <code>payload</code>. Place the value <code>nil</code> (CBOR major type 7, value 22) here.</p>
</li>
<li>
<p>The fourth element is <code>signature</code>. Place a <code>bstr</code> of size 0 here.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_complete_the_c2pa_manifest"><a class="anchor" href="#_complete_the_c2pa_manifest"></a>10.4.3. Complete the C2PA Manifest</h4>
<div class="paragraph">
<p>At this point all of the boxes that comprise the entire C2PA Manifest for the asset are completed and can be (if not already) constructed into its final form. The asset&#8217;s C2PA Manifest, along with the manifests of any ingredients, are combined together to form the complete C2PA Manifest Store. The active manifest must be the last C2PA Manifest superbox in the C2PA Manifest Store superbox. The C2PA Manifest Store can then be embedded into the asset as discussed in <a href="#_embedding_manifests_into_various_file_formats">Section 11.3, &#8220;Embedding manifests into various file formats&#8221;</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_going_back_and_filling_in"><a class="anchor" href="#_going_back_and_filling_in"></a>10.4.4. Going back and filling in</h4>
<div class="paragraph">
<p>Now that the C2PA Manifest Store has been embedded into the asset, the starting offset and the length of the active manifest can be updated in its data hash assertion.  It is necessary that when doing so, you do not change the size of the assertion&#8217;s box, only its data.  This is done by adjusting the value of the <code>pad</code> field to be the necessary length to "fill up" the remaining bytes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Preferred/deterministic CBOR serialization of <code>pad</code> uses a variable length integer to specify the length of the encoded binary data. When the length goes from zero to 1 byte, or 1 to 2 bytes (etc.), the length of the resulting pad jumps by two bytes. This means that not all paddings can be expressed using a single padding field. For example, 24-byte and 26-byte pads can be created, but a 25-byte pad cannot.  If this situation arises, the desired padding can be split between <code>pad</code> and <code>pad2</code>. For example, to make a 25-byte pad, a claim generator can encode 19 bytes into <code>pad</code> (resulting in an encoded length of 20 bytes), and 4 bytes into <code>pad2</code> (resulting in 5 bytes.)</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once the data hash assertion has been updated, it can be hashed and the hash written over the empty spaces that were used previously to hold the location.</p>
</div>
<div class="paragraph">
<p>The claim is now complete, and it can be hashed and signed as described in <a href="#_signing_a_claim">Section 10.3.2.4, &#8220;Signing a Claim&#8221;</a>, with the resultant signature filling the pre-allocated space. The <code>pad</code> header can then be shrunk as required so that the claim signature box remains the same size; because this header is unprotected, changing it does not invalidate the claim signature.</p>
</div>
<div class="paragraph">
<p>If the serialized <code>COSE_Sign1_Tagged</code> structure exceeds the reserved size of the C2PA Claim Signature box, multiple step processing must be repeated with a larger padding size chosen in <a href="#_create_a_temporary_claim_and_signature">Section 10.4.2, &#8220;Create a temporary Claim and Signature&#8221;</a>. Revocation information retrieved during the previous attempt should be reusable if it is still within its validity interval (<a href="https://datatracker.ietf.org/doc/html/rfc6960#section-4.2.2.1">RFC 6960 section 4.2.2.1</a>), but a new time-stamp will be required on the new claim with the file offsets changed as the result of added padding.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_manifests"><a class="anchor" href="#_manifests"></a>11. Manifests</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_use_of_jumbf"><a class="anchor" href="#_use_of_jumbf"></a>11.1. Use of JUMBF</h3>
<div class="sect3">
<h4 id="_rationale"><a class="anchor" href="#_rationale"></a>11.1.1. Rationale</h4>
<div class="paragraph">
<p>In order to support many of the requirements of C2PA, C2PA Manifests needed to be stored (serialized) into a structured binary data store that enables some specific functionality including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ability to store multiple manifests (e.g., parents and ingredients) in a single container</p>
</li>
<li>
<p>Ability to refer to individual elements (both within and across manifests) via URIs</p>
</li>
<li>
<p>Ability to clearly identify the parts of an element to be hashed</p>
</li>
<li>
<p>Ability to store pre-defined data types used by C2PA (e.g., JSON and CBOR)</p>
</li>
<li>
<p>Ability to store arbitrary data formats (e.g., XML, JPEG, etc.)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition to supporting all of the requirements above, our chosen container format - <a href="https://www.iso.org/standard/84635.html">JUMBF, ISO 19566-5</a> - is also natively supported by the JPEG family of formats and is compatible with the box-based model (i.e., <a href="https://www.iso.org/standard/68960.html">ISOBMFF, ISO 14496-12</a>) used by many common image and video file formats. Using JUMBF enables all the same benefits (and a few extras, such as <a href="#_uri_references">URI References</a>) while being able to work with classic image formats, such as JPEG/JFIF and PNG as well as 3D and document (e.g., PDF) formats. This serialized format shall be used also in formats that do not natively support JUMBF, or when C2PA Manifest Stores are stored separately from the asset, such as in a separate file or URI location.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Since most of the standard assertions, as well the claim signature, are serialized as CBOR, using CBOR for the entire C2PA Manifest was considered but not chosen because CBOR is not a container format. It could be used as one through having to re-define how CBOR would be used to provide the features natively supported by JUMBF.</p>
</div>
<div class="paragraph">
<p>For example, to store a "blob of JSON" inside of CBOR, and know that it is JSON (and not some other format) would require designing a data structure for storing such things. Then the parent structure would need to be defined as to how to carry that structure. This same concept would also have to be done for each of the native features of JUMBF.</p>
</div>
<div class="paragraph">
<p>While it would certainly be possible to re-implement all of the required functionality entirely in CBOR, it would be a lot of work and would not fully remove the need for a JUMBF/BMFF parser in all implementations.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_processing_rules"><a class="anchor" href="#_processing_rules"></a>11.1.2. Processing Rules</h4>
<div class="paragraph">
<p>A C2PA Manifest Consumer shall never process an assertion, assertion store, claim, claim signature or C2PA Manifest that is not contained inside of a C2PA Manifest Store. Additionally, when a C2PA Manifest Consumer encounters a JUMBF box or superbox whose UUID it does not recognize, it shall skip over (and ignore) its contents.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This means that the C2PA Manifest Consumer can process private boxes that it knows about, but ignore ones of which it is unaware.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the <em>Requestable</em> and <em>Label Present</em> toggles are both set in the JUMBF Description box of any JUMBF box or superbox, that box or superbox shall be maintained in any updated C2PA Manifest Store.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Boxes with those toggles set are intended to be referenced via JUMBF URIs, and their removal could cause downstream workflows to fail.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_extensions"><a class="anchor" href="#_extensions"></a>11.1.3. Extensions</h4>
<div class="sect4">
<h5 id="_compressed_boxes"><a class="anchor" href="#_compressed_boxes"></a>11.1.3.1. Compressed boxes</h5>
<div class="paragraph">
<p>In order to support compressing manifests, a new <code>brob</code> content box is supported by C2PA. Based on a similar box in JPEG-XL (ISO 18181-2), the <code>brob</code> box is a content box whose contents are the <a href="https://datatracker.ietf.org/doc/html/rfc7932">Brotli-compressed</a> bytes of either a <a href="#_standard_manifests">standard manifest</a> or <a href="#_update_manifests">update manifest</a>, as described in the <a href="#_compressed_manifests">compressed manifests</a> clause. The <code>brob</code> box shall have a UUID of <code>0x62726F62-0011-0010-8000-00AA00389B71</code> (<code>brob</code>).</p>
</div>
<div id="compressed_manifest_image" class="imageblock text-center">
<div class="content">
<img src="_images/brob_box.drawio.png" alt="Example of compressed manifest" width="360">
</div>
<div class="title">Figure 9. Example of a compressed manifest</div>
</div>
<div class="paragraph">
<p>Hashing a compressed box is done in the same way as any other box, as described in <a href="#_hashing_jumbf_boxes">Section 8.3.1.3, &#8220;Hashing JUMBF Boxes&#8221;</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This implies that given a <code>hashed_uri</code> reference from an ingredient assertion to a C2PA Manifest via the <code>c2pa_manifest</code> field, the hash is calculated using the same process as any other JUMBF superbox: over the JUMBF Description Box and the <code>brob</code> box with its compressed payload, but excluding the superbox&#8217;s header. The contents of the <code>brob</code> box are not decompressed first to calculate the hash.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_c2pa_box_details"><a class="anchor" href="#_c2pa_box_details"></a>11.1.4. C2PA Box details</h4>
<div class="sect4">
<h5 id="_jumbf_description_boxes"><a class="anchor" href="#_jumbf_description_boxes"></a>11.1.4.1. JUMBF Description boxes</h5>
<div class="sect5">
<h6 id="_labels_2"><a class="anchor" href="#_labels_2"></a>11.1.4.1.1. Labels</h6>
<div class="paragraph">
<p>As described in the JUMBF specification (ISO 19566-5, A.3), a label shall be stored as ISO/IEC 10646 characters in the UTF-8 encoding. Characters in the ranges U+0000 to U+001F inclusive and U+007F to U+009F inclusive, as well as the specific characters '/', ';', '?', and '#', are not permitted in the label. The label shall be null-terminated.</p>
</div>
<div class="paragraph">
<p>As labels used as part of JUMBF URIs, the characters U+FEFF, U+FFFF, and U+D800-U+DFFF shall also not be used.</p>
</div>
</div>
<div class="sect5">
<h6 id="_toggles"><a class="anchor" href="#_toggles"></a>11.1.4.1.2. Toggles</h6>
<div class="paragraph">
<p>All JUMBF Description boxes (ISO 19566-5, A.3) used in a C2PA Manifest require a label, the <em>Label Present</em> toggle (<code>xxxxxx1x</code>) shall be set. In addition, because JUMBF URIs are used to refer to boxes throughout the system (e.g., listing assertions, references to ingredients, etc.), the <em>Requestable</em> toggle (<code>xxxxxx11</code>) shall be set.</p>
</div>
<div class="paragraph">
<p>When including a salt in a <em>PRIVATE</em> box as described in <a href="#_hashing_jumbf_boxes">Section 8.3.1.3, &#8220;Hashing JUMBF Boxes&#8221;</a>, the <em>Private</em> toggle (<code>xxx1xxxx</code>) shall also be set.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_manifest_store"><a class="anchor" href="#_manifest_store"></a>11.1.4.2. Manifest Store</h5>
<div class="paragraph">
<p>C2PA data is serialized into a JUMBF-compatible box structure. The outermost box is referred to as the C2PA Manifest Store, also known as the Content Credentials. Here is an example C2PA Manifest Store with a single C2PA Manifest:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/ManifestStore.svg" alt="C2PA Manifest Store" width="240" height="500">
</div>
<div class="title">Figure 10. C2PA Manifest Store</div>
</div>
<div class="paragraph">
<p>The C2PA Manifest Store is a JUMBF superbox composed of a series of other JUMBF boxes and superboxes, each identified by their own UUID and label in their JUMBF Description box. The C2PA Manifest Store shall have a label of <code>c2pa</code>, a UUID of <code>0x63327061-0011-0010-8000-00AA00389B71</code> (<code>c2pa</code>) and shall contain one or more C2PA manifest superboxes, also known as C2PA Manifests. The C2PA Manifest Store may also contain JUMBF boxes and superboxes whose UUIDs are not defined in this specification.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Allowing other boxes and superboxes enables custom extensions to C2PA as well as enabling the addition of new boxes in future versions of this specification without breaking compatibility.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each C2PA Manifest shall contain the data created at the time a claim is issued including the C2PA Assertion Store, a C2PA Claim, and a C2PA Claim Signature. A C2PA Manifest may also contain JUMBF boxes and superboxes whose UUIDs are not defined in this specification.</p>
</div>
<div class="paragraph">
<p>The UUID for each C2PA Manifest shall be either <code>0x63326D61-0011-0010-8000-00AA00389B71</code> (<code>c2ma</code>), <code>0x6332636D-0011-0010-8000-00AA00389B71</code> (<code>c2cm</code>) or <code>0x6332756D-0011-0010-8000-00AA00389B71</code> (<code>c2um</code>) depending on the <a href="#_types_of_manifests">type of manifest</a>. In order to enable uniquely identifying each C2PA Manifest, they shall be labelled with a <a href="https://tools.ietf.org/html/rfc4122">RFC 4122, UUID</a> optionally proceeded by an identifier of the claim generator and a <code>:</code>. An example label for the fictitious ACME claim generator might look like <code>acme:urn:uuid:F9168C5E-CEB2-4FAA-B6BF-329BF39FA1E4</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_assertion_store_2"><a class="anchor" href="#_assertion_store_2"></a>11.1.4.3. Assertion Store</h5>
<div class="paragraph">
<p>The C2PA <a href="#_assertion_store">Assertion Store</a> is a superbox that shall have a label of <code>c2pa.assertions</code> and a UUID of <code>0x63326173-0011-0010-8000-00AA00389B71</code> (<code>c2as</code>). It shall contain one or more JUMBF superboxes (called C2PA Assertion boxes) whose JUMBF type defines the BMFF type of the sub-boxes that contain the assertion data (see ISO 19566-5, Annex B, Table B.1 and ISO 19566-5/AMD-1, Annex B). These superboxes shall each have a label as defined in <a href="#_c2pa_standard_assertions">Standard Assertions</a>.</p>
</div>
<div class="paragraph">
<p>The JUMBF Content Type (ISO 19566-5, Annex B) box(es) contained in each assertion superbox should be CBOR Content Type (<code>cbor</code>), JSON Content Type (<code>json</code>), Embedded File Content Type (<code>bfdb</code> &amp; <code>bidb</code>) or UUID Content Type (<code>uuid</code>) though any Content Type defined in JUMBF and its amendments is permitted. In addition, a JUMBF Protection Box as described in ISO 19566-4 may also be used.</p>
</div>
<div class="paragraph">
<p>The C2PA Assertion Store shall not contain any JUMBF boxes or superboxes that are not JUMBF Content Boxes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Custom assertions containing other formats/serializations of data, such as encrypted data, are supported through the use of a UUID Content Box containing the custom UUID followed by the data (see ISO 19566-5, B.5).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_claim_and_claim_signature"><a class="anchor" href="#_claim_and_claim_signature"></a>11.1.4.4. Claim and Claim Signature</h5>
<div class="paragraph">
<p>The C2PA <a href="#_claims">Claim</a> box shall have a label of <code>c2pa.claim.v2</code>, a UUID of <code>0x6332636C-0011-0010-8000-00AA00389B71</code> (<code>c2cl</code>) and shall consist of a single CBOR Content Type box (<code>cbor</code>).</p>
</div>
<div class="paragraph">
<p>The C2PA <a href="#_digital_signatures">Claim Signature</a> box shall have a label of <code>c2pa.signature</code>, a UUID of <code>0x63326373-0011-0010-8000-00AA00389B71</code> (<code>c2cs</code>) and shall consist of a single CBOR Content Type box (<code>cbor</code>).</p>
</div>
</div>
<div class="sect4">
<h5 id="_ingredient_storage"><a class="anchor" href="#_ingredient_storage"></a>11.1.4.5. Ingredient Storage</h5>
<div class="paragraph">
<p>When a C2PA Manifest includes <a href="#_ingredient">ingredient assertions</a>, and an ingredient contains a C2PA Manifest, that C2PA Manifest shall be included to ensure that the provenance data is kept intact. Such ingredient manifests are added to the C2PA Manifest Store as a peer of the C2PA Manifest for the asset itself.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/ManifestStore_Ingredient.svg" alt="C2PA Manifest Store with Ingredient" width="240" height="500">
</div>
<div class="title">Figure 11. C2PA Manifest Store With an Ingredient</div>
</div>
</div>
<div class="sect4">
<h5 id="_data_storage"><a class="anchor" href="#_data_storage"></a>11.1.4.6. Data Storage</h5>
<div class="paragraph">
<p>A C2PA Data Box Store is a JUMBF superbox that shall contain only one or more CBOR Content Type boxes (<code>cbor</code>). It shall not contain any other type of JUMBF box or superbox. It shall have a label of <code>c2pa.databoxes</code> and a UUID of <code>0x63326462-0011-0010-8000-00AA00389B71</code> (<code>c2db</code>).</p>
</div>
<div class="paragraph">
<p>The CBOR Content Type boxes shall have a label of <code>c2pa.data</code> (for <a href="#_embedded_data">embedded data</a>).</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/ManifestStore_DataBoxes.svg" alt="C2PA Manifest Store with Data boxes" width="244" height="500">
</div>
<div class="title">Figure 12. C2PA Manifest Store with Data Boxes</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_types_of_manifests"><a class="anchor" href="#_types_of_manifests"></a>11.2. Types of Manifests</h3>
<div class="sect3">
<h4 id="_commonalities"><a class="anchor" href="#_commonalities"></a>11.2.1. Commonalities</h4>
<div class="paragraph">
<p>All C2PA Manifests shall contain an <a href="#_assertion_store">assertion store</a> with at least one <a href="#_assertions">assertion</a>, a <a href="#_claims">claim</a> and a <a href="#_signing_a_claim">claim signature</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_standard_manifests"><a class="anchor" href="#_standard_manifests"></a>11.2.2. Standard Manifests</h4>
<div class="paragraph">
<p>A standard C2PA Manifest (UUID: <code>0x63326D61-0011-0010-8000-00AA00389B71</code> (<code>c2ma</code>)) shall contain exactly one <a href="#_binding_to_content">hard binding to content</a> assertion - either a <code>c2pa.hash.data</code>, <code>c2pa.hash.boxes</code>, <code>c2pa.hash.collection.data</code>, or <code>c2pa.hash.bmff.v2</code> based on the type of asset and version for which the manifest is destined. Because of this requirement, they are the predominant type of manifest that will be present in C2PA provenance data.</p>
</div>
</div>
<div class="sect3">
<h4 id="_update_manifests"><a class="anchor" href="#_update_manifests"></a>11.2.3. Update Manifests</h4>
<div class="paragraph">
<p>There are, however, provenance workflows where additional assertions need to be added but the digital content is not changed. In these workflows, an Update Manifest (UUID: <code>0x6332756D-0011-0010-8000-00AA00389B71</code> (<code>c2um</code>)) can be used.</p>
</div>
<div class="paragraph">
<p>An Update Manifest shall not contain assertions of types <code>c2pa.hash.data</code>, <code>c2pa.hash.boxes</code>, <code>c2pa.hash.collection.data</code>, or <code>c2pa.hash.bmff.v2</code> because the content has not changed and therefore the bindings need not be updated.  In the case of a file offset hash (<code>c2pa.hash.data</code>), the C2PA Manifest Store has to continue to start at the same file offset after updating - only its length can change.</p>
</div>
<div class="paragraph">
<p>The Update Manifest shall not contain an assertion of type <code>c2pa.actions</code> or <code>c2pa.actions.v2</code> because that assertion is defined to describe "changes to the digital content". It shall not contain a <a href="#:_thumbnails">thumbnail assertion</a> as that would imply changes to the content as well.</p>
</div>
<div class="paragraph">
<p>The Update Manifest shall contain exactly one <code>c2pa.ingredient</code> assertion that (a) includes a <code>c2pa_manifest</code> field with a value that is the <a href="#_uri_references">URI reference</a> to that <a href="#_c2pa_box_details">C2PA Manifest</a> that is being updated and (b) has the value of <code>parentOf</code> for the <code>relationship</code> field.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The ingredient&#8217;s C2PA Manifest (referenced via the <code>c2pa_manifest</code> field) can be either a standard manifest or an update manifest.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_compressed_manifests"><a class="anchor" href="#_compressed_manifests"></a>11.2.4. Compressed Manifests</h4>
<div class="paragraph">
<p>Standard and Update Manifests can be compressed, in their entirety, using the <a href="https://datatracker.ietf.org/doc/html/rfc7932">Brotli compression algorithm</a> as described <a href="#_compressed_boxes">above</a>. For either type of manifest, the value of the <code>TYPE</code> field shall be <code>c2cm</code>, the value of the <a href="#_label">label field</a> shall be the identical to the label of the compressed manifest superbox, and the contents of the <code>brob</code> content box shall be the compressed bytes of the entire manifest superbox.  See <a href="#compressed_manifest_image">Figure 9, &#8220;Example of a compressed manifest&#8221;</a> for an example of a compressed standard manifest.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Any place in this specification that a standard or update manifest is referenced, a compressed standard or update manifest is also valid.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_embedding_manifests_into_various_file_formats"><a class="anchor" href="#_embedding_manifests_into_various_file_formats"></a>11.3. Embedding manifests into various file formats</h3>
<div class="sect3">
<h4 id="_embedding_manifests_into_non_bmff_based_assets"><a class="anchor" href="#_embedding_manifests_into_non_bmff_based_assets"></a>11.3.1. Embedding manifests into non-BMFF-based assets</h4>
<div class="paragraph">
<p>A C2PA Manifest is embedded into an asset as part of the C2PA Manifest Store for that asset.</p>
</div>
<div class="paragraph">
<p>When embedding the C2PA Manifest Store into an asset, the location will vary based on the type of the asset. Here are some well-known types and the location to use:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">JPEG</dt>
<dd>
<p>Refer to <a href="#_embedding_manifests_into_jpeg">Section 11.3.1.1, &#8220;Embedding manifests into JPEG&#8221;</a> for more information.</p>
</dd>
<dt class="hdlist1">PNG</dt>
<dd>
<p>Refer to <a href="#_embedding_manifests_into_png">Section 11.3.1.2, &#8220;Embedding manifests into PNG&#8221;</a> for more information.</p>
</dd>
<dt class="hdlist1">SVG</dt>
<dd>
<p>Refer to <a href="#_embedding_manifests_into_svg">Section 11.3.1.3, &#8220;Embedding manifests into SVG&#8221;</a> for more information.</p>
</dd>
<dt class="hdlist1">FLAC</dt>
<dd>
<p>Refer to <a href="#_embedding_manifests_into_id3">Section 11.3.1.4, &#8220;Embedding manifests into ID3&#8221;</a> for more information.</p>
</dd>
<dt class="hdlist1">MP3</dt>
<dd>
<p>Refer to <a href="#_embedding_manifests_into_id3">Section 11.3.1.4, &#8220;Embedding manifests into ID3&#8221;</a> for more information.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">EDITORS NOTE</div>
C2PA is asking for feedback from the audio community if embedding the C2PA Manifest Store in an ID3v2 container will work with FLAC or if we will need to use the native FLAC container.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1">GIF</dt>
<dd>
<p>Refer to <a href="#_embedding_manifests_into_gifs">Section 11.3.1.7, &#8220;Embedding manifests into GIFs&#8221;</a> for more information.</p>
</dd>
<dt class="hdlist1">DNG</dt>
<dd>
<p>Refer to <a href="#_embedding_manifests_into_tiff_based_assets">Section 11.3.1.5, &#8220;Embedding manifests into TIFF-based assets&#8221;</a> for more information.</p>
</dd>
<dt class="hdlist1">TIFF-based formats</dt>
<dd>
<p>Refer to <a href="#_embedding_manifests_into_tiff_based_assets">Section 11.3.1.5, &#8220;Embedding manifests into TIFF-based assets&#8221;</a> for more information.</p>
</dd>
<dt class="hdlist1">WAV &amp; BWF</dt>
<dd>
<p>Refer to <a href="#_embedding_manifests_into_riff_based_assets">Section 11.3.1.6, &#8220;Embedding manifests into RIFF-based assets&#8221;</a> for more information.</p>
</dd>
<dt class="hdlist1">AVI</dt>
<dd>
<p>Refer to <a href="#_embedding_manifests_into_riff_based_assets">Section 11.3.1.6, &#8220;Embedding manifests into RIFF-based assets&#8221;</a> for more information.</p>
</dd>
<dt class="hdlist1">WebP</dt>
<dd>
<p>Refer to <a href="#_embedding_manifests_into_riff_based_assets">Section 11.3.1.6, &#8220;Embedding manifests into RIFF-based assets&#8221;</a> for more information.</p>
</dd>
<dt class="hdlist1">RIFF-based formats</dt>
<dd>
<p>Refer to <a href="#_embedding_manifests_into_riff_based_assets">Section 11.3.1.6, &#8220;Embedding manifests into RIFF-based assets&#8221;</a> for more information.</p>
</dd>
<dt class="hdlist1">BMFF-based formats</dt>
<dd>
<p>The box specified in <a href="#_embedding_manifests_into_bmff_based_assets">Section 11.3.3, &#8220;Embedding manifests into BMFF-based assets&#8221;</a>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A C2PA Manifest Store can be embedded in BMFF-based downloadable audio files using codecs such as the Advanced Audio Codec (AAC) or the Apple Lossless Audio Codec (ALAC).
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Non-BMFF-based audio formats which are being considered for addition to this specification include Ogg Vorbis and the native container version of the Free Lossless Audio Codec (Native FLAC).
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Many classic image formats such as BMP do not support the embedding of arbitrary data, so that the use of an <a href="#_external_manifests">external manifest</a> is required.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Fonts</dt>
<dd>
<p>Refer to <a href="#_embedding_manifests_into_fonts">Section 11.3.1.8, &#8220;Embedding manifests into fonts&#8221;</a> for more information.</p>
<div class="paragraph">
<p>Additional locations for other file formats will be added in the future.</p>
</div>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="_embedding_manifests_into_jpeg"><a class="anchor" href="#_embedding_manifests_into_jpeg"></a>11.3.1.1. Embedding manifests into JPEG</h5>
<div class="paragraph">
<p>The C2PA Manifest Store shall be embedded as the data contained in an <strong>APP11</strong> Marker as defined in <a href="https://www.iso.org/standard/66071.html">JPEG XT, ISO/IEC 18477-3</a>.</p>
</div>
<div class="paragraph">
<p>Since a single marker segment in JPEG 1 cannot be larger than 64K bytes, it is likely that multiple <strong>APP11</strong> segments will be required, and they shall be constructed as per the JPEG 1 standard and <a href="https://www.iso.org/standard/84635.html">ISO 19566-5, D.2</a>. When writing multiple segments, they shall be written in sequential order, and they shall be contiguous (i.e., one segment immediately following the next).</p>
</div>
</div>
<div class="sect4">
<h5 id="_embedding_manifests_into_png"><a class="anchor" href="#_embedding_manifests_into_png"></a>11.3.1.2. Embedding manifests into PNG</h5>
<div class="paragraph">
<p>The C2PA Manifest Store shall be embedded using an ancillary, private, not safe to copy, chunk type of <code>'caBX'</code> (as per <a href="https://www.w3.org/TR/2003/REC-PNG-20031110/">PNG, 4.7.2</a>). It is recommended that the <code>'caBX'</code> chuck precede the <code>'IDAT'</code> chunks.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Although PNG supports it, it&#8217;s considered bad-form to have a data block after the <code>'IDAT'</code> and before the <code>'IEND'</code>. (The exception being animated PNG blocks)
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_embedding_manifests_into_svg"><a class="anchor" href="#_embedding_manifests_into_svg"></a>11.3.1.3. Embedding manifests into SVG</h5>
<div class="paragraph">
<p><a href="https://www.w3.org/TR/SVG11/">SVG</a> is an XML-based format that can exist either stand-alone or embedded into other text-based formats such as HTML. As such, it is necessary to Base64 encode the binary C2PA Manifest Store to perform the embedding. While this section describes how to do that, the use of an <a href="#_external_manifests">external manifest</a> is preferred.</p>
</div>
<div class="paragraph">
<p>The C2PA Manifest Store shall be embedded as the Base64-encoded value of a <code>c2pa:manifest</code> element in the <a href="https://www.w3.org/TR/SVG11/metadata.html#MetadataElement"><code>metadata</code> element</a> of the SVG. Because XML, and SVG in particular, strongly recommend the declaration of a namespace prior to its use, a <code>xmlns:c2pa = "http://c2pa.org/manifest"</code> attribute declaration should be added to the <code>svg</code> element.</p>
</div>
<div class="paragraph">
<p>An example might look like this (with the actual C2PA Manifest&#8217;s data left out)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" standalone="yes"?&gt;
&lt;svg width="4in" height="3in" version="1.1"
    xmlns = "http://www.w3.org/2000/svg"
    xmlns:c2pa = "http://c2pa.org/manifest"&gt;
    &lt;metadata&gt;
        &lt;c2pa:manifest&gt;...Base64 data goes here...&lt;/c2pa:manifest&gt;
    &lt;/metadata&gt;
&lt;/svg&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_embedding_manifests_into_id3"><a class="anchor" href="#_embedding_manifests_into_id3"></a>11.3.1.4. Embedding manifests into ID3</h5>
<div class="paragraph">
<p>The C2PA Manifest Store shall be embedded into a ID3v2-compatible, compressed audio file (e.g., MP3 or FLAC) file as the Encapsulated object data of a General Encapsulated Object (GEOB) as defined in <a href="https://id3.org/id3v2.3.0#General_encapsulated_object">https://id3.org/id3v2.3.0</a>. The GEOB&#8217;s <code>MIME type</code> field shall be present and shall use the value for the media type for JUMBF as described in <a href="#_external_manifests">Section 11.4, &#8220;External Manifests&#8221;</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_embedding_manifests_into_tiff_based_assets"><a class="anchor" href="#_embedding_manifests_into_tiff_based_assets"></a>11.3.1.5. Embedding manifests into TIFF-based assets</h5>
<div class="paragraph">
<p>The <a href="https://helpx.adobe.com/content/dam/help/en/photoshop/pdf/dng_spec_1_6_0_0.pdf">Digital Negative or DNG</a> format provides camera manufacturers to provide their camera raw formats in a standardized manner. DNG is based on which is based on <a href="https://www.iso.org/standard/29377.html">TIFF/EP</a> (which is, itself, based on <a href="https://www.itu.int/itudoc/itu-t/com16/tiff-fx/docs/tiff6.pdf">TIFF</a>).</p>
</div>
<div class="paragraph">
<p>The C2PA Manifest Store shall be embedded into a TIFF-compatible file (i.e., TIFF/EP, DNG or other TIFF-based RAW formats) as the data of a tag with ID 52545 (decimal) or 0xCD41 (hexadecimal), with a tag type of 7.</p>
</div>
<div class="paragraph">
<p>Although TIFF supports the concept of multiple pages or layers (via multiple IFD&#8217;s), there shall only be one C2PA Manifest Store for the entire asset - not one per IFD.  As such, the C2PA Manifest Store shall be the only box present in the last IFD, the IFD immediately preceding the end of the file.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Previous versions of this specification required the use of IFD 0, but it was recognized that doing so restricted its use in TIFF-based RAW formats.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_embedding_manifests_into_riff_based_assets"><a class="anchor" href="#_embedding_manifests_into_riff_based_assets"></a>11.3.1.6. Embedding manifests into RIFF-based assets</h5>
<div class="paragraph">
<p>The <a href="https://www.loc.gov/preservation/digital/formats/fdd/fdd000025.shtml">RIFF (Resource Interchange File Format)</a> format provides a generic container format for storing data in tagged chunks.  It is primarily used to store multimedia such as images, sound and video. It serves as the container format for <a href="https://en.wikipedia.org/wiki/WAV">WAV</a>, <a href="https://en.wikipedia.org/wiki/Broadcast_Wave_Format">BWF, Broadcast Wave</a>, <a href="https://en.wikipedia.org/wiki/Audio_Video_Interleave">AVI</a> and <a href="https://en.wikipedia.org/wiki/WebP">WebP</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
RIFF is based on an older format called <a href="https://en.wikipedia.org/wiki/Interchange_File_Format">IFF</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The C2PA Manifest Store shall be embedded into a RIFF-compatible file (i.e., WAV, AVI or WebP) as the data of a chunk with an identifier of <code>C2PA</code>.</p>
</div>
<div class="paragraph">
<p>For WebP, the C2PA chunk shall appear at the end of the RIFF chunk because of its strict chunk order. When working with other RIFF-based formats, such as WAV, BWF and AVI files, it is recommended to put the C2PA chunk early in the RIFF chunk when possible.</p>
</div>
</div>
<div class="sect4">
<h5 id="_embedding_manifests_into_gifs"><a class="anchor" href="#_embedding_manifests_into_gifs"></a>11.3.1.7. Embedding manifests into GIFs</h5>
<div class="paragraph">
<p>The C2PA Manifest Store shall be broken into chunks of a size no greater than 255 bytes and embedded into contiguous data sub-blocks (as per <a href="https://www.w3.org/Graphics/GIF/spec-gif89a.txt">GIF, 15</a>) within a C2PA-specialised Application Extension block (as per <a href="https://www.w3.org/Graphics/GIF/spec-gif89a.txt">GIF, 26</a>), specified below.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In this C2PA Application Extension Block, the Application Authentication Code is not used to authenticate the application producing the block. Instead, it is used as a block version, and set initially at major version 1, minor version 0, and is encoded as specified below.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">Extension Introducer: 0x21
Application Extension Label: 0xFF
Block Size: 0xB
Application Identifier: 0x43, 0x32, 0x50, 0x41, 0x5F, 0x47, 0x49, 0x46 (“C2PA_GIF”)
Application Authentication Code: 0x010000 (0x[MajorVersion][MinorVersion]00)
Application Data: The C2PA Manifest Store, encoded as a series of data sub-blocks, each containing 1 byte size followed by up to 255 bytes of data
Block Terminator: 0x00 (added after the last data sub-block of the C2PA Manifest Store)
Quantity: One</code></pre>
</div>
</div>
<div class="paragraph">
<p>This block shall be embedded after the header and prior to the first image descriptor box.</p>
</div>
</div>
<div class="sect4">
<h5 id="_embedding_manifests_into_fonts"><a class="anchor" href="#_embedding_manifests_into_fonts"></a>11.3.1.8. Embedding manifests into fonts</h5>
<div class="paragraph">
<p>Fonts which conform to either <a href="https://www.iso.org/standard/74461.html">Open Font Format</a>
or the <a href="https://learn.microsoft.com/en-us/typography/opentype/spec/">OpenType</a>
specification may include a <code>C2PA</code> table. When present, this table may include
an embedded manifest, a remote manifest URI, or both.</p>
</div>
<div class="paragraph">
<p>The <code>C2PA</code> table format is not yet defined in the <a href="https://www.iso.org/standard/74461.html">Open Font Format</a>
nor <a href="https://learn.microsoft.com/en-us/typography/opentype/spec/">OpenType</a> specification;
the following definition is preliminary:</p>
</div>
<div class="sect5">
<h6 id="_table_tag"><a class="anchor" href="#_table_tag"></a>11.3.1.8.1. Table Tag</h6>
<div class="paragraph">
<p>The C2PA table record will be identified by the following table tag: <code>C2PA</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_table_record"><a class="anchor" href="#_table_record"></a>11.3.1.8.2. Table Record</h6>
<div class="paragraph">
<p>The C2PA table provides full support for embedded and/or remote Manifest Stores:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16%;">
<col style="width: 42%;">
<col style="width: 42%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>uint16</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>majorVersion</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the major version of the C2PA font table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>uint16</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minorVersion</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the minor version of the C2PA font table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Offset32</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>activeManifestUriOffset</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Offset from the beginning of the C2PA font table to the section containing a URI to the active manifest. If a URI is not provided a NULL offset = 0x0000 should be used.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>uint16</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>activeManifestUriLength</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Length of URI in bytes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>uint16</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reserved</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved for future use.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Offset32</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>manifestStoreOffset</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Offset from the beginning of the C2PA font table to the section containing a C2PA Manifest Store. If a Manifest Store is not provided a NULL offset = 0x0000 should be used.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>uint32</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>manifestStoreLength</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Length of the C2PA Manifest Store data in bytes.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The non-embedded C2PA manifest may be remote or locally on the same storage system. If the reference is a JUMBF URI, it should be a valid reference within the C2PA Manifest Store.</p>
</div>
<div class="paragraph">
<p>This use of a URI to a remote manifest store is analogous to the <a href="#_embedding_a_reference_to_the_active_manifest">method recommended for XMP-bearing formats</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_embedding_manifests_into_pdfs"><a class="anchor" href="#_embedding_manifests_into_pdfs"></a>11.3.2. Embedding manifests into PDFs</h4>
<div class="sect4">
<h5 id="_general_2"><a class="anchor" href="#_general_2"></a>11.3.2.1. General</h5>
<div class="paragraph">
<p>All C2PA Manifest Stores shall be embedded using embedded file streams (ISO 32000, 7.11.4). The file specification dictionary shall have an <code>AFRelationship</code> key (ISO 32000, 7.11.3) whose value is <code>C2PA_Manifest</code>. If a C2PA Manifest Store is embedded into an encrypted PDF, the embedded file stream shall use an <code>Identity</code> crypt filter.</p>
</div>
</div>
<div class="sect4">
<h5 id="_document_level_manifests"><a class="anchor" href="#_document_level_manifests"></a>11.3.2.2. Document-level Manifests</h5>
<div class="paragraph">
<p>When adding a C2PA Manifest to the entire PDF, the document catalog dictionary shall contain an <code>AF</code> entry whose value is (an indirect reference to) the embedded file specification containing the active manifest. It shall also be referenced (via indirect object) either from the <code>EmbeddedFiles</code> NameTree (<code>/Catalog/Names/EmbeddedFiles</code>) or from a <code>FileAttachment</code> annotation. The annotation approach shall be used when adding a C2PA Manifest Store to a PDF that already has an existing PDF certifying signature in order to avoid invalidating its <code>DocMDP</code> restrictions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The value of the <code>P</code> field in the DocMDP dictionary needs to be <em>3</em> in order to add another C2PA Manifest.  Values of <em>1</em> or <em>2</em> do not allow that type of modification.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In most other formats, there only exists a single C2PA Manifest Store that contains all of the C2PA Manifests for the asset.  However, because of PDF&#8217;s "incremental update" feature, it is necessary to instead support multiple manifests in a single PDF.  In this scenario, the C2PA Manifest Store found in the base PDF shall be considered the initial manifest and the one in the most recent update, the active manifest.  A C2PA Manifest Consumer shall process all C2PA Manifests in all C2PA Manifest Stores as if they were contained in a single C2PA Manifest Store.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Because a JUMBF URI is always a full URI, meaning that it starts at a given C2PA Manifest, and all C2PA Manifests are considered to be contained in a single C2PA Manifest Store, using such a URI to refer to a <code>parentOf</code> ingredient across C2PA Manifest Stores in a PDF is acceptable.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is necessary to know, when adding a new C2PA Manifest Store, if a PDF signature (certifying or approval) will also be applied. Since the PDF signature will change the data of the PDF after the C2PA Manifest is signed, the size and location of the PDF signature dictionary&#8217;s <code>Contents</code> key must be determined before C2PA signing. That range of bytes shall be added to the list of exclusions in the <code>c2pa.hash.data</code> assertion, so that the C2PA signature is not invalidated by the addition of the PDF signature.  The PDF signature shall be over the entire PDF, including the associated C2PA Manifest Store.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Adding the PDF signature in addition to the C2PA&#8217;s claim signature improves compatibility with the existing PDF ecosystem.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_object_level_manifests"><a class="anchor" href="#_object_level_manifests"></a>11.3.2.3. Object-level Manifests</h5>
<div class="paragraph">
<p>In addition to being able to provide provenance for the PDF itself, via document-level manifests, individual objects within a document may also have an associated C2PA Manifest Store. This is done by adding an <code>AF</code> entry to the object&#8217;s stream or dictionary.  The value of the <code>AF</code> entry shall be an indirect reference to the embedded file specification containing the C2PA Manifest Store, embedded <a href="#_general">as described above</a>.</p>
</div>
<div class="paragraph">
<p>The most common uses for this feature are to provide provenance for embedded images - either as Image or Form XObjects and Fonts. It can also be used to provide provenance for specific pieces of content by adding the <code>AF</code> entry to the object (via property list) or a structure element, as described in the Associated Files clause of ISO 32000-2 (14.13.1).</p>
</div>
<div class="paragraph">
<p>It is recommended that any object-level manifest that is added be referenced from the active manifest as a <code>componentOf</code> ingredient.  This will allow the C2PA Manifest Consumer to easily traverse the entire chain of provenance for the asset.</p>
</div>
<div class="paragraph">
<p>In general, any PDF stream or dictionary may have a C2PA Manifest attached to it as long as the stream or dictionary represents an actual information resource. When there is ambiguity about exactly which stream or dictionary may bear the <code>AF</code> entry, the manifest shall be attached as closely as possible to the object that actually stores the data resource described.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The C2PA Manifest describing a raster image would be attached to the Image XObject stream describing it, and the manifest for embedded font files would be attached to font file streams rather than to font dictionaries.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_example"><a class="anchor" href="#_example"></a>11.3.2.4. Example</h5>
<div class="imageblock text-center">
<div class="content">
<img src="_images/PDF_Manifests.drawio.svg" alt="a PDF with multiple ingredient manifests" width="50%">
</div>
<div class="title">Figure 13. Example of a PDF with multiple ingredient manifests</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_embedding_manifests_into_bmff_based_assets"><a class="anchor" href="#_embedding_manifests_into_bmff_based_assets"></a>11.3.3. Embedding manifests into BMFF-based assets</h4>
<div class="sect4">
<h5 id="_the_uuid_box_for_c2pa"><a class="anchor" href="#_the_uuid_box_for_c2pa"></a>11.3.3.1. The <code>'uuid'</code> Box for C2PA</h5>
<div class="paragraph">
<p>All BMFF-based C2PA assets, whether they are timed (e.g., videos with or without audio tracks), untimed (e.g., still photos) or mixed (e.g., live or animated photos) audiovisual media, shall use a <code>'uuid'</code> box that adheres to the following syntax and semantics defined below.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">EDITORS NOTE</div>
<div class="paragraph">
<p>The reason that a <code>'uuid'</code> box instead of a <code>'c2pa'</code> box is being used is that browsers based on Chromium will immediately fail playback when they encounter any unknown top-level boxes.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Some file formats that are BMFF-based and would be supported via this method include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>MPEG-4 code-points, either complete (<code>.mp4</code>) or fragmented (<code>.m4s</code>); downloadable audio files (<code>.m4a</code>)</p>
</li>
<li>
<p>HEIF (<code>.heif</code>, <code>.heic</code>)</p>
</li>
<li>
<p>AVIF (<code>.avif</code>)</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_definition"><a class="anchor" href="#_definition"></a>11.3.3.1.1. Definition</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">Box Type: `'uuid'`
Extended Box Type: 0xD8, 0xFE, 0xC3, 0xD6, 0x1B, 0x0E, 0x48, 0x3C, 0x92, 0x97, 0x58, 0x28, 0x87, 0x7E, 0xC4, 0x81
Container: File
Mandatory: No
Quantity: Zero or more</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Coalition for Content Provenance and Authenticity (<code>'uuid'</code> with aforementioned uuid) box embeds provenance into BMFF. One such box contains a C2PA Manifest Store, and there may be one or more auxiliary boxes containing additional information required for validation.</p>
</div>
</div>
<div class="sect5">
<h6 id="_syntax_2"><a class="anchor" href="#_syntax_2"></a>11.3.3.1.2. Syntax</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">aligned(8) class ContentProvenanceBox extends FullBox(`'uuid'`, extended_type = 0xD8 0xFE 0xC3 0xD6 0x1B 0x0E 0x48 0x3C 0x92 0x97 0x58 0x28 0x87 0x7E 0xC4 0x81, version = 0, 0) {
    string box_purpose;
    bit(8) data[];
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_semantics"><a class="anchor" href="#_semantics"></a>11.3.3.1.3. Semantics</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">box_purpose</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[indicates purpose of box]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[depends on box_purpose]</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The box_purpose and fields that depend on it are described below for each box purpose.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Regarding unique ids:</p>
</div>
<div class="paragraph">
<p>There are cases, such as fragmented MP4 (fMP4), where the id for a subset of the asset, such as the track_id field of the <code>'tkhd'</code> box, is only locally unique to a subset of the overall asset rather than globally unique to the asset.</p>
</div>
<div class="paragraph">
<p>Because a globally unique id is required to determine what to hash, a unique id is included.  This unique id does not equal any value from the original asset; each value is instead defined when the manifest is created.  The unique id is then combined with an associated local id to form an id that&#8217;s globally unique to the entire asset.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_box_containing_the_manifest"><a class="anchor" href="#_box_containing_the_manifest"></a>11.3.3.2. Box Containing the Manifest</h5>
<div class="paragraph">
<p>The box containing the C2PA Manifest Store shall appear before the first <code>'mdat'</code> box in the file and before any <code>'moov'</code> box in the file.  To accommodate major_brand and compatible_brand verification, it shall be placed after the <code>'ftyp'</code> box.</p>
</div>
<div class="paragraph">
<p>The fields in the corresponding box described above shall be set as follows.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">box_purpose</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For a C2PA Manifest Store, this value shall be <code>manifest</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When box_purpose is <code>manifest</code>, the first 8 bytes inside <code>'data'</code> shall be the absolute file byte offset to the first auxiliary <code>'uuid'</code> C2PA box with box_purpose equal to <code>merkle</code>.  If this file contains no such boxes, those 8 bytes shall be zero.  Those 8 bytes shall be followed by the raw C2PA Manifest Store bytes followed by zero or more unused padding bytes.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>'data'</code> field inside the <code>'uuid'</code> box of type <code>manifest</code> includes the absolute file byte offset, manifest, and padding bytes.  Padding bytes are NOT permitted OUTSIDE the <code>'uuid'</code> box unless they are contained in their own mp4 box such as a <code>'free'</code> box.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For fragmented MP4 (fMP4) files, an identical <code>'uuid'</code> C2PA box of type <code>manifest</code> shall be present in each initialization segment; the C2PA Manifest Store shall be identical.</p>
</div>
</div>
<div class="sect4">
<h5 id="_auxiliary_c2pa_boxes_for_large_and_fragmented_files"><a class="anchor" href="#_auxiliary_c2pa_boxes_for_large_and_fragmented_files"></a>11.3.3.3. Auxiliary <code>'c2pa'</code> Boxes for Large and Fragmented Files</h5>
<div class="paragraph">
<p>Some files have one or more very large <code>'mdat'</code> boxes (e.g., large video or image files which may be downloaded and rendered progressively) or large numbers of independent 'mdat' boxes (e.g., fMP4 where each fragment can be downloaded independently).</p>
</div>
<div class="paragraph">
<p>In these cases, it is unreasonable to require a client to completely download all <code>'mdat'</code> box(es) before validating any portion of the asset.  Avoiding that necessity is resolved by using multiple hashes.</p>
</div>
<div class="paragraph">
<p>For each large <code>'mdat'</code> box, subsets of the box have individual hashes that can be validated independently; how to determine these subsets is specified below. For fMP4 content where each <code>'mdat'</code> box can be downloaded independently, each fragment has its own individual hash.</p>
</div>
<div class="paragraph">
<p>In the simplest case, all of these hashes are stored in the active manifest. Each subset has an auxiliary <code>'uuid'</code> C2PA box that declares how to locate its hash in the active manifest; refer to the note regarding unique ids above for why this is the case.</p>
</div>
<div class="paragraph">
<p>However, for sufficiently large assets, including every subset&#8217;s hash in the manifest itself would increase the size of the C2PA Manifest Store to one or more megabytes.</p>
</div>
<div class="paragraph">
<p>Avoiding such a large C2PA Manifest Store for a large asset is achieved by using one or more Merkle trees.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For a large non-fragmented asset that contains one or more <code>'mdat'</code> boxes in a single large file, one Merkle tree is used for each <code>'mdat'</code> box.</p>
</li>
<li>
<p>For a large fragmented asset that contains a set of <code>'mdat'</code> boxes for a single track which may be spread across multiple files, one Merkle tree is used for each track.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In either case:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each leaf node of any given Merkle tree is the subset&#8217;s hash.</p>
</li>
<li>
<p>The manifest stores one row of each Merkle tree.</p>
</li>
<li>
<p>The auxiliary <code>'uuid'</code> C2PA box that exists for each subset indicates which Merkle tree row in the active manifest it requires and which leaf node it represents. It also includes any additional hash(es) from the Merkle tree necessary to derive a hash in the active manifest&#8217;s Merkle tree row.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The selection of which Merkle tree row to store in the manifest creates a size tradeoff within the asset.  Specifically, storing a single hash per Merkle tree in the manifest minimizes the size of the manifest but requires log2(subsets) to be stored in each subset-specific box.  Each time the number of hashes stored in the manifest for a Merkle tree is doubled (by moving "down" one Merkle tree row), the number of hashes stored in each subset-specific box decreases by one.  Thus, increasing the size of the manifest decreases the size of the entire asset and vice-versa, and since hashes for individual subsets are replicated across subsets as required to derive a manifest-specified hash, the tradeoff is not 1 to 1.</p>
</div>
<div class="paragraph">
<p>Making this size tradeoff is left up to the implementation creating the manifest; this spec neither mandates nor recommends that any specific Merkle tree row be stored in the manifest.  That said, because the simplest case of storing all subset hashes in the manifest is equivalent to using a Merkle tree where the leaf nodes are stored in the manifest, the same Merkle tree construction is used for multiple hashes in all cases.  That construction is defined as follows.</p>
</div>
<div class="paragraph">
<p>The portion of the manifest containing the BMFF Hash shall include the <code>merkle</code> field.  Refer to <a href="#_hashing_a_bmff_formatted_asset">Section 9.2.3, &#8220;Hashing a BMFF-formatted asset&#8221;</a> for more information.</p>
</div>
<div class="paragraph">
<p>For large <code>'mdat'</code> boxes that can be validated piecemeal, two or more auxiliary <code>'uuid'</code> C2PA boxes with box_purpose set to <code>'merkle'</code> as described below shall be included in the single asset file. They shall follow the last <code>'mdat'</code> box in the file.</p>
</div>
<div class="paragraph">
<p>For timed-media where an <code>'stco'</code> or <code>'co64'</code> box is present, the hash used for a given leaf node in the Merkle tree shall be computed over an individual subset of samples as defined by that box.</p>
</div>
<div class="paragraph">
<p>For untimed-media where an <code>'iloc'</code> box is present (such as HEIF or AVIF), the hash used for a given leaf node in the Merkle tree shall be computed over an individual item as defined by that box.</p>
</div>
<div class="paragraph">
<p>Regardless of the subset-defining mechanism, all such auxiliary <code>'uuid'</code> C2PA boxes shall meet the following requirements.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>They shall be in the same sequence as the subsets they hash as specified by the <code>'stco'</code>, <code>'co64'</code>, or <code>'iloc'</code> box regardless of their location in the <code>'mdat'</code>.</p>
</li>
<li>
<p>They shall be grouped such that a single Merkle tree&#8217;s auxiliary <code>'uuid'</code> C2PA boxes are sequential with no intervening boxes.</p>
</li>
<li>
<p>The <code>location</code> value in the first box shall be set to 0, in the second box shall be set to 1, and shall increase sequentially thereafter.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">EDITORS NOTE</div>
<div class="paragraph">
<p>Are there other scenarios where an <code>'mdat'</code> can be large enough to be worth dividing where neither <code>'stco'</code>, <code>'co64'</code>, nor <code>'iloc'</code> is present?  If so, what box(es) should be used to decide on subset division points?</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For fMP4 assets which are split across multiple files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One auxiliary <code>'uuid'</code> C2PA box with box_purpose set to <code>'merkle'</code> as described below shall be included in each fragment file immediately preceding the <code>'moof'</code> box.</p>
</li>
<li>
<p>The hash used for a given leaf node in the Merkle tree shall be over all data in its containing single fragment file except data excluded by the exclusion list.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This specification does not enable support for fMP4 assets which are split across multiple files where individual fragment files contain more than one <code>'moof'</code> box and/or <code>'mdat'</code> box.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For fMP4 assets which are stored as a single flat MP4 file with a single <code>'moov'</code> for all tracks and then one <code>'moof'</code>/<code>'mdat'</code> pair for each fragment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One auxiliary <code>'uuid'</code> C2PA box with box_purpose set to <code>'merkle'</code> as described below shall be included immediately preceding each <code>'moof'</code> box.</p>
</li>
<li>
<p>The hash used for a given leaf node in the Merkle tree shall be over that <code>'moof'</code> box plus all data preceding the next <code>'moof'</code> box or over all data through the end of the file if there is no further <code>'moof'</code> box.  The hash shall not cover data excluded by the exclusion list.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Taking a c2pa-compliant fMP4 asset which is split across multiple files (i.e., has <code>'c2pa'</code> boxes of types <code>'manifest'</code> and <code>'merkle'</code>) and appending the individual files together will not produce a single file which is <code>'c2pa'</code> compliant (nor vice-versa).  This is because which boxes are included in each <code>'merkle'</code> hash will be different in the two cases.  If both forms are desirable, the second form shall consider the first form as an ingredient and the new manifest shall include both an ingredient assertion with relationship <code>parentOf</code> and an actions assertion that includes an action of type <code>c2pa.repackaged</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Regardless of how the asset is structured, the fields in the corresponding box described above shall be set as follows.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">box_purpose</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For an auxiliary <code>'uuid'</code> C2PA box, this value shall be <code>merkle</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When box_purpose is <code>merkle</code>, this value shall contain raw CBOR bytes indicating how to validate a portion of the asset as defined as follows.  If there are multiple auxiliary <code>'uuid'</code> C2PA boxes with box_purpose <code>merkle</code> for a given Merkle tree in a single file, each shall be followed by sufficient padding bytes (zero or more) to make all auxiliary <code>'uuid'</code> C2PA boxes for that Merkle tree a fixed size.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When there are more than one of these boxes in a single file, i.e., the case where there are large <code>'mdat'</code>(s) being validated piecemeal, a fixed size is required in order to enable a progressively downloading client to only download the boxes it needs to begin validation rather than the entire Merkle tree.  Such a client can download enough of the first of these boxes based on the absolute file byte offset in the <code>active manifest</code> to determine if its uniqueId and localId match the 'mdat' it is trying to validate.  If they do, it can determine the absolute file byte offset to the box it needs to validate by multiplying the subset number by that size then download just that box.  Otherwise, it can determine the absolute file byte offset to the beginning of the next Merkle tree by multiplying that fixed size by the current Merkle tree&#8217;s total number of leaf nodes, and it can repeat this process until it locates the box it needs.  The total download size for this subset of boxes is very small relative to the size of a single subset.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="_schema_and_example_2"><a class="anchor" href="#_schema_and_example_2"></a>11.3.3.3.1. Schema and Example</h6>
<div class="paragraph">
<p>The schema for this type is defined by the <code>bmff-merkle-map</code> rule in the following <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; The data structure used to store sufficient information to validate a single 'mdat' box or 
; a portion of an 'mdat' box when a Merkle tree is used",
bmff-merkle-map = {
  "uniqueId": int, ; A unique integer used to differentiate local ids
  "localId": int, ; A local id indicating which 'mdat' box this entry pertains to.  This may not be globally unique
  "location": int, ; Zero-based index into the leaf-most Merkle tree row corresponding to this 'mdat' box or portion of this 'mdat' box
  ? "hashes": [1* bstr], ; An ordered array representing the set of additional hashes required to reach a hash in the Merkle tree specified in the manifest from leaf-most (peer of this node) to root-most (child of node in manifest).  Note that this array may not be present, e.g. if the manifest itself contains the leaf-most row of the Merkle tree.  Null hashes are not included in this array.  The algorithm used shall be determined using the `alg` field from the corresponding entry in the `merkle` field array in the BMFF hash structure.
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{
  "hashes": [
    b64'TWVub3JhaA=='
  ],
  "localId": 4402,
  "location": 2203,
  "uniqueId": 1339
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For files that use a <code>'tkhd'</code> box to indicate individual tracks, the localId in the preceding CBOR shall be set to the track_id field of the <code>'tkhd'</code> box pertaining to the <code>'mdat'</code> being hashed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">EDITORS NOTE</div>
<div class="paragraph">
<p>How do we handle the case where there are multiple <code>'mdat'</code> boxes for untimed media, e.g. a file that includes multiple image <code>'mdat'</code> boxes?
How do we handle the case where there are multiple <code>'mdat'</code> boxes of different types, e.g. a file that has both audio/video <code>'mdat'</code> boxes as well as an image <code>'mdat'</code> box (e.g. for a thumbnail)?
For scenarios such as these, a <code>'tkhd'</code> box alone cannot be used to reference the complete set of different <code>'mdat'</code> boxes when there are more than one; it may not be present at all.
What box value(s) should be used for localId instead?</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_dynamic_stream_generation"><a class="anchor" href="#_dynamic_stream_generation"></a>11.3.3.4. Dynamic stream generation</h5>
<div class="paragraph">
<p>Many adaptive bitrate streaming (ABR) implementations store a single version of an asset, e.g., as a flat MP4 or in another intermediate format, and generate individual asset streams using various codecs, bitrates, etc. at consumption time. As a result, such a server must either hash said streams and create a C2PA Manifest each time the content is consumed or, if generation is deterministic, create and cache the hashes and C2PA Manifests once and then embed them at consumption time.</p>
</div>
<div class="paragraph">
<p>This implies that such a server must also be a <a href="#signer-definition">signer</a> that will be trusted by validators.</p>
</div>
</div>
<div class="sect4">
<h5 id="_exclusion_list_requirements"><a class="anchor" href="#_exclusion_list_requirements"></a>11.3.3.5. Exclusion List Requirements</h5>
<div class="paragraph">
<p>For all <code>c2pa.hash.bmff.v2</code> assertions, the following entries shall always appear on the exclusion list.  Other entries are allowed but not required.</p>
</div>
<div class="paragraph">
<p>The entire <code>'uuid'</code> C2PA box shall be excluded.  (The <code>'data'</code> field is ensuring that other <code>'uuid'</code> boxes are not excluded.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">xpath = "/uuid"
data = [ { offset = 8, data = b64'2P7D1hsOSDySl1goh37EgQ==' } ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The entire <code>'ftyp'</code> and <code>'mfra'</code> boxes shall be excluded.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">xpath = "/ftyp"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">xpath = "/mfra"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Previous versions of this specification included additional mandatory exclusions, but it was discovered that excluding them is insecure.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For all <code>c2pa.hash.bmff.v2</code> assertions where the bmff-hash-map includes both the <code>hash</code> field and <code>merkle</code> fields, the following entry shall appear on the exclusion list.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">xpath = "/mdat"
subset = { { 16, 0 } }</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As indicated in the CDDL Definition above, the <code>c2pa.hash.bmff</code> assertion excludes the entire <code>'mdat'</code> box in this case, but it was discovered that excluding it is insecure.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As indicated in the CDDL Definition above, a relative byte offset or relative byte offset plus length that exceeds the length of the box is allowed; bytes beyond the end of the box are never hashed.  For example, if the <code>mdat</code> box is only 12 bytes long, all of it is hashed and the aforementioned mandatory exclusion entry has no effect although it is still required.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_timed_media_streams_that_are_neither_audio_nor_video"><a class="anchor" href="#_timed_media_streams_that_are_neither_audio_nor_video"></a>11.3.3.6. Timed-media streams that are neither audio nor video</h5>
<div class="paragraph">
<p>Timed-media streams that are neither audio nor video, such as text streams for captions, that the claim generator wishes to make tamper evident shall be handled the same way as audio and video streams.</p>
</div>
</div>
<div class="sect4">
<h5 id="_external_references"><a class="anchor" href="#_external_references"></a>11.3.3.7. External references</h5>
<div class="paragraph">
<p>Externally referenced content declared inside BMFF boxes, such as in a <code>'dref'</code>, <code>'url'</code>, or <code>'urn'</code> box, that the claim generator wishes to make tamper evident shall <strong>not</strong> exclude the referencing box and shall include a separate <a href="#_cloud_data">cloud data assertion</a> for each external reference to be hashed.</p>
</div>
</div>
<div class="sect4">
<h5 id="_size_requirements"><a class="anchor" href="#_size_requirements"></a>11.3.3.8. Size requirements</h5>
<div class="paragraph">
<p>If a BMFF-based asset uses 32-bit sizes or offsets in any box(es), e.g. the <code>'stco'</code> box, and adding boxes to conform to this specification will push the file size over 4 gigabytes, it is the responsibility of the manifest creator to edit the file to use appropriate sizes and offsets, e.g. by replacing the <code>'stco'</code> box with a <code>'co64'</code> box, before creating the manifest.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_embedding_manifests_into_zip_based_formats"><a class="anchor" href="#_embedding_manifests_into_zip_based_formats"></a>11.3.4. Embedding manifests into ZIP-based formats</h4>
<div class="sect4">
<h5 id="_general_3"><a class="anchor" href="#_general_3"></a>11.3.4.1. General</h5>
<div class="paragraph">
<p>Because of its longevity and being an <a href="https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT">openly published specification</a>, many command file formats are really ZIP archives, but with a specific organization of the content files. This includes formats such as <a href="https://www.w3.org/TR/epub/">EPUB</a>, <a href="https://www.iso.org/standard/61796.html">Office Open XML</a>, <a href="https://www.iso.org/standard/66376.html">Open Document</a> and <a href="https://www.ecma-international.org/publications-and-standards/standards/ecma-376/">OpenXPS</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_hashing"><a class="anchor" href="#_hashing"></a>11.3.4.2. Hashing</h5>
<div class="sect5">
<h6 id="_hashing_the_files"><a class="anchor" href="#_hashing_the_files"></a>11.3.4.2.1. Hashing the Files</h6>
<div class="paragraph">
<p>A ZIP-based file format shall be hashed using a <a href="#_collection_data_hash">collection data hash</a>, where each file contained in the ZIP (except the C2PA Manifest itself) shall be included. The hash of each file in the collection is computed over the file&#8217;s compressed and/or encrypted content. The hash algorithm used is specified in the <code>alg</code> field of the <a href="#_collection_data_hash">collection data hash</a> structure.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The reason that the hash is over the compressed/encrypted content is to enable validation without the need to decompress or have the decryption key. This is important for formats that can be encrypted, such as EPUB.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="_hashing_the_zip_central_directory"><a class="anchor" href="#_hashing_the_zip_central_directory"></a>11.3.4.2.2. Hashing the ZIP Central Directory</h6>
<div class="paragraph">
<p>As described in 4.3.12 of the ZIP AppNote, the Central Directory is an array of central directory headers - one per file in the ZIP archive.  It is stored at the end of the ZIP archive and used to locate the files in the ZIP archive and necessary information/metadata about them. It is immediately followed by the End of Central Directory record (ZIP AppNote, 4.3.16), which contains information about the ZIP archive itself.</p>
</div>
<div class="paragraph">
<p>In order to prevent tampering with the ZIP Central Directory, such as adding new files or modifying information about the existing files, each "central directory header" in the ZIP Central Directory as well as the the "end of central directory record" shall be hashed. The hash is computed over the range of bytes from the first byte of the "central directory header" to the last byte of the "end of central directory record" using the hash algorithm specified in the <code>alg</code> field of the <a href="#_collection_data_hash">collection data hash</a> structure.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The "central directory headers" are stored contiguously and then immediately followed by the "end of central directory record".
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The resultant hash value shall be stored in the <code>zip_central_directory_hash</code> field of the <a href="#_collection_data_hash">collection data hash</a> structure.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Using a specially named file in the list of files was considered, but was not accepted because of the two-pass scenario described below.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; An array of URIs and their associated hashes
$collection-data-hash-map /= {
  "uris": [1* uri-hashed-data-map],
  "alg": tstr .size (1..max-tstr-length), ; A string identifying the cryptographic hash algorithm used to compute the hash on each entry of the `uris` array, taken from the C2PA hash algorithm identifier list. 
	? "zip_central_directory_hash" : bstr,
	}
}

; The data structure used to store a reference to a URI and its hash. 
$uri-hashed-data-map /= {
  "uri": relative-url-regexp-type, ; relative URI reference
  "hash": bstr, ;  byte string containing the hash value
  ? "size": size-type, ; Number of bytes of data
  ? "dc:format": format-string, ; IANA media type of the data
  ? "data_types": [1* $asset-type-map],  ; additional information about the data's type
}

; with CBOR Head (#) and tail ($) are introduced in regexp, so not needed explicitly
relative-url-regexp-type  /= tstr .regexp "[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b[-a-zA-Z0-9@:%_\\+.~#?&amp;//=]*"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because the ZIP file must be completed prior to the completion of the C2PA Manifest, a two pass approach (as described for JPEG, BMFF and PDF) needs to be used. The first pass creates a ZIP file with a zero-filled <code>content_credential.c2pa</code> file, and computes the hash of the ZIP Central Directory. The second pass completes the C2PA Manifest including filling the value of the <code>zip_central_directory_hash</code> field.</p>
</div>
<div class="paragraph">
<p>One possible implementation of this two-pass approach would be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>create a ZIP with an zero-filled manifest store file (large enough to be replaced)</p>
</li>
<li>
<p>compute the hash of the ZIP Central Directory</p>
</li>
<li>
<p>add the hash to the <code>zip_central_directory_hash</code> field of the <code>collection-data-hash-map</code></p>
</li>
<li>
<p>complete the manifest</p>
</li>
<li>
<p>overwrite the zero-filled <code>content_credential.c2pa</code> file with the completed manifest data</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When creating the <code>content_credential.c2pa</code> file in the ZIP archive, it shall be stored (compression method 0) and not encrypted.  Its <code>general purpose bit flag</code> and <code>crc-32</code> fields shall be set to 0. The date and time fields may be set to the time of creation of the ZIP archive, or set to 0. It may have a file comment.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_placement_of_the_manifest_store"><a class="anchor" href="#_placement_of_the_manifest_store"></a>11.3.4.3. Placement of the Manifest Store</h5>
<div class="paragraph">
<p>The C2PA Manifest Store shall be stored in the <code>META-INF</code> directory of the ZIP archive with a filename of <code>content_credential.c2pa</code> and a media type as recommended for <a href="#_external_manifests">external manifests</a>. The file shall be stored (compression method 0) and not encrypted.</p>
</div>
</div>
<div class="sect4">
<h5 id="_digitally_signing_zip_based_formats"><a class="anchor" href="#_digitally_signing_zip_based_formats"></a>11.3.4.4. Digitally signing ZIP-based formats</h5>
<div class="sect5">
<h6 id="_epub"><a class="anchor" href="#_epub"></a>11.3.4.4.1. EPUB</h6>
<div class="paragraph">
<p>EPUB&#8217;s digital signatures are based on <a href="https://www.w3.org/TR/xmldsig-core1/">W3C XML DigSig Core</a>, where each file that is signed is listed in the <code>&lt;Manifest&gt;</code> element of the <code>&lt;Signature&gt;</code> element. In addition, no support exists for signing the ZIP Central Directory.  As such, EPUB native signing must take place before the introduction of the C2PA Manifest.</p>
</div>
</div>
<div class="sect5">
<h6 id="_office_open_xml"><a class="anchor" href="#_office_open_xml"></a>11.3.4.4.2. Office Open XML</h6>
<div class="paragraph">
<p>OOXML&#8217;s digital signatures are based on <a href="https://www.w3.org/TR/xmldsig-core1/">W3C XML DigSig Core</a>, where each file that is signed is listed as a <code>&lt;Reference&gt;</code> element in the <code>&lt;Manifest&gt;</code> element of the <code>&lt;Signature&gt;</code> element. In addition, no support exists for signing the ZIP Central Directory.  As such, OOXML native signing must take place before the introduction of the C2PA Manifest.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
OpenXPS is based on the same Open Packaging Convention (OPC) standard as OOXML, and as such, the same approach applies.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_external_manifests"><a class="anchor" href="#_external_manifests"></a>11.4. External Manifests</h3>
<div class="paragraph">
<p>In some cases, it may not be possible (or practical) to embed a C2PA Manifest Store in an asset. In those cases, keeping the C2PA Manifests externally to the asset is an acceptable model for providing providence to assets. The C2PA Manifest should be stored in a location, referred to as a manifest repository, that is easily locatable by a Manifest Consumer working with the asset, such as <a href="#_by_reference_or_uri">by reference or URI</a>. As the C2PA Manifest Store is a JUMBF box, it shall be served with the JUMBF Media Type, <code>application/c2pa</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Previous versions of this specification used the media type <code>application/x-c2pa-manifest-store</code> for the C2PA Manifest Store. That media type is deprecated.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Some common reasons to use an external manifest are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It may not be technically possible, such as with a <code>.txt</code> file.</p>
</li>
<li>
<p>It may not be practical, such as when the size of the C2PA Manifest Store is larger than the asset&#8217;s digital content.</p>
</li>
<li>
<p>It may not be appropriate, such as when it would modify an asset that should not be modified.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
a good example of this is creating a manifest for a pre-existing asset.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_embedding_a_reference_to_an_external_manifest"><a class="anchor" href="#_embedding_a_reference_to_an_external_manifest"></a>11.5. Embedding a Reference to an external Manifest</h3>
<div class="paragraph">
<p>If the asset has embedded XMP, and the C2PA Manifest will be stored externally, it is recommended that the claim generator add a <a href="https://www.dublincore.org/specifications/dublin-core/dcmi-terms/#http://purl.org/dc/terms/provenance"><code>dcterms:provenance</code></a> key to the XMP, the value (a URI reference) being where to locate the Active Manifest.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A previous version of this specification also recommended using this method for references to embedded manifests. Now this mechanism is only for external manifests.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Since fonts do not support XMP, an equivalent method for specifying a URI to a remote manifest store is described in <a href="#_embedding_manifests_into_fonts">this clause on fonts</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_entity_diagram"><a class="anchor" href="#_entity_diagram"></a>12. Entity Diagram</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following diagram provides a look at how all of the pieces of the C2PA system integrate and relate to each other.</p>
</div>
<div class="imageblock text-center kroki">
<div class="content">
<img src="https://kroki.io/plantuml/svg/eNqlVE1v2zAMPdu_gmgPAQa0xi47eEOANt2GHroBa_6AYjG2UFkyJLldVvS_j5I_ZDtBM2AFglqU-PhIPjJdwY-f2685oHLCHUBYYAqYFMzCXhsoJLM2_WLdQeI6Dac7wUrDanhNobsOX_5vBcw5I3atQw_DoUZXaW6H629auY2WBLuTLQ7WW1Y8lUa3ind3B5RSv6QjZhdDsXrwqJBxNGNUAI_7KP4gfPw02ibBnoWW6OavfT6w05L35rfU_97SL1mfappILFHxNEk-wI2UYFAyJ7SylWgoO4NghSpbyQy0SiJR1K5C8yIs3TRYiL3Azvu7QVQghaKqGGwMWio2YL1DzpFnBfFhQtnw9pYKc_SUzk_IybBHg6rA7ukWfzsQCrJMOGpYYbOMCs4UEWk8USYBJdYEQO8pkz6fNFlBJTgCsSWi2o0Gpg7EqiEVuIpSs9fX12kSbgphCon9oXtSe_7GBjj2rAWHxugdxbPwIlxFYKUkzoXRL6QkRB_GPgnVMK8dn6E7NAjakEJSzy_I78ZadNTZJNlQVchIXyvwPOjfAzrGmWN0CJYHpsQeLTVTGyL3NkMxvgQB6W7ikmUDSJYFj9Ug_I1B7j-paq_eHNFuheJUDm-OxntVkoPw3fEx7hUNSx30EUPd9WGG87Zq651iQk6NQxIdnxF_I5moA_SYjI1Ov5CzItgiVPB4FKVirp2XY34TQLemtY7as_HQe1EwhxOe_eVW1PjoWN0suM3q3nEkMs842CNSrNJwZ_u6L6DmmfYNjZ3PstiecLlI-3wNjpl0_RwfjCVd2D1aWDbBGPSZ5_MKXF1d8TUs1JjGdPLcK8E_W091c-mX4GdHU5z7L8ihZoc45F6ExxDrqVDPIaTJoN0QuyffT9YJ7-mCWcEp32F63ndO56OZ53N9hDTGw2Xp12MHFT4JK67EBdAJQQW0i5qW18WpLr8LH_GJ40x9U9S4Tv6N60msoZr_AXGU5EkwL4Ee0HcxIi5GaAo5E9U5zAliWFJBH_0YLu7i0omP4nimSUwlzhTMxyQ28qzYA_ykcraLetzFd7QLI0zcsdNKxTVxdnx7nPOFODdM_Qo6UcG_R78lHQ==" alt="C2PA Entity Diagram" width="612">
</div>
<div class="title">Figure 14. C2PA Entity Diagram</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cryptography"><a class="anchor" href="#_cryptography"></a>13. Cryptography</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_hashing_2"><a class="anchor" href="#_hashing_2"></a>13.1. Hashing</h3>
<div class="paragraph">
<p>All cryptographic hashes that are stored in a C2PA Manifest shall be generated using one of the hash algorithms as described in this section. This section defines both:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A list of hash algorithms that are allowed for generating hashes of new content as well as required for validating hashes of existing content (the allowed list), and</p>
</li>
<li>
<p>A list of hash algorithms that are required to be supported for validating hashes of existing content but are not allowed for generating hashes of new content (the deprecated list).</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This section does not govern algorithms used for soft bindings as described in <a href="#_soft_bindings">Section 9.3, &#8220;Soft Bindings&#8221;</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An algorithm must appear in no more than one list. An algorithm that is instantiated over multiple output lengths (such as the various lengths of SHA2) will each be considered different algorithms, and each instantiation must be listed separately. If an algorithm does not appear in either list, it is forbidden and must not be used or supported. Algorithms can be removed from the lists in order to implement forbidding an algorithm. For this reason, implementations must not support additional algorithms on an optional basis.</p>
</div>
<div class="paragraph">
<p>Implementers should consult this section in the current version of the specification when releasing software updates and ensure their supported algorithms conform to it.</p>
</div>
<div class="paragraph">
<p>These lists establish the allowed algorithms for creating hashes and a string algorithm identifier to be used as the algorithm identifier (usually called <code>alg</code>) in the corresponding field of C2PA data structures. The outputs of hash functions shall be stored as their binary values encoded into CBOR as byte strings (major type 2) with a declared length. Wherever a field contains the output of a hash function, an algorithm identifier string field shall be present within the same structure, or within an enclosing structure, to declare which algorithm was used. A hash algorithm identifier field should be present in exactly one of these places, but if more than one is present within the structure and its enclosing structures, the nearest identifier must be used. Nearest is defined first as an identifier that is a sibling field of the hash value, and then the immediately enclosing structure, up to the root structure.</p>
</div>
<div class="paragraph">
<p>The allowed list is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SHA2-256 ("sha256")</p>
</li>
<li>
<p>SHA2-384 ("sha384")</p>
</li>
<li>
<p>SHA2-512 ("sha512")</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The SHA-3 family of hash algorithms are not on the allowed list for consistency with the digital signature algorithm allowed list, because COSE has not yet established digital signature algorithms that use a SHA-3 algorithm as the hash algorithm. A future version of this specification will incorporate SHA-3 for hashing as well as COSE digital signature algorithms that use SHA-3 when they are available.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The deprecated list is empty.</p>
</div>
</div>
<div class="sect2">
<h3 id="_digital_signatures"><a class="anchor" href="#_digital_signatures"></a>13.2. Digital Signatures</h3>
<div class="paragraph">
<p>All digital signatures that are stored in a C2PA Manifest shall be generated using one of the digital signature algorithms and key types listed as described in this section. This section defines both:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A list of digital signature algorithms and key types that are allowed for generating signatures for new claim signatures as well as required for validating existing claim signatures (the allowed list), and</p>
</li>
<li>
<p>A list of digital signature algorithms and key types that are required to be supported for validating existing claim signatures but are not allowed for generating new claim signatures (the deprecated list).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These lists establish the allowed algorithms and key types by referencing an algorithm identifier from the relevant standards that define algorithms for COSE and their mappings to CBOR identifiers, including but not limited to <a href="https://tools.ietf.org/html/rfc8152">RFC 8152</a> and <a href="https://datatracker.ietf.org/doc/html/rfc8230/">RFC 8230</a>. These standards also specify the hash algorithm used in the signature scheme. Nothing in <a href="#_hashing">Section 11.3.4.2, &#8220;Hashing&#8221;</a> shall apply to this use of hash algorithms; if a digital signature algorithm is present in the digital signature algorithm and key type registry, the use of its specified hash algorithm in the signature scheme shall be allowed and followed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Parenthetical notes in the lists below are explainers provided only as an aid to the reader.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_signature_algorithms"><a class="anchor" href="#_signature_algorithms"></a>13.2.1. Signature Algorithms</h4>
<div class="paragraph">
<p>The allowed list is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ES256</code> (ECDSA with SHA-256)</p>
</li>
<li>
<p><code>ES384</code> (ECDSA with SHA-384)</p>
</li>
<li>
<p><code>ES512</code> (ECDSA with SHA-512)</p>
</li>
<li>
<p><code>PS256</code> (RSASSA-PSS using SHA-256 and MGF1 with SHA-256)</p>
</li>
<li>
<p><code>PS384</code> (RSASSA-PSS using SHA-384 and MGF1 with SHA-384)</p>
</li>
<li>
<p><code>PS512</code> (RSASSA-PSS using SHA-512 and MGF1 with SHA-512)</p>
</li>
<li>
<p><code>EdDSA</code> (Edwards-Curve DSA)</p>
<div class="ulist">
<ul>
<li>
<p>Ed25519 instance only. No other EdDSA instances are allowed.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The deprecated list is empty.</p>
</div>
<div class="paragraph">
<p>Implementations must check that keys provided for signing or verification operations are correct for the chosen algorithm, as required by <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-8.1">RFC 8152 section 8.1</a> for ECDSA, <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-8.2">RFC 8152 section 8.2</a> for EdDSA, and <a href="https://www.rfc-editor.org/rfc/rfc8230.html#section-2">RFC 8230 section 2</a> and <a href="https://www.rfc-editor.org/rfc/rfc8230.html#section-4">section 4</a> for RSASSA-PSS. These requirements are summarized here for convenience:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ECDSA requires elliptic curve keys on the P-256, P-384, or P-521 elliptic curves.</p>
<div class="ulist">
<ul>
<li>
<p>Although it is recommended to use P-256 keys with <code>ES256</code>, P-384 keys with <code>ES384</code>, and P-521 keys with <code>ES512</code>, it is not required. Implementations must accept keys on any of these curves for all ECDSA algorithm choices.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Ed25519 requires elliptic curve keys on the X25519 elliptic curve.</p>
</li>
<li>
<p>RSASSA-PSS requires RSA keys with a modulus length of at least 2048 bits.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Implementations must refuse to generate or verify signatures with keys that are not correct for the algorithm choice. Implementations may refuse RSA keys with modulus length greater than 16384 bits.</p>
</div>
</div>
<div class="sect3">
<h4 id="_use_of_cose"><a class="anchor" href="#_use_of_cose"></a>13.2.2. Use of COSE</h4>
<div class="paragraph">
<p>The signature for the CBOR-encoded claim is produced by CBOR Object Signing and Encryption (COSE) as described in <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-4.2">RFC 8152</a> sections <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-4.2">4.2</a> and <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-4.4">4.4</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Payloads can either be present inside a COSE signature, or transported separately ("detached content" as described in <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-4.1">RFC 8152 section 4.1</a>). In "detached content" mode, the signed data is stored externally to the <code>COSE_Sign1_Tagged</code> structure, and the <code>payload</code> field of the <code>COSE_Sign1_Tagged</code> structure is always <code>nil</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Regardless of whether the payload will be present in or detached from the <code>COSE_Sign1_Tagged</code> signature; the contents of the <code>payload</code> field of <code>Sig_structure</code> in memory, when constructed to compute or verify a digital signature, must be populated with that external data as described by the particular use of digital signature in this specification. The <code>payload</code> field of <code>Sig_structure</code> shall never be <code>nil</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For example, when computing or verifying a claim signature, the <code>payload</code> field of the <code>Sig_structure</code> will contain the contents of the Claim JUMBF box, as described in <a href="#_signing_a_claim">Section 10.3.2.4, &#8220;Signing a Claim&#8221;</a> and <a href="#_use_of_jumbf">Section 11.1, &#8220;Use of JUMBF&#8221;</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_computing_the_signature"><a class="anchor" href="#_computing_the_signature"></a>13.2.3. Computing the Signature</h4>
<div class="ulist">
<ul>
<li>
<p>The signature is computed or verified as described in <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-4.4">RFC 8152 section 4.4</a>. The following additional requirements apply to the construction of <code>Sig_structure</code>:</p>
<div class="ulist">
<ul>
<li>
<p>The value for the <code>context</code> element shall be <code>Signature1</code> except where a particular use of digital signatures in this specification specifies using <code>CounterSignature</code> instead. <code>Signature</code> shall not be used.</p>
</li>
<li>
<p>The value for the <code>payload</code> element will be specified by each use of digital signatures in this specification.</p>
</li>
<li>
<p>The <code>external_aad</code> element shall be a <code>bstr</code> of length zero. External authenticated data shall not be used.</p>
</li>
<li>
<p>The <code>alg</code> header specifying the signature algorithm shall be present in the <code>body_protected</code> element. <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-3.1">RFC 8152 section 3.1</a></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>alg</code> header is a standard COSE header, and therefore is always included in the protected header map with the integer <code>1</code> as its label, as established in the <a href="https://www.iana.org/assignments/cose/cose.xhtml#header-parameters">IANA COSE Header Parameters Registry</a>. The literal string <code>alg</code> is never used as the label. The <code>sign_protected</code> element is always omitted when using <code>COSE_Sign1</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>All digital signatures in C2PA structures shall be a <code>COSE_Sign1_Tagged</code> structure as defined in <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-4.2">RFC 8152 section 4.2</a>. <code>COSE_Sign1_Tagged</code> contains a <code>COSE_Sign1</code> structure. The following additional requirements apply to the construction of <code>COSE_Sign1_Tagged</code>:</p>
<div class="ulist">
<ul>
<li>
<p>The same <code>alg</code> header in the <code>Sig_structure</code> above shall be present in the <code>protected</code> header bucket.</p>
</li>
<li>
<p>The value for the <code>payload</code> field and whether the payload is present in the signature or detached will be specified by each use of digital signatures in this specification. When the <code>payload</code> is specified as detached, its value here must be <code>nil</code>. Conversely, when the payload is present in the signature, the binary contents of the payload are stored in this field as a <code>bstr</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>COSE defines <code>nil</code> to be major type 7, value 22 in <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-1.3">section 1.3</a> and uses this value exclusively for detached content. A byte array (major type 2) of length zero cannot be used to indicate detached content.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_signature_validation"><a class="anchor" href="#_signature_validation"></a>13.2.4. Signature Validation</h4>
<div class="sect4">
<h5 id="_trusted_credential"><a class="anchor" href="#_trusted_credential"></a>13.2.4.1. Trusted Credential</h5>
<div class="paragraph">
<p>When producing a signature, if the claim generator can also act as a validator, the claim generator should validate that the signing credential is acceptable according to <a href="#_trust_model">Chapter 14, <em>Trust Model</em></a> and produce a warning if it is not. The claim generator may still allow signing with that credential if so desired. This may be desirable if it is known that the local claim generator&#8217;s validator has a different configuration than validators used by the expected audience of the asset.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_cryptographic_validation"><a class="anchor" href="#_cryptographic_validation"></a>13.2.5. Cryptographic validation</h4>
<div class="paragraph">
<p>When verifying a signature, an in-memory <code>Sig_structure</code> is generated. Its <code>body_protected</code> field is populated with the contents of the <code>protected</code> header bucket from the <code>COSE_Sign1_Tagged</code> structure (see <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-4.4" class="bare">https://datatracker.ietf.org/doc/html/rfc8152#section-4.4</a>). For the <code>payload</code> field, if the payload was specified as present in the signature, it is populated from the <code>payload</code> field of the <code>COSE_Sign1_Tagged</code> structure. If the payload was specified as detached, the <code>payload</code> field of the <code>COSE_Sign1_Tagged</code> structure will be <code>nil</code>. In this case, the contents of the <code>payload</code> field of <code>Sig_structure</code> shall be populated from the same external source that was used in the generation of the signature. These are defined in the places where the digital signature is used in this specification.</p>
</div>
</div>
<div class="sect3">
<h4 id="_inclusion_of_signer_icons"><a class="anchor" href="#_inclusion_of_signer_icons"></a>13.2.6. Inclusion of Signer Icons</h4>
<div class="paragraph">
<p>A C2PA Manifest Consumer may wish to display an icon or logo for the signer. To locate such a graphic, it shall look inside the embedded certificate for a logotype as defined in <a href="https://datatracker.ietf.org/doc/rfc9399/">RFC 9399</a>. If no logotype is present, the Manifest Consumer may use icons or logos from other sources in an implementation-dependent manner.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_trust_model"><a class="anchor" href="#_trust_model"></a>14. Trust Model</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In this section, "user" refers to human actors that are using C2PA-compliant validators in consumption and authoring scenarios.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_overview_5"><a class="anchor" href="#_overview_5"></a>14.1. Overview</h3>
<div class="imageblock text-center kroki">
<div class="content">
<img src="https://kroki.io/ditaa/svg/eNqtUstqw0AMvPsrdF_8A6G9OBDoOaXHwHatJEscG6R1wOCPr7wP29s2OYTMSdZ4RtJKqoxQ8AuqLO9yOa-KMSXHT-rZMbA9tUjgunERSBhZy9x71icTLS77IJMko-kJwZ3RknBbwhpbZ3UjnPXhcYhVWPgv3dhau47GVS9vZQ4Z4yNU_svlY4qL2e2q2LWZi_OUMFVg1s2vIMqqii7qJa87fR_gSRy8fPOsfPNArt4T1LzaW1qE326SR1IzIznbtRISLqYSmTOaS1BbN4Bu66X6UmcNBVsx6q9I__PTL0Xwv-oa4XuYrildJuTVOyI0rhnm2yruP0k2djzBH9wQuXI=" alt="TrustModel">
</div>
</div>
<div class="paragraph">
<p>The above model shows, in yellow, green and red, the three entities specified in the trust model, which is concerned with trust in a signer&#8217;s identity. In dashed lines, below, is the consumer (who is not specified in the trust model), who uses the identity of the signer, along with other trust signals, to decide whether the assertions made about an asset are true.</p>
</div>
</div>
<div class="sect2">
<h3 id="_identity_of_signers"><a class="anchor" href="#_identity_of_signers"></a>14.2. Identity of Signers</h3>
<div class="paragraph">
<p>Identity in the trust model is the means by which a cryptographic signing key (aka credential) is associated with the <a href="#signer-definition">signer</a> for the basis of making trust decisions based on the <a href="#claim-signature-definition">claim signature</a> or any structure (including, but not limited to, assertions and claims) signed with that key.</p>
</div>
<div class="paragraph">
<p>The credential shall be listed in the COSE protected headers of the <code>COSE_Sign1_Tagged</code> structure used for digital signatures in all C2PA manifests. Exactly one instance of an identity credential shall appear in the union of the protected and unprotected headers. <code>COSE_Sign1_Tagged</code> structures with no credentials, or two or more credentials, shall be rejected. Repeating the same credential more than once, including separately in the protected and unprotected headers, is also an instance of two or more credentials and shall be rejected.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Older versions of this specification also allowed the credential to appear in the COSE unprotected headers.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>How the credential is stored in the header value, how trust chains are constructed are specified, and additional information can be found in <a href="#x509_certificates">Section 14.6, &#8220;X.509 Certificates&#8221;</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_statements_by_a_validator"><a class="anchor" href="#_statements_by_a_validator"></a>14.3. Statements by a Validator</h3>
<div class="paragraph">
<p>A validator is a Manifest Consumer that will make some <a href="#_validation">validation</a> statements about that asset. The actor consuming the asset, usually through their user agent and its user interface, then has to interpret those statements to arrive at a set of conclusions of their own about the provenance of the asset they are consuming. These conclusions will be drawn from these statements and the contents of the asset itself.</p>
</div>
<div class="paragraph">
<p>A validator can make the following true or false statements about the asset they are validating, and no more. The process for determining the validation state of each statement is described in the <a href="#_validation">validation section</a>.</p>
</div>
<div class="sect3">
<h4 id="_content_bindings"><a class="anchor" href="#_content_bindings"></a>14.3.1. Content Bindings</h4>
<div class="ulist">
<ul>
<li>
<p>The portions of the asset that are covered by content bindings have not been modified since the active manifest was produced [<a href="#_validate_the_assets_content">Section 15.10, &#8220;Validate the Asset&#8217;s Content&#8221;</a>].</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_well_formed_manifest"><a class="anchor" href="#_well_formed_manifest"></a>14.3.2. Well-formed Manifest</h4>
<div class="ulist">
<ul>
<li>
<p>The active manifest has not been modified since the active manifest was signed [<a href="#_cryptographic_validation">Section 13.2.5, &#8220;Cryptographic validation&#8221;</a>].</p>
</li>
<li>
<p>The claim was produced by a <a href="#claim-generator-definition">claim generator</a> which is identified by the <code>claim_generator_info</code> field of the claim [<a href="#_claim_generator_info">Section 10.2.1, &#8220;Claim Generator Info&#8221;</a>].</p>
</li>
<li>
<p>The assertions of the active manifest have not been modified since the active manifest was produced [<a href="#_validate_the_assertions">Section 15.7, &#8220;Validate the Assertions&#8221;</a>].</p>
</li>
<li>
<p>Only those assertions allowed for the <a href="#_types_of_manifests">specific type</a> of the active manifest are present [<a href="#_assertion_validation">Section 15.7.3, &#8220;Assertion Validation&#8221;</a>].</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_additional_statements"><a class="anchor" href="#_additional_statements"></a>14.3.3. Additional Statements</h4>
<div class="ulist">
<ul>
<li>
<p>The assertions of the active manifest consist of statements created or gathered by the <a href="#_claim_generator">claim generator</a> and the data contained inside them is not verified.</p>
</li>
<li>
<p>The assets referred to by ingredient assertions are not (necessarily) available at validation of the active manifest, and therefore their hashes cannot be validated.</p>
</li>
<li>
<p>The ingredient assertion may contain a <code>validationStatus</code> field that indicates the active manifest signer&#8217;s assessment of the validation state of the ingredient at the time of adding the ingredient.</p>
</li>
<li>
<p>The content of ingredient assertions, like all other assertions, is not independently validated.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_trusted_signer_credentials"><a class="anchor" href="#_trusted_signer_credentials"></a>14.3.4. Trusted Signer Credentials</h4>
<div class="ulist">
<ul>
<li>
<p>The credential of the signer of a C2PA manifest is trusted if, <a href="#_validate_the_signature">after being validated</a>, the signing credential receives the success code of <code>signingCredential.trusted</code> [<a href="#_validate_the_signature">Section 15.4, &#8220;Validate the Signature&#8221;</a>] any associated time-stamp receives the success code of <code>timeStamp.trusted</code> [<a href="#_validate_the_time_stamp">Section 15.5, &#8220;Validate the Time-Stamp&#8221;</a>], and the credential is not rejected with a failure code of <code>signingCredential.revoked</code> [<a href="#_validate_the_credential_revocation_information">Section 15.6, &#8220;Validate the Credential Revocation Information&#8221;</a>].</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_trust_lists"><a class="anchor" href="#_trust_lists"></a>14.4. Trust Lists</h3>
<div class="sect3">
<h4 id="_c2pa_signers"><a class="anchor" href="#_c2pa_signers"></a>14.4.1. C2PA Signers</h4>
<div class="paragraph">
<p>A validator shall maintain the following lists for C2PA signers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The list of X.509 certificate trust anchors provided by the C2PA (i.e., the C2PA Trust List).</p>
</li>
<li>
<p>A list of additional X.509 certificate trust anchors.</p>
</li>
<li>
<p>A list of accepted Extended Key Usage (EKU) values.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Some of these lists can be empty.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In addition to the list of trust anchors provided in the C2PA Trust List, a validator should allow a user to configure additional trust anchor stores, and should provide default options or offer lists maintained by external parties that the user may opt into to populate the validator&#8217;s trust anchor store for C2PA signers.</p>
</div>
</div>
<div class="sect3">
<h4 id="_time_stamp_authorities"><a class="anchor" href="#_time_stamp_authorities"></a>14.4.2. Time Stamp Authorities</h4>
<div class="paragraph">
<p>A validator shall maintain a list of X.509 certificate trust anchors for Time Stamp Authorities, which shall be different than the lists <a href="#_c2pa_signers">for C2PA signers</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This list can be empty.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A validator should allow a user to configure additional trust anchor stores, and should provide default options or offer lists maintained by external parties that the user may opt into to populate the validator&#8217;s trust anchor store for Time Stamp Authorities.</p>
</div>
</div>
<div class="sect3">
<h4 id="_private_credential_storage"><a class="anchor" href="#_private_credential_storage"></a>14.4.3. Private Credential Storage</h4>
<div class="paragraph">
<p>A validator may also allow the user to create and maintain a private credential store of signing credentials. This store is intended as an "address book" of credentials they have chosen to trust based on an out-of-band relationship. If present, the private credential store shall only apply to validating signed C2PA manifests, and shall not apply to validating time-stamps. If present, the private credential store shall only allow trust in signer certificates directly; entries in the private credential store cannot issue credentials and shall not be included as trust anchors during validation.</p>
</div>
<div class="paragraph">
<p>A validator shall not be pre-configured with any entries in a private credential store.</p>
</div>
<div class="paragraph">
<p>A validator shall only add entries to a private credential store in response to a user request to trust the credential. Similarly, a validator shall only remove entries from a private credential store in response to a user request to stop trusting the credential.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_c2pa_valid_manifests"><a class="anchor" href="#_c2pa_valid_manifests"></a>14.5. C2PA Valid Manifests</h3>
<div class="paragraph">
<p>A C2PA Manifest shall be considered a C2PA Valid Manifest if both of these conditions are met:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the claim signature receives the success code of <code>signingCredential.trusted</code> <a href="#_validate_the_signature">after being validated</a>.</p>
</li>
<li>
<p>the C2PA Manifest is <a href="#_well_formed_manifest">well-formed</a> having passed all steps of the <a href="#_validation">validation process</a>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="x509_certificates"><a class="anchor" href="#x509_certificates"></a>14.6. X.509 Certificates</h3>
<div class="paragraph">
<p>X.509 Certificates are stored as defined by <a href="https://datatracker.ietf.org/doc/html/rfc9360">RFC 9360: CBOR Object Signing and Encryption (COSE): Header Parameters for Carrying and Referencing X.509 Certificates</a>. For convenience, the definition of <code>x5chain</code> is copied below.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This specification adds additional requirements beyond those of RFC 9360, which are listed after the quoted text. In particular, this specification requires all intermediate certificate authorities' certificates of the signer&#8217;s certificate chain to be included in the <code>x5chain</code> header, and requires claim generators to always place the <code>x5chain</code> header in the protected header bucket.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>x5chain: This header parameter contains an ordered array of X.509 certificates. The certificates are to be ordered starting with the certificate containing the end-entity key followed by the certificate that signed it, and so on. There is no requirement for the entire chain to be present in the element if there is reason to believe that the relying party already has, or can locate, the missing certificates. This means that the relying party is still required to do path building but that a candidate path is proposed in this header parameter.</p>
</div>
<div class="paragraph">
<p>The trust mechanism MUST process any certificates in this parameter as untrusted input. The presence of a self-signed certificate in the parameter MUST NOT cause the update of the set of trust anchors without some out-of-band confirmation. As the contents of this header parameter are untrusted input, the header parameter can be in either the protected or unprotected header bucket. Sending the header parameter in the unprotected header bucket allows an intermediary to remove or add certificates.</p>
</div>
<div class="paragraph">
<p>The end-entity certificate MUST be integrity protected by COSE. This can, for example, be done by sending the header parameter in the protected header, sending an 'x5chain' in the unprotected header combined with an 'x5t' in the protected header, or including the end-entity certificate in the external_aad.</p>
</div>
<div class="paragraph">
<p>This header parameter allows for a single X.509 certificate or a chain of X.509 certificates to be carried in the message.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a single certificate is conveyed, it is placed in a CBOR byte string.</p>
</li>
<li>
<p>If multiple certificates are conveyed, a CBOR array of byte strings is used, with each certificate being in its own byte string.</p>
</li>
</ul>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The validator is only expected to have the certificates for its trust anchors. Therefore, when creating the <code>x5chain</code> header as part of signing, the claim generator shall include the signer&#8217;s certificate and all intermediate certificate authorities in the header&#8217;s value. The trust anchor&#8217;s certificate (also called the root certificate) should not be included.</p>
</div>
<div class="paragraph">
<p>The <code>subjectPublicKeyInfo</code> element of the first or only certificate will be the public key used to validate the signature. The <code>validity</code> element of the <code>tbsCertificate</code> sequence provides the time validity period of the certificate.</p>
</div>
<div class="paragraph">
<p>A previous version of this specification required claim generators to write the string label <code>x5chain</code> only to avoid the unlikely possibility that the integer label <code>33</code> would not be standardized. Integer label <code>33</code> has now been standardized, and this specification now adopts it as standard, and deprecates use of the string label. Therefore:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Claim generators should use only the integer <code>33</code> as the label when inserting this header into a COSE signature. Claim generators may continue to write the string label <code>x5chain</code> but this behaviour is now deprecated and claim generators should be updated to use the integer label only. Claim generators shall place this header only in the protected header bucket of the COSE signature as required above.</p>
</li>
<li>
<p>Validators shall accept either the string <code>x5chain</code> or the integer <code>33</code> as the label for this header. If both labels are present, validators shall use the header with the integer label <code>33</code> and ignore the header with the string <code>x5chain</code> as the label. Validators shall accept the header from either the protected or unprotected bucket, to maintain compatibility with previous versions of this specification. In compliance with <a href="#_identity_of_signers">Section 14.2, &#8220;Identity of Signers&#8221;</a>, if this header appears in both the protected and unprotected buckets with the same label, a validator must reject the claim signature as malformed due to the presence of multiple credentials.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_certificate_profile"><a class="anchor" href="#_certificate_profile"></a>14.6.1. Certificate Profile</h4>
<div class="paragraph">
<p>This section defines the requirements to validate that an X.509 certificate is acceptable as a signing credential as described in <a href="#_validate_the_signature">Section 15.4, &#8220;Validate the Signature&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>All certificates must fulfill the following requirements.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>algorithm</code> field of the <code>signatureAlgorithm</code> field shall be one of the following values:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ecdsa-with-SHA256</code></dt>
<dd>
<p><a href="https://datatracker.ietf.org/doc/html/rfc5758#section-3.2">RFC 5758 section 3.2</a></p>
</dd>
<dt class="hdlist1"><code>ecdsa-with-SHA384</code></dt>
<dd>
<p><a href="https://datatracker.ietf.org/doc/html/rfc5758#section-3.2">RFC 5758 section 3.2</a></p>
</dd>
<dt class="hdlist1"><code>ecdsa-with-SHA512</code></dt>
<dd>
<p><a href="https://datatracker.ietf.org/doc/html/rfc5758#section-3.2">RFC 5758 section 3.2</a></p>
</dd>
<dt class="hdlist1"><code>sha256WithRSAEncryption</code></dt>
<dd>
<p><a href="https://datatracker.ietf.org/doc/html/rfc8017#appendix-A.2.4">RFC 8017 appendix A.2.4</a></p>
</dd>
<dt class="hdlist1"><code>sha384WithRSAEncryption</code></dt>
<dd>
<p><a href="https://datatracker.ietf.org/doc/html/rfc8017#appendix-A.2.4">RFC 8017 appendix A.2.4</a></p>
</dd>
<dt class="hdlist1"><code>sha512WithRSAEncryption</code></dt>
<dd>
<p><a href="https://datatracker.ietf.org/doc/html/rfc8017#appendix-A.2.4">RFC 8017 appendix A.2.4</a></p>
</dd>
<dt class="hdlist1"><code>id-RSASSA-PSS</code></dt>
<dd>
<p><a href="https://datatracker.ietf.org/doc/html/rfc8017#appendix-A.2.3">RFC 8017 appendix A.2.3</a></p>
</dd>
<dt class="hdlist1"><code>id-Ed25519</code></dt>
<dd>
<p><a href="https://datatracker.ietf.org/doc/html/rfc8410#section-3">RFC 8410 section 3</a></p>
</dd>
</dl>
</div>
</li>
<li>
<p>If the <code>algorithm</code> field of the <code>signatureAlgorithm</code> field is <code>id-RSASSA-PSS</code>, the <code>parameters</code> field is of type <code>RSASSA-PSS-params</code>. Its fields shall have the following requirements: <a href="https://datatracker.ietf.org/doc/html/rfc8017#appendix-A.2.3">RFC 8017 section A.2.3</a></p>
<div class="ulist">
<ul>
<li>
<p>The <code>hashAlgorithm</code> field shall be present.</p>
</li>
<li>
<p>The <code>algorithm</code> field of the <code>hashAlgorithm</code> field shall be one of the following values: <a href="https://datatracker.ietf.org/doc/html/rfc8017#appendix-B.1">RFC 8017 appendix B.1</a></p>
<div class="ulist">
<ul>
<li>
<p><code>id-sha256</code></p>
</li>
<li>
<p><code>id-sha384</code></p>
</li>
<li>
<p><code>id-sha512</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>The <code>maskGenAlgorithm</code> field shall be present.</p>
</li>
<li>
<p>The <code>algorithm</code> field of the <code>parameters</code> field of the <code>maskGenAlgorithm</code> field shall be equal to the <code>algorithm</code> field of the <code>hashAlgorithm</code> field.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If the <code>algorithm</code> field of the <code>algorithm</code> field of the certificate&#8217;s <code>subjectPublicKeyInfo</code> is <code>id-ecPublicKey</code>, the <code>parameters</code> field shall be one of the following named curves: <a href="https://datatracker.ietf.org/doc/html/rfc5480#section-2.1.1.1">RFC 5480 section 2.1.1.1</a></p>
<div class="ulist">
<ul>
<li>
<p><code>prime256v1</code></p>
</li>
<li>
<p><code>secp384r1</code></p>
</li>
<li>
<p><code>secp521r1</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>If the <code>algorithm</code> field of the <code>algorithm</code> field of the certificate&#8217;s <code>subjectPublicKeyInfo</code> is <code>rsaEncryption</code> or <code>rsaPSS</code>, the <code>modulus</code> field of the <code>parameters</code> field shall have a length of at least 2048 bits.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All certificates except those in the private credential store for X.509 certificates must fulfill the following additional requirements to be acceptable.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Version must be <code>v3</code>. <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.1.2.1">RFC 5280 section 4.1.2.1</a></p>
</li>
<li>
<p>The <code>issuerUniqueID</code> and <code>subjectUniqueID</code> optional fields of the <code>TBSCertificate</code> sequence must not be present. <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.1.2.8">RFC 5280 section 4.1.2.8</a></p>
</li>
<li>
<p>The Basic Constraints extension must follow <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.9">RFC 5280 section 4.2.1.9</a>. In particular, it must be present with the <code>cA</code> boolean asserted if the certificate issues certificates, and not asserted if it does not.</p>
</li>
<li>
<p>The Authority Key Identifier extension must be present in any certificate that is not self-signed. <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.1">RFC 5280 section 4.2.1.1</a></p>
</li>
<li>
<p>The Subject Key Identifier extension must be present in any certificate that acts as a CA. It should be present in end entity certificates. <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.2">RFC 5280 section 4.2.1.2</a></p>
</li>
<li>
<p>The Key Usage extension must be present and should be marked as critical. Certificates used to sign C2PA manifests must assert the <code>digitalSignature</code> bit. The <code>keyCertSign</code> bit must only be asserted if the <code>cA</code> boolean is asserted in the Basic Constraints extension. <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.3">RFC 5280 section 4.2.1.3</a></p>
</li>
<li>
<p>The Extended Key Usage (EKU) extension must be present and non-empty in any certificate where the Basic Constraints extension is absent or the <code>cA</code> boolean is not asserted. These are commonly called "end entity" or "leaf" certificates. <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.12">RFC 5280 section 4.2.1.12</a></p>
<div class="ulist">
<ul>
<li>
<p>The <code>anyExtendedKeyUsage</code> EKU (2.5.29.37.0) must not be present.</p>
</li>
<li>
<p>If the configuration store contains a list of EKUs, a certificate that signs C2PA manifests must be valid for at least one of the listed purposes.</p>
</li>
<li>
<p>If the configuration store does not contain a list of EKUs, a certificate that signs C2PA manifests must be valid for the <code>id-kp-emailProtection</code> (1.3.6.1.5.5.7.3.4) purpose and/or the <code>id-kp-documentSigning</code> (1.3.6.1.5.5.7.3.36) purpose.</p>
<div class="ulist">
<ul>
<li>
<p>The <code>id-kp-emailProtection</code> and <code>id-kp-documentSigning</code> purposes are not implicitly included by default if a list of EKUs has been configured. This only applies when no list has been configured.</p>
</li>
</ul>
</div>
</li>
<li>
<p>A certificate that signs time-stamping countersignatures must be valid for the <code>id-kp-timeStamping</code> (1.3.6.1.5.5.7.3.8) purpose.</p>
</li>
<li>
<p>A certificate that signs OCSP responses for certificates must be valid for the <code>id-kp-OCSPSigning</code> (1.3.6.1.5.5.7.3.9) purpose.</p>
</li>
<li>
<p>If a certificate is valid for either <code>id-kp-timeStamping</code> or <code>id-kp-OCSPSigning</code>, it must be valid for exactly one of those two purposes, and not valid for any other purpose.</p>
</li>
<li>
<p>A certificate should not be valid for any other purposes outside of the purposes listed above, but the presence of any EKUs not mentioned in this profile and not in the list of EKUs in the configuration store shall not cause the certificate to be rejected.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_certificate_trust_chain"><a class="anchor" href="#_certificate_trust_chain"></a>14.6.1.1. Certificate Trust Chain</h5>
<div class="paragraph">
<p>When validating a certificate as the signing credential, if the certificate is present in the private credential store for X.509 certificates, the certificate is accepted. The private credential store is not consulted when validating time-stamps.</p>
</div>
<div class="paragraph">
<p>If the certificate is not present in the private credential store, or the validator does not implement one, the trust chain shall be built and validated according to the procedure in <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-6">RFC 5280 section 6</a> for the particular purpose required (signing, time-stamping, or OCSP signing) and for the appropriate trust anchor store for that purpose. Any failure of that validation algorithm shall mean the chain must be rejected. The private credential store is never included when building certificate chains; certificates in the private credential store cannot act as CAs.</p>
</div>
<div class="paragraph">
<p>Only end entity certificates shall be used to sign C2PA Manifests or time-stamps. A CA certificate must not be used for these purposes. Any CA certificate (where the <code>cA</code> boolean in the Basic Constraints extension is asserted) being used to validate a signature on a C2PA Manifest, time-stamp, or OCSP response must be rejected.</p>
</div>
<div class="paragraph">
<p>A validator must ensure a signing certificate is authorized for the purpose for which it is being used, and reject certificates used for an unauthorized purpose. A certificate is authorized for a particular purpose if the purpose&#8217;s EKU Object Identifier (OID) is present in the Extended Key Usage extension of the certificate (<a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.12">RFC 5280 section 4.2.1.12</a>). When validating a certificate chain used to sign a C2PA manifest, the signing certificate must have at least one of the accepted EKUs for C2PA signers if configured, or at least one of <code>id-kp-emailProtection</code> (1.3.6.1.5.5.7.3.4) and <code>id-kp-documentSigning</code> (1.3.6.1.5.5.7.3.36) EKUs if such a list is not configured. When validating a certificate chain used to sign a time-stamp, the signing certificate must have the <code>id-kp-timeStamping</code> (1.3.6.1.5.5.7.3.8) EKU. When validating a certificate chain used to sign an OCSP response, the signing certificate must have the <code>id-kp-OCSPSigning</code> (1.3.6.1.5.5.7.3.9) EKU.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is recommended that applications always configure a list of acceptable EKUs for C2PA signers, even when using the defaults.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Except for certificates accepted through the private credential store for X.509 certificates, a validator must verify a certificate&#8217;s compliance with the Certificate Profile, and reject certificates that do not comply. This includes requiring the presence of the Extended Key Usage extension, as well as a certificate being authorized for no more than one of the three purposes listed in this section: C2PA signing, time-stamp signing, or OCSP response signing.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As described in the Certificate Profile, Certification Authority (CA) certificates which issue certificates are not required to have an EKU extension, and usually will not. If one is present, it is ignored. This requirement only applies to end entity certificates signing C2PA manifests, time-stamps, or OCSP responses. CA certificates cannot be used for signing C2PA manifests, time-stamps, or OCSP responses.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_certificate_revocation"><a class="anchor" href="#_certificate_revocation"></a>14.6.2. Certificate Revocation</h4>
<div class="paragraph">
<p>X.509 certificates support revocation status queries. C2PA uses the Online Certificate Status Protocol (OCSP) and OCSP stapling to implement revocation. C2PA does not use Certificate Revocation Lists (CRLs).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Using CRLs requires downloading the entire list of revoked certificates for each Certificate Authority encountered, which can be time-consuming. Although a CRL could be included in the same way an OCSP response is stapled, the potential size of a CRL relative to an OCSP response also makes this undesirable.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A conforming CA should include an AuthorityInfoAccess (AIA) extension (<a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.2.1">RFC 5280 section 4.2.2.1</a>) to provide access information for an Online Certificate Status Protocol (OCSP) service operated by the CA.</p>
</div>
<div class="paragraph">
<p>If the certificate has an AIA extension, revocation information shall be stored in an unprotected header of the <code>COSE_Sign1</code> structure with the string label <code>rVals</code> and the value&#8217;s schema shall follow the <code>rVals</code> rule in the following CDDL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; CBOR version of rVals and related structures based on JSON schema in https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf section 5.3.5.2
rVals = {
  "ocspVals": [1* bstr] 
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The above definition is a CBOR adaptation of a subset of the schema from <a href="https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf">JAdES section 5.3.5.2</a>, which only stores OCSP responses, and stores them as binary strings.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Before signing a claim, if a signer&#8217;s certificate has the AIA extension, a signer should query the OCSP service indicated therein, capture the response, and store it in an element of the <code>ocspVals</code> array of the <code>rVals</code> header.</p>
</div>
<h6 id="_validating_the_certificate_revocation_information" class="discrete">Validating the Certificate Revocation Information</h6>
<div class="paragraph">
<p>A validator must follow the requirements of <a href="https://datatracker.ietf.org/doc/html/rfc6960">RFC 6960</a>, in particular <a href="https://datatracker.ietf.org/doc/html/rfc6960#section-3">section 3</a>, when constructing an OCSP query and accepting an OCSP response. Validators shall ignore elements of the <code>ocspVals</code> field of the <code>rVals</code> header that are not accepted (as defined by RFC 6960) or contain a <code>certStatus</code> of <code>unknown</code>, and proceed as if those elements were not present. If all elements of the <code>ocspVals</code> field are ignored for this reason, validators shall proceed as if the <code>rVals</code> header was absent.</p>
</div>
<div class="paragraph">
<p>If a validator chooses to make an OCSP query at validation time, and the response is not accepted or contains a <code>certStatus</code> of <code>unknown</code>, the validator shall proceed as if it chose not to make the query.</p>
</div>
<div class="paragraph">
<p>An accepted OCSP response in the <code>rVals</code> header establishes that the signer&#8217;s certificate was not revoked at the time of signing if all of the following requirements are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The manifest has an attested time provided by a valid time-stamp,</p>
</li>
<li>
<p>There exists a <code>SingleResponse</code> in the <code>responses</code> array of the <code>tbsResponseData</code> field of the OCSP response such that:</p>
<div class="ulist">
<ul>
<li>
<p>The attested time from the time-stamp:</p>
<div class="ulist">
<ul>
<li>
<p>is earlier than <code>thisUpdate</code>, or</p>
</li>
<li>
<p>falls within the <code>(thisUpdate,nextUpdate)</code> interval, if <code>nextUpdate</code> is present, or</p>
</li>
<li>
<p>falls within the <code>(thisUpdate,producedAt)</code> interval where <code>producedAt</code> is the field in the containing <code>ResponseData</code>, if <code>nextUpdate</code> is not present,</p>
</li>
</ul>
</div>
</li>
<li>
<p>The <code>certStatus</code> field of the <code>SingleResponse</code> is <code>good</code>, or <code>revoked</code> but with a <code>revocationReason</code> of <code>removeFromCRL</code>,</p>
</li>
</ul>
</div>
</li>
<li>
<p>The signer of the response is an "authorized responder" as defined by <a href="https://datatracker.ietf.org/doc/html/rfc6960#section-4.2.2.2">RFC 6960 section 4.2.2.2</a>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>removeFromCRL</code> is unique amongst the values of <code>revocationReason</code> because it is equivalent to a <code>good</code> response. Despite being a type of <code>revoked</code> response, this response indicates the certificate had temporarily been put "on hold" (the <code>certificateHold</code> reason) previously due to some concern about its integrity, but that the concern has been resolved and the issuer is stating the certificate remains trustworthy.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Validators must check the <code>revocationReason</code> of any <code>revoked</code> response to disambiguate the <code>removedFromCRL</code> case from an actual revocation.</p>
</div>
<div class="paragraph">
<p>If the <code>rVals</code> header is not present or does not contain an accepted OCSP response, or if the manifest does not have a time-stamp, but the certificate has an AIA extension, the validator may choose to query the OCSP responder, as described in <a href="#_validate_the_credential_revocation_information">Section 15.6, &#8220;Validate the Credential Revocation Information&#8221;</a>. If it does, and the response is accepted per the requirements of RFC 6960, it shall establish the signer&#8217;s certificate was not revoked at the time of signing if either of the following requirements is fulfilled:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The manifest has a valid time-stamp, and the attested time falls within the <code>(thisUpdate,nextUpdate)</code> interval of the response, or</p>
</li>
<li>
<p>The manifest does not have a valid time-stamp but the current time falls within the <code>(thisUpdate,nextUpdate)</code> interval of the response,</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And both of the following requirements are fulfilled:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>certStatus</code> field of the response is <code>good</code>, or <code>revoked</code> but with a <code>revocationReason</code> of <code>removeFromCRL</code>, and</p>
</li>
<li>
<p>The signer of the response is an "authorized responder" as defined by <a href="https://datatracker.ietf.org/doc/html/rfc6960#section-4.2.2.2">RFC 6960 section 4.2.2.2</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <code>certStatus</code> field of the response is <code>revoked</code> but with a <code>revocationReason</code> that is not <code>removeFromCRL</code>, it shall establish the signer&#8217;s certificate was not revoked at the time of signing if both of the following requirements are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The manifest has a valid time-stamp, and the attested time falls within the <code>(thisUpdate,nextUpdate)</code> interval of the response, and</p>
</li>
<li>
<p>The <code>revocationTime</code> in the response is after the attested time-stamp.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Otherwise, the certificate shall be considered revoked at the time of signing and the claim shall be rejected.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_validation"><a class="anchor" href="#_validation"></a>15. Validation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The active manifest of an asset is valid only if all the steps in this section are successful. This validation must be completed before a validator presents a successful result to a human user or begins to render any content. Validating content as it is rendered to the user is described in <a href="#_validate_the_assets_content">Section 15.10, &#8220;Validate the Asset&#8217;s Content&#8221;</a>.</p>
</div>
<div class="sect2">
<h3 id="_status_codes"><a class="anchor" href="#_status_codes"></a>15.1. Status Codes</h3>
<div class="paragraph">
<p>The validation algorithm outputs status codes to indicate successful or failed portions of the validation process. They are also used by <a href="#_ingredient">ingredient assertions</a> to document the validation done on ingredients during the claim generation process.</p>
</div>
<div class="paragraph">
<p>The set of standard success and failure codes are defined below. Custom status codes are also permitted, when a claim generator has a need to record some process-specific status information.  The code shall conform to the same syntax as <a href="#_labels">custom labels</a>, e.g. <code>com.litware</code>. When using custom labels, because they are not inherently success or failure codes, a boolean success or failure result must be returned as well. This is either part of the output of the validation algorithm when performing validation, or the value of the <code>success</code> boolean in the <code>validationStatus</code> object inside an ingredient assertion.</p>
</div>
<div class="paragraph">
<p>The <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a> for status codes is included in the schema for the ingredient assertion at <a href="#ingredient_schema">Section 18.13.5, &#8220;Schema and Example&#8221;</a>.</p>
</div>
<div class="sect3">
<h4 id="_success_codes"><a class="anchor" href="#_success_codes"></a>15.1.1. Success codes</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 21.0526%;">
<col style="width: 52.6315%;">
<col style="width: 26.3159%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top"><code>url</code> Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claimSignature.validated</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The claim signature referenced in the ingredient&#8217;s claim validated.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>signingCredential.trusted</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The signing credential is trusted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>signingCredential.notRevoked</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The signing credential was not revoked at the time of signing.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>timeStamp.trusted</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time-stamp credential is listed on the validator&#8217;s <a href="#_time_stamp_authorities">list of trust anchors for time stamp authorities</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.hashedURI.match</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hash of the the referenced assertion in the ingredient&#8217;s manifest matches the corresponding hash in the assertion&#8217;s hashed URI in the claim.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.dataHash.match</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hash of a byte range of the asset matches the hash declared in the data hash assertion.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.bmffHash.match</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hash of a box-based asset matches the hash declared in the BMFF hash assertion.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.boxesHash.match</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hash of a box-based asset matches the hash declared in the general boxes hash assertion.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.accessible</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A non-embedded (remote) assertion was accessible at the time of validation.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_failure_codes"><a class="anchor" href="#_failure_codes"></a>15.1.2. Failure codes</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 21.0526%;">
<col style="width: 52.6315%;">
<col style="width: 26.3159%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top"><code>url</code> Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claim.missing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The referenced claim in the ingredient&#8217;s manifest cannot be found.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claim.multiple</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">More than one claim box is present in the manifest.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claim.hardBindings.missing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No hard bindings are present in the claim.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claim.required.missing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A required field is not present in the claim.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claim.cbor.invalid</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The cbor of the claim is not valid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ingredient.hashedURI.mismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hash of the the referenced ingredient claim in the manifest does not match the corresponding hash in the ingredient&#8217;s hashed URI in the claim.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claimSignature.missing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The claim signature referenced in the ingredient&#8217;s claim cannot be found in its manifest.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claimSignature.mismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The claim signature referenced in the ingredient&#8217;s claim failed to validate.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>manifest.multipleParents</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The manifest has more than one ingredient whose <code>relationship</code> is <code>parentOf</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>manifest.update.invalid</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The manifest is an update manifest, but it contains a disallowed assertion, such as a hard binding or actions assertions.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>manifest.update.wrongParents</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The manifest is an update manifest, but it contains either zero or multiple <code>parentOf</code> ingredients.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>manifest.inaccessible</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A non-embedded (remote) manifest was inaccessible at the time of validation.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>manifest.compressed.invalid</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The compressed manifest was not valid.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>signingCredential.untrusted</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The signing credential is not listed on any of the validator&#8217;s <a href="#_c2pa_signers">trust lists</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>signingCredential.invalid</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The signing credential is not valid for signing.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>signingCredential.revoked</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The signing credential has been revoked by the issuer.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>signingCredential.expired</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The signing credential has expired.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>timeStamp.mismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time-stamp does not correspond to the contents of the claim.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>timeStamp.untrusted</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time-stamp credential is not listed on the validator&#8217;s <a href="#_time_stamp_authorities">trust lists</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>timeStamp.outsideValidity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The signed time-stamp attribute in the signature falls outside the validity window of the signing certificate or the TSA&#8217;s certificate.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Signature Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.hashedURI.mismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hash of the the referenced assertion in the manifest does not match the corresponding hash in the assertion&#8217;s hashed URI in the claim.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.missing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An assertion listed in the ingredient&#8217;s claim is missing from the ingredient&#8217;s manifest.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.multipleHardBindings</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The manifest has more than one hard binding assertion.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion Store Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.undeclared</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An assertion was found in the ingredient&#8217;s manifest that was not explicitly declared in the ingredient&#8217;s claim.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box or C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.inaccessible</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A non-embedded (remote) assertion was inaccessible at the time of validation.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.notRedacted</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An assertion was declared as redacted in the ingredient&#8217;s claim but is still present in the ingredient&#8217;s manifest.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.selfRedacted</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An assertion was declared as redacted by its own claim.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.required.missing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A required field is not present in an assertion.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.json.invalid</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The JSON(-LD) of an assertion is not valid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.cbor.invalid</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The cbor of an assertion is not valid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.action.ingredientMismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An action that requires an associated ingredient either does not have one or the one specified cannot be located</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.action.redacted</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An actions assertion was redacted when the ingredient&#8217;s claim was created.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.action.redactionMismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An action that requires an associated redaction either does not have one or the one specified cannot be located</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.dataHash.mismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hash of a byte range of the asset does not match the hash declared in the data hash assertion.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.bmffHash.mismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hash of a box-based asset does not match the hash declared in a BMFF hash assertion.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.boxesHash.mismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hash of a general box-like asset format does not match the hash declared in a general boxes hash assertion.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.cloud-data.hardBinding</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A hard binding assertion is in a cloud data assertion.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.cloud-data.actions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An update manifest contains a cloud data assertion referencing an actions assertion.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assertion.boxesHash.unknownBox</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A box other than those expected was found</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>algorithm.unsupported</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value of an <code>alg</code> header, or other header that specifies an algorithm used to compute the value of another field, is unknown or unsupported.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box or C2PA Assertion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>general.error</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A value to be used when there was an error not specifically listed here.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA Claim Box or C2PA Assertion</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_locating_the_active_manifest"><a class="anchor" href="#_locating_the_active_manifest"></a>15.2. Locating the Active Manifest</h3>
<div class="paragraph">
<p>The last C2PA Manifest superbox in the C2PA Manifest Store superbox is the active manifest, but locating the C2PA Manifest Store may involve looking in a number of possible locations.</p>
</div>
<div class="sect3">
<h4 id="_embedded_2"><a class="anchor" href="#_embedded_2"></a>15.2.1. Embedded</h4>
<div class="paragraph">
<p>The C2PA Manifest Store shall be located by the Manifest Consumer embedded inside the asset at the <a href="#_embedding_manifests_into_various_file_formats">standard locations for embedding manifests</a>.  However, if an asset was retrieved via an HTTP connection, a Manifest Consumer may look for a <code>Link</code> header, as described in the <a href="#_by_link_header">Link Header</a> clause below, to determine if a C2PA Manifest Store is present.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Checking the <code>Link</code> header, if present, allows a Manifest Consumer to determine if a C2PA Manifest Store is present without having to download the entire asset.  This is useful for assets that are large or that are streamed.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If there are multiple C2PA Manifest Stores present in an asset, they shall all be considered as invalid and the validation should treat this as if no manifests were located. In the case where this asset is being added as an ingredient, none of these embedded C2PA manifests shall be included in the ingredient assertion.</p>
</div>
<div class="sect4">
<h5 id="_special_considerations_for_pdf"><a class="anchor" href="#_special_considerations_for_pdf"></a>15.2.1.1. Special Considerations for PDF</h5>
<div class="paragraph">
<p>PDF files support a technology called "incremental update", where information is appended to the end of the document instead of modifying the original. This requires that PDF files support multiple C2PA Manifest Stores - though there shall only be one per update section.</p>
</div>
<div class="paragraph">
<p>If there are multiple C2PA Manifest Stores present in a single update section, they shall all be considered as invalid and the validation should treat this as if no manifests were located. However, any C2PA Manifest Stores present in early updates of the PDF or of the original PDF, shall still be considered valid and processed accordingly.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_by_reference_or_uri"><a class="anchor" href="#_by_reference_or_uri"></a>15.2.2. By Reference or URI</h4>
<div class="paragraph">
<p>If there is no embedded C2PA Manifest Store, the following attempts should be made to locate one at a remote location.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the asset was retrieved via an HTTP connection, the <a href="#_by_link_header">Link Header</a> clause below describes how to find a manifest via the <code>Link</code> header.</p>
</li>
<li>
<p>If the asset has any XMP in the standard asset locations (i.e., outside the C2PA Manifest) and that XMP contains a <code>dcterms:provenance</code> key, the provided URI should be used to locate the active manifest.</p>
</li>
<li>
<p>If the asset is a font with a <code>C2PA</code> table and its <code>activeManifestUriLength</code> is non-zero, then the indicated URI should be used to locate the active manifest.</p>
</li>
<li>
<p>If no C2PA Manifest Store has been located, the Manifest Consumer should look for files at the same path or URI, but with a filename extension of <code>.c2pa</code>. If the C2PA Manifest Store is not found, a Manifest Consumer may look in whatever additional places it deems most appropriate to locate it.  For example, a child folder of a file system.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A Manifest Consumer is not restricted to only the above locations, it can choose to look in additional locations as well.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If a manifest was documented to exist in a remote location, but is not present there, or the location is not currently available (such as in an offline scenario), the <code>manifest.inaccessible</code> error code shall be used to report the situation.</p>
</div>
<div class="paragraph">
<p>Information about the IANA media type for a C2PA Manifest Store can be found in the <a href="#_external_manifests">external manifests section</a>.</p>
</div>
<div class="sect4">
<h5 id="_by_link_header"><a class="anchor" href="#_by_link_header"></a>15.2.2.1. By <code>Link</code> header</h5>
<div class="paragraph">
<p>If the asset was retrieved via an HTTP connection, the Manifest Consumer should look in the header of the HTTP response for a <code>Link</code> header, as defined in <a href="https://datatracker.ietf.org/doc/html/rfc8288">RFC 8288</a>, containing a parameter of <code>rel=c2pa-manifest</code>. If present, a C2PA Manifest Store can be retrieved from that URI reference. The URI will be a standard <code>http</code> or <code>https</code> URI, but may include the <a href="#_uri_references">JUMBF URI</a> fragment.  If the URI includes the <a href="#_uri_references">JUMBF URI</a> fragment, such as https://c2pa.org/image.jpg#jumbf=c2pa/urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4 it shall be to the active manifest within the C2PA Manifest Store that is embedded in that asset.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>HTTP refers to the <em>Hypertext Transfer Protocol</em> defined in <a href="https://tools.ietf.org/html/rfc7230">RFC 7230</a>, not the specific URL scheme <code>http://</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_decompression"><a class="anchor" href="#_decompression"></a>15.2.3. Decompression</h4>
<div class="paragraph">
<p>As described <a href="#_compressed_manifests">previously</a>, both standard and update manifests can be compressed. When a compressed manifest is encountered, a Manifest Consumer shall decompress it before proceeding with the standard validation process. If the data contained in the <code>brob</code> box of a compressed manifest is not either a standard or update manifest or if the decompression fails, the Manifest Consumer shall reject the manifest with a failure code of <code>manifest.compressed.invalid</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_validating_a_match"><a class="anchor" href="#_validating_a_match"></a>15.2.4. Validating a Match</h4>
<div class="paragraph">
<p>A Manifest Consumer may wish to validate that the located C2PA Manifest Store is indeed the one associated with asset.</p>
</div>
<div class="paragraph">
<p>If the C2PA Manifest Store was located then the hard binding assertion present in its active manifest shall be used to validate that it is the matching manifest and whether the asset has been modified without manifest updates. If the hard binding does not match, it is unknown if that is because of (a) modification of the asset or (b) the wrong C2PA Manifest Store was located. Accordingly, the Manifest Consumer shall treat this as a non-matching hard binding and reject the manifest with a failure code of <code>assertion.dataHash.mismatch</code> if a data hash assertion is used, <code>assertion.boxesHash.mismatch</code> if a general boxes hash assertion is used, or <code>assertion.bmffHash.mismatch</code> if a BMFF hash assertion is used.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_locating_the_claim"><a class="anchor" href="#_locating_the_claim"></a>15.3. Locating the Claim</h3>
<div class="paragraph">
<p>Once the active manifest has been located, the claim is found by locating, within the active manifest, the JUMBF Superbox with a label of <code>c2pa.claim.v2</code> and a UUID of <code>0x6332636C-0011-0010-8000-00AA00389B71</code> (<code>c2cl</code>).  There shall only be one such box in the active manifest, if more than one is located, the manifest shall be rejected with a failure code of <code>claim.multiple</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_validate_the_signature"><a class="anchor" href="#_validate_the_signature"></a>15.4. Validate the Signature</h3>
<div class="paragraph">
<p>Retrieve the URI reference for the signature from the value of the claim&#8217;s <code>signature</code> field and resolve the URI reference to obtain the COSE signature. The signature must be embedded in the same manifest as described in <a href="#_c2pa_box_details">Section 11.1.4, &#8220;C2PA Box details&#8221;</a>. If the signature URI does not refer to a location within the same C2PA Manifest box (a <code>self#jumbf</code> location), the claim must be rejected. If no such field is present or the URI cannot be resolved, then the claim must be rejected with a failure code of <code>claimSignature.missing</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The signature and the claim need to be in the same manifest to be valid.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Validate that the credential used in the signature is acceptable according to <a href="#_trust_model">Chapter 14, <em>Trust Model</em></a>. If a chain of trust cannot be built from the credential to an entry in one of the trust anchor lists, the claim must be rejected with a failure code of <code>signingCredential.untrusted</code>. If the credential is not acceptable per <a href="#x509_certificates">the requirements of the credential&#8217;s type</a>, then the claim must be rejected with a failure code of <code>signingCredential.invalid</code>. If the signature algorithm is not on the allowed or deprecated list in <a href="#_digital_signatures">Section 13.2, &#8220;Digital Signatures&#8221;</a>, then the claim must be rejected with a failure code of <code>algorithm.unsupported</code>. After confirming the credential is an <a href="#x509_certificates">X.509 certificate</a> and its signing algorithm is acceptable, validation should proceed according to the specified procedure in <a href="#_digital_signatures">Section 13.2, &#8220;Digital Signatures&#8221;</a>. If validation of the signature fails, then the claim must be rejected with a failure code of <code>claimSignature.mismatch</code>.</p>
</div>
<div class="paragraph">
<p>If the claim has not been rejected for any reason, then the claim signature shall be considered trusted and assigned a success code of <code>signingCredential.trusted</code>.</p>
</div>
<div class="paragraph">
<p>For the remainder of this chapter, headers refer to the union of the set of protected and unprotected header parameters in the COSE signature. Unless otherwise specified in <a href="#_digital_signatures">Section 13.2, &#8220;Digital Signatures&#8221;</a> or <a href="#x509_certificates">Section 14.6, &#8220;X.509 Certificates&#8221;</a>, a header may appear in either bucket. <a href="https://datatracker.ietf.org/doc/html/rfc8152#section-3">RFC8152 section 3</a> describes COSE headers.</p>
</div>
</div>
<div class="sect2">
<h3 id="_validate_the_time_stamp"><a class="anchor" href="#_validate_the_time_stamp"></a>15.5. Validate the Time-Stamp</h3>
<div class="paragraph">
<p>If the <code>sigTst</code> header is present, the claim is valid if the <code>tstTokens</code> array contains at least one <code>tstToken</code> whose <code>val</code> property is an RFC3161-compliant <code>TimeStampResp</code> which satisfies the following requirements. To aid in diagnosing time-stamp problems, a validator should maintain a list called <code>timeStampStatusCodes</code> which is also described in the following requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The value of the <code>status</code> field <code>PKIStatusInfo</code>, which is the value of the <code>status</code> field of the <code>TimeStampResp</code> must be either <code>granted</code> (0) or <code>grantedWithMods</code> (1). If it contains any other value, the time-stamp must be ignored, and the failure code <code>timeStamp.mismatch</code> should be added to <code>timeStampStatusCodes</code>.</p>
</li>
<li>
<p>The time-stamp contains a message imprint as described in <a href="#_time_stamps">Section 10.3.2.5, &#8220;Time-stamps&#8221;</a> that matches the claim being validated. If it does not, the time-stamp must be ignored, and the failure code <code>timeStamp.mismatch</code> should be added to <code>timeStampStatusCodes</code>.</p>
</li>
<li>
<p>The time attested by the Time Stamp Authority (TSA) falls within the validity period of the signing credential. If it does not, the time-stamp must be ignored.</p>
</li>
<li>
<p>The attested time falls within the validity period of the TSA&#8217;s signing certificate. If it does not, the time-stamp must be ignored, and the failure code <code>timeStamp.outsideValidity</code> should be added to <code>timeStampStatusCodes</code>.</p>
</li>
<li>
<p>A trust chain can be built to an entry in the TSA trust store. If the TSA&#8217;s certificate cannot be located (as described in <a href="https://datatracker.ietf.org/doc/html/rfc3161#section-2.4.1">RFC 3161 section 2.4.1</a>), the time-stamp must be ignored, the failure code <code>timeStamp.untrusted</code> should be added to <code>timeStampStatusCodes</code>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Time-stamps remain valid even after the signing credential of the time-stamp authority expires, so long as the attested time falls within the time-stamp authority&#8217;s certificate&#8217;s validity period. This is a special type of trust extended only to time-stamp authorities. At time of validation, when a time-stamp is present, validators must use the attested time, and not the current time, when determining the time validity of the signing certificate and the time-stamp authority&#8217;s certificate.</p>
</div>
<div class="paragraph">
<p>At this time, the revocation status of a Time Stamp Authority&#8217;s certificate is neither captured at signing time nor validated at validation time.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the <code>sigTst</code> header is not present, or if it is present but no time-stamp tokens satisfy the above requirements, then the claim is valid if the current time at validation is within the validity period of the signer&#8217;s credential. If it is not, the claim must be rejected with a failure code of <code>signingCredential.expired</code>.</p>
</div>
<div class="paragraph">
<p>If the claim is rejected with a failure code of <code>signingCredential.expired</code>, and the <code>sigTst</code> header is present, and no time-stamp tokens satisfy the above requirements, and <code>timeStampStatusCodes</code> is non-empty, then the validator should also return <code>timeStampStatusCodes</code>.</p>
</div>
<div class="paragraph">
<p>A validator may stop processing further time-stamp tokens in the <code>tstTokens</code> array after validating that there exists one token that satisfies the above requirements. This is because there is no difference between one or multiple valid time-stamps being present.</p>
</div>
</div>
<div class="sect2">
<h3 id="_validate_the_credential_revocation_information"><a class="anchor" href="#_validate_the_credential_revocation_information"></a>15.6. Validate the Credential Revocation Information</h3>
<div class="paragraph">
<p>If the signer&#8217;s credential does not support revocation status, or the credential&#8217;s issuer did not provide a method to query its revocation status, the validator presumes the credential is not revoked.</p>
</div>
<div class="paragraph">
<p>If the signer&#8217;s credential supports revocation, and the credential&#8217;s issuer provided a method to query its revocation status:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the <code>rVals</code> header is present, its contents shall be validated as described in <a href="#x509_certificates">Section 14.6, &#8220;X.509 Certificates&#8221;</a>.</p>
</li>
<li>
<p>If the <code>rVals</code> header is not present, and the signer&#8217;s credential is considered valid by the requirements of <a href="#_validate_the_signature">Section 15.4, &#8220;Validate the Signature&#8221;</a> and <a href="#_trust_model">Chapter 14, <em>Trust Model</em></a>, a validator may choose to query the credential status method to determine if the credential is currently revoked.</p>
<div class="ulist">
<ul>
<li>
<p>If the validator does not query the credential status, the validator shall presume the credential is not revoked.</p>
</li>
<li>
<p>If the validator does query the credential status, it shall determine the status from the response as described in <a href="#x509_certificates">Section 14.6, &#8220;X.509 Certificates&#8221;</a>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Querying the credential status method can reveal to an observer the identity of the asset being validated, and so this query is optional.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When a signer&#8217;s credential is revoked, this does not invalidate manifests that were signed before the time of revocation. The inclusion of the <code>rVals</code> header combined with a time-stamp provides proof that the signer&#8217;s credential was valid at the time of signing. Signers are encouraged to include revocation information and time-stamps to avoid the necessity of a query at validation time.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In all cases, if the credential is deemed revoked at the time of signing, the claim shall be rejected with a failure code of <code>signingCredential.revoked</code>. If the validator is able to determine the credential was not revoked at the time of signing, it shall include the success code <code>signingCredential.notRevoked</code> when returning. The absence of either code indicates the validator could not determine the status either way, and is presuming the credential is not revoked.</p>
</div>
</div>
<div class="sect2">
<h3 id="_validate_the_assertions"><a class="anchor" href="#_validate_the_assertions"></a>15.7. Validate the Assertions</h3>
<div class="sect3">
<h4 id="_validate_the_correct_assertions_for_the_type_of_manifest"><a class="anchor" href="#_validate_the_correct_assertions_for_the_type_of_manifest"></a>15.7.1. Validate the correct assertions for the type of manifest</h4>
<div class="paragraph">
<p>Depending on the <a href="#_types_of_manifests">type of manifest</a>, there are assertions that are either required or forbidden. A validator shall check for required and not-permitted assertions.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If it is a <a href="#_standard_manifests">standard manifest</a></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Validate that there is exactly one <a href="#_binding_to_content">hard binding to content</a> assertion - either a <code>c2pa.hash.data</code>, a <code>c2pa.hash.boxes</code>, a <code>c2pa.hash.collection.data</code>, or a <code>c2pa.hash.bmff.v2</code> based on the type of asset for which the manifest is destined.  If no such assertion is present, the manifest must be rejected with a failure code of <code>claim.hardBindings.missing</code>.  If there is more than one such assertion, the manifest must be rejected with a failure code of <code>assertion.multipleHardBindings</code>.</p>
</li>
<li>
<p>Validate that there are zero or one <code>c2pa.ingredient</code> assertions whose <code>relationship</code> is <code>parentOf</code>.  If there is more than one, the manifest must be rejected with a failure code of <code>manifest.multipleParents</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>If it is an <a href="#_update_manifests">update manifest</a></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Validate that there are not any <code>c2pa.hash.data</code>, <code>c2pa.hash.boxes</code>, <code>c2pa.hash.collection.data</code>, <code>c2pa.hash.bmff.v2</code>, <code>c2pa.actions</code>, <code>c2pa.actions.v2</code> or <a href="#_thumbnails">thumbnail</a> assertions.  If there are, the manifest must be rejected with a failure code of <code>manifest.update.invalid</code>.</p>
</li>
<li>
<p>Validate that there is exactly one <code>c2pa.ingredient</code> assertion and whose <code>relationship</code> is <code>parentOf</code>.  If there is not (i.e., either it is missing, there are more than one, or the value of <code>relationship</code> is not <code>parentOf</code>), the manifest must be rejected with a failure code of <code>manifest.update.wrongParents</code>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_preparing_the_list_of_redacted_assertions"><a class="anchor" href="#_preparing_the_list_of_redacted_assertions"></a>15.7.2. Preparing the list of redacted assertions</h4>
<div class="paragraph">
<p>For each manifest, there may be a set of its assertions that were redacted from it. The list of those assertions is not found in the manifest itself but instead in a manifest that references it as an ingredient. Therefore a validator, when processing a claim, shall gather the set of redacted assertions for each ingredient manifest based on each JUMBF URI listed in the <code>redacted_assertions</code> field. A claim&#8217;s <code>redacted_assertions</code> field shall never include a JUMBF URI to any of its own assertions.</p>
</div>
</div>
<div class="sect3">
<h4 id="_assertion_validation"><a class="anchor" href="#_assertion_validation"></a>15.7.3. Assertion Validation</h4>
<div class="paragraph">
<p>Each assertion in the <code>created_assertions</code> and <code>gathered_assertions</code> fields of the claim is a <code>hashed_uri</code> structure. For each assertion, the validator must:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If the URI reference in the <code>url</code> field is in the <a href="#_preparing_the_list_of_redacted_assertions">list of redacted assertions</a>:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If the assertion&#8217;s label is <code>c2pa.actions</code> or <code>c2pa.actions.v2</code>, the claim must be rejected with a failure code of <code>assertion.action.redacted</code> as <code>c2pa.actions</code> and <code>c2pa.actions.v2</code> assertions shall not be redacted.</p>
</li>
<li>
<p>Otherwise, the redacted assertion is considered valid, and validation continues to the next assertion.</p>
</li>
</ol>
</div>
</li>
<li>
<p>For all other assertions:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Resolve the URI reference in the <code>url</code> field to obtain its data. If the URI does not refer to a location within the same C2PA Manifest Store (a <code>self#jumbf</code> location), the claim must be rejected. If the URI cannot be resolved and the data retrieved, the claim must be rejected with a failure code of <code>assertion.missing</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A claim can refer to an assertion in a different C2PA Manifest box than the one it is in, provided that they are both in the same C2PA Manifest Store.
</td>
</tr>
</table>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>If the assertion&#8217;s label is <code>c2pa.cloud-data</code>:</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>If the <code>label</code> field of the external assertion is <code>c2pa.hash.data</code>, <code>c2pa.hash.boxes</code>, <code>c2pa.hash.collection.data</code>, <code>c2pa.hash.bmff.v2</code>, the claim must be rejected with a failure code of <code>assertion.cloud-data.hardBinding</code>.</p>
</li>
<li>
<p>If the manifest is an update manifest and the <code>label</code> field of the external assertion is <code>c2pa.actions</code> or <code>c2pa.actions.v2</code>, the claim must be rejected with a failure code of <code>assertion.cloud-data.actions</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Determine the hash algorithm identifier as determined by following the procedure described in <a href="#_hashing">Section 11.3.4.2, &#8220;Hashing&#8221;</a>:</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>If an <code>alg</code> field is present in the <code>hashed_uri</code> structure, that determines the hash algorithm.</p>
</li>
<li>
<p>If an <code>alg</code> field is not present in the <code>hashed_uri</code> structure, an <code>alg</code> field must be present in an enclosing structure, and the nearest instance present determines the hash algorithm.</p>
</li>
<li>
<p>If no <code>alg</code> field is found in any of these locations:</p>
<div class="olist upperroman">
<ol class="upperroman" type="I">
<li>
<p>If an <code>alg</code> field is present in the claim, that determines the hash algorithm.</p>
</li>
<li>
<p>If no <code>alg</code> field is present in the claim, the claim must be rejected with a failure code of <code>assertion.hashedURI.mismatch</code>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>If the assertion&#8217;s label is <code>c2pa.actions</code> or <code>c2pa.actions.v2</code>:</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>For each action in the <code>actions</code> list:</p>
<div class="olist upperroman">
<ol class="upperroman" type="I">
<li>
<p>If the <code>action</code> field is <code>c2pa.opened</code>, <code>c2pa.placed</code>, <code>c2pa.removed</code>, <code>c2pa.repackaged</code>, or <code>c2pa.transcoded</code>:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Check the <code>ingredient</code> field that is a member of the <code>parameters</code> object for the presence of a JUMBF URI. If the JUMBF URI is not present, or cannot be resolved to the related ingredient assertion, the claim must be rejected with a failure code of <code>assertion.action.ingredientMismatch</code>.</p>
</li>
<li>
<p>Follow the JUMBF URI link in the <code>ingredient</code> field to the ingredient assertion. Check that the URI link resolves to an assertion in the active manifest. If it does not, the claim must be rejected with a failure code of <code>assertion.action.ingredientMismatch</code>.</p>
</li>
<li>
<p>For <code>c2pa.opened</code>, <code>c2pa.repackaged</code>, or <code>c2pa.transcoded</code>: Check that the value of the <code>relationship</code> field is <code>parentOf</code>. If it is not, the claim must be rejected with a failure code of <code>assertion.action.ingredientMismatch</code>.</p>
</li>
<li>
<p>For <code>c2pa.placed</code> or <code>c2pa.removed</code>: Check that the value of the <code>relationship</code> field is <code>componentOf</code>. If it is not, the claim must be rejected with a failure code of <code>assertion.action.ingredientMismatch</code>.</p>
</li>
<li>
<p>Check the <code>c2pa_manifest</code> field in the ingredient assertion for the presence of a hashed URI. If the hashed URI is not present, or cannot be resolved to a manifest, the claim must be rejected with a failure code of <code>assertion.action.ingredientMismatch</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>If the <code>action</code> field is <code>c2pa.redacted</code>:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Check the <code>redacted</code> field that is a member of the <code>parameters</code> object for the presence of a JUMBF URI. If the JUMBF URI is not present, or cannot be resolved to an assertion, the claim must be rejected with a failure code of <code>assertion.action.redactionMismatch</code>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Locate the value of the <code>alg</code> field in the allowed list or the deprecated list in <a href="#_hashing">Section 11.3.4.2, &#8220;Hashing&#8221;</a> to determine the hash algorithm. If it is not present in either list, the claim must be rejected with a failure code of <code>algorithm.unsupported</code>.</p>
</li>
<li>
<p>Compute the hash of the assertion using that algorithm and the procedure described in <a href="#_hashing_jumbf_boxes">Section 8.3.1.3, &#8220;Hashing JUMBF Boxes&#8221;</a>.</p>
</li>
<li>
<p>Compare the computed hash value with the value in the <code>hash</code> field. If they do not match, the claim must be rejected with a failure code of <code>assertion.hashedURI.mismatch</code>.</p>
</li>
<li>
<p>Otherwise, the assertion is valid and validation continues to the next assertion.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Then, for each element of the claim&#8217;s own <code>redacted_assertions</code> array, if any element of the claim&#8217;s <code>created_assertions</code> array or <code>gathered_assertions</code> array has a <code>url</code> field equal to that value, the claim must be rejected with a failure code of <code>assertion.selfRedacted</code>. A claim cannot redact its own assertions, only those of its ingredients.</p>
</div>
<div class="sect4">
<h5 id="_validation_of_references"><a class="anchor" href="#_validation_of_references"></a>15.7.3.1. Validation of References</h5>
<div class="paragraph">
<p>Some assertions and other structures support referencing other boxes in the C2PA Manifest via the use of a <code>hashed_uri</code>. For example, there can be various references <a href="#_actions">actions</a>, <a href="#_ingredients">ingredient</a> and <a href="#_thumbnails">thumbnail</a> assertions, and <a href="#_data_storage">Data Boxes</a>. In those cases, when validation is taking place, and the destination of the <code>hashed_uri</code> cannot be located (i.e., that data isn&#8217;t present where it is supposed to be) then it shall be treated as a validation failure.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_external_data_validation"><a class="anchor" href="#_external_data_validation"></a>15.7.4. External Data Validation</h4>
<div class="paragraph">
<p>The contents of a <a href="#_cloud_data">cloud data assertion</a> contains the URI references to and hashes of external data, are validated like any other assertion, but those references are not retrieved and validated as part of standard validation. A validator must first successfully validate a claim before attempting to retrieve the external data referenced. A validator must not attempt to retrieve external data from a rejected claim. As the retrieval of external data is optional, the inability to retrieve or validate external data shall not cause a claim to become rejected.</p>
</div>
<div class="paragraph">
<p>If a validator chooses to retrieve any of the external data in a cloud data assertion, the validator must:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>First, determine the hash algorithm to be used.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If an <code>alg</code> field is present in the <code>hashed_ext_uri</code> structure, that determines the hash algorithm. If an <code>alg</code> field is not present, the validator must abort the attempt to retrieve the external data.</p>
</li>
<li>
<p>Locate the value of the <code>alg</code> field in the allowed list or the deprecated list in <a href="#_hashing">Section 11.3.4.2, &#8220;Hashing&#8221;</a> to determine the hash algorithm. If it is not present in either list, the validator must abort the attempt to retrieve the external data.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>alg</code> field is mandatory in <code>hashed_ext_uri</code>, so no recursive procedure to determine the hash algorithm is required.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Resolve the URI reference in the <code>url</code> field to obtain its data. If the URI cannot be resolved and the data retrieved, the validator must abort the attempt to retrieve the external data.</p>
</li>
<li>
<p>If the size of the retrieved data is not equal to the value of the <code>size</code> field, the validator must return a failure code of <code>assertion.hashedURI.mismatch</code> to the application and not provide the retrieved data.</p>
</li>
<li>
<p>Validate that the content type returned in the <code>Content-Type</code> header of the HTTP response is equal to the declared content type. If they do not match, the validator must return a failure code of <code>assertion.hashedURI.mismatch</code> to the application and not provide the retrieved data. The declared content type is determined by:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>For external data, the content type is determined by the <code>dc:format</code> field of the <code>hashed_ext_uri</code> structure. If the <code>dc:format</code> field is absent, content type validation is always successful.</p>
</li>
<li>
<p>For a cloud data assertion, if the <code>dc:format</code> field is present in its <code>location</code> field, that determines the content type and the value of the cloud data assertion&#8217;s <code>content_type</code> field is ignored. If <code>location</code> does not have a <code>dc:format</code> field, then the assertion&#8217;s <code>content_type</code> field determines the content type.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Compute the hash of the data. For a cloud data assertion, use the hash algorithm and the procedure described in <a href="#_hashing_jumbf_boxes">Section 8.3.1.3, &#8220;Hashing JUMBF Boxes&#8221;</a> on the retrieved content. For external data, use the hash algorithm and the exact retrieved content as input to the hash function.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Compare the computed hash value with the value in the <code>hash</code> field. If they do not match, the validator must return a failure code of <code>assertion.hashedURI.mismatch</code> to the application and not provide the retrieved data.</p>
</li>
<li>
<p>Otherwise, the retrieved data is successfully provided to the application.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_recursively_validating_integrity_of_ingredients"><a class="anchor" href="#_recursively_validating_integrity_of_ingredients"></a>15.8. Recursively Validating Integrity of Ingredients</h3>
<div class="paragraph">
<p>A validator must perform the above validation steps for the asset being presented and its manifest. If any of the above steps conclude the manifest is invalid, that manifest must be rejected with the indicated failure code.</p>
</div>
<div class="paragraph">
<p>An asset&#8217;s manifest may list one or more ingredients.</p>
</div>
<div class="paragraph">
<p>When processing a standard manifest, a validator may choose whether or not to recurse through any ingredient manifests found therein. Even if the validator chooses to recurse through the ingredients, it may not need to display or use any of the data from their manifests. In these cases, where the data is not used, then a validator may skip validation because it is not necessary. Only when there is a need to display or use the data from a manifest, shall the validator first validate the ingredient&#8217;s manifest.</p>
</div>
<div class="paragraph">
<p>For update manifests, the <code>parentOf</code> ingredient of an update manifest shall be validated by the procedure below.</p>
</div>
<div class="paragraph">
<p>There is no requirement that signers of ingredient manifests are trusted by the validator and building of trust chains of signers of ingredients shall not be attempted. Instead, as the ingredient is included by the signer of the active manifest, and if the signer of the active manifest is accepted per the rules above, ingredient manifests will inherit that trust for the purposes of this recursive validation. Applications should not display data from ingredient manifests with failed integrity checks. If the application chooses to display such data, it must flag the display with a warning about the failed integrity check, and that the data cannot be reliably attributed to the ingredient manifest&#8217;s signer nor to the asset&#8217;s manifest&#8217;s signer. Applications and data must not display data from ingredient manifests without first attempting validation.</p>
</div>
<div class="paragraph">
<p>When ingredients are being added to an asset as part of an authoring/editing workflow, the ingredient may undergo full validation.  The results of that validation should be expressed in the ingredient&#8217;s <a href="#_existing_manifests">validation status</a>. When performing such validation before the ingredient is added to the asset, the ingredient&#8217;s manifest is considered the active manifest for the purposes of validation.</p>
</div>
<div class="paragraph">
<p>In authoring scenarios, it may be desirable to more prominently raise warnings so that a creator making use of such an asset with a flawed provenance history can make an informed decision of how to proceed.</p>
</div>
<div class="paragraph">
<p>If the manifest is an update manifest, or if a validator has cause to validate the ingredients of a standard manifest, then for each ingredient, it must recursively:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the ingredient does not have a <code>c2pa_manifest</code> field</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If the manifest is a standard manifest, then the ingredient is accepted.</p>
</li>
<li>
<p>If the manifest is an update manifest, then the claim must be rejected with a failure code of <code>manifest.update.wrongParents</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>If the ingredient does have a <code>c2pa_manifest</code> field:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create an <a href="#_preparing_the_list_of_redacted_assertions">list of redacted assertions</a> which is the concatenation of the claim&#8217;s <code>redacted_assertions</code> array with any pre-existing redacted assertions list from previous recursive calls. This list is therefore only the redacted assertions from the active manifest&#8217;s claim and any ingredients along the path to the current ingredient.</p>
</li>
<li>
<p>Resolve the URI reference in the <code>url</code> field to obtain the ingredient claim&#8217;s manifest. If the URI reference cannot be resolved, the ingredient claim is rejected with a failure code of <code>claim.missing</code>.</p>
</li>
<li>
<p>Determine the hash algorithm identifier as determined by following the procedure described in <a href="#_hashing">Section 11.3.4.2, &#8220;Hashing&#8221;</a>:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If an <code>alg</code> field is present in the <code>hashed_uri</code> structure, that determines the hash algorithm.</p>
</li>
<li>
<p>If an <code>alg</code> field is not present in the <code>hashed_uri</code> structure, an <code>alg</code> field must be present in an enclosing structure, and the nearest instance present determines the hash algorithm.</p>
</li>
<li>
<p>If no <code>alg</code> field is found in any of these locations, the claim must be rejected with a failure code of <code>ingredient.hashedURI.mismatch</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Locate the value of the <code>alg</code> field in the allowed list or the deprecated list in <a href="#_hashing">Section 11.3.4.2, &#8220;Hashing&#8221;</a> to determine the hash algorithm. If it is not present in either list, the claim must be rejected with a failure code of <code>algorithm.unsupported</code>.</p>
</li>
<li>
<p>Compute the hash of the ingredient manifest&#8217;s data using that algorithm and the procedure described in <a href="#_hashing_jumbf_boxes">Section 8.3.1.3, &#8220;Hashing JUMBF Boxes&#8221;</a>.</p>
</li>
<li>
<p>Compare the computed hash with the value in the <code>hash</code> field. If the hashes are not equal, the claim must be rejected with a failure code of <code>ingredient.hashedURI.mismatch</code>.</p>
</li>
<li>
<p>If the ingredient contains a <code>validationStatus</code> field, each of the entries in the array shall be evaluated.  If the <code>code</code> field of any <code>validationStatus</code> equals a failure code or has a <code>success</code> field with a value of <code>false</code>, as defined at <a href="#_failure_codes">Section 15.1.2, &#8220;Failure codes&#8221;</a>, the ingredient&#8217;s claim is admitted. An admitted manifest is treated like an accepted manifest, but with an explicit indication that it may contain validation errors that are known to the signer. If admitted in this way, the validator must present each <code>validationStatus</code> present in the <code>validationStatus</code> field array as part of any exploration of the provenance history. Validators should perform full validation if exploration of the provenance history of the ingredient is requested to indicate where there are validation errors.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The presence of a <code>validationStatus</code> with a failure code or with a <code>success</code> field with a value of <code>false</code> is an explicit statement by the signer that they acknowledged and have chosen to override validation errors in the ingredient&#8217;s claim itself.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Otherwise, validate the ingredient claim and assertions as described beginning in <a href="#_validate_the_signature">Section 15.4, &#8220;Validate the Signature&#8221;</a>, except skip establishing signer credential trust, as this is not applicable to ingredients.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>When validating the assertions as described in <a href="#_validate_the_assertions">Section 15.7, &#8220;Validate the Assertions&#8221;</a>, provide a <a href="#_preparing_the_list_of_redacted_assertions">list of redacted assertions</a> as an input.</p>
</li>
<li>
<p>The validator may optionally recursively validate the ingredient&#8217;s ingredients. If it does and those are accepted, the ingredient&#8217;s claim is accepted. If any are rejected, the ingredient&#8217;s claim is rejected. If the validator chooses not to recurse further, the ingredient&#8217;s claim is accepted.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_visual_look_of_validation"><a class="anchor" href="#_visual_look_of_validation"></a>15.9. Visual look of Validation</h3>
<div class="paragraph">
<p>Here is a visual representation of the process of validating a claim (and its assertions).</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/Claim_Validation.svg" alt="Validating a Claim" width="720" height="432">
</div>
<div class="title">Figure 15. Validating a Claim</div>
</div>
</div>
<div class="sect2">
<h3 id="_validate_the_assets_content"><a class="anchor" href="#_validate_the_assets_content"></a>15.10. Validate the Asset&#8217;s Content</h3>
<div class="paragraph">
<p>If the active manifest is an update manifest, its <a href="#_hard_bindings">Section 9.2, &#8220;Hard Bindings&#8221;</a> are inherited from the <code>parentOf</code> ingredient&#8217;s manifest. If that manifest is also an update manifest, the search for a standard manifest shall recurse though the chain of ingredients.  If no standard manifest is found, then the manifest shall be rejected with a failure code of <code>manifest.update.wrongParents</code>.</p>
</div>
<div class="sect3">
<h4 id="_validating_a_data_hash"><a class="anchor" href="#_validating_a_data_hash"></a>15.10.1. Validating a data hash</h4>
<div class="paragraph">
<p>Once a standard manifest (and its bindings) has been located, the exclusion range(s) shall be extracted from the <code>c2pa.hash.data</code> assertion.</p>
</div>
<div class="paragraph">
<p>If any update manifests were encountered then the <code>length</code> value of the exclusion range whose <code>start</code> value is the offset of the start of the entire C2PA manifest store shall be treated as the current length of the entire C2PA manifest store plus any file format specific extras.</p>
</div>
<div class="paragraph">
<p>The hash algorithm (<code>alg</code>) specified in that <code>c2pa.hash.data</code> shall be computed over the bytes of the asset, minus those specified in the exclusion range(s).</p>
</div>
<div class="paragraph">
<p>If the hash algorithm specified in the <code>alg</code> field does not appear in the allowed or deprecated list in <a href="#_hashing">Section 11.3.4.2, &#8220;Hashing&#8221;</a>, then the manifest shall be rejected with a failure code of <code>algorithm.unsupported</code>. If the resultant hash does not match the value of the <code>hash</code> field in the <code>c2pa.hash.data</code>, then the manifest shall be rejected with a failure code of <code>assertion.dataHash.mismatch</code>.</p>
</div>
<div class="paragraph">
<p>The combination of exclusion ranges and padding values, especially padding needed to support multi-pass processing workflows, can enable an attacker to replace parts of that padding with arbitrary data that could impact the consumption of the asset without invalidating the hash.  For this reason a validator shall ensure that the data contained within the exclusion range consists only of a C2PA Manifest Store and appropriate padding (e.g., zero&#8217;d data) in clearly marked <code>pad</code> fields or <code>free</code>/<code>skip</code> boxes. If a validator encounters any data that is not part of the C2PA Manifest Store or padding, then the manifest shall be rejected with a failure code of <code>assertion.dataHash.mismatch</code>.</p>
</div>
<div class="paragraph">
<p>If no error conditions were encountered, the validator shall add the success code <code>assertion.dataHash.match</code> to the list it eventually returns.</p>
</div>
<div class="sect4">
<h5 id="_hashing_of_jpeg_1_files"><a class="anchor" href="#_hashing_of_jpeg_1_files"></a>15.10.1.1. Hashing of JPEG-1 files</h5>
<div class="paragraph">
<p>In JPEG-1 files, the file format extras described above would include any <code>APP11</code> markers and their respective segment length bytes for <code>APP11</code> segments.  Because the segment lengths are inside the exclusion range, a validator shall match the total length of the exclusion range with that of the total length of all <code>APP11</code> segments representing the C2PA Manifest to ensure that the length was not tampered with.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A JPEG-1 file can contain <code>APP11</code> segments for reasons other than C2PA (e.g., JPEG 360 or JPEG Privacy &amp; Security) and those are not included in these calculations.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_validating_a_bmff_hash"><a class="anchor" href="#_validating_a_bmff_hash"></a>15.10.2. Validating a BMFF-hash</h4>
<div class="paragraph">
<p>For any portions of an asset rendered for presentation to a user, including but not limited to audio, video, or text, the corresponding hard binding corresponding to the rendered content must be validated in accordance with <a href="#_hard_bindings">Section 9.2, &#8220;Hard Bindings&#8221;</a>. If at any time content fails to be validated, the validator must clearly signal to the user that some of the content does not match the claim, and if possible, should indicate what part of the content did not validate. If any content is absent for which content bindings exist, discovery of this absence is also a validation failure. The validator must continue to report validation has failed, even if later portions of the content validate correctly.</p>
</div>
<div class="paragraph">
<p>For content that is not wholly available before rendering begins, such as during adaptive bitrate streaming (ABR) and progressive download, absence of not-yet-available portions of content is not considered a validation failure. As the content becomes available, the validator must validate each portion of the content before it is rendered as previously described. In addition, the validator must validate that the sequence of said content is the same as when the manifest was produced. Unless the player has explicitly signalled the validator that a discontinuity is expected (e.g., when the consumer performs a manual seek operation via the UI), the validator must clearly signal to the user that an unexpected discontinuity has occurred whenever the sequence does not match. This includes validating that the <code>location</code> values for a given Merkle tree start at zero and increments by one for each following chunk; equivalently, the <code>location</code> value always indicates which chunk is being rendered.</p>
</div>
<div class="paragraph">
<p>For content that is intentionally not being rendered as the claim generator originally intended, such as during fast-forward, rewind, or playback at a different speed, the validator may not be able to validate the content. In this case, the validator must clearly signal to the user that the content cannot be validated during the corresponding operation.</p>
</div>
<div class="paragraph">
<p>If the hash algorithm specified in the <code>alg</code> field does not appear in the allowed or deprecated list in <a href="#_hashing">Section 11.3.4.2, &#8220;Hashing&#8221;</a>, then the manifest shall be rejected with a failure code of <code>algorithm.unsupported</code>. The <code>assertion.bmffHash.mismatch</code> failure code is used for all other failures described in this section. Otherwise, the validator shall add the success code <code>assertion.bmffHash.match</code> to the list it eventually returns.</p>
</div>
</div>
<div class="sect3">
<h4 id="_validating_a_general_box_hash"><a class="anchor" href="#_validating_a_general_box_hash"></a>15.10.3. Validating a general box hash</h4>
<div class="paragraph">
<p>Once a standard manifest (and its bindings) has been located, the list of boxes to be validated shall be extracted from the <code>c2pa.hash.boxes</code> assertion. The boxes must appear in the asset in the same order that they appear in the array, including the box containing the C2PA Manifest. If there are any other boxes present in the asset, then the manifest shall be rejected with a failure code of <code>assertion.boxesHash.unknownBox</code>. If the boxes appear out of order, or any of the hash values do not match, then the manifest shall be rejected with a failure code of <code>assertion.boxesHash.mismatch</code>. Otherwise, the validator shall add the success code <code>assertion.boxesHash.match</code> to the list it eventually returns.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">JPEG Special Handling</div>
<div class="paragraph">
<p>When validating a JPEG, a validator will need to check that each box identified with the special <code>C2PA</code> box identifier is indeed an <code>APP11</code> containing some or all of the C2PA Manifest Store.  The C2PA Manifest Store can be identified by it being a JUMBF superbox with a label of <code>c2pa</code> and a UUID of <code>0x63327061-0011-0010-8000-00AA00389B71</code>  as described in <a href="#_manifest_store">Section 11.1.4.2, &#8220;Manifest Store&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>If an <code>APP11</code> that is not part of the C2PA Manifest Store is present and not included in the list of hashed boxes, then the manifest shall be rejected with a failure code of <code>assertion.boxesHash.unknownBox</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">Font Special Handling</div>
<div class="paragraph">
<p>When validating a font, a validator will need to check that the box corresponding with the font&#8217;s <code>C2PA</code> table is present, and determine whether it contains an embedded manifest and/or a remote manifest URI.</p>
</div>
<div class="paragraph">
<p>If any font tables are present which are not covered by any box, then the manifest shall be rejected with a failure code of <code>assertion.boxesHash.unknownBox</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the hash algorithm specified in any <code>alg</code> field does not appear in the allowed or deprecated list in <a href="#_hashing">Section 11.3.4.2, &#8220;Hashing&#8221;</a>, then the manifest shall be rejected with a failure code of <code>algorithm.unsupported</code>.</p>
</div>
<div class="paragraph">
<p>For each box listed in the <code>names</code> and <code>boxes</code> array, the specified hash algorithm shall be computed over the bytes of the box (along with any associated header). If there are multiple entries in a <code>names</code> array, the hash value for that range of boxes shall be computed from the start of the first box (in the range) until the end of the last box (in the range).  This would include any arbitrary bytes that may be present between boxes.</p>
</div>
<div class="paragraph">
<p>If any resultant hash does not match the value of the <code>hash</code> field for those boxes, then the manifest shall be rejected with a failure code of <code>assertion.boxesHash.mismatch</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_validating_a_collection_data_hash"><a class="anchor" href="#_validating_a_collection_data_hash"></a>15.10.4. Validating a collection data hash</h4>
<div class="paragraph">
<p>Validation of a collection data hash assertion (<code>c2pa.hash.collection.data</code>) that has been located in a standard manifest shall be performed by iterating over the array of <code>uris</code> in the <code>collection-data-hash-map</code>.  For each <code>uri</code>, its hash shall be computing using the specific hash algorithm defined in the <code>alg</code> field.</p>
</div>
<div class="paragraph">
<p>In order to avoid any potential security concerns, a validator shall validate the URIs before use, ensuring that neither <code>.</code> nor <code>..</code> appear as part of the URI.  If either of these are found in a URI, the manifest shall be rejected with a failure code of <code>assertion.collectionHash.invalidURI</code>.</p>
</div>
<div class="paragraph">
<p>If there are any files listed in the collection data hash assertion that are not found by the validator, then the manifest shall be rejected with a failure code of <code>assertion.collectionHash.incorrectFileCount</code>. If any of the resultant hash values do not match, then the manifest shall be rejected with a failure code of <code>assertion.collectionHash.mismatch</code>. Otherwise, the validator shall add the success code <code>assertion.collectionHash.match</code> to the list it eventually returns.</p>
</div>
<div class="sect4">
<h5 id="_extras_for_zip"><a class="anchor" href="#_extras_for_zip"></a>15.10.4.1. Extras for ZIP</h5>
<div class="paragraph">
<p>In a ZIP file with an associated C2PA Manifest, the <a href="#_collection_data_hash">collection data hash</a> contains the additional <code>zip_central_directory_hash</code> field.  As described <a href="#_hashing_the_zip_central_directory">earlier</a>, this field contains a hash of every "central directory header" in the ZIP Central Directory as well as the the "end of central directory record" (which is the last part of a ZIP file). The hash algorithm used for this field is the same as the one used for the <code>hash</code> field in the <code>c2pa.hash.collection.data</code> assertion.</p>
</div>
<div class="paragraph">
<p>When validating a ZIP file, the validator shall check that the <code>zip_central_directory_hash</code> field is present and that the hash of the ZIP Central Directory and "end of central directory record" matches its value.  If the hash does not match, then the manifest shall be rejected with a failure code of <code>assertion.collectionHash.mismatch</code>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_user_experience"><a class="anchor" href="#_user_experience"></a>16. User Experience</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_approach"><a class="anchor" href="#_approach"></a>16.1. Approach</h3>
<div class="paragraph">
<p>The C2PA intends to provide clear recommendations and guidance for implementers of provenance-enabled user experiences (UX). Developing these recommendations is an ongoing process that involves diverse stakeholders, with the results balancing uniformity and familiarity with utility and flexibility for users across contexts, platforms, and devices. These recommendations can be found in the <a href="../../1.4/ux/UX_Recommendations.html" class="xref page">User experience guidance document</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_principles"><a class="anchor" href="#_principles"></a>16.2. Principles</h3>
<div class="paragraph">
<p>The UX recommendations aim to define best practices for presenting C2PA provenance to consumers. The recommendations strive to describe standard, readily recognizable experiences that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>provide asset creators a means to capture information and history about the content they are creating, and</p>
</li>
<li>
<p>provide asset consumers information and history about the content they are experiencing, thereby empowering them to understand where it came from and decide how much to trust it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>User interfaces designed for the consumption of C2PA provenance must be informed by the context of the asset. We have studied 4 primary user groups and a collection of contexts in which C2PA assets are encountered. These user groups have been defined in the <a href="https://c2pa.org/principles/">C2PA Guiding Principles</a> as Consumers, Creators, Publishers and Verifiers (or Investigators). To serve the needs of each of these groups across common contexts, exemplary user interfaces are presented for many common cases. These are recommendations, not mandates, and we expect best practices to evolve.</p>
</div>
</div>
<div class="sect2">
<h3 id="_disclosure_levels"><a class="anchor" href="#_disclosure_levels"></a>16.3. Disclosure Levels</h3>
<div class="paragraph">
<p>Because the complete set of C2PA data for a given asset can be overwhelming to a user, we describe 4 levels of progressive disclosure which guide the designs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Level 1: An indication that C2PA data is present and its cryptographic validation status.</p>
</li>
<li>
<p>Level 2: A summary of C2PA data available for a given asset. This level should provide enough information for the particular content, user, and context to allow the consumer to understand to a sufficient degree how the asset came to its current state.</p>
</li>
<li>
<p>Level 3: A detailed display of all relevant provenance data. Note that the relevance of certain items over others is contextual and determined by the UX implementer.</p>
</li>
<li>
<p>Level 4: For sophisticated, forensic investigatory usage, a tool capable of revealing all the granular detail of signatures and trust signals is recommended.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_public_review_feedback_and_evolution"><a class="anchor" href="#_public_review_feedback_and_evolution"></a>16.4. Public Review, Feedback and Evolution</h3>
<div class="paragraph">
<p>The team authoring the UX recommendations is cognizant of its limitations and potential biases, recognizing that feedback, review, user testing and ongoing evolution is a key requirement for success. The recommendations will therefore be an evolving document, informed by real world experiences deploying C2PA UX across a wide variety of applications and scenarios.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_information_security"><a class="anchor" href="#_information_security"></a>17. Information security</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_threats_and_security_considerations"><a class="anchor" href="#_threats_and_security_considerations"></a>17.1. Threats and Security Considerations</h3>
<div class="paragraph">
<p>This section provides a summary of information security considerations and processes for technology described in the C2PA core specification. More detailed content will be provided in future releases of C2PA material including the Guidance document.</p>
</div>
<div class="sect3">
<h4 id="_context"><a class="anchor" href="#_context"></a>17.1.1. Context</h4>
<div class="paragraph">
<p>Information security is a principal concern of C2PA. C2PA maintains a threat model and security considerations for the C2PA specification. This effort complements other security-related work within C2PA. Associated documentation is currently in development and can be found at <a href="../../1.0/security/Security_Considerations.html" class="xref page">Security Considerations</a>.</p>
</div>
<div class="paragraph">
<p>The C2PA is developing security considerations documentation that includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A summary of relevant security features of C2PA technology</p>
</li>
<li>
<p>Security considerations for practical use of C2PA technology</p>
</li>
<li>
<p>Threats to C2PA technology and respective treatment of those threats, including countermeasures</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_threat_modelling_process_overview"><a class="anchor" href="#_threat_modelling_process_overview"></a>17.1.2. Threat modelling process overview</h4>
<div class="paragraph">
<p>The C2PA builds security into our designs as they are being developed, but also expects that security design and threat modelling will continue as the system, ecosystem, and threat landscape evolve.</p>
</div>
<div class="paragraph">
<p>To this end, the C2PA uses a focused threat modelling process to support development of a strong security and privacy design. Outcomes of the effort directly support development of explicit threats and security considerations documentation, but also facilitate security thinking throughout the design process.</p>
</div>
<div class="paragraph">
<p>The threat modelling process combines synchronous (live) threat modelling sessions consisting of focused groups of subject matter experts (SMEs) with asynchronous development of content. The number of attendees in each synchronous session is kept small to promote efficient discussions, but all members of the C2PA have the opportunity to participate via either modality.</p>
</div>
<div class="paragraph">
<p>Like other security activities, we expect our threat modelling process to evolve with the C2PA ecosystem. Process documentation is considered a guide rather than a strict directive on how threat modelling works within the C2PA.</p>
</div>
<div class="sect4">
<h5 id="_references"><a class="anchor" href="#_references"></a>17.1.2.1. References</h5>
<div class="paragraph">
<p>A variety of references and experiences are used to inform threat modelling and related security activities for the C2PA. This section provides a subset of public documents for reference.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://datatracker.ietf.org/doc/html/rfc3552#page-26">IETF on security considerations</a></p>
</li>
<li>
<p><a href="https://datatracker.ietf.org/doc/html/rfc6973#section-7">IETF on privacy considerations (guidelines)</a></p>
</li>
<li>
<p><a href="https://www.w3.org/TR/security-privacy-questionnaire/">W3C security and privacy self-review questionnaire</a></p>
</li>
<li>
<p><a href="https://datatracker.ietf.org/doc/html/rfc6819">OAuth2 threat model (example)</a></p>
</li>
<li>
<p><a href="https://shostack.org/books/threat-modelling-book">Threat modelling: Designing for Security</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-community/Threat_modelling">OWASP Threat modelling</a></p>
</li>
<li>
<p><a href="https://www.microsoft.com/en-us/securityengineering/sdl/threatmodelling">Microsoft Threat modelling</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_harms_misuse_and_abuse"><a class="anchor" href="#_harms_misuse_and_abuse"></a>17.2. Harms, Misuse, and Abuse</h3>
<div class="sect3">
<h4 id="_introduction_2"><a class="anchor" href="#_introduction_2"></a>17.2.1. Introduction</h4>
<div class="paragraph">
<p>The C2PA <a href="https://c2pa.org/principles/">Guiding Principles</a> establish that C2PA specifications must be reviewed with a critical eye towards the potential abuse or misuse of the framework to cause unintended harms, threats to human rights, or disproportionate risks to vulnerable groups globally.</p>
</div>
<div class="paragraph">
<p>To ensure that the C2PA is meeting this aspect of its principles, the harms, misuse, and abuse assessment aims to identify and address potential concerns during the specifications development and as encountered in subsequent implementations.</p>
</div>
<div class="paragraph">
<p>In addition, the specifications are being reviewed to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Anticipate and mitigate potential abuse and misuse;</p>
</li>
<li>
<p>Address common privacy concerns of its users; and</p>
</li>
<li>
<p>Consider the needs of users and stakeholders throughout the world.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_considerations"><a class="anchor" href="#_considerations"></a>17.2.2. Considerations</h4>
<div class="paragraph">
<p>The harms, misuse, and abuse assessment is an ongoing process. The information presented in the <a href="../../1.0/security/Harms_Modelling.html" class="xref page">Harms Modelling documentation</a> should not be considered the end result of a comprehensive evaluation, but as a basis for ongoing discussions centered on impacted communities, and aimed at mitigating potential abuse and misuse and protecting human rights.</p>
</div>
<div class="paragraph">
<p>There are two critical aspects of the approach:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ongoing</dt>
<dd>
<p>The harms, misuse, and abuse assessment necessarily accompanies the design and development, as well as implementation and use-stages of the C2PA by continuously informing the specifications development process, the implementation and user-experience guides, sensitization efforts, the governance of the Coalition and potentially multilateral cooperation for the promotion of a diverse C2PA ecosystem that serves a broad range of global contexts.</p>
</dd>
<dt class="hdlist1">Multi-disciplinary and diverse</dt>
<dd>
<p>The harms, misuse, and abuse assessment should be a collaborative effort that includes multi-disciplinary experts and a broad range of stakeholders with lived, practical and technical experience of the issues from diverse geographical locations, cultural backgrounds and individual identities.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_assessment"><a class="anchor" href="#_assessment"></a>17.2.3. Assessment</h4>
<div class="paragraph">
<p>Harms modelling focuses on analysing how a socio-technical system might negatively impact users, other stakeholders or broader society, or otherwise create or re-enforce structures  of injustice, threats to human rights, or disproportionate risks to vulnerable groups globally. The process of harms modelling systematically requires combining knowledge about a system architecture and its user affordances with historical and contextual evidence about the impact of similar existing systems on different social groups and participatory consultation with a range of communities who may be implicated by the system. This combined information frames the ability to anticipate harm and proactively identify responses.</p>
</div>
<div class="paragraph">
<p>The <a href="../../1.0/security/Harms_Modelling.html" class="xref page">Harms Modelling documentation</a> describes the framework and the process carried out to date, followed by the methodology, an overview of the assessment, an outline for public review and feedback, and due diligence actions being developed to accompany version 1.0 of these specifications, its implementations and evolution.</p>
</div>
</div>
<div class="sect3">
<h4 id="_due_diligence_actions"><a class="anchor" href="#_due_diligence_actions"></a>17.2.4. Due Diligence Actions</h4>
<div class="paragraph">
<p>The harms, misuse and abuse assessment has informed, and should continue to inform, the development of the C2PA technical specifications as well as its accompanying documentation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../../1.3/guidance/Guidance.html" class="xref page">Guidance for implementers</a></p>
</li>
<li>
<p><a href="../../1.4/ux/UX_Recommendations.html" class="xref page">User experience guidance</a></p>
</li>
<li>
<p><a href="../../1.0/security/Security_Considerations.html" class="xref page">Security Considerations</a></p>
</li>
<li>
<p><a href="../../1.3/explainer/Explainer.html" class="xref page">Explainer</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, the harms, misuse and abuse assessment should inform the governance of the Coalition and guide potential multilateral cooperation for the promotion of a diverse C2PA ecosystem that pushes for the optimization of the benefits in terms of trust in media, user control and transparency that prompted the development of the C2PA specifications.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_c2pa_standard_assertions"><a class="anchor" href="#_c2pa_standard_assertions"></a>18. C2PA Standard Assertions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction_3"><a class="anchor" href="#_introduction_3"></a>18.1. Introduction</h3>
<div class="paragraph">
<p>This section of the document lists the standard set of assertions for use by C2PA implementations, describing their syntax, usage, etc. To keep things simple, all example JUMBF URIs have been shortened for illustrative purposes - full URIs are necessary in the actual data.</p>
</div>
<div class="paragraph">
<p>All C2PA standardized assertions use the JSON JUMBF content type, the CBOR JUMBF content type, or the Embedded File content type from ISO 19566-5. Entity-specific assertions can be any of those, any of the other JUMBF content types from ISO 19566-5, B.1 (such as XML) or may create its own (as per the instructions in ISO 19566-5, Table B.1).  The Codestream content type shall not be used for a C2PA assertion.</p>
</div>
<div class="paragraph">
<p>Unless otherwise mentioned, all assertions documented in this standard set of assertions shall be serialized as CBOR. For all assertions of type CBOR, their schemas shall be defined using <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL</a>. All assertions that are serialized as CBOR shall comply with the <a href="https://www.rfc-editor.org/rfc/rfc8949.html#name-core-deterministic-encoding">"Core Deterministic Encoding Requirements" of CBOR</a>.  For those defined using JSON, their schemas shall be defined using the latest version of <a href="https://json-schema.org/specification-links.html">JSON Schema</a>.</p>
</div>
<div class="paragraph">
<p>All assertions shall have a label as described in <a href="#_labels">Section 6.2, &#8220;Labels&#8221;</a> and shall be versioned as described in <a href="#_versioning">Section 6.3, &#8220;Versioning&#8221;</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_regions_of_interest"><a class="anchor" href="#_regions_of_interest"></a>18.2. Regions of Interest</h3>
<div class="paragraph">
<p>In some use cases, a given assertion, such as an <a href="#_actions">actions assertion</a>, may only be relevant to a specific portion of an asset as opposed to the entire asset.  In those cases, it is necessary to have a way to describe that region - whether it be temporal, spatial, textual or a combination of them.  A <code>region</code> definition serves that purpose.</p>
</div>
<div class="sect3">
<h4 id="_common"><a class="anchor" href="#_common"></a>18.2.1. Common</h4>
<div class="paragraph">
<p>The most important part of the <code>region</code> definition is the <code>range</code> field which is used to describe a temporal range, a spatial range, a textual range or a combination of them, for the region.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>While the specification allows for specifying a combination of ranges, it is not defined how a Manifest Consumer will use them. It is expected that the C2PA&#8217;s User Experience Task Force will take this up in the future.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A <code>region</code> may also contain one of more common fields:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>name</code></dt>
<dd>
<p>a free-text string representing a human-readable name for the region which might be used in a user interface.</p>
</dd>
<dt class="hdlist1"><code>identifier</code></dt>
<dd>
<p>a free-text string representing a machine-readable, unique to this assertion, identifier for the region.</p>
</dd>
<dt class="hdlist1"><code>type</code></dt>
<dd>
<p>a value from a controlled vocabulary such as <a href="https://cv.iptc.org/newscodes/imageregiontype/" class="bare">https://cv.iptc.org/newscodes/imageregiontype/</a> or an entity-specific value (e.g., <code>com.litware.newType</code>) that represents the type of thing(s) depicted by a region.</p>
</dd>
<dt class="hdlist1"><code>role</code></dt>
<dd>
<p>a value from our controlled vocabulary or an entity-specific value (e.g., <code>com.litware.coolArea</code>) that represents the role of a region among other regions.</p>
</dd>
<dt class="hdlist1"><code>description</code></dt>
<dd>
<p>a free-text string.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="_roles"><a class="anchor" href="#_roles"></a>18.2.1.1. Roles</h5>
<div class="paragraph">
<p>The following are the proposed values for the <code>role</code> field, which represents the "role" of a region among other regions of the same asset. They were derived from the IPTC <a href="https://cv.iptc.org/newscodes/imageregionrole">ImageRegionRole</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$role-choice /= "c2pa.areaOfInterest",  ; arbitrary area worth identifying
$role-choice /= "c2pa.cropped",         ; this area is all that is left after a crop action
$role-choice /= "c2pa.edited",          ; this area has had edits applied to it
$role-choice /= "c2pa.placed",          ; the area where an ingredient was placed/added
$role-choice /= "c2pa.redacted",        ; something in this area was redacted
$role-choice /= "c2pa.subjectArea",     ; area specific to a subject (human or not)
$role-choice /= "c2pa.deleted",         ; a range of information was removed/deleted
$role-choice /= "c2pa.styled",          ; styling was applied to this area
$role-choice /= "c2pa.watermarked",     ; invisible watermarking was applied to this area for the purpose of soft binding</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ranges"><a class="anchor" href="#_ranges"></a>18.2.1.2. Ranges</h5>
<div class="paragraph">
<p>All ranges consist of a <code>type</code> field whose value is either "spatial", "temporal", "frame" or "textual".  In addition, it shall contain one of the following fields whose data is an object consisting of the specific data for that range.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>shape</code> (for spatial)</p>
</li>
<li>
<p><code>time</code> (for temporal)</p>
</li>
<li>
<p><code>frame</code> (for temporal or textual)</p>
</li>
<li>
<p><code>text</code> (for textual)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_spatial"><a class="anchor" href="#_spatial"></a>18.2.1.3. Spatial</h5>
<div class="paragraph">
<p>Spatial ranges are described using a <code>shape</code> object. A <code>shape`</code> can be use to represent a rectangle, a circle or a polygon.  It is modelled on the <a href="http://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata#region-boundary-structure">Region Boundary Structure</a> from the IPTC.</p>
</div>
</div>
<div class="sect4">
<h5 id="_temporal"><a class="anchor" href="#_temporal"></a>18.2.1.4. Temporal</h5>
<div class="paragraph">
<p>Temporal ranges are described using a <code>time</code> object, which represents a range from a starting time to an ending time.  If no <code>start</code> is provided, the range shall start at the beginning of the asset.  If no <code>end</code> is provided, the range shall end at the end of the asset.  If neither is provided, the range shall represent the entire asset.</p>
</div>
<div class="paragraph">
<p>Times are described using Normal Play Time (<code>npt</code>) as described in <a href="http://www.ietf.org/rfc/rfc2326.txt">RFC 2326</a>, as recommended in the <a href="https://www.w3.org/TR/media-frags/#media-fragment-syntax">Media Fragments specification</a> from the W3C.</p>
</div>
</div>
<div class="sect4">
<h5 id="_frames"><a class="anchor" href="#_frames"></a>18.2.1.5. Frames</h5>
<div class="paragraph">
<p>A <code>frame</code> object defines a range using the starting and ending frames or pages (inclusive). If no <code>start</code> is provided, the range shall start at the beginning of the asset.  If no <code>end</code> is provided, the range shall end at the end of the asset.  If neither is provided, the range shall represent the entire asset.</p>
</div>
<div class="paragraph">
<p>Frames are represented as a single ordinal numbers, where <code>0</code> is the first frame.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Frames are typically used to represent page numbers of a document, such as PDF, although they may have uses in other media types, such as animation, video and audio. However, it is recommended that where possible, media types dealing with regions of interest over time use <code>temporal</code> ranges instead.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_textual"><a class="anchor" href="#_textual"></a>18.2.1.6. Textual</h5>
<div class="paragraph">
<p>A <code>text</code> object defines a range using a one or more URL fragment identifiers, as defined by the <a href="https://www.w3.org/TR/annotation-model/#fragment-selector">W3C Web Annotation fragment selector</a>.  It may also refine the range using offsets to the starting and ending characters (inclusive). If no <code>start</code> is provided, the range shall start at the beginning of the fragment.  If no <code>end</code> is provided, the range shall end at the end of the fragment.  If neither is provided, the range shall represent the entire fragment.</p>
</div>
<div class="paragraph">
<p>When used singularly, the <code>fragment</code> entry of the <code>text-selector-map</code> represents the entirety of the specified textual range. However, the <code>text-selector-range-map</code> supports a pair of <code>text-selector-map</code> objects. The value of <code>selector</code> is the start of the range (or its entirely, if no <code>end</code> entry is present) and the value of <code>end</code> (if present) represents the end of a contiguous range.  In addition, multiple pairs may be used to represent a range that is not contiguous.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_schema"><a class="anchor" href="#_schema"></a>18.2.2. Schema</h4>
<div class="paragraph">
<p>The schema for this type is defined by the <code>region-map</code> rule in the following <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">$role-choice /= "c2pa.areaOfInterest"  ; arbitrary area worth identifying
$role-choice /= "c2pa.cropped"         ; this area is all that is left after a crop action
$role-choice /= "c2pa.edited"          ; this area has had edits applied to it
$role-choice /= "c2pa.placed"          ; the area where an ingredient was placed/added
$role-choice /= "c2pa.redacted"        ; something in this area was redacted
$role-choice /= "c2pa.subjectArea"     ; area specific to a subject (human or not)
$role-choice /= "c2pa.deleted"         ; a range of information was removed/deleted
$role-choice /= "c2pa.styled"          ; styling was applied to this area
$role-choice /= "c2pa.watermarked"     ; watermarking was applied to this area for the purpose of soft binding

region-map = {
	"region":		[1* $range-map],		; definition of the range, one or more ranges
	? "name": tstr .size (1..max-tstr-length),  ; a free-text string representing a human-readable name for the region which might be used in a user interface.
	? "identifier": tstr .size (1..max-tstr-length),  ; a free-text string representing a machine-readable, unique to this assertion, identifier for the region.
	? "type": 	tstr .size (1..max-tstr-length),	; from a controlled list
	? "role": 	$role-choice, 	; from a controlled list 
	? "description": tstr .size (1..max-tstr-length),
	? "metadata": $assertion-metadata-map, ; additional information about the assertion
}

$range-choice /= "spatial"  	; a range identified by physical area
$range-choice /= "temporal"  	; a range identified by a time period
$range-choice /= "frame"  		; a range identified by a series of frames or pages
$range-choice /= "textual"  	; a range identified by a range of text

range-map = {
	"type": 	$range-choice,		; either "spatial", "temporal", "frame" or "textual"
	? "shape": 	$shape-map, 	  	; description of the shape of a spatial range 
	? "time": 	$time-map, 		  	; description of the time boundaries of a temporal range
	? "frame": 	$frame-map, 		; description of the frame boundaries of a temporal range
	? "text": 	$text-map, 			; description of the boundaries of a textual range
}

coordinate-map = {
	"x": float,		; coordinate along the x-axis
	"y": float,		; coordinate along the y-axis
}

$shape-choice /= "rectangle"  	; a rectangular shape
$shape-choice /= "circle"  		; a circular shape
$shape-choice /= "polygon"  	; a polygonal shape

$unit-choice /= "pixel"  	; units are in pixels
$unit-choice /= "percent"   ; units are in percent of the total size


shape-map = {
	"type": 	$shape-choice,			; either "rectangle", "circle" or "polygon"
	"unit":		$unit-choice,		  	; either "pixel" or "percent"
	"origin": 	$coordinate-map, 		; starting/origin coordinate of the shape. 
	? "width": 	float, 				    ; width for rectangles, diameter for circles (ignored for polygons)
	? "height":	float				    ; height for rectangles
	? "inside" : bool,            		; inside or outside the shape, default is `true`
	? "vertices":	[1* $coordinate-map]	; remaining points/vertices of the polygon
}

$time-choice /= "npt"  ; Normal Play Time

time-map = {
	"type": 	$time-choice,
	? "start": 	tstr .regexp "^(?:(?:([01]?\d|2[0-3]):)?([0-5]?\d):)?([0-5]?\d)(\.(\d{1,9}))?$", 	; start time (or beginning of asset if not present). 
	? "end": 	tstr .regexp "^(?:(?:([01]?\d|2[0-3]):)?([0-5]?\d):)?([0-5]?\d)(\.(\d{1,9}))?$", 	; end time (or end of asset if not present).
}

; this can be used for either frames of a video or pages of a document
frame-map = {
	? "start": 	int, 	; start frame (or beginning of asset if not present). 
	? "end": 	int		; end frame (or end of asset if not present). 
}

; this is modeled after the W3C Web Annotation selector model
text-selector-map = {
	"fragment": 	tstr,	; fragment identifier, as per RFC3023 or ISO 32000-2, Annex O
	? "start": 		int, 	; start character offset (or beginning of fragment if not present).
	? "end": 		int		; end character offset (or end of fragment if not present).
}

; one or two text-selector-maps used to identify the range
text-selector-range-map = {
	"selector": 	$text-selector-map, 	; start (or only) text selector
	? "end": 		$text-selector-map		; if present, represents the end of the text range
}

text-map = {
	"selectors": [1* $text-selector-range-map]	; array of (possibly discontinuous) ranges of text
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A series of examples in CBOR Diagnostic Format (<code>.cbordiag</code>) are shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">// example of a combined temporal and spatial range in a video //
{
  "region": [
    {
      "type": "temporal",
      "time": {
        "type": "npt",
        "start": "0",
        "end": "5.2"
      }
    },
    {
      "type": "spatial",
      "shape": {
        "type": "rectangle",
        "unit": "pixel",
        "origin": {
          "x": 10.0,
          "y": 10.0
        },
        "width": 200.0,
        "height": 112.0
      }
    }
  ],
  "name": "Animated Logo",
  "identifier": "logo-clip",
  "role": "c2pa.placed",
  "description": "5.2 seconds of the opening animated logo, in a rectangle 10 pixels down from the top and left, 200px by 112px"
}

// example of a textual range in a Word/DOCX file //
{
  "region": [
    {
      "type": "textual",
      "text" : {
        "selectors" : [
          [
            {
              "fragment" : "xpointer(/w:document/w:body/w:p/)"
            }
          ]
        ]
      }
    },
  ],
  "role": "c2pa.edited",
  "description": "AI assistant edited content"
}

// example of a textual range in a tagged PDF file //
{
  "region": [
    {
      "type": "textual",
      "text" : {
        "selectors" : [
          [
            {
              "selector" : {
                "fragment" : "path=/Document/Sect[0]/P[3]",
                "start" : 10,
                "end" : 20
              }
            }
          ]
        ]
      }
    },
  ],
  "role": "c2pa.redacted",
  "description": "Redaction performed as per FOIA request"
}

// example of a textual range in a non-tagged PDF file //
//  in this case, we can only specify a page &amp; rectangular area //
{
  "region": [
    {
      "type": "textual",
      "text" : {
        "selectors" : [
          [
            {
              "selector" : {
                "fragment" : "page=1,rect=10,10,450,500",
                "start" : 10,
                "end" : 20
              }
            }
          ]
        ]
      }
    },
  ],
  "role": "c2pa.redacted",
  "description": "Redaction performed as per FOIA request"
}

// example of deletion of some pages from a PDF //
{
  "region": [
    {
      "type": "frame",
      "frame" : {
        "start" : 27,
        "end" : 30
      }
    },
  ],
  "role": "c2pa.deleted",
  "description": "unnecessary pages removed before distribution"
}

// example of a range of cells in Excel //
{
  "region": [
    {
      "type": "textual",
      "text" : {
        "selectors" : [
          [
            {
              "selector" : {
                "fragment" : "xpointer(Sheet1!A5:A10)",
              }
            }
          ],
          [
            {
              "selector" : {
                "fragment" : "xpointer(Sheet1!B5:B10)",
              }
            }
          ]
        ]
      }
    },
  ],
  "role": "c2pa.styled",
  "description": "applied some styling to a range of cells in Excel"
}

// example of a contiguous range of table cells //
{
  "region": [
    {
      "type": "textual",
      "text" : {
        "selectors" : [
          [
            {
              "selector" : {
                "fragment" : "xpointer(//table[1]/tr[1]/td[2])",
              },
              "end" : {
                "fragment" : "xpointer(//table[1]/tr[1]/td[4])",
              }
            }
          ]
		    ]
      }
    },
  ],
  "role": "c2pa.cleared",
  "description": "cleared some table cells"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_metadata_about_assertions"><a class="anchor" href="#_metadata_about_assertions"></a>18.3. Metadata About Assertions</h3>
<div class="paragraph">
<p>In many cases, it is useful or even necessary to provide additional information about an assertion, such as the date and time when it was generated or other data that may help manifest consumers to make informed decisions about the provenance or veracity of the assertion data.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A Manifest Consumer is not required to read any portion of assertion metadata. It can choose which, if any, fields it wishes to consume, perhaps even varying based on the assertion type to which it is applied.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Below shows the core schemas used inside other assertions.</p>
</div>
<div class="paragraph">
<p>In CDDL it is defined by the <code>assertion-metadata-map</code> rule in the following schema:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">;Describes additional information about an assertion, including a hashed-uri reference to it. We use a socket/plug here to allow hashed-uri-map to be used in individual files without having the map defined in the same file
$assertion-metadata-map /= {
  ? "dateTime":  tdate, ; The ISO 8601 date-time string when the assertion was created/generated
  ? "reviewRatings": [1* rating-map], ; Ratings given to the assertion (may be empty)
  ? "reference": $hashed-uri-map, ;hashed_uri reference to another assertion that this review is about
  ? "dataSource": source-map, ; A description of the source of the assertion data, selected from a predefined list
  ? "localizations" : [1* localization-data-entry] ; localizations for strings in the assertion
  ? "regionOfInterest" : $region-map ; describes a region of the asset where this assertion is relevant
  * $$assertion-metadata-map-extension
}

$source-type /= "signer"
$source-type /= "claimGenerator.REE"
$source-type /= "claimGenerator.TEE"
$source-type /= "localProvider.REE"
$source-type /= "localProvider.TEE"
$source-type /= "remoteProvider.1stParty"
$source-type /= "remoteProvider.3rdParty"
$source-type /= "humanEntry"
; the following two values of source-type are deprecated as of 2.0
$source-type /= "humanEntry.anonymous"
$source-type /= "humanEntry.identified"

source-map = {
  "type": $source-type, ; A value from among the enumerated list indicating whether the source of the assertion is a claim generator running in a rich execution environment (REE), a claim generator running in a trusted execution environment (TEE), a local data provider in REE (e.g. the location API from a mobile operating system), a local data running in a TEE (e.g. a trusted location trusted app from a chipset vendor), a remote data provider such as a server (e.g. Google's geolocation API service), or entry by a human.
  ? "details": tstr .size (1..max-tstr-length), ; A human readable string giving details about the source of the assertion data, e.g. the URL of the remote server that provided the data
  
  ; NOTE: an earlier version of this specification also included an "actors" field, however this was removed in version 2.0.
}

int-range = 1..5

$review-code /= "actions.unknownActionsPerformed"
$review-code /= "actions.missing"
$review-code /= "actions.possiblyMissing"
$review-code /= "depthMap.sceneMismatch"
$review-code /= "ingredient.modified"
$review-code /= "ingredient.possiblyModified"
$review-code /= "thumbnail.primaryMismatch"

; the following three values of review-code are deprecated as of 2.0
$review-code /= "stds.iptc.location.inaccurate"
$review-code /= "stds.schema-org.CreativeWork.misattributed"
$review-code /= "stds.schema-org.CreativeWork.missingAttribution"

rating-map = {
  "value":  int-range, ; "A value from 1 (worst) to 5 (best) of the rating of the item"
  ? "code": $review-code, ; A label-formatted string that describes the reason for the rating
  ? "explanation": tstr .size (1..max-tstr-length), ; A human readable string explaining why the rating is what it is
}

; The data structures used to store localization dictionaries
$localization-data-entry /= {
  * $$language-string
}

language-string /= tstr .size (1..max-tstr-length)</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Editors Note</div>
<div class="paragraph">
<p>I think we need a cbor-diag example here&#8230;&#8203;</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In most cases, this assertion specific metadata will appear directly inside of other assertions (e.g., ingredients) as the value of their <code>metadata</code> field. However, sometimes it is necessary or desirable to store the assertion metadata in a separate, independent assertion metadata assertion, such as when an assertion is not in JSON or CBOR, such as thumbnails.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Since the claim is a special type of assertion, it too supports having assertion metadata.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The label for the assertion metadata assertion is <code>c2pa.assertion.metadata</code>.</p>
</div>
<div class="sect3">
<h4 id="_data_source"><a class="anchor" href="#_data_source"></a>18.3.1. Data Source</h4>
<div class="paragraph">
<p>This <code>dataSource</code> field is an optional field that allows the claim signer to inform downstream Manifest Consumers about the source from which the assertion contents originated. If no <code>dataSource</code> is provided for a given assertion, the <code>dataSource</code> is considered to be the <code>Signer</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By default, all assertions are sourced to the Signer, as the Trust Model is rooted in trust of the Signer. Where a different source is indicated, it will be a useful Trust Signal to a Manifest Consumer.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of the field is a <code>dataSource</code> object that is composed of two fields: <code>type</code> and <code>details</code>.</p>
</div>
<div class="paragraph">
<p>The dataSource <code>type</code> field defines the type of the dataSource. It is assembled with labels in the format described in <a href="#_labels">Section 6.2, &#8220;Labels&#8221;</a>. The value can be one of the following specification-defined values, or entity-specific labels can be used as an extension mechanism.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 76.9231%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value of <code>type</code></th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>signer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The assertion contents came from the Signer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claimGenerator.REE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assertion contents came from a claim generator running in a rich execution environment (REE), such as a desktop or mobile operating system</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>claimGenerator.TEE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assertion contents came from a claim generator running in a trusted execution environment (TEE), such as a trusted OS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>localProvider.REE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assertion contents came from a data source running in an REE on the same physical computing device as the claim generator</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>localProvider.TEE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assertion contents came from a data source running in a TEE on the same physical computing device as the claim generator</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>remoteProvider</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assertion contents came from a remote data source controlled by the signer or claim generator vendor</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>remoteProvider.external</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assertion contents came from an external, remote data source that is not the signer or claim generator vendor</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>humanEntry</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assertion contents were entered by a human</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>details</code> field is a human-readable string that provides additional information about the dataSource, e.g., the name of the API used to provide the assertion contents, or the URL of the server from which the contents were provided. For example, a broad location assertion source may have a <code>type</code> value of <code>remoteProvider.3rdParty</code>, with the <code>details</code> value set to <code>www.googleapis.com/geolocation/v1/geolocate</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_review_ratings"><a class="anchor" href="#_review_ratings"></a>18.3.2. Review Ratings</h4>
<div class="paragraph">
<p>When present, the <code>reviewRatings</code> array provides a place for the claim generator to provide one or more <code>rating</code> objects on the quality (or lack thereof) of an assertion. A <code>reviewRatings</code> shall not be present if a <code>dataSource</code> object is present with a <code>type</code> field whose value is either <code>humanEntry.anonymous</code> or <code>humanEntry.credentialed</code>.</p>
</div>
<div class="paragraph">
<p>The <code>value</code> field of the <code>rating</code> object shall be present with any integer value from <em>1</em> (worst) through <em>5</em> (best). If present, the <code>explanation</code> field shall contain a human-consumable string description of the type of rating. In addition, an optional machine-readable <code>code</code> field which defines assertion-specific evaluation outcome codes may be provided. The value of the <code>code</code> field is assembled with labels in the format described in <a href="#_labels">Section 6.2, &#8220;Labels&#8221;</a>. The value can be one of the following specification-defined values, or entity-specific labels can be used as an extension mechanism.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 22.2222%;">
<col style="width: 22.2222%;">
<col style="width: 55.5556%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value of <code>code</code></th>
<th class="tableblock halign-left valign-top">Applicable Assertion</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>actions.unknownActionsPerformed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c2pa.actions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The actions assertion does not contain a full list of all actions performed in the authoring tool (e.g., because of the use of a 3rd party filter whose effect is unknown to the authoring tool).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>actions.placedIngredientNotFound</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c2pa.actions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The actions assertion being reviewed has a <code>placed</code> action without a resolvable <code>ingredient</code> URI. <code>value</code> should be <code>1</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ingredient.actionMissing</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c2pa.ingredient</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The ingredient assertion being reviewed does not have at least one action that references it in its claim. <code>value</code> should be <code>1</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ingredient.notVisible</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c2pa.ingredient</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The ingredient assertion being reviewed is not visible in the digital content bound to that manifest. <code>value</code> should be <code>1</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>depthMap.sceneMismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c2pa.depthmap.GDepth</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The contents of the depth map assertion do not correspond to the scene portrayed in the primary presentation in the asset (e.g., because of a picture-of-picture attack).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>thumbnail.primaryMismatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c2pa.thumbnail.claim</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The thumbnail&#8217;s contents do not match the contents of the primary presentation in the asset.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_references_2"><a class="anchor" href="#_references_2"></a>18.3.3. References</h4>
<div class="paragraph">
<p>Because the <code>reference</code> field of the assertion metadata assertion is a standard <a href="#_uri_references">hashed_uri</a>, it is also possible to have an <a href="#_metadata_about_assertions">assertion metadata assertion</a> refer to assertions in other manifests than the active one. For example, the active manifest could include an <code>assertion metadata</code> assertion that validates the <code>c2pa.metadata</code> assertion present in an ingredient&#8217;s manifest.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Since the claim is a special type of assertion, this same method can be used to refer to claims in other manifests.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_datetime"><a class="anchor" href="#_datetime"></a>18.3.4. DateTime</h4>
<div class="paragraph">
<p>If a <code>dateTime</code> field is present, its value shall be a date time string that complies with <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO 8601</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_region_of_interest"><a class="anchor" href="#_region_of_interest"></a>18.3.5. Region of Interest</h4>
<div class="paragraph">
<p>The assertion may be specific to only a portion of an asset - such as a range of frames in a video or a specific area on an image.  Such a portion may be identified using a <code>regionOfInterest</code> field, whose value is a <code>region-map</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_localization"><a class="anchor" href="#_localization"></a>18.3.6. Localization</h4>
<div class="paragraph">
<p>It is important that consumers of C2PA manifests be able to understand the information in their native language, when possible. To this end, it is possible to add localization information for an assertion with a dictionary that is included in the assertion&#8217;s metadata.</p>
</div>
<div class="sect4">
<h5 id="_localization_dictionary"><a class="anchor" href="#_localization_dictionary"></a>18.3.6.1. Localization Dictionary</h5>
<div class="paragraph">
<p>A localization dictionary consists of a single object, where each of its keys represent the translations using the <a href="https://www.w3.org/TR/json-ld/#language-indexing">language indexing technique</a>.  If the value that requires translation is not associated with a top-level key, then "dot notation" (<code>.</code>) shall be used to reference keys nested in objects. An array indexing notation (<code>[n]</code>, <code>n&gt;=0</code>) shall be used where a specific element in an array needs to be traversed. When the value requiring translation is itself an array, a specific element may be referenced. Some examples would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "dc:title": {
    "en-US": "Kevin's Five Cats",
    "en-GB": "Lord Kevin's Five Cats",
    "es-MX": "Los Cinco Gatos de Kevin",
    "es-ES": "Los Thinco Gatos de Kevin",
    "fr": "Les Cinq Chats de Kevin",
    "jp": "ケヴィンの５匹の猫"
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "actions[0].softwareAgent": {
    "en-US": "Joe's Photo Editor",
    "en-GB": "Joe's Photo Editor",
    "es": "Editor de fotos de Joe",
    "fr": "L'éditeur de photos de Joe",
    "jp": "ジョーの写真編集者"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Any such 3rd party keys or values are required to be namespaced in the same way as <a href="#_labels">Section 6.2, &#8220;Labels&#8221;</a>, e.g. <code>com.litware</code>. In order for a Manifest Consumer to display human-readable information about these keys and values, the claim generator should provide the strings via this localization approach.</p>
</div>
<div class="paragraph">
<p>The following example shows how this could be used for localizing custom <a href="#_actions">actions</a>, by using this in the assertion metadata of a <code>c2pa.actions</code> assertion.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "com.litware.blur": {
    "en-US": "Blur",
    "fr-FR": "Brouiller",
  },
  "com.litware.filter": {
    "en-US": "Filter",
    "es-ES": "Filtrar",
    "jp-JP": "フィルター"
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_standard_c2pa_assertion_summary"><a class="anchor" href="#_standard_c2pa_assertion_summary"></a>18.4. Standard C2PA Assertion Summary</h3>
<div class="paragraph">
<p>The standard C2PA assertions are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Assertion</th>
<th class="tableblock halign-left valign-top">Schema</th>
<th class="tableblock halign-left valign-top">Serialization</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assertion Metadata</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.assertion.metadata</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Asset Reference</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.asset-ref</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Hash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.hash.data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BMFF-based Hash v2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.hash.bmff.v2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">General Box Hash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.hash.boxes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Collection Data Hash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.hash.collection.data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Soft Binding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.soft-binding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cloud Data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.cloud-data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Thumbnail</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.thumbnail.claim (claim creation time) c2pa.thumbnail.ingredient (importing an ingredient)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Embedded File</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Actions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.actions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ingredient</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.ingredient</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Metadata</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.metadata</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON-LD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GDepth Depthmap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.depthmap.GDepth</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developers.google.com/depthmap-metadata/reference" class="bare">https://developers.google.com/depthmap-metadata/reference</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Font Information</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">font.info</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_data_hash"><a class="anchor" href="#_data_hash"></a>18.5. Data Hash</h3>
<div class="paragraph">
<p>The most common way to uniquely verify the integrity of portions of a non-BMFF-based asset is via the hard bindings (i.e., cryptographic hash) present in data hash assertions. However, for those formats that are "box like" but not compatible with BMFF, the <a href="#_general_boxes_hash">general box hash</a> assertion is recommended.</p>
</div>
<div class="paragraph">
<p>The data hash assertion supports the creation and storage of hashes as described in <a href="#_hashing">Section 11.3.4.2, &#8220;Hashing&#8221;</a>, and the value shall be present in the <code>hash</code> field.</p>
</div>
<div class="paragraph">
<p>Each data hash assertion defines a specified range of bytes over which the hash has been computed. If only a portion of the asset shall be hashed, then the range(s) to be excluded shall be present in the array value of the <code>exclusions</code> field.</p>
</div>
<div class="paragraph">
<p>A previous version of this specification provided a <code>url</code> field to provide a pointer to where the hashed data can be located, but it was never used. This field is now deprecated in favour of the <a href="#_asset_reference">asset reference assertion</a>. Claim generators shall not add this field to a data hash assertion, and consumers shall ignore the field when present, except this shall not affect inclusion of the field as part of the content being validated as described in <a href="#_assertion_validation">Section 15.7.3, &#8220;Assertion Validation&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>A Data Hash assertion shall have a label of <code>c2pa.hash.data</code>.</p>
</div>
<div class="paragraph">
<p>A Data Hash assertion must not appear in a <a href="#_cloud_data">cloud data assertion</a>.</p>
</div>
<div class="sect3">
<h4 id="_schema_and_example_3"><a class="anchor" href="#_schema_and_example_3"></a>18.5.1. Schema and Example</h4>
<div class="paragraph">
<p>The schema for this type is defined by the <code>data-hash-map</code> rule in the following <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; Also check optionality within the hash-map
; The data structure used to store the cryptographic hash of some or all of the asset's data 
; and additional information required to compute the hash.
data-hash-map = {
  ? "exclusions": [1* EXCLUSION_RANGE-map],
  ? "alg":tstr .size (1..max-tstr-length), ; A string identifying the cryptographic hash algorithm used to compute the hash in this assertion, taken from the C2PA hash algorithm identifier list. If this field is absent, the hash algorithm is taken the `alg` value of the enclosing structure. If both are present, the field in this structure is used. If no value is present in any of these places, this structure is invalid; there is no default.
  "hash": bstr, ; byte string of the hash value
  "pad": bstr, ; zero-filled byte string used for filling up space
  ? "pad2": bstr, ; optional zero-filled byte string used for filling up space
  ? "name": tstr .size (1..max-tstr-length), ; (optional) a human-readable description of what this hash cover
  ? "url": uri, ; Unused and deprecated. Claim generators shall not add this field and consumers shall ignore it if present.
}

EXCLUSION_RANGE-map = {
  "start": int, ; Starting byte of the range
  "length": int, ; Number of bytes of data to exclude
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{
  "alg" : "sha256",
  "pad" : '0000',
  "hash": 'Auxjtmax46cC2N3Y9aFmBO9Jfay8LEwJWzBUtZ0sUM8gA=',
  "name": "JUMBF manifest"
  "exclusions": [ 
    {
      "start": 9960,
      "length": 4213
    } 
  ],
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Normally, the <code>start</code> and <code>length</code> values of an <code>exclusion</code> shall be written in their preferred serialization (i.e., "as short as possible"). However, when a data hash assertion needs to be created but the <code>start</code> and <code>length</code> values are not yet known, they shall be created "as large as possible", which would be as a 32-bit integer.</p>
</div>
<div class="paragraph">
<p>The <code>pad</code> value shall always be present but shall be a zero-filled byte string of length 0 unless used to replace (i.e., "pad") bytes during multiple pass processing. <code>pad2</code> is an optional zero-filled byte string that is used if the desired padding cannot be achieved with <code>pad</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<a href="#_multiple_step_processing">Section 10.4, &#8220;Multiple Step Processing&#8221;</a> describes how to fill in the correct values and adjust the padding.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_special_consideration_for_jpeg_1"><a class="anchor" href="#_special_consideration_for_jpeg_1"></a>18.5.2. Special consideration for JPEG-1</h4>
<div class="paragraph">
<p>When hashing a JPEG-1 (.jpg) file into which the C2PA Manifest will be embedded, the APP11 marker (<code>FFEB</code>)  and the segment&#8217;s length (<code>Lp</code>) of all APP11 segments containing the JUMBF data shall be included in the exclusion range.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All the APP11 segments containing the C2PA Manifest JUMBF are contiguous so that only a single range is required.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_special_consideration_for_png"><a class="anchor" href="#_special_consideration_for_png"></a>18.5.3. Special consideration for PNG</h4>
<div class="paragraph">
<p>When hashing a PNG (.png) file into which the C2PA Manifest will be embedded, it is important that the <code>Length</code> and the <code>'caBX'</code> (representing the chunk type) of the chunk containing the JUMBF data be included in the exclusion range.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bmff_based_hash"><a class="anchor" href="#_bmff_based_hash"></a>18.6. BMFF-Based Hash</h3>
<div class="paragraph">
<p>Portion(s) of a BMFF-based asset that a claim generator wishes to uniquely identify with a hard binding (i.e., cryptographic hash) shall be described using BMFF-based hash assertions.</p>
</div>
<div class="paragraph">
<p>A BMFF-based hash assertion shall have a label of <code>c2pa.hash.bmff.v2</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Earlier versions of this standard also documented a <code>c2pa.hash.bmff</code> assertion.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A validator or consumer shall not validate content authenticated by a <code>c2pa.hash.bmff</code> assertion. Instead, it shall report the content as unauthenticated, as if no manifest were present.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A BMFF-based hash assertion must not appear in a <a href="#_cloud_data">cloud data assertion</a>.</p>
</div>
<div class="paragraph">
<p>A previous version of this specification provided a <code>url</code> field to provide a pointer to where the hashed data can be located, but it was never used. This field is now deprecated in favor of the <a href="#_asset_reference">asset reference assertion</a>. Claim generators shall not add this field to a BMFF hash assertion, and consumers shall ignore the field when present, except this shall not affect inclusion of the field as part of the content being validated as described in <a href="#_assertion_validation">Section 15.7.3, &#8220;Assertion Validation&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>To compute the hash specified in the value field of a BMFF hash, all bytes of the file are added to the hash excluding those BMFF boxes or subset[s] thereof which match any exclusion entry in the exclusions array.</p>
</div>
<div class="paragraph">
<p>Boxes that are included in their entirety also include their box headers in the input data contributed to the hash.  Similarly, boxes that are excluded in their entirety also exclude their box headers from the input data contributed to the hash.  When a box is partially excluded from the input data contributed to the hash through the use of a <code>subset</code> field in the exclusion specification, the portion(s) of the box to be excluded defined by the relative byte offsets in the <code>subset</code> field are offsets from the start of the box including the box headers, not offsets from the start of the box&#8217;s content.</p>
</div>
<div class="paragraph">
<p>In a <code>c2pa.hash.bmff.v2</code> assertion, for any root box not excluded in its entirety, the input data contributed to the hash for that box is comprised of the concatenation of the binary strings <code>offset || data</code>, where <code>offset</code> is defined as the absolute file offset of the box as an 8-byte integer in big-endian format, and <code>data</code> is defined as the box&#8217;s contents, including headers, minus any exclusions. In this definition, "||" represents the binary concatenation of the two.  The offset shall not be included for Merkle tree hashes when the bmff-hash-map includes both the <code>hash</code> and <code>merkle</code> fields.</p>
</div>
<div class="paragraph">
<p>In addition, a <code>c2pa.hash.bmff.v2</code> assertion includes the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The absolute file byte offset is included at the start of the input data contributed to the hash for any root box.  This ensures that a root box included in the hash cannot change positions in the file.</p>
</li>
<li>
<p>The <code>mdat</code> box is no longer excluded in its entirety when the bmff-hash-map includes both the <code>hash</code> and <code>merkle</code> fields.  Instead, a mandatory entry on the exclusion list excludes most of the box.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
These two features ensure that the <code>mdat</code> cannot change positions in the file while also eliminating the need for the offset for each individual Merkle tree hash when the bmff-hash-map includes both the <code>hash</code> and <code>merkle</code> fields.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A box matches an exclusion entry in the exclusions array if and only if all of the following conditions are met.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The box&#8217;s location in the file exactly matches the <code>exclusions-map</code> entry&#8217;s <code>xpath</code> field.</p>
</li>
<li>
<p>If <code>length</code> is specified in the <code>exclusions-map</code> entry, the box&#8217;s length exactly matches the <code>exclusions-map</code> entry&#8217;s <code>length</code> field.  Note: The length includes the box headers.</p>
</li>
<li>
<p>If <code>version</code> is specified in the <code>exclusions-map</code> entry, the box is a FullBox and the box&#8217;s version exactly matches the <code>exclusions-map</code> entry&#8217;s <code>version</code> field.</p>
</li>
<li>
<p>If <code>flags</code> (byte array of exactly 3 bytes) is specified in the <code>exclusions-map</code> entry and the box is a FullBox.  If <code>exact</code> is set to true or not specified, the box&#8217;s flags (bit(24), i.e., 3 bytes) also exactly matches the <code>exclusions-map</code> entry&#8217;s <code>flags</code> field.  If <code>exact</code> is set to false, the bitwise-and of the box&#8217;s flags (bit(24), i.e., 3 bytes) with the <code>exclusions-map</code> entry&#8217;s <code>flags</code> field exactly matches the <code>exclusions-map</code> entry&#8217;s <code>flags</code> field (i.e., the box has at least those bits set but may also have additional bits set).</p>
</li>
<li>
<p>If <code>data</code> (array of objects) is specified in the <code>exclusions-map</code> entry, then for each item in the array, the box&#8217;s binary data at that item&#8217;s relative byte <code>offset</code> field exactly matches that item&#8217;s <code>bytes</code> field.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>xpath</code> field&#8217;s string syntax shall be limited to the following strict subset.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Only abbreviated syntax shall be used.</p>
</li>
<li>
<p>Only full paths shall be used.</p>
</li>
<li>
<p>Only node selection via <code>node</code> or <code>node[integer]</code> shall be used.</p>
</li>
<li>
<p>Descendent syntax, i.e., <code>//</code>, shall NOT be used.</p>
</li>
<li>
<p>All nodes shall be BMFF <code>4cc</code> codes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Complete Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">  xpath = '/' nodes
  nodes = node
        | node '/' nodes
  node = box4cc
       | box4cc '[' integer ']'
Where:
  box4cc is any 4cc allowed by ISO/IEC 14496-12 for a BMFF box.
  integer is any non-zero positive integer with no leading zeros.</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Any given exclusion entry may match zero or more boxes. It is not required that an exclusion entry match exactly one box.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A non-leaf xpath node shall only point to a container box that has no fields of its own (i.e., contains no data, only child boxes) and that does not inherit from FullBox.  This ensures that a C2PA validator does not need to be aware of the syntax and semantics of unusual boxes that contain other boxes.  If a child box of such an unusual box needs to be excluded in full or in part, the <code>exclusions-map</code> entry&#8217;s <code>xpath</code> field shall point to the unusual box itself and the <code>subset-map</code> field shall exclude the byte rang(es) containing the excluded child box data.  For example, the <code>'sgpd'</code> box contains other boxes but is unusual in that it inherits from FullBox; as such, if excluding child box(es), in whole or in part, from <code>'sgpd'</code> is required, the assertion shall use an <code>xpath</code> field pointing to the <code>'sgpd'</code> itself (e.g., <code>/moof/traf/sgpd</code>) and shall use the <code>subset-map</code> field to exclude the desired bytes.</p>
</div>
<div class="paragraph">
<p>If the C2PA Manifest is embedded into the file, the box containing it shall be one of the entries in the exclusions array.  Refer to <a href="#_embedding_manifests_into_bmff_based_assets">Section 11.3.3, &#8220;Embedding manifests into BMFF-based assets&#8221;</a> for more information.</p>
</div>
<div class="paragraph">
<p>If a non-root excluded box is removed after the C2PA Manifest is created, it shall be replaced with a <code>'free'</code> box of the same size to ensure that the input data contributed to the hash for other boxes are not invalidated.  If it is expected that a non-root excluded box may be added after the C2PA Manifest is created, then, at manifest creation time, a <code>'free'</code> box shall be inserted with sufficient space for the excluded box and that <code>'free'</code> box shall also be excluded by an exclusion entry using its full xpath.  When the excluded box is added, the <code>'free'</code> box shall be shrunk (or removed) to make space for the added box.</p>
</div>
<div class="paragraph">
<p>Embedding C2PA data into a BMFF-based asset via MP4 boxes changes file offsets in other MP4 boxes as well as the absolute file byte offsets being included in the input data contributed to the hash for any root box.  Those boxes and offsets must be included in the input data contributed to the hash with their post-embed values, not their pre-embed values, or the BMFF-based hash assertion will not validate.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Here are two possible ways an implementation can ensure that post-embed values for all file byte offsets are hashed.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use <code>'free'</code> boxes.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Determine reasonable maximum size(s) for the C2PA box(es) which will be embedded.  All MP4 boxes for C2PA support unused padding bytes at the end, so it is fine to overestimate the size for the <code>'free'</code> boxes because any extra bytes will be ignored.</p>
</li>
<li>
<p>Insert <code>'free'</code> box(es) of said size(s) into the asset file(s) and update all offsets appropriately.</p>
</li>
<li>
<p>Perform hashing of the asset with "/free" on the exclusion list.</p>
</li>
<li>
<p>Create and sign the manifest.  Create the C2PA box(es).</p>
</li>
<li>
<p>Overwrite the <code>'free'</code> box(es) with the C2PA box(es).</p>
</li>
</ol>
</div>
</li>
<li>
<p>Use a two-pass approach.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Compute the exact sizes of the BMFF-based hash assertion and the <code>merkle</code> box(es) if any.  The latter will require parsing the asset file(s) to determine the size of the Merkle tree.</p>
</li>
<li>
<p>Compute the exact size of the final manifest.</p>
</li>
<li>
<p>Perform hashing of the asset file(s).  Update any box that includes any file offsets to correct values before including that box in the input data contributed to the hash.  Compute the input data contributed to the hash using <code>(offset || data)</code> using the updated absolute file offset as described above.  As indicated above, the offset is not included in the data contributed for Merkle tree hashes when the bmff-hash-map includes both the <code>hash</code> and <code>merkle</code> fields.</p>
</li>
<li>
<p>Create and sign the manifest.  Create the C2PA box(es).</p>
</li>
<li>
<p>Insert the C2PA box(es).</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>While the latter method is significantly more complex, it does enable correct hashing without any foreknowledge of the maximum manifest size.  It also minimizes the final asset&#8217;s size.
Common boxes (<strong>not</strong> exhaustive) with file offsets include <code>'iloc'</code>, <code>'stco'</code>, <code>'co64'</code>, <code>'tfhd'</code>, <code>'sidx'</code>, and <code>'saio'</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_schema_and_example_4"><a class="anchor" href="#_schema_and_example_4"></a>18.6.1. Schema and Example</h4>
<div class="paragraph">
<p>The schema for <code>c2pa.hash.bmff.v2</code> is defined by the <code>bmff-hash-map</code> rule in the following <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">bmff-hash-map = {
  "exclusions": [1* exclusions-map],
  ? "alg": tstr .size (1..max-tstr-length), ; A string identifying the cryptographic hash algorithm used to compute this hash, taken from the C2PA hash algorithm identifier list. If this field is absent, the hash algorithm is taken from an enclosing structure as defined by that structure. If both are present, the field in this structure is used. If no value is present in any of these places, this structure is invalid; there is no default.
  ? "hash": bstr, ; For non-fragmented MP4, this shall be the hash of the entire BMFF file excluding boxes listed in the exclusions array.  For `c2pa.hash.bmff` (deprecated) assertions, if the merkle field is present, this hash also excludes all 'mdat' boxes.  For fragmented MP4, this field is required to be absent.
  ? "merkle": [1* merkle-map], ; A set of Merkle tree rows and the associated data required to enable verification of a single 'mdat' box, multiple 'mdat' boxes, and/or individual fragment files within the asset.
  ? "name": tstr .size (1..max-tstr-length), ; optional) a human-readable description of what this hash covers.
  ? "url": uri, ; Unused and deprecated. Claim generators shall not add this field and consumers shall ignore it if present.
}

;(optional) CBOR byte string of exactly 3 bytes.
flag-type = bytes

flag-t = flag-type .eq 3

exclusions-map = {
  "xpath": tstr, ; Location of box(es) to exclude from the hash starting from the root node as an xpath formatted string of version https://www.w3.org/TR/xpath-10/ with highly constrained syntax.
  ? "length": int, ; (optional) Length that a leafmost box must have to exclude from the hash.
  ? "data": [1* data-map], ; (optional) The data in the leafmost box at the specified relative byte offset must be identical to the specified data for the box to be excluded from the hash.
  ? "subset":[1* subset-map], ; (optional) Only this portion of the excluded box shall be excluded from the hash.  Each entry in the array must have a monotonically increasing relative byte offset.  No subset within the array may overlap.  The last entry may have a length of zero; this indicates that the remainder of the box from that relative byte offset onward is excluded.  A relative byte offset or relative byte offset plus length that exceeds the length of the box is allowed; bytes beyond the end of the box are never hashed.
  ? "version": int, ; (optional) Version that must be set in a leafmost box for the box to be excluded from the hash.  Shall only be specified for a box that inherits from FullBox.
  ? "flags": flag-t,  ; (optional) byte string of exactly 3 bytes.  The 24-bit flags that must be set in a leafmost box for the box to be excluded from the hash.  Shall only be specified for a box that inherits from FullBox.
  ? "exact": bool, ; (optional) indicates that flags must be an exact match.  If not specified, defaults to true.  Shall only be specified for a box that inherits from FullBox and when flags is also specified.
}

data-map = {
  "offset": int,
  "value" : bstr,
}
subset-map = {
  "offset": int,
  "length": int,
}

; Each entry in a map is a Merkle tree rows and the associated data required to enable validation of a single
; 'mdat' box or multiple 'mdat' boxes within the asset.",
merkle-map = {
  "uniqueId": int, ; 1-based unique id used to differentiate across files to determine which Merkle tree should be used to validate a given 'mdat' box.
  "localId": int, ; Local id used to differentiate across multiple 'mdat' boxes within a single file to determine which Merkle tree should be used to validate that 'mdat' box.
  "count": int, ; Number of leaf nodes in the Merkle tree.  Null nodes are not included in this count.
  ? "alg": tstr .size (1..max-tstr-length), ; A string identifying the cryptographic hash algorithm used to compute the hashes in this Merkle tree, taken from the C2PA hash algorithm identifier list. If this field is absent, the hash algorithm is taken the `alg` value of the enclosing structure as defined by that structure. If both are present, the field in this structure is used. If no value is present in any of these places, this structure is invalid; there is no default.
  ? "initHash": bstr, ; For fragmented MP4 assets which are split across multiple files, this field is required to be present and shall be the hash of the entire initialization segment file for chunks hashed by this Merkle tree excluding boxes listed in the exclusions array.  For fragmented MP4 assets which are stored as a single flat MP4 file, this field is required to be present and shall be the hash of all bytes preceding the first 'moof' box excluding boxes listed in the exclusions array.  For non-fragmented MP4, this field is required to be absent.
  "hashes": [1* bstr], ; An ordered array representing a single row of the Merkle tree which may be the leaf-most row, root row, or any intermediate row.  The depth of the row is implied by (shall be computed from) the number of items in this array.
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) for a monolithic MP4 file asset where the <code>mdat</code> box is validated as a unit is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{
  "hash": b64'EiAuxjtmax46cC2N3Y9aFmBO9Jfay8LEwJWzBUtZ0sUM8gA=',
  "name": "Example `c2pa.hash.bmff.v2` assertion",
  "exclusions": [
    {
      "data": [
        {
          "value": b64'2P7D1hsOSDySl1goh37EgQ==',
          "offset": 8
        }
      ],
      "xpath": "/uuid"
    },
    {
      "xpath": "/ftyp"
    },
    {
      "xpath": "/mfra"
    },
    {
      "xpath": "/moov[1]/pssh"
    },
    {
      "xpath": "/emsg",
      "data": [
        {
          "value": b64'r3avWCpXHkmKHATFsV0Q5g==',
          "offset": 20
        }
      ]
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) for an asset composed of fragmented MP4 files is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{
  "alg": "sha256",
  "name": "Example `c2pa.hash.bmff.v2` assertion for fMP4",
  "merkle": [
    {
      "count": 23,
      "hashes": [ b64'HvWZOxKMfkSatRAygs8DJfnEEcN/G1BNi359NdIDxbQ=', b64'HvWZOxKMfkSatRAygs8DJfnEEcN/G1BNi359NdIDxbQ=' ],
      "localId": 19,
      "initHash": b64'Hf0IgeqbL0m+FTTLpUWwsDGR8pvhUR1AlwvaXjQ0qGY=',
      "uniqueId": 17
    },
    {
      "count": 69,
      "hashes": [ b64'9Zk7Eox+RJq1EDKCzwMl+cQRw38bUE2Lfn010gPFtB0=', b64'9Zk7Eox+RJq1EDKCzwMl+cQRw38bUE2Lfn010gPFtB0=', b64'mTsSjH5EmrUQMoLPAyX5xBHDfxtQTYt+fTXSA8W0Hf0=', b64'mTsSjH5EmrUQMoLPAyX5xBHDfxtQTYt+fTXSA8W0Hf0=', b64'OxKMfkSatRAygs8DJfnEEcN/G1BNi359NdIDxbQd/Qg=' ],
      "localId": 38,
      "initHash": b64'Hf0IgeqbL0m+FTTLpUWwsDGR8pvhUR1AlwvaXjQ0qGY=',
      "uniqueId": 34
    },
    {
      "count": 46,
      "hashes": [ b64'OxKMfkSatRAygs8DJfnEEcN/G1BNi359NdIDxbQd/Qg=' ],
      "localId": 57,
      "initHash": b64'Hf0IgeqbL0m+FTTLpUWwsDGR8pvhUR1AlwvaXjQ0qGY=',
      "uniqueId": 51
    }
  ],
  "exclusions": [
    {
      "data": [
        {
          "value": b64'2P7D1hsOSDySl1goh37EgQ==',
          "offset": 8
        }
      ],
      "xpath": "/uuid"
    },
    {
      "xpath": "/ftyp"
    },
    {
      "xpath": "/mfra"
    },
    {
      "xpath": "/moov[1]/pssh"
    },
    {
      "data": [
        {
          "value": b64'9Q==',
          "offset": 5
        },
        {
          "value": b64'UAJXD79SlkG9rfnmcsqTUA==',
          "offset": 20
        },
        {
          "value": b64'OxKM',
          "offset": 70
        }
      ],
      "flags": b64'ZDNx',
      "xpath": "/emsg",
      "length": 200,
      "subset": [
        {
          "length": 7,
          "offset": 5
        },
        {
          "length": 28,
          "offset": 20
        },
        {
          "length": 63,
          "offset": 45
        },
        {
          "length": 112,
          "offset": 80
        }
      ],
      "version": 1
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A pseudo-code implementation of this algorithm follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">offset = 0
While (offset &lt; length of file)
	Starting at offset, locate the first byte of the first box that matches any entry in the exclusions array, call this first_excluded_byte
		If no such box is found, set first_excluded_byte = length of file
	Determine the length of that box, call this excluded_byte_count
		If no such box was found, set excluded_byte_count = 0
	To the hash, add all bytes between offset and first_excluded_byte minus one (inclusive)
	If first_excluded_byte &lt; length of file and there exists a subset array within the exclusion that determined the value of first_excluded_byte
		set next_included_begin = first_excluded_byte
		For each entry in the subset array within the exclusion that determined the value of first_excluded_byte
			Set next_excluded_begin = this subset array entry's offset field plus first_excluded_byte
			If next_excluded_begin &gt; next_included_begin
				To the hash, add all bytes between next_included_begin and next_excluded_begin minus one (inclusive)
			Set next_included_begin  = this subset array entry's length field plus next_excluded_begin
		If next_included_begin &lt; first_excluded_byte + excluded_byte_count
			To the hash, add all bytes between next_included_begin and first_excluded_byte + excluded_byte_count minus one (inclusive)
	Set offset = first_excluded_byte + excluded_byte_count</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_exclusion_list_profiles"><a class="anchor" href="#_exclusion_list_profiles"></a>18.6.2. Exclusion list profiles</h4>
<div class="sect4">
<h5 id="_basic_profile"><a class="anchor" href="#_basic_profile"></a>18.6.2.1. Basic profile</h5>
<div class="paragraph">
<p>Typical untimed media (e.g., still photos) and timed media (e.g., videos with or without audio tracks, whether fragmented or not) need only include the mandatory exclusions listed in <a href="#_exclusion_list_requirements">Exclusion List Requirements</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Editor&#8217;s Note</div>
<div class="paragraph">
<p>Additional recommended exclusions for other types of media should be added here as needed.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_general_boxes_hash"><a class="anchor" href="#_general_boxes_hash"></a>18.7. General Boxes Hash</h3>
<div class="paragraph">
<p>A claim generator should use a general box hash assertion to verify the integrity, with a hard binding (i.e., cryptographic hash), of assets whose formats use a non-BMFF-based box format such as JPEG, PNG, or GIF.</p>
</div>
<div class="paragraph">
<p>A general box hash assertion shall have a label of <code>c2pa.hash.boxes</code>.  Such an assertion consists of an array of structures, each one listing one or more boxes (by their name/identifier) and a hash that covers that data of those boxes (and any possible data that may be present in the file between them), along with the algorithm used for hashing. The boxes must appear in the assertion in the same order that they appear in the asset, including the box containing the C2PA Manifest. If there are any other boxes present in the asset, or if the boxes appear out of order the manifest will be rejected during validation as described in <a href="#_validating_a_general_box_hash">Section 15.10.3, &#8220;Validating a general box hash&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>The creation of the hashes is described in <a href="#_hashing">Section 11.3.4.2, &#8220;Hashing&#8221;</a>, and the value shall be present in the <code>hash</code> field. The hash value for a range of boxes shall be computed from the start of the first box (in the range) until the end of the last box (in the range).  This would include any arbitrary bytes that may be present between boxes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When using a range of boxes, all data between the start of the first box and the end of the last box is included in the hash. However, when listing each box separately, additional data is not included, only data within the listed box.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The box containing the C2PA Manifest (e.g. <code>APP11</code> for JPEG, <code>caBX</code> for PNG, or <code>21FF</code> for GIF) shall also be listed, but in order to clearly identify it as the C2PA Manifest box, it shall have the name <code>C2PA</code> and the value of <code>hash</code> shall be the binary string <code>0</code> (a single byte with a value of 0).</p>
</div>
<div class="paragraph">
<p>The <code>pad</code> value shall always be present and shall be a zero-filled byte string unless it was replaced by something else during multiple pass processing, in which case no <code>pad</code> shall be present.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<a href="#_multiple_step_processing">Section 10.4, &#8220;Multiple Step Processing&#8221;</a> describes how to fill in the correct values and adjust the padding.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A General Box Hash assertion shall not appear in a <a href="#_cloud_data">Cloud Data assertion</a>.</p>
</div>
<div class="sect3">
<h4 id="_handling_for_specific_formats"><a class="anchor" href="#_handling_for_specific_formats"></a>18.7.1. Handling for specific formats</h4>
<div class="sect4">
<h5 id="_jpeg_specific_handling"><a class="anchor" href="#_jpeg_specific_handling"></a>18.7.1.1. JPEG-specific Handling</h5>
<div class="paragraph">
<p>When working with JPEG, the <code>APP11</code> box is used for standards other than C2PA (i.e., JPEG 360). In those situations, all non-C2PA <code>APP11</code> boxes shall be included in the list of hashed boxes.  The <code>APP11</code> boxes containing the C2PA Manifest Store shall be identified by <code>C2PA</code>. All other boxes shall be identified by the symbol found in <a href="https://www.iso.org/standard/18902.html">ISO 10918-1:1994, Table B.1</a>.</p>
</div>
<div class="paragraph">
<p>The C2PA Manifest Store can be identified by it being a JUMBF superbox with a label of <code>c2pa</code> and a UUID of <code>0x63327061-0011-0010-8000-00AA00389B71</code>  as described in <a href="#_manifest_store">Section 11.1.4.2, &#8220;Manifest Store&#8221;</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Start of Scan box and Restart boxes, label of <code>SOS</code> and <code>RST[n]</code>, will include the entropy coded segments following the respective marker.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <a href="https://www.cipa.jp/e/std/std-sec.html">Multi-Picture Format (MPF)</a> extension to JPEG can also be supported using this method by listing all boxes contained in the file as they appear.</p>
</div>
</div>
<div class="sect4">
<h5 id="_png_specific_handling"><a class="anchor" href="#_png_specific_handling"></a>18.7.1.2. PNG-specific Handling</h5>
<div class="paragraph">
<p>A PNG file always begins with an 8 byte header (<code>89 50 4E 47 0D 0A 1A 0A</code>). Including this in the hash will improve the integrity of the image. To include it, use the special value <code>PNGh</code> as the first box in the list of boxes and start hashing from the first byte of the image.</p>
</div>
</div>
<div class="sect4">
<h5 id="_tiff_specific_handling"><a class="anchor" href="#_tiff_specific_handling"></a>18.7.1.3. TIFF-specific Handling</h5>
<div class="paragraph">
<p>A TIFF file always begins with an 8 byte header. Including this in the hash will improve the integrity of the image. To include it, use the special value <code>TIFh</code> as the first box in the list of boxes.</p>
</div>
<div class="paragraph">
<p>A TIFF file consists of one or more IFDs (image file directories) which are equivalent to "super boxes". Each IFD contains an array of entries called either 'IFD entries' or 'TIFF fields' which represent the "boxes". The <code>box-name</code> for each IFD entry shall be the value of the <code>Tag</code> field converted into a string of its decimal value.</p>
</div>
<div class="paragraph">
<p>Unlike other box-like formats, the data of an IFD entry may not be contained within the entry (unless it is 4 bytes in length or smaller) but instead will exist elsewhere in the file.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The length of the data of an IFD entry is determined by multiplying the number of data values (as determined in the <code>Count</code> field in the IFD entry) by the size each data value (as determined by the <code>Type</code> field in the IFD entry).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The hash of an IFD entry shall be computed over the 12 bytes of the IFD entry. If the length of the IFD entry is more than 4 bytes, then the hash shall be computed from the concatenation of those 12 bytes with the bytes of the file referenced by the entry starting at the byte offset specified in the <code>Value Offset</code> field of the IFD entry and going for the length of the data.</p>
</div>
<div class="paragraph">
<p>For some well known IFD entries - <code>StripOffsets</code> (273), <code>TileOffsets</code> (324), and <code>FreeOffsets</code> (288) - the data referenced by the IFD entry is itself a list of offsets to the actual data. In these cases, the data over which the hash is computed shall be the concatenation of the following in the order given:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The 12 bytes of the IFD,</p>
</li>
<li>
<p>The bytes starting at <code>Value Offset</code> of length <code>Count</code> times the size of <code>Type</code> containing the offsets, and</p>
</li>
<li>
<p>For each offset in the order it appears, the bytes at that offset, with the length given by the type&#8217;s associated byte count entry: <code>StripByteCounts</code> (279), <code>TileByteCounts</code> (325) and  <code>FreeByteCounts</code> (289), respectively.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The image data in a TIFF would therefore be hashed through this combination of "offsets" and "byte counts".
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>TIFF also supports SubIFDs, an IFD type that points to and therefore incorporates one or more IFDs by reference. These include not only the type called <code>SubIFD</code> (330), but also <code>EXIF</code> (34665), <code>GPS</code> (34853), and <code>Interoperability</code> (40965). For all of these IFD types, and any other IFD types which reference other IFDs in this manner, the data over which the hash is computed shall be the concatenation of the following in the order given:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The 12 bytes of the IFD,</p>
</li>
<li>
<p>Either:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If <code>N = 1</code>, the bytes starting at <code>Value Offset</code> of length of the size of <code>Type</code> containing the offset of the referenced IFD, or</p>
</li>
<li>
<p>If <code>N &gt; 1</code>, the bytes starting at <code>Value Offset</code> of length of the size of <code>Type</code> containing the offset to the array of IFD offsets, concatenated with the bytes starting at that offset of length <code>Count</code> times the size of <code>Type</code> which contain the offsets to each "treed" IFD.</p>
</li>
</ol>
</div>
</li>
<li>
<p>For each referenced IFD, recursively compute the data for the hash for that IFD at that offset as specified in this section.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_gif_specific_handling"><a class="anchor" href="#_gif_specific_handling"></a>18.7.1.4. GIF-specific Handling</h5>
<div class="paragraph">
<p>The hash of a box containing a 'Packed Fields' attribute will also hash the optional data indicated by that attribute. For example, The Image Descriptor will include the Local Color Table block, and the Logical Screen Descriptor will include the Global Color Table block, if they exist.</p>
</div>
<div class="paragraph">
<p>For all boxes containing a block label, the naming convention shall be as follows: "&lt;Block Label&gt;".</p>
</div>
<div class="paragraph">
<p>For all extension blocks, the naming convention is as follows: "&lt;Extension Introducer&gt;&lt;Extension Label&gt;".</p>
</div>
<div class="paragraph">
<p>The only other blocks that are not described by the above naming convention are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The header will be marked with "GIF89a".</p>
</li>
<li>
<p>The Table Based Image Data will be marked with "TBID"</p>
</li>
<li>
<p>The Logical Screen Descriptor will be marked with "LSD"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Header: "GIF89a"</p>
</li>
<li>
<p>Trailer: "3B"</p>
</li>
<li>
<p>Image Descriptor: "2C"</p>
</li>
<li>
<p>Comment Extension: "21FE"</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_font_specific_handling"><a class="anchor" href="#_font_specific_handling"></a>18.7.1.5. Font-specific Handling</h5>
<div class="paragraph">
<p>The tables of a font correspond directly to the hash boxes, including the <code>C2PA</code> table.</p>
</div>
<div class="paragraph">
<p>Tables are always enumerated in the order they appear in the font&#8217;s table directory.</p>
</div>
<div class="paragraph">
<p>Note that the table directory itself is not part of the hashed content, and therefore not covered by any box.</p>
</div>
<div class="paragraph">
<p>The <code>checkSumAdjustment</code> value must be treated as zero (<code>0</code>) when computing the hash for the box containing the <code>head</code> table.</p>
</div>
<div class="paragraph">
<p>The grouping, or lack thereof, of Font tables in the generic box hash assertion is up to the claim generator.</p>
</div>
<div class="paragraph">
<p>Note: Fonts created for wide distribution may benefit from assigning each table
to an individual box; in this way, if the font is re-packaged in another format,
its hash will continue to validate correctly. By contrast, systems which
generate large numbers of fonts automatically, such as a subsetter, may choose
to combine tables into fewer boxes to streamline processing. In this case,
the box hash(es) may not validate following a format transformation, due to the
inclusion of inter-table padding.</p>
</div>
<div class="paragraph">
<p>Because font consumers must not react to tables they do not recognize, existing font-handling infrastructure will expect that the <code>head</code> table&#8217;s <code>checkSumAdjustment</code> value incorporate the final settled content of the <code>C2PA</code> table itself, including any local manifest in its entirety.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_schema_and_example_5"><a class="anchor" href="#_schema_and_example_5"></a>18.7.2. Schema and Example</h4>
<div class="paragraph">
<p>The schema for this type is defined by the <code>box-map</code> rule in the following <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">box-map = {
  "boxes": [1* box-hash-map],
  ? "alg":tstr .size (1..max-tstr-length), ; A string identifying the cryptographic hash algorithm used to compute the hash in this assertion, taken from the C2PA hash algorithm identifier list. If this field is absent, the hash algorithm is taken the `alg` value of the enclosing structure. If both are present, the field in this structure is used. If no value is present in any of these places, this structure is invalid; there is no default.
}

box-hash-map = {
  "names": [1* box-name], ; An array of strings representing the box identifiers in order of appearance (e.g., `APP0`, `IHDR`)
  ? "alg": tstr .size (1..max-tstr-length), ; A string identifying the cryptographic hash algorithm used to compute the hash in this assertion, taken from the C2PA hash algorithm identifier list. If this field is absent, the hash algorithm is taken the `alg` value of the enclosing structure. If both are present, the field in this structure is used. If no value is present in any of these places, this structure is invalid; there is no default.
  "hash": bstr, ; byte string of the hash value
  "pad": bstr, ; zero-filled byte string used for filling up space
}

box-name /= tstr .size (1..10)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Five examples in CBOR Diagnostic Format (<code>.cbordiag</code>) are shown below:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>JPEG</p>
</li>
<li>
<p>PNG</p>
</li>
<li>
<p>GIF</p>
</li>
<li>
<p>DNG (TIFF), with a SubIFD</p>
</li>
<li>
<p>TTF</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">// JPEG Example //
{
  	"alg" : "sha256",
	"boxes": [
		{
			"names" : ["SOI", "APP0", "APP2"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["C2PA"],
			"hash" : 0,
			"pad" : b64'',
		},
		{
			"names" : ["DQT", "SOF0", "DHT", "SOS", "RST0", "RST1", "EOI"],
			"hash" : b64'...',
			"pad" : b64'',
		}
	]
}

// PNG Example //
{
  	"alg" : "sha256",
	"boxes": [
		{
			"names" : ["PNGh", "IHDR"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["C2PA"],
			"hash" : 0,
			"pad" : b64'',
		},
		{
			"names" : ["sBIT"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["zTXt"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["IDAT", "IEND"],
			"hash" : b64'...',
			"pad" : b64'',
		}
	]
}

// GIF Example //
{
  	"alg" : "sha256",
	"boxes": [
		{
			"names" : ["GIF89a", "LSD"]
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["2C", "TBID", "2C", "TBID"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["21FE"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["21F9"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["3B"],
			"hash" : b64'...',
			"pad" : b64'',
		},
	]
}

// TIFF/DNG Example //
{
  	"alg" : "sha256",
	"boxes": [
		{
			"names" : ["TIFh", "254", "256", "257", "258", "259", "262"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["273", "277", "278", "279", "284"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			// this is a SubIFD containing a secondary image //
			"names" : ["330", "254", "256", "257", "258", "259", "262", "277", "278", "279", "284"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["700", "34665"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["C2PA"],
			"hash" : 0,
			"pad" : b64'',
		}
	]
}

// TTF Example //
{
  	"alg" : "sha256",
	"boxes": [
		{
			"names" : ["C2PA"],
			"hash" : 0,
			"pad" : b64'',
		},
		{
			"names" : ["PCLT"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["cmap"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["cvt"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["fpgm"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["gasp"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["glyf"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["head"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["hhea"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["hmtx"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["loca"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["maxp"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["name"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["post"],
			"hash" : b64'...',
			"pad" : b64'',
		},
		{
			"names" : ["prep"],
			"hash" : b64'...',
			"pad" : b64'',
		}
	]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_collection_data_hash"><a class="anchor" href="#_collection_data_hash"></a>18.8. Collection Data Hash</h3>
<div class="paragraph">
<p>In workflows where it is known in advance that the C2PA Manifest will refer to a collection of assets, instead of a single asset, the collection data hash assertion is used as the method to specify the hard bindings (i.e., cryptographic hashes) for the assets in the collection.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If it is desired to describe each folder of the training data set of an AI/ML model, it could be done by having each folder be a separate ingredient of the complete training data set&#8217;s manifest.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A collection data hash assertion shall have a label of <code>c2pa.hash.collection.data</code>.</p>
</div>
<div class="paragraph">
<p>A collection data hash assertion shall not appear in a <a href="#_cloud_data">cloud data assertion</a>.</p>
</div>
<div class="sect3">
<h4 id="_schema_and_example_6"><a class="anchor" href="#_schema_and_example_6"></a>18.8.1. Schema and Example</h4>
<div class="paragraph">
<p>The schema for this type is defined by the <code>collection-data-hash-map</code> rule in the following <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; An array of URIs and their associated hashes
$collection-data-hash-map /= {
  "uris": [1* uri-hashed-data-map],
  "alg": tstr .size (1..max-tstr-length), ; A string identifying the cryptographic hash algorithm used to compute the hash on each entry of the `uris` array, taken from the C2PA hash algorithm identifier list. 
	? "zip_central_directory_hash" : bstr,
	}
}

; The data structure used to store a reference to a URI and its hash. 
$uri-hashed-data-map /= {
  "uri": relative-url-regexp-type, ; relative URI reference
  "hash": bstr, ;  byte string containing the hash value
  ? "size": size-type, ; Number of bytes of data
  ? "dc:format": format-string, ; IANA media type of the data
  ? "data_types": [1* $asset-type-map],  ; additional information about the data's type
}

; with CBOR Head (#) and tail ($) are introduced in regexp, so not needed explicitly
relative-url-regexp-type  /= tstr .regexp "[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b[-a-zA-Z0-9@:%_\\+.~#?&amp;//=]*"</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">// example of a list of remote URLs //
{
	"alg" : "sha256",
	"uris": [
		{
			"uri": "photos/id/870.jpg"
			"hash": b64'+ddHMTUUEpuSF6dNaHFa9uFc1sSnY+O3l3MMPFvX5Ws=',
			"dc:format": "image/jpeg"
		},
		{
			"url": "deepmind/bigbigan-resnet50/1",
			"hash" : b64'...',
			"dc:format": "application/octet-stream",
			"data_types": [
				{
					"type": "c2pa.types.generator",
				},
				{
					"type": "c2pa.types.model.tensorflow",
					"version":  "1.0.0",
				},
				{
					"type": "c2pa.types.tensorflow.hubmodule",
					"version":  "1.0.0",
				}
			]
		}
	]
}

// example of a list of (relative) file URIs //
{
	"alg" : "sha256",
	"uris": [
		{
			"uri": "image1.png",
			"hash": b64'U9Gyz05tmpftkoEYP6XYNsMnUbnS/KcktAg2vv7n1n8='
		},
		{
			"uri": "document.pdf",
			"hash": b64'G5hfJwYeWTlflxOhmfCO9xDAK52aKQ+YbKNhRZeq92c='
		},
	]
}

// example of a list of relative paths inside an EPUB (which is a ZIP) //
{
	"alg" : "sha256",
	"uris": [
		{
			"uri": "mimetype"
			"hash": b64'+ZXhhbXBsZSBvZiBhIGxpc3Qgb2YgcmVsYXRpdmUgc8=',
			"dc:format": "text/text"
		},
		{
			"uri": "META-INF/container.xml"
			"hash": b64'+ddHMTUUEpuSF6dNaHFa9uFc1sSnY+O3l3MMPFvX5Ws=',
			"dc:format": "text/xml"
		},
		{
			"uri": "cover_page.svg",
			"hash": b64'U9Gyz05tmpftkoEYP6XYNsMnUbnS/KcktAg2vv7n1n8='
		},
		{
			"uri": "chapter1.html",
			"hash": b64'G5hfJwYeWTlflxOhmfCO9xDAK52aKQ+YbKNhRZeq92c='
		},
	]
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fields"><a class="anchor" href="#_fields"></a>18.8.2. Fields</h4>
<div class="paragraph">
<p>The <code>uris</code> field consists of an array of <code>uri-hashed-data-map</code> values that represents a collection of assets. The <code>alg</code> field, is as described in <a href="#_hashing">Section 11.3.4.2, &#8220;Hashing&#8221;</a> and by having it here ensures that all content items in the list are hashed with the same algorithm.</p>
</div>
<div class="paragraph">
<p>For each <code>uri-hashed-data-map</code>,  the <code>uri</code> field shall be present and shall be a valid relative URI. All URIs shall be considered as relative to the location of the manifest, regardless of whether that is local, in a container (e.g., ZIP) or in the cloud. As a relative URI can contain navigation elements (e.g., <code>../</code>), it is possible to refer to content items that are not in the same folder as the manifest - which would be a security issue.  A claim generator shall validate or sanitize the URIs before use, ensuring that neither <code>.</code> nor <code>..</code> appear as part of the URI.</p>
</div>
<div class="paragraph">
<p>The <code>hash</code> field is a byte string representing of the valid hash value for the content item, as determined by the <code>alg</code> field.  The hash shall be over all bytes (from 0 to n) of the content item - no exceptions.</p>
</div>
<div class="paragraph">
<p>The rest of the fields are identical to those of an <a href="#_ingredient">ingredient assertion</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_hashing_the_members_of_the_collection"><a class="anchor" href="#_hashing_the_members_of_the_collection"></a>18.8.3. Hashing the members of the collection</h4>
<div class="paragraph">
<p>Each file in the collection is hashed individually using the specific hash algorithm defined in the <code>alg</code> field.  The resultant hash value is stored in the <code>hash</code> field of the <code>uri-hashed-data-map</code> associated with the <code>uri</code> to the file.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Not all files in a given hierarchy need to be included in a hashed collection. This is useful in cases where there are files present that aren&#8217;t necessary to hash, but that also provides an opening for an adversary to add files without invalidating the binding.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_soft_binding_2"><a class="anchor" href="#_soft_binding_2"></a>18.9. Soft Binding</h3>
<div class="paragraph">
<p>If a claim generator wishes to provide a soft binding for the asset&#8217;s content, it shall be described using a soft binding assertion. The types of soft bindings which can be created and stored in such an assertion are described in <a href="#_soft_bindings">Section 9.3, &#8220;Soft Bindings&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>A previous version of this specification provided a <code>url</code> field to provide a pointer to where the hashed data can be located, but it was never used. This field is now deprecated in favor of the <a href="#_asset_reference">asset reference assertion</a>. Claim generators shall not add this field to a soft binding assertion, and consumers shall ignore the field when present, except this shall not affect inclusion of the field as part of the content being validated as described in <a href="#_assertion_validation">Section 15.7.3, &#8220;Assertion Validation&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>A soft binding assertion shall have a label of <code>c2pa.soft-binding</code>.</p>
</div>
<div class="sect3">
<h4 id="_schema_and_example_7"><a class="anchor" href="#_schema_and_example_7"></a>18.9.1. Schema and Example</h4>
<div class="paragraph">
<p>The schema for this type is defined by the <code>soft-binding-map</code> rule in the following <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">;The data structure used to store one or more soft bindings across some or all of the asset's content
soft-binding-map = {
  "alg": tstr, ; A string identifying the soft binding algorithm and version of that algorithm used 
              ; to compute the value, taken from the C2PA soft binding algorithm identifier list. If this field is absent, the algorithm is taken from the `softbinding-alg` value of the enclosing structure. If both are present, the field in this structure is used. 
              ; If no value is present in any of these places, this structure is invalid; there is no default.
  "blocks": [1* soft-binding-block-map],
  "pad": bytes, ; zero-filled byte string used for filling up space
  ? "pad2": bytes, ; optional zero-filled byte string used for filling up space
  ? "name": tstr .size (1..max-tstr-length), ; (optional) a human-readable description of what this hash covers
  ? "alg-params": bstr, ; (optional) CBOR byte string describing parameters of the soft binding algorithm. 
                        ; If this field is absent, the algorithm is taken from the `softbinding-alg-params` 
                        ; value of the enclosing structure, if present."
  ? "url": uri, ; Unused and deprecated. Claim generators shall not add this field and consumers shall ignore it if present.
}

soft-binding-block-map = {
  "scope": soft-binding-scope-map,
  "value": bstr, ; CBOR byte string describing, in algorithm specific format, 
                ; the value of the soft binding computed over this block of digital content"
}

soft-binding-scope-map = {
  ? "extent": bstr, ;CBOR byte string describing, in algorithm specific format, 
                    ; the part of the digital content over which the soft binding value has been computed"
  ? "timespan":soft-binding-timespan-map,
}

soft-binding-timespan-map = {
  "start": uint, ; Start of the time range (as milliseconds from media start) over which the soft binding value has been computed.
  "end": uint,   ; End of the time range (as milliseconds from media start) over which the soft binding value has been computed.
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{
  "alg": "phash",
  "pad": h'00',
  "url": 32("http://example.c2pa.org/media.mp4"),
  "blocks": [
    {
      "scope": {
        "extent": b64'c2NvcGUxCg==',
        "timespan": {
          "end": 133016
          "start": 0,
        }
      },
      "value": b64'dmFsdWUxCg=='
    },
    {
      "scope": {
        "extent": b64'YzJOdmNHVXlDZz09==',
        "timespan": {
          "end": 245009  
          "start": 133017,
        }
      },
      "value": b64'ZG1Gc2RXVXlDZz09=='
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The soft binding algorithm used shall be present as the value of the <code>alg</code> field, and the blocks over which is was applied shall be listed in the <code>blocks</code> field.  If the algorithm used requires any additional parameters, they should be present as the value of <code>alg-params</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cloud_data"><a class="anchor" href="#_cloud_data"></a>18.10. Cloud Data</h3>
<div class="paragraph">
<p>There are use cases where storing the data for the assertion remotely, such as in the cloud, is better than embedded inside the asset, especially when the data is large. For any such cases, it is possible to use a special type of assertion that serves as a reference to that information. For privacy and reliability reasons, data referenced through a cloud data assertion shall be considered optional: their contents should not be retrieved as part of manifest validation. A validator may retrieve the contents later to serve an application-dependent need, such as further exploration of the provenance history.</p>
</div>
<div class="paragraph">
<p>If <a href="#_metadata_about_assertions">assertion metadata</a> is included as part of another assertion, then it too would be part of the information referenced from a cloud data assertion.  It is also possible to store individual assertion metadata assertions remotely, just as with other assertion types.</p>
</div>
<div class="paragraph">
<p>A cloud data assertion shall have a label of <code>c2pa.cloud-data</code>.</p>
</div>
<div class="paragraph">
<p>A cloud data assertion must not refer to an assertion with the label <code>c2pa.hash.data</code>, <code>c2pa.hash.boxes</code>, <code>c2pa.hash.collection.data</code>, or <code>c2pa.hash.bmff.v2</code>.</p>
</div>
<div class="sect3">
<h4 id="_schema_and_example_8"><a class="anchor" href="#_schema_and_example_8"></a>18.10.1. Schema and Example</h4>
<div class="paragraph">
<p>The schema for this type is defined by the <code>cloud-data-map</code> rule in the following <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; Assertion that references the actual assertion stored in the cloud
cloud-data-map = {
  "label": tstr, ; label for the cloud-based assertion (eg.c2pa.actions)
  "size": size-type, ; Number of bytes of data
  "location": $hashed-ext-uri-map, ; http(s) URL to where the cloud-hosted assertion can be found
  "content_type": tstr .regexp "^[-\\w.]+/[-+\\w.]+$", ; media/MIME type for the data
  ? "metadata": $assertion-metadata-map,  ; additional information about the assertion
}

; size is minimum 1 in multiples of 1.0
size-type = int .ge 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{
  "size": 98765,
  "label": "c2pa.thumbnail.claim.jpg",
  "location": {
    "url": "https://some.storage.us/foo",
    "hash": b64'zP84FPSremIrAQHlhw+hRYQdZp/+KggnD0W8opXlIQQ='
  },
  "content_type": "application/jpeg"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_thumbnail"><a class="anchor" href="#_thumbnail"></a>18.11. Thumbnail</h3>
<div class="paragraph">
<p>A thumbnail assertion provides an approximate visual representation of the asset at a specific event in the lifecycle of an asset. There are currently two specific events:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ingredient import and claim creation</p>
</li>
<li>
<p>each using a unique label for the assertion.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For thumbnails created at claim creation time, the thumbnail assertion shall have a label that starts with <code>c2pa.thumbnail.claim</code> and be followed by the <a href="https://www.iana.org/assignments/media-types/media-types.xhtml#image">IANA registry</a> image type (e.g., <code>c2pa.thumbnail.claim.png</code>). For each of these types of thumbnails, there can be only one per claim.</p>
</div>
<div class="paragraph">
<p>When importing an ingredient (see <a href="#_adding_ingredients">Section 10.3.2.2, &#8220;Adding Ingredients&#8221;</a>), it is preferable to reference that ingredient&#8217;s own manifest-stored thumbnail. However, some ingredients may not include a thumbnail assertion, or even a manifest. In that case, a new thumbnail of the ingredient should be generated, and a new thumbnail assertion in the active manifest created. The thumbnail assertion shall have a label that starts with <code>c2pa.thumbnail.ingredient</code> and be followed by an underscore (<code>_</code> (U+005F)) then a unique ID such as a simple monotonically increasing integer and ending with the image type. For example, an ingredient thumbnail of type <code>jpeg</code> could have label <code>c2pa.thumbnail.ingredient_1.jpg</code>.</p>
</div>
<div class="paragraph">
<p>The data in a thumbnail assertion is the bits of a file (such as a raster image) in whatever format is desired by the claim generator. The Embedded File content type (ISO 19566-5:AMD-1), <code>bfdb</code>, shall be used to contain the thumbnail&#8217;s data.</p>
</div>
</div>
<div class="sect2">
<h3 id="_actions"><a class="anchor" href="#_actions"></a>18.12. Actions</h3>
<div class="paragraph">
<p>An actions assertion provides information on edits and other actions taken that affect the asset&#8217;s content. There will be an array of actions - each action declaring <em>what</em> took place on the asset, <em>when</em> it took place, along with possible other information such as what software performed the action.</p>
</div>
<div class="paragraph">
<p>There are two versions of the actions assertion - the original v1 (which shall have a label of <code>c2pa.actions</code>) and the new and improved v2 (which shall have a label of <code>c2pa.actions.v2</code>). There shall be no more than one actions assertion of any version per C2PA Manifest. Actions are modelled after <a href="https://github.com/adobe/xmp-docs/blob/master/XMPNamespaces/XMPDataTypes/ResourceEvent.md">XMP ResourceEvents</a>, though contain a number of C2PA-specific adjustments.</p>
</div>
<div class="paragraph">
<p>v1 actions are fully specified in its <code>actions</code> array. However, in v2, an action may either be fully specified in an element of the <code>actions</code> array or it may be derived from an element in the <code>templates</code> array with the same action name.</p>
</div>
<div class="paragraph">
<p>For each action present in either the <code>actions</code> or <code>templates</code> arrays, the value of the <code>action</code> field shall be either a pre-defined action name (<code>c2pa.resized</code>, <code>c2pa.edited</code>, etc.) or entity-specific action name (<code>com.fabrikam.gaussianBlur</code>, etc.).</p>
</div>
<div class="paragraph">
<p>The set of pre-defined names, prefixed with <code>c2pa.</code> are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 36.8421%;">
<col style="width: 63.1579%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Action</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.color_adjustments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changes to tone, saturation, etc.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.converted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The format of the asset was changed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.created</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The asset was first created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.cropped</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Areas of the asset&#8217;s "editorial" content were cropped out.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.deleted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Areas of the asset&#8217;s "editorial" content were deleted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.drawing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changes using drawing tools including brushes or eraser.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.edited</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generalized actions that would be considered 'editorial transformations' of the content.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.edited.metadata</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Modifications to a metadata assertion but not the asset&#8217;s content.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.filtered</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changes to appearance with applied filters, styles, etc.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.opened</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An existing asset was opened and is being set as the <code>parentOf</code> ingredient.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.orientation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changes to the direction and position of content.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.placed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Added/Placed a <code>componentOf</code> ingredient into the asset.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.published</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Asset is released to a wider audience.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.redacted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">One or more assertions were redacted</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.removed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A <code>componentOf</code> ingredient was removed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.repackaged</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A conversion of one packaging or container format to another. Content is repackaged without transcoding. This action is considered as a 'non-editorial transformation' of the <code>parentOf</code> ingredient.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.resized</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changes to content dimensions and/or file size</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.transcoded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A conversion of one encoding to another, including resolution scaling, bitrate adjustment and encoding format change. This action is considered as a 'non-editorial transformation' of the <code>parentOf</code> ingredient.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.unknown</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Something happened, but the claim_generator cannot specify what.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.watermarked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An invisible watermark was inserted into the digital content for the purpose of creating a soft binding.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In addition, the following set of pre-defined names, prefixed with <code>font.</code> are used specifically for font assets:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
An earlier version of this specification labelled these as <code>c2pa.font</code>, but that has been deprecated in favor of the shorter <code>font</code> prefix.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 36.8421%;">
<col style="width: 63.1579%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Action</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">font.charactersAdded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Characters or character sets added.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">font.charactersDeleted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Characters or character sets deleted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">font.charactersModified</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Characters or character sets added and deleted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">font.createdFromVariableFont</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Font was instantiated, in whole or part, from a variable font.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">font.edited</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Font has suffered an editing action not described by any more-specific action.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">font.hinted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hinting applied.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">font.merged</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Font is a combination of antecedent fonts.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">font.openTypeFeatureAdded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpenType feature added to font.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">font.openTypeFeatureModified</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpenType feature altered.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">font.openTypeFeatureRemoved</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpenType feature removed from font.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">font.subset</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Font has been stripped down to support an arbitrary (sui generis) sub-group of characters.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An action may include a free-text description, in the <code>description</code> field, of what an action does.  This is most useful for non-standard actions, however, it could also be used as a way to provide additional information about a standard action. For example, a <code>c2pa.edited</code> action could have a <code>description</code> that says "Paintbrush tool".</p>
</div>
<div class="paragraph">
<p>If present, the <code>reason</code> field shall contain one of the standard values, or a custom value which conforms to the same syntax as <a href="#_labels">custom labels</a>, for the rationale behind the action.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>c2pa.PII.present</code></p>
</li>
<li>
<p><code>c2pa.invalid.data</code></p>
</li>
<li>
<p><code>c2pa.trade-secret.present</code></p>
</li>
<li>
<p><code>c2pa.government.confidential</code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Although the <code>reason</code> field may be used for any actions, only redaction-focused <code>c2pa</code> values are defined at this time.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When using a <code>c2pa.redacted</code> action, the <code>reason</code> field shall contain the rationale for the redaction. Additional requirements for the <code>c2pa.redacted</code> action can be found in <a href="#_parameters">Section 18.12.2, &#8220;Parameters&#8221;</a>.</p>
</div>
<div class="paragraph">
<p>Also present may be the date and time when the action took place in the <code>when</code> field. If included, the value of the <code>when</code> field shall be compliant with <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO 8601</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>when</code> field serves as a simple non-trusted timestamp. UTC-based times are recommended.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The software or hardware used to perform the action can be identified via the <code>softwareAgent</code> field.  In a v1 action, this is a simple text string.  However, for v2, <code>softwareAgent</code> uses the richer <code>generator-info-map</code> structure as described in <a href="#_generator_info_map">Section 10.2.1.1, &#8220;Generator Info Map&#8221;</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This field is useful for when the <code>softwareAgent</code> is not the same program as the claim generator.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
An earlier version of this specification also included an <code>actors</code> field, however this was removed in version 2.0.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An action may include a <code>digitalSourceType</code> key, whose value shall be one of the terms <a href="https://cv.iptc.org/newscodes/digitalsourcetype/">defined by the IPTC</a> or a C2PA specific value from the list below:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>c2pa.trainedAlgorithmicData</code></dt>
<dd>
<p>Data that is the result of algorithmically using a model derived from sampled content and data.  Differs from trainedAlgorithmicMedia in that the result isn&#8217;t a media type (e.g., image or video) but is a data format (e.g., CSV, pickle)</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>One common use case for the <code>digitalSourceType</code> key is in conjunction with the <code>c2pa.created</code> action to provide a way to specify how the media item was created - such as "digital capture", "digitised from negative" or "trained algorithmic media".</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For "trained algorithmic" assets and data, such as those created by Generative AI, one or more <a href="#_ingredients">ingredients</a> may be added to the C2PA Manifest to provide info about the inputs that led to the production of the asset. They can be referenced from a <code>c2pa.placed</code> or <code>c2pa.created</code> action as shown <a href="#generative_example">below</a>.</p>
</div>
<div class="sect3">
<h4 id="_changes"><a class="anchor" href="#_changes"></a>18.12.1. Changes</h4>
<div class="paragraph">
<p>The action may be specific to only a portion of an asset - such as a range of frames in a video or a specific area on an image. In v1, the value was a simple text string.  For v2, they are identified using a <code>changes</code> field, whose value is a <code>region-map</code> as described in <a href="#_regions_of_interest">Section 18.2, &#8220;Regions of Interest&#8221;</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_parameters"><a class="anchor" href="#_parameters"></a>18.12.2. Parameters</h4>
<div class="paragraph">
<p>An action may include a <code>parameters</code> key that provides for the specification of some action-specific information via some pre-defined as well as the open-ended inclusion of any other keys (and their associated values).  This is useful for providing extra information that would be useful to a specific workflow or C2PA Manifest Consumer.</p>
</div>
<div class="paragraph">
<p>When using a <code>c2pa.transcoded</code>, <code>c2pa.repackaged</code>, <code>c2pa.opened</code>, or a <code>c2pa.placed</code> action, the <code>ingredient</code> field (for v1) or <code>ingredients</code> field (for v2) in the <code>parameters</code> object shall contain the hashed JUMBF URI to one or more related ingredient assertion.  A <code>c2pa.removed</code> action may have the hashed JUMBF URI to an ingredient, if that ingredient is from a different manifest than the active one.</p>
</div>
<div id="generative_example" class="paragraph">
<p>As an example, the <code>c2pa.created</code> action for an image created by a Generative AI model, might look like this, in CBOR Diagnostic Format (<code>.cbordiag</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">// an actions assertion used to describe output of Generative AI //
{
  "actions": [
    {
      "action": "c2pa.created",
      "when": 0("2023-02-11T09:00:00Z"),
      "softwareAgent" : {
          "name": "Joe's Photo Editor",
          "version": "2.0",
          "schema.org.SoftwareApplication.operatingSystem": "Windows 10"
      },
      "digitalSourceType": "http://cv.iptc.org/newscodes/digitalsourcetype/trainedAlgorithmicMedia",
      "parameters" : {
        "ingredients" : [ 
          {
            "url": "self#jumbf=c2pa/joe-ed:urn:uuid:ABCD/c2pa.assertions/c2pa.ingredient__1", 
            "alg": "sha256",
            "hash" : b64'...',
          },
          {
            "url": "self#jumbf=c2pa/joe-ed:urn:uuid:EFGH/c2pa.assertions/c2pa.ingredient__2", 
            "alg": "sha256",
            "hash" : b64'...',
          }
        ]
      }
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using a <code>c2pa.redacted</code> action, the <code>redacted</code> field in the <code>parameters</code> object shall contain the hashed JUMBF URI to the assertion that has been redacted.</p>
</div>
</div>
<div class="sect3">
<h4 id="_action_templates"><a class="anchor" href="#_action_templates"></a>18.12.3. Action Templates</h4>
<div class="paragraph">
<p>The elements of the <code>templates</code> array, in a v2 action, are described using a combination of common elements about actions, along with some template-specific values. These values are combined with actions of the same name, by a C2PA Manifest Consumer, to get a full picture of an action.</p>
</div>
<div class="paragraph">
<p>For example, given the following action &amp; template, in CBOR Diagnostic Format (<code>.cbordiag</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{
  "actions": [
    {
      "action": "com.joesphoto.filter",
      "when": 0("2020-02-11T09:00:00Z")
    },
    {
      "action": "c2pa.edited",
      "when": 0("2020-02-11T09:10:00Z")
    },
    {
      "action": "com.joesphoto.filter",
      "when": 0("2020-02-11T09:20:00Z")
    },
    {
      "action": "c2pa.cropped",
      "when": 0("2020-02-11T09:30:00Z")
    }
  ],
  "templates": [{
		"action": "com.joesphoto.filter",
		"description": "Magic Filter",
		"digitalSourceType": "http://cv.iptc.org/newscodes/digitalsourcetype/compositeSynthetic",
    "softwareAgent" : {
        "name": "Joe's Photo Editor",
        "version": "2.0",
        "schema.org.SoftwareApplication.operatingSystem": "Windows 10"
    }
  }]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A C2PA Manifest Consumer shall take the values from the template and overlay (i.e., replacing any with the same name) the values from the action itself.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/Actions_template.svg" alt="Redacting assertions in a secondary claim" width="720" height="432">
</div>
<div class="title">Figure 16. Actions Template Flow</div>
</div>
<div class="paragraph">
<p>A template may include a <code>templateParameters</code> key that allows the inclusion of any other keys (and their associated values).  This is useful for providing extra information that would be useful to a specific workflow or C2PA Manifest Consumer.</p>
</div>
<div class="sect4">
<h5 id="_icons"><a class="anchor" href="#_icons"></a>18.12.3.1. Icons</h5>
<div class="paragraph">
<p>A template may also include an icon - an image (raster or vector) that can be used in the C2PA Manifest Consumer&#8217;s user experience to provide some graphic representation of the action.  Since a Manifest Consumer will know about all the defined actions, such icons shall only be present in templates for entity-specific actions.</p>
</div>
<div class="paragraph">
<p>It is strongly recommend that the data for the icon be embedded in the C2PA Manifest using an <a href="#_embedded_data">embedded data box</a>.  However, referencing via an external URI can be done instead through a <code>hashed-ext-uri</code>, though a Manifest Consumer is not required to resolve the URI.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_localizations"><a class="anchor" href="#_localizations"></a>18.12.4. Localizations</h4>
<div class="paragraph">
<p>If the <code>metadata</code> of an actions assertion contains a <a href="#_localization_dictionary">Section 18.3.6.1, &#8220;Localization Dictionary&#8221;</a> for a template, then the localizations shall also apply to any action based on that template.</p>
</div>
</div>
<div class="sect3">
<h4 id="_watermarking"><a class="anchor" href="#_watermarking"></a>18.12.5. Watermarking</h4>
<div class="paragraph">
<p>When using a <code>c2pa.watermarked</code> action, a <a href="#_soft_binding">soft binding assertion</a> must also be included in the C2PA Manifest to describe the inserted watermark.</p>
</div>
</div>
<div class="sect3">
<h4 id="_related_actions"><a class="anchor" href="#_related_actions"></a>18.12.6. Related Actions</h4>
<div class="paragraph">
<p>When a series of actions are related to each other, usually taking place at the same time, it can be useful to associate them accordingly.  The <code>related</code> field, in the v2 action, provides a place to list the additional actions that are related.  Each related action should be a subset of the primary action, only including those fields that differ.  Just as with an action template, the values are merged with those of the primary action, by a C2PA Manifest Consumer to get a full picture of each related action.</p>
</div>
</div>
<div class="sect3">
<h4 id="_asset_renditions"><a class="anchor" href="#_asset_renditions"></a>18.12.7. Asset Renditions</h4>
<div class="paragraph">
<p>Asset renditions are a common occurrence when distributing media on the internet. These renditions are often created for the purpose of delivering media to consumers in differing connectivity, screen resolution, and other environments. We can use the <code>actions</code> assertion to help consuming actors understand the intention of certain claim creators to create asset renditions.</p>
</div>
<div class="paragraph">
<p>The presence of only the <code>c2pa.published</code>, <code>c2pa.transcoded</code> and/or <code>c2pa.repackaged</code> actions in a <code>c2pa.actions</code> assertion provides a signal to the Manifest Consumer that the signer is asserting that no "editorial" changes have happened between the ingredient asset(s) and this one. Editorial changes are those that alter the intent and/or meaning of the content.</p>
</div>
<div class="paragraph">
<p>The additional presence of a single "parentOf" ingredient provides a further signal to the Manifest Consumer that the signer is asserting that the asset has been derived directly from that parent.</p>
</div>
</div>
<div class="sect3">
<h4 id="_deprecated_actions"><a class="anchor" href="#_deprecated_actions"></a>18.12.8. Deprecated Actions</h4>
<div class="paragraph">
<p>The following actions were part of previous versions of this specification and have since been deprecated.  Accordingly, they shall no longer be written into <code>c2pa.actions</code> assertions but may appear in pre-existing C2PA Manifests.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>c2pa.copied</p>
</li>
<li>
<p>c2pa.formatted</p>
</li>
<li>
<p>c2pa.version_updated</p>
</li>
<li>
<p>c2pa.printed</p>
</li>
<li>
<p>c2pa.managed</p>
</li>
<li>
<p>c2pa.produced</p>
</li>
<li>
<p>c2pa.saved</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_schema_and_example_9"><a class="anchor" href="#_schema_and_example_9"></a>18.12.9. Schema and Example</h4>
<div class="paragraph">
<p>The schema for <code>c2pa.actions</code> is defined by the <code>actions-map</code> rule, and the schema for <code>c2pa.actions.v2</code> is defined by the <code>actions-map-v2</code> rule in the following <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">actions-map = {
  "actions" : [1* action-items-map],  ; list of actions
  ? "metadata": $assertion-metadata-map, ; additional information about the assertion
}


buuid = #6.37(bstr)

$action-choice /= "c2pa.color_adjustments"
$action-choice /= "c2pa.converted"
$action-choice /= "c2pa.copied"
$action-choice /= "c2pa.created"
$action-choice /= "c2pa.cropped"
$action-choice /= "c2pa.drawing"
$action-choice /= "c2pa.edited"
$action-choice /= "c2pa.edited.metadata"
$action-choice /= "c2pa.filtered"
$action-choice /= "c2pa.formatted"
$action-choice /= "c2pa.managed"
$action-choice /= "c2pa.opened"
$action-choice /= "c2pa.orientation"
$action-choice /= "c2pa.produced"
$action-choice /= "c2pa.placed"
$action-choice /= "c2pa.printed"
$action-choice /= "c2pa.published"
$action-choice /= "c2pa.redacted"
$action-choice /= "c2pa.removed"
$action-choice /= "c2pa.repackaged"
$action-choice /= "c2pa.resized"
$action-choice /= "c2pa.saved"
$action-choice /= "c2pa.transcoded"
$action-choice /= "c2pa.watermarked"
$action-choice /= "c2pa.unknown"
$action-choice /= "c2pa.version_updated"
$action-choice /= "font.edited"
$action-choice /= "font.subset"
$action-choice /= "font.createdFromVariableFont"
$action-choice /= "font.charactersAdded"
$action-choice /= "font.charactersDeleted"
$action-choice /= "font.charactersModified"
$action-choice /= "font.hinted"
$action-choice /= "font.openTypeFeatureAdded"
$action-choice /= "font.openTypeFeatureModified"
$action-choice /= "font.openTypeFeatureRemoved"
$action-choice /= "font.merged"
$action-choice /= tstr .regexp "([\\da-zA-Z_-]+\\.)+[\\da-zA-Z_-]+"

action-items-map = {
  "action": $action-choice,
  ? "when": tdate, ; Timestamp of when the action occurred. 
  ? "softwareAgent": tstr .size (1..max-tstr-length), ;The software agent that performed the action.
  ? "changed": tstr .size (1..max-tstr-length), ; A semicolon-delimited list of the parts of the resource that were changed since the previous event history. If not present, presumed to be undefined. When tracking changes and the scope of the changed components is unknown, it should be assumed that anything might have changed.
  ? "instanceID": buuid, ; The value of the xmpMM:InstanceID property for the modified (output) resource
  ? "parameters": parameters-map, ; Additional parameters of the action. These will often vary by the type of action
  ? "digitalSourceType": tstr .size (1..max-tstr-length), ; One of the defined source types at https://cv.iptc.org/newscodes/digitalsourcetype/

  ; NOTE: an earlier version of this specification also included an "actors" field, however this was removed in version 2.0.
}

parameters-map = {
  ? "ingredient": $hashed-uri-map, ; A hashed-uri to the ingredient assertion that this action acts on
  ? "description": tstr .size (1..max-tstr-length) ; Additional description of the action
  * tstr =&gt; any
}


; Version 2 (v2) of the actions assertion

$action-reason /= "c2pa.PII.present"
$action-reason /= "c2pa.invalid.data"
$action-reason /= "c2pa.tradesecret.present"
$action-reason /= "c2pa.government.confidential"
$action-reason /= tstr .regexp "([\\da-zA-Z_-]+\\.)+[\\da-zA-Z_-]+"

actions-map-v2 = {
  "actions" : [1* action-items-map-v2],     ; list of actions
  ? "templates": [1* $action-template-map-v2], ; list of templates for the actions
  ? "metadata": $assertion-metadata-map,    ; additional information about the assertion
}

action-common-map-v2 = {
  "action": $action-choice,
  ? "softwareAgent": $generator-info-map, ; Description of the software/hardware that did the action
  ? "description": tstr .size (1..max-tstr-length), ; Additional description of the action, important for custom actions
  ? "digitalSourceType": tstr .size (1..max-tstr-length), ; One of the defined source types at https://cv.iptc.org/newscodes/digitalsourcetype/ or in this specification
}

action-items-map-v2 = {
  action-common-map-v2, ; start with the common set of items

  ? "when": tdate, ; Timestamp of when the action occurred. 
  ? "changed": [1* region-map], ; A list of the regions of interest of the resource that were changed. If not present, presumed to be undefined. 
  ? "related": [1* action-items-map-v2], ; List of related actions
  ? "reason": $action-reason, ; the reason why this action was performed, required when the action is `c2pa.redacted`
  ? "parameters": parameters-map-v2 ; Additional parameters of the action. These will often vary by the type of action

  ; NOTE: an earlier version of this specification also included an "actors" field, however this was removed in version 2.0.
}

action-template-map-v2 = {
  action-common-map-v2, ; start with the common set of items
  ? "icon": $hashed-uri-map / $hashed-ext-uri-map,  ; hashed_uri reference to a data box or a hashed_ext_uri to external data
  ? "templateParameters": parameters-common-map-v2 ; Additional parameters of the template.
}

parameters-common-map-v2 = {
  * tstr =&gt; any
}

parameters-map-v2 = {
  ? "instanceID": buuid, ; The value of the xmpMM:InstanceID property for the modified (output) resource
  ? "redacted": $jumbf-uri-type, ; A JUMBF URI to the redacted assertion, required when the action is `c2pa.redacted`
  ? "ingredients": [1* $hashed-uri-map], ; A list of hashed JUMBF URI(s) to the ingredient (v2) assertion(s) that this action acts on
  parameters-common-map-v2  ; anything from the common parameters
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Standard actions specific to font assets are described in:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; Maps, ranges and parameters for font-specific actions.

; Multiple font actions work with respect to ranges of Unicode values.
font-unicode-range-map = {
  "start": uint, ; Inclusive start 
  "stop": uint, ; Inclusive end
}

; Font parameter used by font.subset, font.charactersAdded, 
; font.charactersDeleted, and font.charactersModified.
font-parameter-unicode-ranges-map = {
  "ranges": [1* font-unicode-range-map] ; Array of unicode ranges 
}

; Ranges for font instantiation parameters
font-weight-range = 1..1000 ; Valid weights or thickness for the font. 400 is normal.
font-width-range = 0.0..1000.0 ; Percentage of normal from 0% to 1000%.  100% is normal width.
font-slant-range = -90.0..90.0 ; Angle of slant with 0 degrees being no slant.

; Font parameters used when creating an instance of a font from a variable font.
; The different 'variation axis` for the fonts are detailed here.  The tag
; names for the different axes are in parenthesis in the comments for each
; parameter.
font-parameter-created-from-variable-font-map = {
  ? "weight": font-weight-range, ; Weight(wght) or thickness of the font to be instantiated.
  ? "width": font-width-range, ; Width(wdth) or narrowness of the letterforms of font to be instantiated.
  ? "italic": bool, ; Get the italic(ital) version of the font.
  ? "slant": font-slant-range, ; The slant(slnt) angle of the font.
  ? "optical-size": int / float, ; The optical size(opsz) of the font, typically you want to match the font size requested.
  * tstr =&gt; any ; Name and type of the custom axes.
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example of a v2 action, in CBOR Diagnostic Format (<code>.cbordiag</code>), is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{
  "actions": [
    {
      "action": "c2pa.filtered",
      "when": 0("2020-02-11T09:00:00Z"),
      "parameters": {
        "instanceID": 37(h'ed610ae51f604002be3dbf0c589a2f1f')
      },
      "softwareAgent" : {
          "name": "Joe's Photo Editor",
          "version": "2.0",
          "schema.org.SoftwareApplication.operatingSystem": "Windows 10"
      }
    },
    {
      "action": "c2pa.cropped",
      "when": 0("2020-02-11T09:30:00Z")
    }
  ],
  "metadata": {
    "dateTime": 0("2021-06-28T16:34:11.457Z"),
    "reviewRatings": [
      {
        "value": 1,
        "explanation": "Content bindings did not validate"
      }
    ]
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ingredient"><a class="anchor" href="#_ingredient"></a>18.13. Ingredient</h3>
<div class="paragraph">
<p>When assets are composed together, for example placing an image into a layer in Photoshop or an audio clip into a video in Premiere, it is important that information about any claim from the placed asset be recorded into the new asset to provide a way to understand the entire history of the new composed asset. This is also true when an existing asset is used to create a derived asset or asset rendition.</p>
</div>
<div class="paragraph">
<p>Another common use for an ingredient is to describe some assets or data that was used as input to a process, such as the training or inference requests associated with an AI/ML model.</p>
</div>
<div class="paragraph">
<p>There are two versions of the ingredients assertion - the original v1 (which shall have a label of <code>c2pa.ingredient</code>) and the new and improved v2 (which shall have a label of <code>c2pa.ingredient.v2</code>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Since there will most likely be more than one ingredient assertion, the use of the monotonically increasing index in the label would be used (e.g., <code>c2pa.ingredient.v2__1</code>, <code>c2pa.ingredient.v2\__2</code>).
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_concept"><a class="anchor" href="#_concept"></a>18.13.1. Concept</h4>
<div class="paragraph">
<p>The concept of ingredients in C2PA was modelled on the XMP Ingredient and Pantry model, as described in the <a href="https://github.com/adobe/XMP-Toolkit-SDK/blob/main/docs/DynamicMediaXMPPartnerGuide.pdf">Partner Guide to XMP for Dynamic Media</a> and <a href="http://wwwimages.adobe.com/content/dam/acom/en/products/xmp/Pdfs/XMPAssetRelationships.pdf">Asset Relationships in XMP</a>. That model relies on the fact that each asset used in the construction of a document has, at the time of inclusion, at least one <a href="#_unique_identifiers">unique identifier</a>. However, there are many instances where such an identifier does not exist, so in the v2 version of the ingredient assertion all identifiers are now optional.</p>
</div>
<div class="sect4">
<h5 id="_establishing_unique_identifiers"><a class="anchor" href="#_establishing_unique_identifiers"></a>18.13.1.1. Establishing unique identifiers</h5>
<div class="paragraph">
<p>If a claim generator is to provide <a href="#_unique_identifiers">unique identifiers</a> for an ingredient, then the following recommendations shall be followed.</p>
</div>
<div class="paragraph">
<p>If the ingredient being added contains a C2PA Manifest, and that C2PA Manifest contains a <code>c2pa.metadata</code> assertion, the following actions shall be taken.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the <code>c2pa.metadata</code> assertion contains an <code>xmpMM:DocumentID</code> entry, that entry shall become the <code>documentID</code> field of this assertion.</p>
</li>
<li>
<p>If the <code>c2pa.metadata</code> assertion contains an <code>xmpMM:InstanceID</code> entry, that entry shall become the <code>instanceID</code> field of this assertion.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the ingredient does not have a C2PA Manifest or that C2PA Manifest does not contain a <code>c2pa.metadata</code> assertion, then some other <a href="#_unique_identifiers">unique identifier</a> for the ingredient shall be used instead. In this situation, the <code>instanceID</code> field shall contain the unique identifier and the <code>documentID</code> field shall not be present.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_relationship"><a class="anchor" href="#_relationship"></a>18.13.2. Relationship</h4>
<div class="paragraph">
<p>When adding an ingredient, its relationship to the current asset shall be described. These are the possible values of the <code>relationship</code> field and their meanings:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>parentOf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The current asset is a derived asset or asset rendition of this ingredient. This relationship value is also used with <a href="#_update_manifests">update manifests</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>componentOf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The current asset is composed of multiple parts, this ingredient being one of them.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>inputTo</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This ingredient was used as input to a computational process, such as an AI/ML model, that led to the creation or modification of this asset.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_title"><a class="anchor" href="#_title"></a>18.13.3. Title</h4>
<div class="paragraph">
<p>The value of <code>dc:title</code> shall be a human-readable name for the ingredient, which may be taken either from the asset&#8217;s XMP or the asset&#8217;s name in a local or remote (e.g., cloud-based) filesystem. If the ingredient does not have a specific name, then a description of the ingredient may be used instead.</p>
</div>
</div>
<div class="sect3">
<h4 id="_format"><a class="anchor" href="#_format"></a>18.13.4. Format</h4>
<div class="paragraph">
<p>The <a href="https://www.iana.org/assignments/media-types/media-types.xhtml">Media Type</a> of the ingredient shall be declared in <code>dc:format</code>.  When describing a <a href="#_multi_file_ingredients">multi-file ingredient</a>, such as the data set of an AI/ML model, the <code>dc:format</code> field shall be set to <a href="https://datatracker.ietf.org/doc/html/rfc2046"><code>multipart/mixed</code></a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="ingredient_schema"><a class="anchor" href="#ingredient_schema"></a>18.13.5. Schema and Example</h4>
<div class="paragraph">
<p>The <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a> for this type is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">;Assertion that describes an ingredient used in the asset
ingredient-map = {
  "dc:title": tstr, ; name of the ingredient
  "dc:format": format-string, ; Media Type of the ingredient
  ? "documentID": tstr, ; value of the ingredient's `xmpMM:DocumentID`
  "instanceID": tstr, ; unique identifier, such as the value of the ingredient's `xmpMM:InstanceID`
  "relationship": $relation-choice, ; The relationship of this ingredient to the asset it is an ingredient of.
                                        ; For example, if an ingredient with a 'parentOf' relationship is added to
                                        ; an asset, then the asserter is stating that the current asset is a derived asset of the ingredient.
  ? "c2pa_manifest": $hashed-uri-map, ; hashed_uri reference to the C2PA Manifest of the ingredient
  ? "thumbnail": $hashed-uri-map, ; hashed_uri reference to an ingredient thumbnail
  ? "validationStatus": [1* $status-map] ; validation status of the ingredient
  ? "metadata": $assertion-metadata-map ; additional information about the assertion
}

; Version 2 (v2) of the ingredient assertion
; Assertion that describes an ingredient used in the asset
ingredient-map-v2 = {
  "dc:title": tstr, ; name of the ingredient
  "dc:format": format-string, ; Media Type of the ingredient
  "relationship": $relation-choice, ; The relationship of this ingredient to the asset it is an ingredient of.
                                        ; For example, if an ingredient with a 'parentOf' relationship is added to
                                        ; an asset, then the asserter is stating that the current asset is a derived asset of the ingredient.
  ? "documentID": tstr, ; value of the ingredient's `xmpMM:DocumentID`
  ? "instanceID": tstr, ; unique identifier, such as the value of the ingredient's `xmpMM:InstanceID`
  ? "data" : $hashed-uri-map / $hashed-ext-uri-map, ; hashed_uri reference to a data box or a hashed_ext_uri to external data
  ? "c2pa_manifest": $hashed-uri-map, ; hashed_uri reference to the C2PA Manifest of the ingredient
  ? "thumbnail": $hashed-uri-map, ; hashed_uri reference to a thumbnail in a data box
  ? "validationStatus": [1* $status-map] ; validation status of the ingredient
  ? "description": tstr .size (1..max-tstr-length) ; Additional description of the ingredient
  ? "informational_URI": tstr .size (1..max-tstr-length) ; URI to an informational page about the ingredient or its data
  ? "metadata": $assertion-metadata-map ; additional information about the assertion
}


format-string = tstr .regexp "^\\w+\/[-+.\\w]+$"

; Choices that describe the reason for how the ingredient is related to the asset
$relation-choice /= "parentOf"
$relation-choice /= "componentOf"
$relation-choice /= "inputTo"

; Success codes
$status-code /= "claimSignature.validated"
$status-code /= "signingCredential.trusted"
$status-code /= "signingCredential.notRevoked"
$status-code /= "timeStamp.trusted"
$status-code /= "assertion.hashedURI.match"
$status-code /= "assertion.dataHash.match"
$status-code /= "assertion.bmffHash.match"
$status-code /= "assertion.boxesHash.match"
$status-code /= "assertion.collectionHash.match"
$status-code /= "assertion.accessible"

; Failure codes
$status-code /= "claim.missing"
$status-code /= "claim.multiple"
$status-code /= "claim.hardBindings.missing"
$status-code /= "claim.required.missing"
$status-code /= "claim.cbor.invalid"
$status-code /= "ingredient.hashedURI.mismatch"
$status-code /= "claimSignature.missing"
$status-code /= "claimSignature.mismatch"
$status-code /= "manifest.compressed.invalid"
$status-code /= "manifest.inaccessible"
$status-code /= "manifest.multipleParents"
$status-code /= "manifest.update.invalid"
$status-code /= "manifest.update.wrongParents"
$status-code /= "signingCredential.untrusted"
$status-code /= "signingCredential.invalid"
$status-code /= "signingCredential.revoked"
$status-code /= "signingCredential.expired"
$status-code /= "timeStamp.mismatch"
$status-code /= "timeStamp.untrusted"
$status-code /= "timeStamp.outsideValidity"
$status-code /= "assertion.hashedURI.mismatch"
$status-code /= "assertion.missing"
$status-code /= "assertion.multipleHardBindings"
$status-code /= "assertion.undeclared"
$status-code /= "assertion.inaccessible"
$status-code /= "assertion.notRedacted"
$status-code /= "assertion.selfRedacted"
$status-code /= "assertion.required.missing"
$status-code /= "assertion.json.invalid"
$status-code /= "assertion.cbor.invalid"
$status-code /= "assertion.action.ingredientMismatch"
$status-code /= "assertion.action.redactionMismatch"
$status-code /= "assertion.action.redacted"
$status-code /= "assertion.dataHash.mismatch"
$status-code /= "assertion.bmffHash.mismatch"
$status-code /= "assertion.boxesHash.mismatch"
$status-code /= "assertion.boxesHash.unknownBox"
$status-code /= "assertion.cloud-data.hardBinding"
$status-code /= "assertion.cloud-data.actions"
$status-code /= "assertion.collectionHash.mismatch"
$status-code /= "assertion.collectionHash.incorrectFileCount"
$status-code /= "assertion.collectionHash.invalidURI"
$status-code /= "algorithm.unsupported"
$status-code /= "general.error" ; when nothing else applies

; custom status codes
$status-code /= tstr .regexp "([\\da-zA-Z_-]+\\.)+[\\da-zA-Z_-]+"

status-map = {
  "code": $status-code, ; A label-formatted string that describes the status
  ? "url": url-regexp-type, ; JUMBF URI reference
  ? "explanation": tstr .size (1..max-tstr-length), ; A human readable string explaining the status
  ? "success": bool ; does the code reflect success (true) or failure (false)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{
  "dc:title": "image 1.jpg",
  "metadata": {
    "dateTime": 0("2021-06-28T16:49:32.874Z"),
    "reviewRatings": [
      {
        "value": 5,
        "explanation": "Content bindings validated"
      }
    ]
  }
  "dc:format": "image/jpeg",
  "thumbnail" : {
      "url": "self#jumbf=c2pa/urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.thumbnail.ingredient_1.jpg",
      "hash": b64'UjRAYWiAq4lfCRDmksWAlDJN/XtHHFFwMWymsZsm3j8='
  },
  "documentID" : "uuid:87d51599-286e-43b2-9478-88c79f49c347",
  "instanceID" : "uuid:7b57930e-2f23-47fc-affe-0400d70b738d",
  "relationship": "parentOf",
  "c2pa_manifest" : {
      "url": "self#jumbf=c2pa/urn:uuid:5E7B01FC-4932-4BAB-AB32-D4F12A8AA322",
      "hash": b64'1kjJTO108b71cL95UxgfHD3eDgk9VrCedW8n3fYTRMk='
  },
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_description"><a class="anchor" href="#_description"></a>18.13.6. Description</h4>
<div class="paragraph">
<p>An ingredient may include a free-text description, in the <code>description</code> field, of what an the ingredient is or is used for.  This is useful for situations where neither the title nor the format is sufficient.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ingredient_data"><a class="anchor" href="#_ingredient_data"></a>18.13.7. Ingredient Data</h4>
<div class="sect4">
<h5 id="_standard_usage"><a class="anchor" href="#_standard_usage"></a>18.13.7.1. Standard Usage</h5>
<div class="paragraph">
<p>In certain use cases, such as Generative AI, it may be important to have ingredients where the data of the ingredient is provided - either embedded into the manifest or via a URL that references the data. This is accomplished through the <code>data</code> field in the ingredient which uses a <code>hashed-uri</code> to point to a <a href="#_embedded_data">data box</a> or a <code>hashed-ext-uri</code> to point to an external reference.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Using a <a href="#_embedded_data">data box</a> implies that its content will be embedded in the manifest, and any future C2PA Manifest that contains this asset as an ingredient. Claim Generators should take the size of this field into consideration when choosing whether to embed data.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An example of some ingredients with data, in CBOR Diagnostic Format (<code>.cbordiag</code>), are shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">// prompt's data box //
{
  "dc:format": "text/plain",
  "data" : 'pirate with bird on shoulder'
  "data_types": [{
    "type": "c2pa.types.generator.prompt",
  }]
}

// ingredient (prompt) //
{
  "dc:title": "prompt",
  "dc:format": "text/plain",
  "relationship": "inputTo",
  "data": {
    "url" : "self#jumbf=c2pa.databoxes/c2pa.data",
    "alg" : "sha256",
    "hash" : b64'...',
  }
}


// ingredient (model) //
{
  "dc:title": "model",
  "dc:format": "application/octet-stream",
  "relationship": "inputTo",
  "data": {
    "url": "https://tfhub.dev/deepmind/bigbigan-resnet50/1?tf-hub-format=compressed",
    "alg" : "sha256",
    "hash" : b64'...',
    "dc:format": "application/octet-stream",
    "data_types": [
      {
        "type": "c2pa.types.generator",
      },
      {
        "type": "c2pa.types.model.tensorflow",
        "version":  "1.0.0",
      },
      {
        "type": "c2pa.types.tensorflow.hubmodule",
        "version":  "1.0.0",
      }
    ]
  },
  "description": "Unsupervised BigBiGAN image generation &amp; representation learning model trained on ImageNet with a smaller (ResNet-50) encoder architecture.",
  "informational_URI": "https://tfhub.dev/deepmind/bigbigan-resnet50/1",
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_multi_file_ingredients"><a class="anchor" href="#_multi_file_ingredients"></a>18.13.7.2. Multi-file Ingredients</h5>
<div class="paragraph">
<p>In some cases, an ingredient may be represented as a set of multiple files, such as the training data set for an AI/ML model. It is recommended that in those instances that the <a href="#_existing_manifests">C2PA Manifest</a> be included in the ingredient assertion and that the manifest for the full data set include an <a href="#_asset_reference">asset reference assertion</a> that references where to find those files.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This method is well suited for when working with a collection of assets where all of the files are not contained in the same hierarchy.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_informational_url"><a class="anchor" href="#_informational_url"></a>18.13.8. Informational URL</h4>
<div class="paragraph">
<p>When it is necessary to provide a URL to a web page with information about the ingredient, such as detailed information about a AI/ML model, it can be placed as the value of the <code>informational_URI</code> field of the ingredient assertion.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>informational_URI</code> is not an authenticated link to the content of the ingredient itself, but something more generally of interest to a human user.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_thumbnails"><a class="anchor" href="#_thumbnails"></a>18.13.9. Thumbnails</h4>
<div class="paragraph">
<p>When adding an ingredient, it may be useful to also include a thumbnail of the ingredient to help establish the state of the ingredient at the time of import. For that purpose, a thumbnail should be added as a <a href="#_embedded_data">data box</a> and referenced herein via a hashed-uri reference.</p>
</div>
<div class="paragraph">
<p>Manifest Consumers should support the <a href="#_thumbnail">thumbnail assertion</a> recommended by earlier versions of this specification.  Claim Generators shall use <a href="#_embedded_data">data boxes</a> when creating C2PA Manifests.</p>
</div>
</div>
<div class="sect3">
<h4 id="_existing_manifests"><a class="anchor" href="#_existing_manifests"></a>18.13.10. Existing manifests</h4>
<div class="paragraph">
<p>If the ingredient has an existing C2PA Manifest Store, then all C2PA Manifests in the store (both standard and updates) shall be copied into the C2PA Manifest Store for the asset. The <a href="#_uri_references">URI reference</a> to the ingredient&#8217;s active <a href="#_c2pa_box_details">C2PA Manifest</a> shall be stored as the value of <code>c2pa_manifest</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A C2PA Manifest Store may contain JUMBF boxes or superboxes that are not C2PA Manifests. They need not be copied as part of this process.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Since an asset may not have its C2PA Manifest Store embedded, but instead <a href="#_embedding_a_reference_to_the_active_manifest">refer to it externally</a>, and it cannot be retrieved by the claim generator, a status code of <code>manifest.inaccessible</code> shall be added to <code>validationStatus</code> as described below.</p>
</div>
<div class="sect4">
<h5 id="_ingredient_validation"><a class="anchor" href="#_ingredient_validation"></a>18.13.10.1. Ingredient validation</h5>
<div class="paragraph">
<p>In addition, it is recommended that the C2PA validator validate the ingredient&#8217;s active C2PA Manifest and document the validation status in the <code>validationStatus</code> field. When present, the value of the <code>validationStatus</code> field shall contain at least one entry in the array.</p>
</div>
<div class="paragraph">
<p>Each object in the <code>validationStatus</code> array consists of a <code>code</code> value that describes the validation status of a specific part of the manifest along with an optional <code>success</code> boolean value representing if the code reflect success (true) or failure (false). A optional <code>url</code> field with a JUMBF URI reference to that element in the manifest may be present. Depending on the code, the <code>url</code> could be to a claim, a claim signature or a specific assertion. An optional description of the validation status may be present in the <code>explanation</code> field if there is a need for an additional human readable explanation.</p>
</div>
<div class="paragraph">
<p>Custom status codes are also permitted, when a claim generator has a need to record some process-specific status information.  The code shall conform to the same syntax as <a href="#_labels">custom labels</a>, e.g. <code>com.litware</code> and the <code>validationStatus</code> object shall contain a <code>success</code> boolean. Status codes are defined in <a href="#_status_codes">Section 15.1, &#8220;Status Codes&#8221;</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_metadata"><a class="anchor" href="#_metadata"></a>18.14. Metadata</h3>
<div class="paragraph">
<p>In earlier versions of this specification, there were individual assertions for each metadata standard (e.g., IPTC, EXIF).  In this version, there now exists a category of assertions that can be used to represent metadata, in a standardized serialization. Having the metadata in an assertion establishes that the metadata in that assertion is significant, because it has been explicitly included in the C2PA Manifest, and signed by a specific signer - thus enabling cryptographic validation and attribution of the data. In addition, by using a common serialization, it enables manifest consumers to process it in a consistent manner.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
These assertions could represent existing standards or they could be private specifications.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_common_requirements"><a class="anchor" href="#_common_requirements"></a>18.14.1. Common Requirements</h4>
<div class="paragraph">
<p>A metadata assertion shall have a label which ends in the string <code>.metadata</code>, and is preceded by either the standard <code>c2pa</code> identifier or any other provided that it conforms to the same syntax as <a href="#_labels">custom labels</a>. For example, a <code>com.litware.metadata</code> assertion would be valid.</p>
</div>
<div class="paragraph">
<p>Each metadata assertion shall contain a single JSON content type box containing the <a href="https://www.w3.org/TR/json-ld11/">JSON-LD</a> serialization of one or more metadata values. The <code>@context</code> property within the JSON-LD object shall be included, and used to provide context / namespaces for the metadata standards being specified.  The recommended procedure to create this JSON-LD object is to first create an <a href="https://www.iso.org/standard/57421.html">XMP Data Model</a> representation of the metadata and then serialize that to JSON-LD using the <a href="https://www.iso.org/standard/79384.html">JSON-LD serialization of XMP</a>. The JSON-LD would then be stored as a JSON content type box.</p>
</div>
</div>
<div class="sect3">
<h4 id="_the_c2pa_metadata_assertion"><a class="anchor" href="#_the_c2pa_metadata_assertion"></a>18.14.2. The <code>c2pa.metadata</code> assertion</h4>
<div class="paragraph">
<p>This specification defines one metadata assertion, whose label is <code>c2pa.metadata</code>, which is used to represent a subset of common metadata schemas that may be used in any C2PA Manifest. The metadata fields that may be included in this assertion are documented in <a href="#metadata_annex">Appendix A, <em>Implementation Details for <code>c2pa.metadata</code></em></a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Custom labelled metadata assertions can contain any values from any schemas.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An example of an <code>c2pa.metadata</code> assertion for an image:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
	"@context" : {
		"exif": "http://ns.adobe.com/exif/1.0/",
		"exifEX": "http://cipa.jp/exif/2.32/",
		"tiff": "http://ns.adobe.com/tiff/1.0/",
		"Iptc4xmpCore": "http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/",
		"Iptc4xmpExt": "http://iptc.org/std/Iptc4xmpExt/2008-02-29/",
		"dc" : "http://purl.org/dc/elements/1.1/",
		"photoshop" : "http://ns.adobe.com/photoshop/1.0/"
	},
	"photoshop:DateCreated": "Aug 31, 2022", 
	"Iptc4xmpExt:DigitalSourceType": "https://cv.iptc.org/newscodes/digitalsourcetype/digitalCapture",
	"Iptc4xmpExt:LocationCreated": { 
	  "Iptc4xmpExt:City": "San Francisco"
	},
	"Iptc4xmpExt:PersonInImage": [ 
	  "Erika Fictional"
	],
	"Iptc4xmpCore:AltTextAccessibility": "Photo of Erika Fictional standing in front of the Golden Gate Bridge at sunset.",
	"exif:GPSVersionID": "2.2.0.0",
	"exif:GPSLatitude": "39,21.102N",
	"exif:GPSLongitude": "74,26.5737W",
	"exif:GPSAltitudeRef": 0,
	"exif:GPSAltitude": "100963/29890",
	"exif:GPSTimeStamp": "2019-09-22T18:22:57Z",
	"exif:GPSSpeedRef": "K",
	"exif:GPSSpeed": "4009/161323",
	"exif:GPSImgDirectionRef": "T",
	"exif:GPSImgDirection": "296140/911",
	"exif:GPSDestBearingRef": "T",
	"exif:GPSDestBearing": "296140/911",
	"exif:GPSHPositioningError": "13244/2207",
	"exif:ExposureTime": "1/100",
	"exif:FNumber": 4.0,
	"exif:ColorSpace": 1,
	"exif:DigitalZoomRatio": 2.0,
	"tiff:Make": "CameraCompany",
	"tiff:Model": "Shooter S1",
	"exifEX:LensMake": "CameraCompany",
	"exifEX:LensModel": "17.0-35.0 mm",
	"exifEX:LensSpecification": { "@list": [ 1.55, 4.2, 1.6, 2.4 ] }
  
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example of an <code>c2pa.metadata</code> assertion for a PDF:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
	"@context" : {
	  "dc" : "http://purl.org/dc/elements/1.1/",
	  "xmp" : "http://ns.adobe.com/xap/1.0/",
	  "pdf" : "http://ns.adobe.com/pdf/1.3/",
	  "pdfx": "http://ns.adobe.com/pdfx/1.3/"
	},
	"dc:created": "2015 February 3", 
	"dc:title": [
		"This is a test file"
	],
	"xmp:CreatorTool": "TeX",
	"pdf:Producer": "pdfTeX-1.40.14",
	"pdf:Trapped": "Unknown",
	"pdfx:PTEX.Fullbanner": "This is pdfTeX, Version 3.1415926-2.5-1.40.14 (TeX Live 2013) kpathsea version 6.1.1"
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Although the redaction process works in such a way that only an entire assertion can be redacted (see <a href="#_redaction_of_assertions">Section 6.7, &#8220;Redaction of Assertions&#8221;</a>), the use of an <a href="#_update_manifests">update manifest</a> enables partial redaction by removing the original and then placing the new, reduced, versions in the update manifest. This new assertion would be presented in a <a href="#_user_experience">user experience</a> in association with the signer of the update manifest and not with the signer of the C2PA Manifest that has been redacted.</p>
</div>
<div class="paragraph">
<p>For example, a metadata assertion containing both location data and camera information which may need to have the location data redacted which could be done through an update manifest with a new metadata assertion containing only the camera information.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_asset_reference"><a class="anchor" href="#_asset_reference"></a>18.15. Asset Reference</h3>
<div class="paragraph">
<p>This assertion is used to indicate one or more locations where a copy of the asset may be obtained.  Such locations shall each be described using an asset reference assertion. The location shall be expressed via a URI.  The URI may be to either a single asset or it may reference a directory. In the latter case, it serves to provide the location for a collection of assets, that would be hashed via a <a href="#_collection_data_hash">collection data hash</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Expressing a <code>uri</code> provides flexibility to source the asset from web locations or distributed filesystems such as IPFS (see <a href="https://docs.ipfs.tech/how-to/address-ipfs-on-web/#subdomain-gateway" class="bare">https://docs.ipfs.tech/how-to/address-ipfs-on-web/#subdomain-gateway</a> for the latter).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An asset reference assertion shall have a label of <code>c2pa.asset-ref</code>.</p>
</div>
<div class="paragraph">
<p>The timestamp within the assertion metadata provides a basis for determining the freshness of the link described as the reference.</p>
</div>
<div class="sect3">
<h4 id="_schema_and_example_10"><a class="anchor" href="#_schema_and_example_10"></a>18.15.1. Schema and Example</h4>
<div class="paragraph">
<p>The schema for this type is defined by the <code>asset-ref-map</code> rule in the following <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">;The asset reference assertion (ARA) describes where a copy of the asset may be obtained.
asset-ref-map = {
  "references": [1* ara-reference-block-map]
}

ara-reference-block-map = {
  "reference": ara-reference-uri-map,
  ? "description": tstr, ; Human readable description of the location.
}

ara-reference-uri-map = {
  "uri": tstr, ; URI reference a location where a copy of the asset may be obtained from
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{
  "references": [
    {
      "description": "A copy of the asset on the web",
      "reference": {
          "uri": "https://some.storage.us/foo"
        }
    },
    {
      "description": "A copy of the asset on IPFS",
      "reference": {
          "uri": "ipfs://cid"
        }
    }
  ]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_asset_type"><a class="anchor" href="#_asset_type"></a>18.16. Asset Type</h3>
<div class="paragraph">
<p>The asset type assertion provides a way to more completely describe an asset, specifically additional context on how to parse or otherwise process it.  Although both <a href="#_claim">claims</a> and <a href="#_ingredients">ingredients</a> must include a valid (<a href="https://www.iana.org/assignments/media-types/media-types.xhtml">IANA Media Type</a>) in the <code>dc:format</code> field, there are many file formats for assets that cannot be completely described by a single Media Type value.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>For example, the <code>dc:format</code> field may specify that an asset is a text (<a href="https://www.iana.org/assignments/media-types/media-types.xhtml#text">text/plain</a>) or binary (<a href="https://www.iana.org/assignments/media-types/media-types.xhtml#application">application/octet-stream</a>) asset, and the asset type assertion would then provide the necessary additions to enable determining the exact type or format of the asset and possibly the version of that asset type.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>The asset type assertion shall have a label of <code>c2pa.asset-type</code>. There shall be at most one asset type assertion in a C2PA Manifest.</p>
</div>
<div class="paragraph">
<p>The asset type assertion has a single required field; the <code>types</code> field, whose value is an array of one or more asset types.  These types can either come from the following table or be an entity-specific type (e.g., com.litware.types.abc), provided that they conform to the same syntax as <a href="#_labels">custom labels</a>. If relevant, the version of the asset (e.g., the version of a dataset or model) can be documented in the <code>version</code> field.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As C2PA is adopted to provide provenance for AI/ML (i.e., artificial intelligence/machine learning) assets in the future, the C2PA Manifest may be embedded in the model and dataset assets, and the asset type assertion will be used to specify the type of these model and dataset assets.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 36.8421%;">
<col style="width: 63.1579%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">C2PA Type</th>
<th class="tableblock halign-left valign-top">Description of C2PA Type of the Asset</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.dataset</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AI/ML dataset which can be processed by multiple AI/ML frameworks or is not described by any other value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.dataset.jax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JAX dataset</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.dataset.keras</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keras dataset</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.dataset.ml_net</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ML.NET dataset</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.dataset.mxnet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MXNet dataset</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.dataset.onnx</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ONNX dataset</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.dataset.openvino</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpenVINO dataset</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.dataset.pytorch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PyTorch dataset</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.dataset.tensorflow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TensorFlow dataset</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.model</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AI/ML model which is not described by any other model type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.model.jax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JAX model</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.model.keras</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keras model</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.model.ml_net</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ML.NET model</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.model.mxnet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MXNet model</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.model.onnx</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ONNX model</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.model.openvino.parameter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpenVINO model parameter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.model.openvino.topology</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpenVINO model topology</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.model.pytorch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PyTorch model</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.model.tensorflow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TensorFlow model</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.numpy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored using the serialized NumPy format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.protobuf</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored using the Protocol Buffer format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.pickle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored using the Python pickle format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.types.savedmodel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored using the TensorFlow SavedModel format</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_schema_and_example_11"><a class="anchor" href="#_schema_and_example_11"></a>18.16.1. Schema and Example</h4>
<div class="paragraph">
<p>The schema for this type is defined by the <code>asset-types</code> rule in the following <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; The asset type assertion provides a way to more completely describe an asset 
; specifically additional context on how to parse or otherwise process it
; when its dc:format is insufficient. 
; It can also be used to describe externally referenced or related assets such as AI/ML models.

$type-choice /= "c2pa.types.classifier"
$type-choice /= "c2pa.types.cluster"
$type-choice /= "c2pa.types.dataset"
$type-choice /= "c2pa.types.dataset.jax"
$type-choice /= "c2pa.types.dataset.keras"
$type-choice /= "c2pa.types.dataset.ml_net"
$type-choice /= "c2pa.types.dataset.mxnet"
$type-choice /= "c2pa.types.dataset.onnx"
$type-choice /= "c2pa.types.dataset.openvino"
$type-choice /= "c2pa.types.dataset.pytorch"
$type-choice /= "c2pa.types.dataset.tensorflow"
$type-choice /= "c2pa.types.format.numpy"
$type-choice /= "c2pa.types.format.protobuf"
$type-choice /= "c2pa.types.format.pickle"
$type-choice /= "c2pa.types.generator"
$type-choice /= "c2pa.types.generator.prompt"
$type-choice /= "c2pa.types.generator.seed"
$type-choice /= "c2pa.types.model"
$type-choice /= "c2pa.types.model.jax"
$type-choice /= "c2pa.types.model.keras"
$type-choice /= "c2pa.types.model.ml_net"
$type-choice /= "c2pa.types.model.mxnet"
$type-choice /= "c2pa.types.model.onnx"
$type-choice /= "c2pa.types.model.openvino"
$type-choice /= "c2pa.types.model.openvino.parameter"
$type-choice /= "c2pa.types.model.openvino.topology"
$type-choice /= "c2pa.types.model.pytorch"
$type-choice /= "c2pa.types.model.tensorflow"
$type-choice /= "c2pa.types.regressor"
$type-choice /= "c2pa.types.tensorflow.hubmodule"
$type-choice /= "c2pa.types.tensorflow.savedmodel"
$type-choice /= tstr .regexp "([\\da-zA-Z_-]+\\.)+[\\da-zA-Z_-]+"

asset-type-map = {
  "type": $type-choice, ; one of the listed choices or a custom value
  ? "version": tstr .regexp "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$"
}

asset-types = {
  "types": [1* asset-type-map] ; An array of asset-type-map elements specifying a collection of types related to the asset
  ? "metadata": $assertion-metadata-map ; additional information about the assertion
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) is shown below. In this example, the asset is a TensorFlow model file of version 2.11.0 which is stored in the SavedModel format.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{
  "types":
  [
    {
      "type": "c2pa.types.model.tensorflow",
      "version": "2.11.0"
    },
    {
      "type": "c2pa.types.savedmodel",
      "version": "2.11.0"
    }
  ]
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_details_on_selection_of_a_value_for_type"><a class="anchor" href="#_details_on_selection_of_a_value_for_type"></a>18.16.2. Details on selection of a value for <code>type</code></h4>
<div class="paragraph">
<p>If an asset&#8217;s exact type is specified in the <a href="https://www.iana.org/assignments/media-types/media-types.xhtml#application">IANA registry application type</a> or <a href="https://www.iana.org/assignments/media-types/media-types.xhtml#text">IANA registry text type</a>, including JSON, CSV, and XML types, this information shall be included in the claim&#8217;s <code>dc:format</code> field.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>For example, if the asset is a CSV formatted text file, the <code>dc:format</code> field would be <code>text/csv</code>.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>These existing Dublin Core formats are not specified as C2PA standard asset type assertion types, but an asset type assertion may be included to provide additional information about the asset&#8217;s type. Some existing Dublin Core types that are commonly used in a Claim with an asset type assertion are specified in the following table.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 36.8421%;">
<col style="width: 63.1579%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">dc:format Value</th>
<th class="tableblock halign-left valign-top">Description of Dublin Core Type of the Asset</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">application/json</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored using the JSON format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">application/gzip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored using the GZIP format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">application/vnd.rar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored using the RAR format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">application/zip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored using the ZIP format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">application/octet-stream</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored using an arbitrary binary format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">text/csv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored using the CSV format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">text/plain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored using the plain text format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">text/tab-separated-values</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored using the tab-separated-values (TSV) text format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">text/xml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored using the XML format</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="https://www.iana.org/assignments/media-type-structured-suffix/media-type-structured-suffix.xhtml">IANA structured suffixes</a>, such as <code>+json</code> and <code>+zip</code>, are also supported in the C2PA Claim&#8217;s <code>dc:format</code> field to specify additional types.</p>
</div>
<div class="paragraph">
<p>Some dc:format types are commonly used but are not specified in the <a href="https://www.iana.org/assignments/media-types/media-types.xhtml">IANA registry</a>. The following <code>dc:format</code> values are valid for C2PA assets.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 36.8421%;">
<col style="width: 63.1579%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">dc:format Value</th>
<th class="tableblock halign-left valign-top">Description of Dublin Core Type of the Asset</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">application/x-hdf5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored using the HDF5 format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">application/x-7z-compressed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stored using the 7Z format</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_depthmap"><a class="anchor" href="#_depthmap"></a>18.17. Depthmap</h3>
<div class="paragraph">
<p>A depthmap assertion provides a 3D description of the scene being captured by a camera. A depthmap assertion may contain a pre-computed <a href="https://en.wikipedia.org/wiki/Depth_map">depth map</a>, or data which can later be used to compute a depth map by downstream ingestion or viewing software (e.g., left/right stereo images).</p>
</div>
<div class="paragraph">
<p>All depthmap assertions shall have a label that starts with <code>c2pa.depthmap</code> and be followed by a third section that identifies the type of depth map.</p>
</div>
<div class="paragraph">
<p>C2PA depthmap assertions shall be captured optically, not inferred from a single 2D image via, for example, a machine learning model.</p>
</div>
<div class="sect3">
<h4 id="_gdepth_depthmap"><a class="anchor" href="#_gdepth_depthmap"></a>18.17.1. GDepth Depthmap</h4>
<div class="paragraph">
<p>A GDepth depth map assertion leverages the well-established <a href="https://developers.google.com/depthmap-metadata/reference">GDepth format</a> to encode a pre-computed depth map.</p>
</div>
<div class="paragraph">
<p>A GDepth depthmap assertion shall have a label of <code>c2pa.depthmap.GDepth</code>.</p>
</div>
<div class="paragraph">
<p>The schema for the data stored in this assertion should always mirror the schema at <a href="https://developers.google.com/depthmap-metadata/reference" class="bare">https://developers.google.com/depthmap-metadata/reference</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
There is no need to worry about splitting up the GDepth data when it grows beyond 64KB, as that limit existed in XMP to accommodate APP1 segment size limitations.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_schema_and_example_12"><a class="anchor" href="#_schema_and_example_12"></a>18.17.2. Schema and Example</h4>
<div class="paragraph">
<p>The schema for this type is defined by the <code>depthmap-gdepth-map</code> rule in the following <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; Assertion that encodes a GDepth-formatted 3D depth map of the captured scene
depthmap-gdepth-map = {
  "GDepth:Format": format-type, ; The format that describes how to convert the depthmap data into a valid float-point depthmap. Current valid values are 'RangeInverse' and 'RangeLinear'
  "GDepth:Near": float, ; The near value of the depthmap in depth units
  "GDepth:Far": float,  ; The far value of the depthmap in depth units
  "GDepth:Mime": mime-type,  ;  The mime type for the base64 string describing the depth image content, e.g. 'image/jpeg' or 'image/png'",
  "GDepth:Data": base64-string-type,  ; The base64 encoded depth image. Please see GDepth encoding page at developers.google.com. The depthmap will be stretched-to-fit the corresponding color image
  ? "GDepth:Units": unit-type,   ; The units of the depthmap, e.g. 'm' for meters or 'mm' for millimeters
  ? "GDepth:MeasureType": depth-meas-type,  ; The type of depth measurement. Current valid values are 'OpticalAxis' and 'OpticRay
  ? "GDepth:ConfidenceMime": confidence-mime-type,  ; The mime type for the base64 string describing the confidence image content, e.g. 'image/png'.",
  ? "GDepth:Confidence": base64-string-type,   ; The base64 encoded confidence image. Please see GDepth encoding page at developers.google.com. The confidence map should have the same size as the depthmap
  ? "GDepth:Manufacturer": tstr .size (1..max-tstr-length),  ; The manufacturer of the device that created this depthmap
  ? "GDepth:Model": tstr .size (1..max-tstr-length),  ; The model of the device that created this depthmap
  ? "GDepth:Software": tstr .size (1..max-tstr-length), ; The software that created this depthmap
  ? "GDepth:ImageWidth": float, ; The width in pixels of the original color image associated to this depthmap. This is NOT the depthmap width. If present, apps must update this property when scaling, cropping or rotating the color image. Clients use this property to verify the integrity of the depthmap w.r.t. the color image
  ? "GDepth:ImageHeight": float, ; The height in pixels of the original color image associated to this depthmap. This is NOT the depthmap height. If present, apps must update this property when scaling, cropping or rotating the color image. Clients use this property to verify the integrity of the depthmap w.r.t. the color image
  ? "metadata": $assertion-metadata-map, ; additional information about the assertion
}

base64-string-type = tstr

$mime-choice /= "image/jpeg" 
$mime-choice /= "image/png"

mime-type = $mime-choice .default "image/jpeg"
confidence-mime-type = $mime-choice .default "image/png"

$format-choice /= "RangeInverse"
$format-choice /= "RangeLinear"

format-type = $format-choice .default "RangeInverse"

; Unit can be meter represented as "m" or could be millimeter represented as "mm"
$unit-choice /= "m"
$unit-choice /= "mm"
unit-type = $unit-choice .default "m"

$depth-meas-choice /= "OpticalAxis"
$depth-meas-choice /= "OpticRay"
depth-meas-type = $depth-meas-choice .default "OpticalAxis"</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR Diagnostic Format (<code>.cbordiag</code>) is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{
  "GDepth:Far": 878.7,
  "GDepth:Data": "hoOspQQ1lFTy/4Tp8Epx670E5QW5NwkNR+2b30KFXug=",
  "GDepth:Mime": "image/jpeg",
  "GDepth:Near": 29.3,
  "GDepth:Model": "CameraCompany Shooter S1",
  "GDepth:Units": "mm",
  "GDepth:Format": "RangeInverse",
  "GDepth:Software": "Truepic Foresight Firmware for QC QRD8250 v0.01",
  "GDepth:Confidence": "acdbpQQ1lFTy/4Tp8Epx670E5QW5NwkNR+2b30KFXug=",
  "GDepth:ImageWidth": 32.2,
  "GDepth:ImageHeight": 43.6
  "GDepth:MeasureType": "OpticalAxis",
  "GDepth:Manufacturer": "CameraCompany",
  "GDepth:ConfidenceMime": "image/png",
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As defined by the GDepth specification, the following fields shall be present in all GDepth depth map assertions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>GDepth:Format</p>
</li>
<li>
<p>GDepth:Near</p>
</li>
<li>
<p>GDepth:Far</p>
</li>
<li>
<p>GDepth:Mime</p>
</li>
<li>
<p>GDepth:Data</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_font_information"><a class="anchor" href="#_font_information"></a>18.18. Font Information</h3>
<div class="paragraph">
<p>A Font Information assertion can be used to ensure that basic font metadata, such as the name, format, creator attribution, and licensing, are added to the asset in a manner which may be validated cryptographically.</p>
</div>
<div class="paragraph">
<p>A Font Information assertion shall have a label of <code>font.info</code>, and there shall be at most one Font Information assertion per manifest.</p>
</div>
<div class="sect3">
<h4 id="_schema_and_example_13"><a class="anchor" href="#_schema_and_example_13"></a>18.18.1. Schema and Example</h4>
<div class="paragraph">
<p>The schema for this type is defined by the <code>font-info-map</code> rule in the following <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cddl hljs" data-lang="cddl">; Assertion data for font.info assertion.
font-info-map = {
  "fullName": tstr, ; The full name of the font.
  ; A version in the semantic versioning (semver) format.
  ? "version": tstr .regexp "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$", 
  ? "versionUrl": ext-url-regexp-type, ; A URL to the release notes associated with this version of the font.
  ? "releaseDate": tdate, ; The date this version of the font was released or published.
  "familyName": tstr, ; The Font Family.
  "style": $font-style, ; The style of the font, e.g. italic or regular.
  "weight": font-weight-map, ; The weight of the font with name and value.
  ; The PostScript name, ID 6, from the font 'name' table.
  "postScriptName": tstr .regexp "^(?!.*[\\[\\]\\(\\)\\{\\}&lt;&gt;\\/%])[!-~]{1,63}$", ; Characters from ASCII 33-126 except the following: [](){}&lt;&gt;/%
  "format": $font-format-choice, ; The format of this font.
  "copyrightNotice": tstr, ; The copyright associated with this font.
  ? "copyrightHolder": font-entity-map, ; The entity that holds the copyright to the font.
  ? "copyrightYears": [1* font-copyright-year-range], ; The years for which the holder asserts copyright.
  ? "designers": [1* font-designer-map], ; The individuals that designed the font. 
  ? "designFoundry": font-entity-map, ; The foundry that designed the font.
  ? "sourceFoundry": font-entity-map, ; The foundry that distributes the font.
  ? "identifier": tstr, ; Internal identier of font for foundry or vendor use.
}

; Font Formats
$font-format-choice /= "TrueType"
$font-format-choice /= "OpenType"

; Copyright year range
font-copyright-year-range = 1..9999

; Font weight range
font-weight-range = 1..1000

; Font weight class descriptors
$font-weight-class /= "Microline"
$font-weight-class /= "Hairline"
$font-weight-class /= "UltraThin"
$font-weight-class /= "ExtraThin"
$font-weight-class /= "Thin"
$font-weight-class /= "UltraLight"
$font-weight-class /= "ExtraLight"
$font-weight-class /= "Light"
$font-weight-class /= "SemiLight"
$font-weight-class /= "Book"
$font-weight-class /= "Normal"
$font-weight-class /= "Regular"
$font-weight-class /= "Medium"
$font-weight-class /= "DemiBold"
$font-weight-class /= "SemiBold"
$font-weight-class /= "Bold"
$font-weight-class /= "Heavy"
$font-weight-class /= "ExtraBold"
$font-weight-class /= "UltraBold"
$font-weight-class /= "SemiBlack"
$font-weight-class /= "Black"
$font-weight-class /= "ExtraBlack"
$font-weight-class /= "UltraBlack"
$font-weight-class /= "MegaBlack"

; The font style
$font-style /= "Normal"
$font-style /= "Italic"
$font-style /= "Oblique"
$font-style /= "Roman"
$font-style /= "Regular"

; Data for a font weight
font-weight-map = {
  "class": $font-weight-class, ; The descriptive name of the weight class, e.g. bold or thin.
  "value": font-weight-range, ; The value of the weight.
}

; Data for an entity with a name and credentials
font-entity-map = {
  "name": tstr, ; The name of the person or foundry.
  ? "url": ext-url-regexp-type, ; A URL for additional information about this person or foundry.
}

; Data for a font designer
font-designer-map = {
  "person": font-entity-map, ; The person who designed the font.
  ? "foundry": font-entity-map, ; The name of the foundry with which the designer was associated when contributing to the font design.
  ? "contribution": tstr, ; A description of what the designer contributed to the font. For example, 'All the Latin and Arabic characters'.
  ? "startDate": tdate, ; "When the designer started to contribute to the font design.
  ? "endDate": tdate, ; When the designer ended contributions to the font design.
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A basic example in CBOR Diagnostic Format (<code>.cbordiag</code>), containing only required fields, is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{
    "fullName": "Example Two Italic",
    "familyName": "ExampleTwo",
    "style": "Italic",
    "weight": {
        "class": "Regular",
        "value": 400
    },
    "postScriptName": "Example-Two-Italic",
    "format": "TrueType",
    "copyrightNotice": "Copyright 2011 The Example Two Project Authors (https://www.example.com/lifonts/Example-Two), with Reserved Font Name 'Example Two'.",
    "copyrightHolder": {
        "name": "Fabrikam"
    },
    "designers": [
        {
            "person": {
              "name": "John Doe",
              "url": "https://fabrikam.example.com/jdoefonts"
            }
        }
    ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This extended example demonstrates optional fields as well:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{
    "fullName": "Example Font Bold Italic",
    "version": "7.0.4-beta",
    "versionUrl": "https://fabrikam.example.com/release/efbi/7.0",
    "familyName": "ExampleFont",
    "style": "Italic",
    "weight": {
        "class": "Bold",
        "value": 700
    },
    "postScriptName": "ExampleFont-BoldItalic",
    "format": "OpenType",
    "copyrightNotice": "© 2017 Fabrikam, Inc. All Rights Reserved.",
    "copyrightHolder": {
        "name": "Fabrikam Inc."
    },
    "copyrightYears": [
        1982,
        2017
    ],
    "designers": [
        {
            "person": {
              "name": "John Doe",
              "url": "https://fabrikam.example.com/browse/designers/john-doe"
            },
            "foundry": {
               "name": "Fabrikam Fonts"
            },
            "contribution": "Ligatures."
        },
        {
            "person": {
              "name": "Jane Doe"
            },
            "foundry": {
                "name": "Fabrikam Fonts"
            },
            "contribution": "All characters."
        }
    ],
    "designFoundry": {
        "name": "Fabrikam Fonts",
        "url": "https://fabrikam.example.com"
    },
    "sourceFoundry": {
        "name": "Fonts Direct 2 U",
        "url": "https://fd2u.example.com"
    },
    "identifier": "ExampleFont Bold Italic (Fabrikam)"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_patent_policy"><a class="anchor" href="#_patent_policy"></a>19. Patent Policy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The C2PA has adopted an open standard patent policy via W3C&#8217;s Patent Mode (2004):</p>
</div>
<div class="paragraph">
<p><strong>Licensing Commitment</strong>. For materials other than source code or datasets developed by the Working Group, each Working Group Participant agrees to make available any of its Essential Claims, as defined in the W3C Patent Policy (available at <a href="http://www.w3.org/Consortium/Patent-Policy-20040205" class="bare">http://www.w3.org/Consortium/Patent-Policy-20040205</a>), under the W3C RF licensing requirements Section 5 (<a href="http://www.w3.org/Consortium/Patent-Policy-20040205" class="bare">http://www.w3.org/Consortium/Patent-Policy-20040205</a>), in Approved Deliverables adopted by that Working Group as if that Approved Deliverable was a W3C Recommendation. Source code developed by the Working Group is subject to the license set forth in the Working Group charter.</p>
</div>
<div class="paragraph">
<p><strong>For Exclusion</strong>. Prior to the adoption of a Draft Deliverable as an Approved Deliverable, a Working Group Participant may exclude Essential Claims from its licensing commitments under this agreement by providing written notice of that intent to the Working Group chair (“Exclusion Notice”). The Exclusion Notice for issued patents and published applications must include the patent number(s) or title and application number(s), as the case may be, for each of the issued patent(s) or pending patent application(s) that the Working Group Participant wishes to exclude from the licensing commitment set forth in Section 1 of this patent policy. If an issued patent or pending patent application that may contain Essential Claims is not set forth in the Exclusion Notice, those Essential Claims shall continue to be subject to the licensing commitments under this agreement. The Exclusion Notice for unpublished patent applications must provide either: (i) the text of the filed application; or (ii) identification of the specific part(s) of the Draft Deliverable whose implementation makes the excluded claim an Essential Claim. If (ii) is chosen, the effect of the exclusion will be limited to the identified part(s) of the Draft Deliverable. The Working Group Chair will publish Exclusion Notices.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="metadata_annex"><a class="anchor" href="#metadata_annex"></a>Appendix A: Implementation Details for <code>c2pa.metadata</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>c2pa.metadata</code> assertion shall only contain the subset of schemas and their fields as described below. However <a href="#_common_requirements">custom metadata assertions</a> can contain any values from these or other schemas.</p>
</div>
<div class="paragraph">
<p>The values present in a <code>c2pa.metadata</code> assertion may be unique to the metadata assertion or they may be taken from the standard "metadata blocks" of the asset format. In either case, they shall be serialized according to the rules of <a href="https://www.iso.org/standard/79384.html">JSON-LD serialization of XMP</a> as described <a href="#_common_requirements">here</a>.</p>
</div>
<div class="sect2">
<h3 id="_completely_supported_schemas"><a class="anchor" href="#_completely_supported_schemas"></a>A.1. Completely Supported Schemas</h3>
<div class="paragraph">
<p>The following schemas/namespaces are supported in full by any signer:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://developer.adobe.com/xmp/docs/XMPNamespaces/xmp/">XMP Basic</a> - <a href="http://ns.adobe.com/xap/1.0/" class="bare">http://ns.adobe.com/xap/1.0/</a></p>
</li>
<li>
<p><a href="https://developer.adobe.com/xmp/docs/XMPNamespaces/xmpMM/">XMP Media Management</a> - <a href="http://ns.adobe.com/xap/1.0/mm/" class="bare">http://ns.adobe.com/xap/1.0/mm/</a></p>
</li>
<li>
<p><a href="https://developer.adobe.com/xmp/docs/XMPNamespaces/xmpTPg/">XMP Paged-Text</a> - <a href="http://ns.adobe.com/xap/1.0/t/pg/" class="bare">http://ns.adobe.com/xap/1.0/t/pg/</a></p>
</li>
<li>
<p><a href="https://developer.adobe.com/xmp/docs/XMPNamespaces/crs/">Camera Raw</a> - <a href="http://ns.adobe.com/camera-raw-settings/1.0/" class="bare">http://ns.adobe.com/camera-raw-settings/1.0/</a></p>
</li>
<li>
<p><a href="https://developer.adobe.com/xmp/docs/XMPNamespaces/pdf/">PDF</a> - <a href="http://ns.adobe.com/pdf/1.3/" class="bare">http://ns.adobe.com/pdf/1.3/</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_partially_supported_schemas"><a class="anchor" href="#_partially_supported_schemas"></a>A.2. Partially Supported Schemas</h3>
<div class="paragraph">
<p>The following schemas/namespaces are only supported in part.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://developer.adobe.com/xmp/docs/XMPNamespaces/dc/">Dublin Core (DC)</a> - <a href="http://purl.org/dc/elements/1.1/" class="bare">http://purl.org/dc/elements/1.1/</a></p>
</li>
<li>
<p><a href="http://iptc.org/std/photometadata/specification/IPTC-PhotoMetadata-2023.1.html#iptc-core-schema-1-4-specifications">IPTC Core</a> - <a href="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/" class="bare">http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/</a></p>
</li>
<li>
<p><a href="https://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata#iptc-extension-schema-1-8-specifications">IPTC Extension</a> - <a href="http://iptc.org/std/Iptc4xmpExt/2008-02-29/" class="bare">http://iptc.org/std/Iptc4xmpExt/2008-02-29/</a></p>
</li>
<li>
<p><a href="https://developer.adobe.com/xmp/docs/XMPNamespaces/exif/">Exif</a> - <a href="http://ns.adobe.com/exif/1.0/" class="bare">http://ns.adobe.com/exif/1.0/</a></p>
</li>
<li>
<p><a href="https://exiv2.org/tags-xmp-exifEX.html">ExifEx</a> - <a href="http://cipa.jp/exif/1.0/exifEX" class="bare">http://cipa.jp/exif/1.0/exifEX</a></p>
</li>
<li>
<p><a href="https://developer.adobe.com/xmp/docs/XMPNamespaces/photoshop/">Photoshop</a> - <a href="http://ns.adobe.com/photoshop/1.0/" class="bare">http://ns.adobe.com/photoshop/1.0/</a></p>
</li>
<li>
<p><a href="https://developer.adobe.com/xmp/docs/XMPNamespaces/tiff/">TIFF</a> - <a href="http://ns.adobe.com/tiff/1.0/" class="bare">http://ns.adobe.com/tiff/1.0/</a></p>
</li>
<li>
<p><a href="https://developer.adobe.com/xmp/docs/XMPNamespaces/xmpDM/">XMP Dynamic Media</a> - <a href="http://ns.adobe.com/xmp/1.0/DynamicMedia/" class="bare">http://ns.adobe.com/xmp/1.0/DynamicMedia/</a></p>
</li>
<li>
<p><a href="http://ns.useplus.org/LDF/ldf-XMPSpecification">PLUS</a> - <a href="http://ns.useplus.org/ldf/xmp/1.0/" class="bare">http://ns.useplus.org/ldf/xmp/1.0/</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_dublin_core_dc"><a class="anchor" href="#_dublin_core_dc"></a>A.2.1. Dublin Core (DC)</h4>
<div class="paragraph">
<p>Only the following Dublin Core (<code>dc</code>) properties are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>dc:coverage</code></p>
</li>
<li>
<p><code>dc:date</code></p>
</li>
<li>
<p><code>dc:format</code></p>
</li>
<li>
<p><code>dc:identifier</code></p>
</li>
<li>
<p><code>dc:language</code></p>
</li>
<li>
<p><code>dc:relation</code></p>
</li>
<li>
<p><code>dc:type</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_iptc_core"><a class="anchor" href="#_iptc_core"></a>A.2.2. IPTC Core</h4>
<div class="paragraph">
<p>Only the following IPTC Core (<code>Iptc4xmpCore</code>) properties are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Iptc4xmpCore:Scene</code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Some IPTC Core properties have been superseded by newer versions in the IPTC Extension schema.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_iptc_extension"><a class="anchor" href="#_iptc_extension"></a>A.2.3. IPTC Extension</h4>
<div class="paragraph">
<p>Only the following IPTC Extension (<code>Iptc4xmpExt</code>) properties are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Iptc4xmpExt:DigImageGUID</code></p>
</li>
<li>
<p><code>Iptc4xmpExt:DigitalSourceType</code></p>
</li>
<li>
<p><code>Iptc4xmpExt:EventId</code></p>
</li>
<li>
<p><code>Iptc4xmpExt:Genre</code></p>
</li>
<li>
<p><code>Iptc4xmpExt:ImageRating</code></p>
</li>
<li>
<p><code>Iptc4xmpExt:ImageRegion</code></p>
</li>
<li>
<p><code>Iptc4xmpExt:RegistryId</code></p>
</li>
<li>
<p><code>Iptc4xmpExt:LocationCreated</code></p>
</li>
<li>
<p><code>Iptc4xmpExt:LocationShown</code></p>
</li>
<li>
<p><code>Iptc4xmpExt:MaxAvailHeight</code></p>
</li>
<li>
<p><code>Iptc4xmpExt:MaxAvailWidth</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information about these, see <a href="https://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata#xmp-namespaces-and-identifiers-2" class="bare">https://www.iptc.org/std/photometadata/specification/IPTC-PhotoMetadata#xmp-namespaces-and-identifiers-2</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_exif"><a class="anchor" href="#_exif"></a>A.2.4. Exif</h4>
<div class="paragraph">
<p>Only the following Exif properties are supported:</p>
</div>
<table class="tableblock frame-none grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><code>exif:ApertureValue</code></p>
</li>
<li>
<p><code>exif:BrightnessValue</code></p>
</li>
<li>
<p><code>exif:CFAPattern</code></p>
</li>
<li>
<p><code>exif:ColorSpace</code></p>
</li>
<li>
<p><code>exif:CompressedBitsPerPixel</code></p>
</li>
<li>
<p><code>exif:Contrast</code></p>
</li>
<li>
<p><code>exif:CustomRendered</code></p>
</li>
<li>
<p><code>exif:DateTimeDigitized</code></p>
</li>
<li>
<p><code>exif:DateTimeOriginal</code></p>
</li>
<li>
<p><code>exif:DeviceSettingDescription</code></p>
</li>
<li>
<p><code>exif:DigitalZoomRatio</code></p>
</li>
<li>
<p><code>exif:ExifVersion</code></p>
</li>
<li>
<p><code>exif:ExposureBiasValue</code></p>
</li>
<li>
<p><code>exif:ExposureIndex</code></p>
</li>
<li>
<p><code>exif:ExposureMode</code></p>
</li>
<li>
<p><code>exif:ExposureProgram</code></p>
</li>
<li>
<p><code>exif:ExposureTime</code></p>
</li>
<li>
<p><code>exif:FileSource</code></p>
</li>
<li>
<p><code>exif:Flash</code></p>
</li>
<li>
<p><code>exif:FlashEnergy</code></p>
</li>
<li>
<p><code>exif:FlashpixVersion</code></p>
</li>
<li>
<p><code>exif:FNumber</code></p>
</li>
<li>
<p><code>exif:FocalLength</code></p>
</li>
<li>
<p><code>exif:FocalLengthIn35mmFilm</code></p>
</li>
<li>
<p><code>exif:FocalPlaneResolutionUnit</code></p>
</li>
<li>
<p><code>exif:FocalPlaneXResolution</code></p>
</li>
<li>
<p><code>exif:FocalPlaneYResolution</code></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><code>exif:GainControl</code></p>
</li>
<li>
<p><code>exif:ImageUniqueID</code></p>
</li>
<li>
<p><code>exif:ISOSpeedRatings</code></p>
</li>
<li>
<p><code>exif:LightSource</code></p>
</li>
<li>
<p><code>exif:MaxApertureValue</code></p>
</li>
<li>
<p><code>exif:MeteringMode</code></p>
</li>
<li>
<p><code>exif:OECF</code></p>
</li>
<li>
<p><code>exif:PixelXDimension</code></p>
</li>
<li>
<p><code>exif:PixelYDimension</code></p>
</li>
<li>
<p><code>exif:RelatedSoundFile</code></p>
</li>
<li>
<p><code>exif:Saturation</code></p>
</li>
<li>
<p><code>exif:SceneCaptureType</code></p>
</li>
<li>
<p><code>exif:SceneType</code></p>
</li>
<li>
<p><code>exif:SensingMethod</code></p>
</li>
<li>
<p><code>exif:Sharpness</code></p>
</li>
<li>
<p><code>exif:ShutterSpeedValue</code></p>
</li>
<li>
<p><code>exif:SpatialFrequencyResponse</code></p>
</li>
<li>
<p><code>exif:SpectralSensitivity</code></p>
</li>
<li>
<p><code>exif:SubjectArea</code></p>
</li>
<li>
<p><code>exif:SubjectDistance</code></p>
</li>
<li>
<p><code>exif:SubjectDistanceRange</code></p>
</li>
<li>
<p><code>exif:SubjectLocation</code></p>
</li>
<li>
<p><code>exif:WhiteBalance</code></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><code>exif:GPSAltitude</code></p>
</li>
<li>
<p><code>exif:GPSAltitudeRef</code></p>
</li>
<li>
<p><code>exif:GPSDestBearing</code></p>
</li>
<li>
<p><code>exif:GPSDestBearingRef</code></p>
</li>
<li>
<p><code>exif:GPSDestDistance</code></p>
</li>
<li>
<p><code>exif:GPSDestDistanceRef</code></p>
</li>
<li>
<p><code>exif:GPSDestLatitude</code></p>
</li>
<li>
<p><code>exif:GPSDestLongitude</code></p>
</li>
<li>
<p><code>exif:GPSDifferential</code></p>
</li>
<li>
<p><code>exif:GPSDOP</code></p>
</li>
<li>
<p><code>exif:GPSImgDirection</code></p>
</li>
<li>
<p><code>exif:GPSImgDirectionRef</code></p>
</li>
<li>
<p><code>exif:GPSLatitude</code></p>
</li>
<li>
<p><code>exif:GPSLongitude</code></p>
</li>
<li>
<p><code>exif:GPSMapDatum</code></p>
</li>
<li>
<p><code>exif:GPSMeasureMode</code></p>
</li>
<li>
<p><code>exif:GPSProcessingMethod</code></p>
</li>
<li>
<p><code>exif:GPSSatellites</code></p>
</li>
<li>
<p><code>exif:GPSSpeed</code></p>
</li>
<li>
<p><code>exif:GPSSpeedRef</code></p>
</li>
<li>
<p><code>exif:GPSStatus</code></p>
</li>
<li>
<p><code>exif:GPSTimeStamp</code></p>
</li>
<li>
<p><code>exif:GPSTrack</code></p>
</li>
<li>
<p><code>exif:GPSTrackRef</code></p>
</li>
<li>
<p><code>exif:GPSVersionID</code></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_exifex"><a class="anchor" href="#_exifex"></a>A.2.5. ExifEx</h4>
<div class="paragraph">
<p>Only the following ExifEx properties are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>exifEX:Gamma</code></p>
</li>
<li>
<p><code>exifEX:PhotographicSensitivity</code></p>
</li>
<li>
<p><code>exifEX:SensitivityType</code></p>
</li>
<li>
<p><code>exifEX:StandardOutput-Sensitivity</code></p>
</li>
<li>
<p><code>exifEX:RecommendedExposureIndex</code></p>
</li>
<li>
<p><code>exifEX:ISOSpeed</code></p>
</li>
<li>
<p><code>exifEX:ISOSpeedLatitudeyyy</code></p>
</li>
<li>
<p><code>exifEX:ISOSpeedLatitudezzz</code></p>
</li>
<li>
<p><code>exifEX:BodySerialNumber</code></p>
</li>
<li>
<p><code>exifEX:LensSpecification</code></p>
</li>
<li>
<p><code>exifEX:LensMake</code></p>
</li>
<li>
<p><code>exifEX:LensModel</code></p>
</li>
<li>
<p><code>exifEX:LensSerialNumber</code></p>
</li>
<li>
<p><code>exifEX:InteroperabilityIndex</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information about these, see <a href="https://www.cipa.jp/std/documents/download_e.html?DC-010-2020_E" class="bare">https://www.cipa.jp/std/documents/download_e.html?DC-010-2020_E</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_photoshop"><a class="anchor" href="#_photoshop"></a>A.2.6. Photoshop</h4>
<div class="paragraph">
<p>Only the following Photoshop properties are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>photoshop:ColorMode</code></p>
</li>
<li>
<p><code>photoshop:DocumentAncestors</code></p>
</li>
<li>
<p><code>photoshop:History</code></p>
</li>
<li>
<p><code>photoshop:ICCProfile</code></p>
</li>
<li>
<p><code>photoshop:TextLayers</code></p>
</li>
<li>
<p><code>photoshop:Category</code></p>
</li>
<li>
<p><code>photoshop:City</code></p>
</li>
<li>
<p><code>photoshop:Country</code></p>
</li>
<li>
<p><code>photoshop:DateCreated</code></p>
</li>
<li>
<p><code>photoshop:State</code></p>
</li>
<li>
<p><code>photoshop:SupplementalCategories</code></p>
</li>
<li>
<p><code>photoshop:TransmissionReference</code></p>
</li>
<li>
<p><code>photoshop:Urgency</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_tiff"><a class="anchor" href="#_tiff"></a>A.2.7. TIFF</h4>
<div class="paragraph">
<p>Only the following TIFF properties are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>tiff:BitsPerSample</code></p>
</li>
<li>
<p><code>tiff:Compression</code></p>
</li>
<li>
<p><code>tiff:DateTime</code></p>
</li>
<li>
<p><code>tiff:ImageLength</code></p>
</li>
<li>
<p><code>tiff:ImageWidth</code></p>
</li>
<li>
<p><code>tiff:Make</code></p>
</li>
<li>
<p><code>tiff:Model</code></p>
</li>
<li>
<p><code>tiff:Orientation</code></p>
</li>
<li>
<p><code>tiff:PhotometricInterpretation</code></p>
</li>
<li>
<p><code>tiff:PlanarConfiguration</code></p>
</li>
<li>
<p><code>tiff:PrimaryChromaticities</code></p>
</li>
<li>
<p><code>tiff:ReferenceBlackWhite</code></p>
</li>
<li>
<p><code>tiff:ResolutionUnit</code></p>
</li>
<li>
<p><code>tiff:SamplesPerPixel</code></p>
</li>
<li>
<p><code>tiff:Software</code></p>
</li>
<li>
<p><code>tiff:TransferFunction</code></p>
</li>
<li>
<p><code>tiff:WhitePoint</code></p>
</li>
<li>
<p><code>tiff:XResolution</code></p>
</li>
<li>
<p><code>tiff:YResolution</code></p>
</li>
<li>
<p><code>tiff:YCbCrCoefficients</code></p>
</li>
<li>
<p><code>tiff:YCbCrPositioning</code></p>
</li>
<li>
<p><code>tiff:YCbCrSubSampling</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_xmp_dynamic_media"><a class="anchor" href="#_xmp_dynamic_media"></a>A.2.8. XMP Dynamic Media</h4>
<div class="paragraph">
<p>Only the following XMP Dynamic Media (<code>xmpDM</code>) properties are supported:</p>
</div>
<table class="tableblock frame-none grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><code>xmpDM:absPeakAudioFilePath</code></p>
</li>
<li>
<p><code>xmpDM:album</code></p>
</li>
<li>
<p><code>xmpDM:altTapeName</code></p>
</li>
<li>
<p><code>xmpDM:altTimecode</code></p>
</li>
<li>
<p><code>xmpDM:audioChannelType</code></p>
</li>
<li>
<p><code>xmpDM:audioCompressor</code></p>
</li>
<li>
<p><code>xmpDM:audioSampleRate</code></p>
</li>
<li>
<p><code>xmpDM:audioSampleType</code></p>
</li>
<li>
<p><code>xmpDM:beatSpliceParams</code></p>
</li>
<li>
<p><code>xmpDM:cameraAngle</code></p>
</li>
<li>
<p><code>xmpDM:cameraLabel</code></p>
</li>
<li>
<p><code>xmpDM:cameraModel</code></p>
</li>
<li>
<p><code>xmpDM:cameraMove</code></p>
</li>
<li>
<p><code>xmpDM:comment</code></p>
</li>
<li>
<p><code>xmpDM:contributedMedia</code></p>
</li>
<li>
<p><code>xmpDM:duration</code></p>
</li>
<li>
<p><code>xmpDM:fileDataRate</code></p>
</li>
<li>
<p><code>xmpDM:genre</code></p>
</li>
<li>
<p><code>xmpDM:good</code></p>
</li>
<li>
<p><code>xmpDM:instrument</code></p>
</li>
<li>
<p><code>xmpDM:introTime</code></p>
</li>
<li>
<p><code>xmpDM:key</code></p>
</li>
<li>
<p><code>xmpDM:logComment</code></p>
</li>
<li>
<p><code>xmpDM:loop</code></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><code>xmpDM:numberOfBeats</code></p>
</li>
<li>
<p><code>xmpDM:markers</code></p>
</li>
<li>
<p><code>xmpDM:outCue</code></p>
</li>
<li>
<p><code>xmpDM:projectName</code></p>
</li>
<li>
<p><code>xmpDM:projectRef</code></p>
</li>
<li>
<p><code>xmpDM:pullDown</code></p>
</li>
<li>
<p><code>xmpDM:relativePeakAudioFilePath</code></p>
</li>
<li>
<p><code>xmpDM:relativeTimestamp</code></p>
</li>
<li>
<p><code>xmpDM:releaseDate</code></p>
</li>
<li>
<p><code>xmpDM:resampleParams</code></p>
</li>
<li>
<p><code>xmpDM:scaleType</code></p>
</li>
<li>
<p><code>xmpDM:scene</code></p>
</li>
<li>
<p><code>xmpDM:shotDate</code></p>
</li>
<li>
<p><code>xmpDM:shotDay</code></p>
</li>
<li>
<p><code>xmpDM:shotLocation</code></p>
</li>
<li>
<p><code>xmpDM:shotName</code></p>
</li>
<li>
<p><code>xmpDM:shotNumber</code></p>
</li>
<li>
<p><code>xmpDM:shotSize</code></p>
</li>
<li>
<p><code>xmpDM:speakerPlacement</code></p>
</li>
<li>
<p><code>xmpDM:startTimecode</code></p>
</li>
<li>
<p><code>xmpDM:stretchMode</code></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><code>xmpDM:takeNumber</code></p>
</li>
<li>
<p><code>xmpDM:tapeName</code></p>
</li>
<li>
<p><code>xmpDM:tempo</code></p>
</li>
<li>
<p><code>xmpDM:timeScaleParams</code></p>
</li>
<li>
<p><code>xmpDM:timeSignature</code></p>
</li>
<li>
<p><code>xmpDM:trackNumber</code></p>
</li>
<li>
<p><code>xmpDM:Tracks</code></p>
</li>
<li>
<p><code>xmpDM:videoAlphaMode</code></p>
</li>
<li>
<p><code>xmpDM:videoAlphaPremultipleColor</code></p>
</li>
<li>
<p><code>xmpDM:videoAlphaUnityIsTransparent</code></p>
</li>
<li>
<p><code>xmpDM:videoColorSpace</code></p>
</li>
<li>
<p><code>xmpDM:videoCompressor</code></p>
</li>
<li>
<p><code>xmpDM:videoFieldOrder</code></p>
</li>
<li>
<p><code>xmpDM:videoFrameRate</code></p>
</li>
<li>
<p><code>xmpDM:videoFrameSize</code></p>
</li>
<li>
<p><code>xmpDM:videoPixelAspectRatio</code></p>
</li>
<li>
<p><code>xmpDM:videoPixelDepth</code></p>
</li>
<li>
<p><code>xmpDM:partOfCompilation</code></p>
</li>
<li>
<p><code>xmpDM:lyrics</code></p>
</li>
<li>
<p><code>xmpDM:discNumber</code></p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_plus"><a class="anchor" href="#_plus"></a>A.2.9. PLUS</h4>
<div class="paragraph">
<p>Only the following PLUS properties are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>plus:Version</code></p>
</li>
<li>
<p><code>plus:ImageType</code></p>
</li>
<li>
<p><code>plus:FileNameAsDelivered</code></p>
</li>
<li>
<p><code>plus:ImageFileFormatAsDelivered</code></p>
</li>
<li>
<p><code>plus:ImageFileSizeAsDelivered</code></p>
</li>
<li>
<p><code>plus:FirstPublicationDate</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information about these, see <a href="http://ns.useplus.org/LDF/ldf-XMPSpecification" class="bare">http://ns.useplus.org/LDF/ldf-XMPSpecification</a>.</p>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="footer-main">
    <figure class="footer-brand">
      <a class="logo" href="https://c2pa.org"><img src="../../../_/img/C2PA-logo.svg" alt="C2PA" width="64"></a>
      <figcaption class="footer-brand-name"><a href="https://c2pa.org">C2PA</a></figcaption>
    </figure>
    <ul class="footer-brand-links">
      <li><a href="https://c2pa.org" target="_blank" rel="noopener">Home</a></li>
      <li><a href="https://c2pa.org/specifications">Docs</a></li>
      <li><a href="https://github.com/c2pa-org" target="_blank" rel="noopener">Project</a></li>
    </ul>
    <p class="footer-brand-follow">
      <a href="https://twitter.com/c2pa_org" title="Follow us on Twitter" target="_blank" rel="noopener"><img src="../../../_/img/twitter-logo.svg" alt="Twitter logo" class="logo" width="28"><span class="handle">@C2PA_org</span></a>
    </p>
  </div>
  <div class="footer-legal">
    <p>Copyright © 2024 Coalition for Content Provenance and Authenticity (C2PA). Except where noted, the content is licensed under a Creative Commons Attribution 4.0 International (CC BY 4.0) license.</p>
    <p>The <a href="https://github.com/asciidoctor/asciidoctor-docs-ui" target="_blank" rel="noopener">UI for this site</a> is derived from the Antora default UI and is licensed under the MPL-2.0 license. Several icons are imported from <a href="https://primer.style/octicons/" target="_blank" rel="noopener">Octicons</a> and are licensed under the MIT license.</p>
  </div>
  <div class="footer-thanks">
    <p>Thanks to our <a href="https://c2pa.org/membership/" target="_blank" rel="noopener">membership</a> for helping to make this project possible.</p>
    <p>Authored in AsciiDoc.<br>Produced by <a href="https://antora.org" target="_blank" rel="noopener">Antora</a> and <a href="https://asciidoctor.org" target="_blank" rel="noopener">Asciidoctor</a>.</p>
  </div>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/vendor/search.js" id="search-script" data-base-path="../../.." data-page-path="/specifications/2.0/specs/C2PA_Specification.html"></script>
<script async src="../../../_/../search-index.js"></script>

  </body>
</html>
